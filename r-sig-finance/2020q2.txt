From tr@v|@g|e|th @end|ng |rom gm@||@com  Wed Apr  1 19:39:05 2020
From: tr@v|@g|e|th @end|ng |rom gm@||@com (travisgleith .)
Date: Wed, 1 Apr 2020 21:39:05 +0400
Subject: [R-SIG-Finance] rugarch bug or my mistake?
Message-ID: <CACK0adF9V4bHKjA5yspAs7JtNXViRbB7-ZpcfwYQgVkP7oAgww@mail.gmail.com>

This is my first post to this mailing list so I apologize if I am out of
order here.

I tried to ask this question on an online forum but got shot down
<https://stats.stackexchange.com/questions/457924/is-this-a-bug-in-rugarch-or-is-the-forecast-supposed-to-conceal-the-first-forec?noredirect=1#comment849108_457924>

library(magrittr)
library(rugarch)
data = c(0.00448915878069781,-0.00593011429139564,-0.00521660375977179,0.00915792713276595,0.0281576105073823,0.00312671172731763,0.00354620561645788,-0.0116968104863564,0.00885293595922043,0.0107479700328324,-0.00286887922892909,-0.0157860645324253,-0.00034496291769634,0.00834156289619709,-0.0118426954076351,-0.0245429072803506,0.00920654078852251,-0.0194853526917377,0.0101437726804425,0.0121099494070556,0.0035482064346366,-0.00229786350435077,-0.00733982114587459,-0.00459640558705143,-0.012915903683943,-0.019073989784277,0.0126645393062962,0.00721493361382838,0.00999175394461038,0.0133412046238938,0.00648737743848443,-0.00562686238554141,-0.00330281416051201,0.00799100742663728,0.000663186933227922,0.0148432054223313,0.00196669935473182,-0.000615357170258429,0.00113636710367157,-0.0194719951587255,0.0169620174351603,-0.0131164201273478,-0.0135647068283389,-0.00438317321680465,-0.0147236772598623,0.00448073182498596,-0.00388037967044466,0.0258503616763401,0.00971753055430585,-0.00790819347457519,-0.00755558584805335,-0.0171629980145799,0.0107626388061985,-0.0105764253253602,-0.00728398157712776,-0.00098385324839817,0.00401832316660708,-0.00123931628811594,0.0117077717740899,0.017917887402996,0.010911835646347,-0.00827245645002914,-0.00906077086137638,-0.0205094556293795,-0.00737675894931045,-0.00690210266337801,0.020337194824323,0.00700174492576033,0.000228651273513847,-0.0143788420968017,0.013170014653836,-0.0041840803265823,-0.00998018021662783,-0.00773937960715987,0.0150502886036981,-0.00281352468848173,-0.0106468266964306,0.00603505797098974,0.00448080249830074,0.00828145475545461,0.000440945562519113,-0.0100964576962305,-0.00160882489466677,-0.000137141351361142,0.00954377280816113,0.00208528678239533,0.0209006426760515,0.00156626715014618,-0.00691347744367798,-0.00860724032017463,0.0110129635734199,0.00446238531960588,-0.0112374698383101,-0.0276009587172153,0.000631167643944636,0.000455412294070562,-0.000428413112601861,-0.00468012712974619,-0.0132383598723957,0.0272178690714789,0.0346151554938807,0.00428132065168324,-0.0135193549155817,-0.0161119996079523)

m_g_spec = ugarchspec(
  mean.model = list(
    armaOrder = c(1,2)
    , include.mean = T
    , archm = F
    , arfima = F
  )
  , distribution.model = "norm"
  , variance.model = list(model = "sGARCH", garchOrder = c(1,1)))

m_g_fit = ugarchfit(m_g_spec, data, solver = "hybrid")
f = ugarchforecast(m_g_fit)
plot(f, which = 1)

f at model$modeldata$data %>% tail(1) %>% {abline(h = .)}
f at forecast$seriesFor[1] %>% {abline(h = ., col = "red")}

The above code generates a chart.
The black horizontal line shows the last value of the input data. The red
line shows the first value of the forecast. Where did the last value in the
blue series come from? The blue series is supposed to show actual data, but
this last value is not in the input data. It seems to be the first forecast
value but it is not given in the forecast object. Any idea what is going
on?

	[[alternative HTML version deleted]]


From @|ex|o@ @end|ng |rom 4d@c@pe@com  Wed Apr  1 20:21:01 2020
From: @|ex|o@ @end|ng |rom 4d@c@pe@com (alexios galanos)
Date: Wed, 1 Apr 2020 11:21:01 -0700
Subject: [R-SIG-Finance] rugarch bug or my mistake?
In-Reply-To: <CACK0adF9V4bHKjA5yspAs7JtNXViRbB7-ZpcfwYQgVkP7oAgww@mail.gmail.com>
References: <CACK0adF9V4bHKjA5yspAs7JtNXViRbB7-ZpcfwYQgVkP7oAgww@mail.gmail.com>
Message-ID: <cfc45241-59ae-4fd4-b38d-9cea7b500f8c@4dscape.com>

There is no discrepancy here. It is just the way the plot is generated 
to connect the last value in the data with the first value in the forecast.
Instead of plotting, you could just look at the data:

 > tail(f at model$modeldata$data,1)
[1] -0.016112
 > tail(f at model$modeldata$data,1)
[1] -0.016112
 > head(f at forecast$seriesFor)
     1970-04-14 16:00:00
T+1        -0.001220014
T+2         0.002245227
T+3         0.001834683
T+4         0.001518531
T+5         0.001275068
T+6         0.001087582

-Alexios

On 4/1/20 10:39 AM, travisgleith . wrote:
> This is my first post to this mailing list so I apologize if I am out of
> order here.
> 
> I tried to ask this question on an online forum but got shot down
> <https://stats.stackexchange.com/questions/457924/is-this-a-bug-in-rugarch-or-is-the-forecast-supposed-to-conceal-the-first-forec?noredirect=1#comment849108_457924>
> 
> library(magrittr)
> library(rugarch)
> data = c(0.00448915878069781,-0.00593011429139564,-0.00521660375977179,0.00915792713276595,0.0281576105073823,0.00312671172731763,0.00354620561645788,-0.0116968104863564,0.00885293595922043,0.0107479700328324,-0.00286887922892909,-0.0157860645324253,-0.00034496291769634,0.00834156289619709,-0.0118426954076351,-0.0245429072803506,0.00920654078852251,-0.0194853526917377,0.0101437726804425,0.0121099494070556,0.0035482064346366,-0.00229786350435077,-0.00733982114587459,-0.00459640558705143,-0.012915903683943,-0.019073989784277,0.0126645393062962,0.00721493361382838,0.00999175394461038,0.0133412046238938,0.00648737743848443,-0.00562686238554141,-0.00330281416051201,0.00799100742663728,0.000663186933227922,0.0148432054223313,0.00196669935473182,-0.000615357170258429,0.00113636710367157,-0.0194719951587255,0.0169620174351603,-0.0131164201273478,-0.0135647068283389,-0.00438317321680465,-0.0147236772598623,0.00448073182498596,-0.00388037967044466,0.0258503616763401,0.00971753055430585,-0.0079
>   0819347457519,-0.00755558584805335,-0.0171629980145799,0.0107626388061985,-0.0105764253253602,-0.00728398157712776,-0.00098385324839817,0.00401832316660708,-0.00123931628811594,0.0117077717740899,0.017917887402996,0.010911835646347,-0.00827245645002914,-0.00906077086137638,-0.0205094556293795,-0.00737675894931045,-0.00690210266337801,0.020337194824323,0.00700174492576033,0.000228651273513847,-0.0143788420968017,0.013170014653836,-0.0041840803265823,-0.00998018021662783,-0.00773937960715987,0.0150502886036981,-0.00281352468848173,-0.0106468266964306,0.00603505797098974,0.00448080249830074,0.00828145475545461,0.000440945562519113,-0.0100964576962305,-0.00160882489466677,-0.000137141351361142,0.00954377280816113,0.00208528678239533,0.0209006426760515,0.00156626715014618,-0.00691347744367798,-0.00860724032017463,0.0110129635734199,0.00446238531960588,-0.0112374698383101,-0.0276009587172153,0.000631167643944636,0.000455412294070562,-0.000428413112601861,-0.00468012712974619,-0.0132383598
>   723957,0.0272178690714789,0.0346151554938807,0.00428132065168324,-0.0135193549155817,-0.0161119996079523)
> 
> m_g_spec = ugarchspec(
>    mean.model = list(
>      armaOrder = c(1,2)
>      , include.mean = T
>      , archm = F
>      , arfima = F
>    )
>    , distribution.model = "norm"
>    , variance.model = list(model = "sGARCH", garchOrder = c(1,1)))
> 
> m_g_fit = ugarchfit(m_g_spec, data, solver = "hybrid")
> f = ugarchforecast(m_g_fit)
> plot(f, which = 1)
> 
> f at model$modeldata$data %>% tail(1) %>% {abline(h = .)}
> f at forecast$seriesFor[1] %>% {abline(h = ., col = "red")}
> 
> The above code generates a chart.
> The black horizontal line shows the last value of the input data. The red
> line shows the first value of the forecast. Where did the last value in the
> blue series come from? The blue series is supposed to show actual data, but
> this last value is not in the input data. It seems to be the first forecast
> value but it is not given in the forecast object. Any idea what is going
> on?
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> 

From @h@wntkh93 @end|ng |rom y@hoo@com@@g  Fri Apr  3 17:15:18 2020
From: @h@wntkh93 @end|ng |rom y@hoo@com@@g (shawn tan)
Date: Fri, 3 Apr 2020 15:15:18 +0000 (UTC)
Subject: [R-SIG-Finance] Selection of appropriate copula family for
 multivariate Monte Carlo simulation of asset returns
References: <1812816871.152175.1585926918167.ref@mail.yahoo.com>
Message-ID: <1812816871.152175.1585926918167@mail.yahoo.com>

Hi R Sig Finance mailing list,
I am currently trying to perform a multivariate Monte Carlo simulation of asset class returns. I found that using copulas can overcome the non-normality of asset class returns as well as better simulate dependence between returns.
In terms of selecting and applying copulas via R, I found the following R packages VineCopula and copula. The BiCopSelect function in VineCopula package is able to recommend the appropriate copula family based on bivariate data. However, I cannot seem to find any function in the packages that is able to recommend the appropriate copula family based on multivariate data (e.g. modelling 3 or more asset classes).?
Is anyone able to suggest how I can identify the appropriate copula family using an R function? Would you be able to show me a sample code, based on say historical returns of 3 equity securities.
Thanks in advance
Regards
Shawn
	[[alternative HTML version deleted]]


From peter@ruckde@che| @end|ng |rom web@de  Thu Apr  9 15:06:37 2020
From: peter@ruckde@che| @end|ng |rom web@de (Peter Ruckdeschel)
Date: Thu, 9 Apr 2020 15:06:37 +0200
Subject: [R-SIG-Finance] Singular matrix in DCC fit in package rmgarch | how
 to bypass base::solve() elegantly
Message-ID: <ebc7c5eb-9a86-ac1a-9a7d-74496782461e@web.de>

Dear Alexis,? dear colleagues,

a student of mine, Patrick Harren (CC), is currently writing his master thesis with me as advisor.

He is to write on portfolio optimization for many assets by means of dynamic elliptical copulas
using a DCC-GARCH model as implemented in R package rmgarch.

In his code he is stumbling on errors of form

??? "error: matrix multiplication: problem with matrix inverse; suggest to use solve() instead"

I am not surprised this happens, as he has a p>n situation, i.e. more assets than observations,
so I would guess this is due to singular matrices which at some point of the code is to be inverted.

Is there any [easy] way to replace the general solver base::solve() by something like MASS::ginv()
for this purpose, or, if appropriate, would you suggest another regularization, say by some sort of
shrinkage?

Any suggestions welcome, thank you already,

best regards, Peter Ruckdeschel

--
%******************************************************************
% Prof. Dr. Peter Ruckdeschel
% Institut fuer Mathematik, Fakultaet V - Mathematik und Naturwissenschaften
% Carl von Ossietzky Universitaet Oldenburg,
% Postfach 25 03,  26111 Oldenburg
% Office: Wechloy W1 02-227 Tel: +49 (0)441 798-3240  Fax: +49 (0)441 798-193240
% peter.ruckdeschel at uni-oldenburg.de
% http://www.uni-oldenburg.de/peter-ruckdeschel
%******************************************************************


--
Diese E-Mail wurde von Avast Antivirus-Software auf Viren gepr?ft.
https://www.avast.com/antivirus


From @|ex|o@ @end|ng |rom 4d@c@pe@com  Sun Apr 12 04:43:08 2020
From: @|ex|o@ @end|ng |rom 4d@c@pe@com (alexios galanos)
Date: Sat, 11 Apr 2020 19:43:08 -0700
Subject: [R-SIG-Finance] 
 Singular matrix in DCC fit in package rmgarch | how
 to bypass base::solve() elegantly
In-Reply-To: <ebc7c5eb-9a86-ac1a-9a7d-74496782461e@web.de>
References: <ebc7c5eb-9a86-ac1a-9a7d-74496782461e@web.de>
Message-ID: <5dcdfdec-adaa-3584-b073-d595139f1435@4dscape.com>

Hi Peter,

I'm not sure whether switching to generalized inverse will be a sensible 
or feasible approach in a DCC situation when p>n. The underlying code 
makes use of RcppArmadillo and you could try to switch out inv with pinv...

However, perhaps a more reasonable approach would be to:

1. Use a factor model (e.g. GO-GARCH)
2. Regularization/Shrinkage, but these have not been implemented in 
rmgarch, and I haven't looked at the literature recently to see what 
approaches and models have been proposed


Best,

Alexios

On 4/9/20 6:06 AM, Peter Ruckdeschel wrote:
> Dear Alexis,? dear colleagues,
> 
> a student of mine, Patrick Harren (CC), is currently writing his master thesis with me as advisor.
> 
> He is to write on portfolio optimization for many assets by means of dynamic elliptical copulas
> using a DCC-GARCH model as implemented in R package rmgarch.
> 
> In his code he is stumbling on errors of form
> 
>  ??? "error: matrix multiplication: problem with matrix inverse; suggest to use solve() instead"
> 
> I am not surprised this happens, as he has a p>n situation, i.e. more assets than observations,
> so I would guess this is due to singular matrices which at some point of the code is to be inverted.
> 
> Is there any [easy] way to replace the general solver base::solve() by something like MASS::ginv()
> for this purpose, or, if appropriate, would you suggest another regularization, say by some sort of
> shrinkage?
> 
> Any suggestions welcome, thank you already,
> 
> best regards, Peter Ruckdeschel
> 
> --
> %******************************************************************
> % Prof. Dr. Peter Ruckdeschel
> % Institut fuer Mathematik, Fakultaet V - Mathematik und Naturwissenschaften
> % Carl von Ossietzky Universitaet Oldenburg,
> % Postfach 25 03,  26111 Oldenburg
> % Office: Wechloy W1 02-227 Tel: +49 (0)441 798-3240  Fax: +49 (0)441 798-193240
> % peter.ruckdeschel at uni-oldenburg.de
> % http://www.uni-oldenburg.de/peter-ruckdeschel
> %******************************************************************
> 
> 
> --
> Diese E-Mail wurde von Avast Antivirus-Software auf Viren gepr?ft.
> https://www.avast.com/antivirus
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From @@n|@@w@dud @end|ng |rom gm@||@com  Wed Apr 22 21:20:22 2020
From: @@n|@@w@dud @end|ng |rom gm@||@com (Sania Wadud)
Date: Wed, 22 Apr 2020 20:20:22 +0100
Subject: [R-SIG-Finance] Fwd: VARMA DCC GARCH with external dummy variable
 in mean and variance model
In-Reply-To: <801607829.402263.1585500063561.JavaMail.administrator@n4.nabble.com>
References: <801607829.402263.1585500063561.JavaMail.administrator@n4.nabble.com>
Message-ID: <CAECzKZb0UjyTR6E4qRRrzDKRWYTEmeis1fu9jJM7UfHC_UWpUA@mail.gmail.com>

Hi,

I would like to know whether there is any way to extract off diagonal
elements for ARCH and GARCH parameter to allow for volatility spillover
(DCC-GARCH) via rmgarch package. As far as I know there was an option to
select "extended" model in ccgarch package to allow spillovers. As I am
using VARX-DCC GARCH model, I can only get spilover effects for conditional
mean and not for volatility equations. However, I require results for
volatility transmission of one series to another series. Is there any
particular model that I need to select to get such results for variance
equation?

Any assistance would be greatly appreciated.

Regards,
Sania





_____________________________________
Sent from https://r.789695.n4.nabble.com

	[[alternative HTML version deleted]]


From m@r|ne1v@ne @end|ng |rom gm@||@com  Mon May  4 04:35:43 2020
From: m@r|ne1v@ne @end|ng |rom gm@||@com (Duke Vane)
Date: Sun, 3 May 2020 22:35:43 -0400
Subject: [R-SIG-Finance] Questions about IBrokers package
Message-ID: <CAO3+UYxhujogAbG4k1_TuKDhBeGCMhvvLhyufLV0E7Sa95Kavg@mail.gmail.com>

Good day,

I have been using the IBrokers package for a few years now and as my coding
skill has gotten better I have decided now is the time to start
contributing to Open Source code that I have found valuable. I am an
economist and while I have had to program functions from time to time it is
not a mainstay of the job. However, the stay at home order has given me
room to make programming a mainstay.

To help me get started I'd like to confirm if I am correct on the following:
IBrokers does not use Roxygen2 to generate the help documentation, right? I
am reading Hadley Wickhams R-Packages book and he creates documentation
differently. Since my first contributions would be along the lines of
expanding the documentation I want to know if I can use the style from
R-Packages, or if I have to conform to the .Rd style I see when I clone the
IBrokers repo.

Even more importantly would you mind if I tried to help contribute to the
IBrokers package? I use the TWS platform everyday and hopefully can solve
some of the open issues with some guidance.

Thank you,

-- 
Duke

*"Don't give up. Everything worth doing is hard."*

	[[alternative HTML version deleted]]


From p@||e@ch|tz @end|ng |rom out|ook@com  Mon May  4 14:21:20 2020
From: p@||e@ch|tz @end|ng |rom out|ook@com (Johan Palleschitz)
Date: Mon, 4 May 2020 12:21:20 +0000
Subject: [R-SIG-Finance] Questions about IBrokers package
In-Reply-To: <CAO3+UYxhujogAbG4k1_TuKDhBeGCMhvvLhyufLV0E7Sa95Kavg@mail.gmail.com>
References: <CAO3+UYxhujogAbG4k1_TuKDhBeGCMhvvLhyufLV0E7Sa95Kavg@mail.gmail.com>
Message-ID: <AM4PR0101MB213125B4E1CF29A85EC57CD8B7A60@AM4PR0101MB2131.eurprd01.prod.exchangelabs.com>


Good afternoon Duke,

Happy to read your input below. I am by no means in a position answer your questions below, but i would be happy to help, test and see how we can expand the usability. 

I am currently stuck on finding a clever solution to pull greeks and simulate option holdings. 

Let me know if you need any inputs!

Wish everyone a nice day!


Johan Palleschitz, FRM
+356 9999 9714

> On 4 May 2020, at 04:36, Duke Vane <marine1vane at gmail.com> wrote:
> 
> ?Good day,
> 
> I have been using the IBrokers package for a few years now and as my coding
> skill has gotten better I have decided now is the time to start
> contributing to Open Source code that I have found valuable. I am an
> economist and while I have had to program functions from time to time it is
> not a mainstay of the job. However, the stay at home order has given me
> room to make programming a mainstay.
> 
> To help me get started I'd like to confirm if I am correct on the following:
> IBrokers does not use Roxygen2 to generate the help documentation, right? I
> am reading Hadley Wickhams R-Packages book and he creates documentation
> differently. Since my first contributions would be along the lines of
> expanding the documentation I want to know if I can use the style from
> R-Packages, or if I have to conform to the .Rd style I see when I clone the
> IBrokers repo.
> 
> Even more importantly would you mind if I tried to help contribute to the
> IBrokers package? I use the TWS platform everyday and hopefully can solve
> some of the open issues with some guidance.
> 
> Thank you,
> 
> -- 
> Duke
> 
> *"Don't give up. Everything worth doing is hard."*
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-finance&amp;data=02%7C01%7C%7C044ae0040e114545457608d7efd3ea10%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C637241565758024027&amp;sdata=ut0X3siewdAPuT8mBzWHOG1mu7vlsDOx8DXM9JQY1NI%3D&amp;reserved=0
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

From @pt|h@ny| @end|ng |rom y@hoo@com  Mon May  4 18:07:55 2020
From: @pt|h@ny| @end|ng |rom y@hoo@com (Sacha Tihanyi)
Date: Mon, 4 May 2020 16:07:55 +0000 (UTC)
Subject: [R-SIG-Finance] Please remove this email from your distribution list
References: <1237205390.666479.1588608475787.ref@mail.yahoo.com>
Message-ID: <1237205390.666479.1588608475787@mail.yahoo.com>

Please remove this email from your distribution list?


Sent from Yahoo Mail for iPhone

	[[alternative HTML version deleted]]


From |r@|nj @end|ng |rom tcd@|e  Mon May  4 23:22:28 2020
From: |r@|nj @end|ng |rom tcd@|e (John Frain)
Date: Mon, 4 May 2020 22:22:28 +0100
Subject: [R-SIG-Finance] Please remove this email from your distribution
 list
In-Reply-To: <1237205390.666479.1588608475787@mail.yahoo.com>
References: <1237205390.666479.1588608475787.ref@mail.yahoo.com>
 <1237205390.666479.1588608475787@mail.yahoo.com>
Message-ID: <CAJWf-11dAEsfFjyCe1fmPrTqqaAbNaZF0LiRnJZOQGWuVmtV5w@mail.gmail.com>

You must do that yourself. Use the link at the foot of any email you
receive from this distribution list

John C Frain, Ph.D.

Economics Department             3 Aranleigh Park
Trinity College Dublin                 Rathfarnham
College Green                           Dublin 14
Dublin 2                                    Ireland
Ireland
www.tcd.ie/Economics/staff/frainj/home.htm
mailto:frainj at tcd.ie
mailto:frainj at gmail.com


On Mon, 4 May 2020 at 17:08, Sacha Tihanyi via R-SIG-Finance <
r-sig-finance at r-project.org> wrote:

> Please remove this email from your distribution list
>
>
> Sent from Yahoo Mail for iPhone
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From @pt|h@ny| @end|ng |rom y@hoo@com  Tue May  5 02:20:31 2020
From: @pt|h@ny| @end|ng |rom y@hoo@com (Sacha Tihanyi)
Date: Tue, 5 May 2020 00:20:31 +0000 (UTC)
Subject: [R-SIG-Finance] Please remove this email from your distribution
 list
In-Reply-To: <CAJWf-11dAEsfFjyCe1fmPrTqqaAbNaZF0LiRnJZOQGWuVmtV5w@mail.gmail.com>
References: <1237205390.666479.1588608475787.ref@mail.yahoo.com>
 <1237205390.666479.1588608475787@mail.yahoo.com>
 <CAJWf-11dAEsfFjyCe1fmPrTqqaAbNaZF0LiRnJZOQGWuVmtV5w@mail.gmail.com>
Message-ID: <1628702024.872875.1588638031008@mail.yahoo.com>

Thank you?


Sent from Yahoo Mail for iPhone


On Monday, May 4, 2020, 5:30 PM, John Frain <frainj at tcd.ie> wrote:

You must do that yourself. Use the link at the foot of any email you receive from this distribution list
John C Frain, Ph.D.

Economics Department ? ? ? ? ? ? 3 Aranleigh ParkTrinity College Dublin ? ? ? ? ? ? ? ? RathfarnhamCollege Green ? ? ? ? ? ? ? ? ? ? ? ? ? Dublin 14Dublin 2 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?Ireland
Irelandwww.tcd.ie/Economics/staff/frainj/home.htm
mailto:frainj at tcd.ie
mailto:frainj at gmail.com

On Mon, 4 May 2020 at 17:08, Sacha Tihanyi via R-SIG-Finance <r-sig-finance at r-project.org> wrote:

Please remove this email from your distribution list?


Sent from Yahoo Mail for iPhone

? ? ? ? [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.





	[[alternative HTML version deleted]]


From deb@@|@hm@|tr@ @end|ng |rom gm@||@com  Wed May  6 15:44:26 2020
From: deb@@|@hm@|tr@ @end|ng |rom gm@||@com (DEBASISH MAITRA)
Date: Wed, 6 May 2020 19:14:26 +0530
Subject: [R-SIG-Finance] Help regarding SVARMA
Message-ID: <CA+=JsgT3Sxw0+UymMFjN-Oe_hD9gJ6FzLz5kzy98R4QbVTYWbQ@mail.gmail.com>

Dear Friends,
Greetings! I hope all you are safe at this trying time!
I have been trying to fit an structural vector autoregression and moving
average (SVARMA) model on 3 time series , for example, GDP growth, interest
rates, and inflation. I find there are packages to estimate SVAR or VARMA
model. However, I am not able to merge SVAR with MA components. SVARMA
model offers better way to estimate impulse response with less number of
lags as compared to SVAR.

It would be of great help if anyone of you can kindly show me the way.

Thanking you in advance!
Wish everyone a good day!

Regards,
Debasish Maitra



-- 
Debasish Maitra
Faculty
Indian Institute of Management Indore
Indore 453556

	[[alternative HTML version deleted]]


From @@chm|d1 @end|ng |rom @teven@@edu  Thu May 21 21:17:57 2020
From: @@chm|d1 @end|ng |rom @teven@@edu (Alec Schmidt)
Date: Thu, 21 May 2020 19:17:57 +0000
Subject: [R-SIG-Finance] effects of events that happened at the same time
Message-ID: <MN2PR10MB4272222C51A9B0FF0417576F84B70@MN2PR10MB4272.namprd10.prod.outlook.com>

I usually use some arma (+garch) model with dummy variables to study the effects of various events that happen on different days. I wonder if there is some way to discern their impacts if the events happen simultaneously, e.g. all macroeconomic announcements in some country are published on the last days of the month.
Thanks! Alec

	[[alternative HTML version deleted]]


From br|@n @end|ng |rom br@verock@com  Thu May 21 23:08:45 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Thu, 21 May 2020 16:08:45 -0500
Subject: [R-SIG-Finance] 
 effects of events that happened at the same time
In-Reply-To: <MN2PR10MB4272222C51A9B0FF0417576F84B70@MN2PR10MB4272.namprd10.prod.outlook.com>
References: <MN2PR10MB4272222C51A9B0FF0417576F84B70@MN2PR10MB4272.namprd10.prod.outlook.com>
Message-ID: <a131d4118f4b15adf85d2bb189179f3bc2672ca5.camel@braverock.com>

On Thu, 2020-05-21 at 19:17 +0000, Alec Schmidt wrote:
> I usually use some arma (+garch) model with dummy variables to study
> the effects of various events that happen on different days. I wonder
> if there is some way to discern their impacts if the events happen
> simultaneously, e.g. all macroeconomic announcements in some country
> are published on the last days of the month.Thanks! Alec

The usual way of dealing with intreaday events is to use intraday
data.  tick, minute, or hourly data is widely available globally.
Regards,
Brian


-- 
Brian G. Peterson
ph: +1.773.459.4973
im: bgpbraverock

	[[alternative HTML version deleted]]


From @@chm|d1 @end|ng |rom @teven@@edu  Thu May 21 23:23:22 2020
From: @@chm|d1 @end|ng |rom @teven@@edu (Alec Schmidt)
Date: Thu, 21 May 2020 21:23:22 +0000
Subject: [R-SIG-Finance] 
 effects of events that happened at the same time
In-Reply-To: <a131d4118f4b15adf85d2bb189179f3bc2672ca5.camel@braverock.com>
References: <MN2PR10MB4272222C51A9B0FF0417576F84B70@MN2PR10MB4272.namprd10.prod.outlook.com>,
 <a131d4118f4b15adf85d2bb189179f3bc2672ca5.camel@braverock.com>
Message-ID: <MN2PR10MB42725CF46A9C2BB0C2D493FE84B70@MN2PR10MB4272.namprd10.prod.outlook.com>

Thank you Brian,
Unfortunately all timestamps are the same (all announcements are published after trading hours on the same day). I'm thinking now about comparing synthetic combos (sums of various Z-scores) to find which combo has the highest impact.

Regards, Alec

________________________________
From: Brian G. Peterson <brian at braverock.com>
Sent: Thursday, May 21, 2020 5:08 PM
To: Alec Schmidt <aschmid1 at stevens.edu>; r-sig-finance at r-project.org <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] effects of events that happened at the same time

On Thu, 2020-05-21 at 19:17 +0000, Alec Schmidt wrote:

I usually use some arma (+garch) model with dummy variables to study the effects of various events that happen on different days. I wonder if there is some way to discern their impacts if the events happen simultaneously, e.g. all macroeconomic announcements in some country are published on the last days of the month.

Thanks! Alec

The usual way of dealing with intreaday events is to use intraday data. tick, minute, or hourly data is widely available globally.

Regards,

Brian



--

Brian G. Peterson
ph: +1.773.459.4973
im: bgpbraverock


	[[alternative HTML version deleted]]


From p@nk@j@b| @end|ng |rom y@hoo@com  Sun May 24 06:32:41 2020
From: p@nk@j@b| @end|ng |rom y@hoo@com (Pankaj K Agarwal)
Date: Sun, 24 May 2020 04:32:41 +0000 (UTC)
Subject: [R-SIG-Finance] Removing Effect of Macroeconomic Variables from
 Time Series
References: <1855592463.2659665.1590294761981.ref@mail.yahoo.com>
Message-ID: <1855592463.2659665.1590294761981@mail.yahoo.com>

Dear All
This question may sound weakly relevant/rudimentary in this group but any help would be invaluable. I am trying to modify a time series of market volume/trading etc. data and would like to remove the effect of macroeconomic variables like interest rates and inflation removed.?
Could someone please advise how is this performed?
Regards,Pankaj K Agarwal
+91-98397-11444http://in.linkedin.com/in/pankajkagarwal/
	[[alternative HTML version deleted]]


From @j@y@h@h @end|ng |rom m@y|n@org  Sun May 24 08:28:35 2020
From: @j@y@h@h @end|ng |rom m@y|n@org (Ajay Shah)
Date: Sun, 24 May 2020 11:58:35 +0530
Subject: [R-SIG-Finance] Removing Effect of Macroeconomic Variables from
 Time Series
In-Reply-To: <1855592463.2659665.1590294761981@mail.yahoo.com>
References: <1855592463.2659665.1590294761981.ref@mail.yahoo.com>
 <1855592463.2659665.1590294761981@mail.yahoo.com>
Message-ID: <CA++P4r3O-B2EfmOFYrYsad2Azcs7USpaWds3-5NFTdjYAgHJ5A@mail.gmail.com>

There is one reasonably well established concept, of "augmented market
models" that are used to purge stock returns of the effects of the stock
market, the exchange rate, etc.

The R package for event studies <https://github.com/nipfpmf/eventstudies>
has a function lmAMM() which does this carefully, e.g. as shown in Patnaik
& Shah 2010
<http://macrofinance.nipfp.org.in/PDF/does-the-currency-regime-shape-unhedged-currency-exposure.pdf>.
Please be sure to fully understand and utilise the capabilities in makeX()
which has to be run before you get to lmAMM(). Many experienced researchers
have difficluties in published papers on these things, and wider use of
these concepts and the package will help.

The paper and package are written around *stock returns ~ market index +
exchange rate*. But the ideas and code are general and can be applied in
many other ways. Please do tell us about your experiences.

-- 
Ajay Shah
ajayshah at mayin.org
http://www.mayin.org/ajayshah

	[[alternative HTML version deleted]]


From hennecke@@ndre@@ @end|ng |rom web@de  Thu May 28 18:18:04 2020
From: hennecke@@ndre@@ @end|ng |rom web@de (Andreas Henneck)
Date: Thu, 28 May 2020 18:18:04 +0200
Subject: [R-SIG-Finance] R quantstrat - filter consecutive entries
Message-ID: <c189f102-c0fd-39d4-f349-8715af667c41@web.de>

Dear all, being new to this list, kindly allow me to introduce myself: I
am an engineer by education, marketer of automation products by
profession and R fan of a few years. i am currently learning to program
technical trading rules for backtesting. The purpose is to stablize
investments and learn to trade. As neither a search through the last
three years of e-mail from this list nor a search through stackexchange
et al revealed an answer I would like to dare a post. I hope I? am not
being to basic with my request.

This first self-written strategy on EOD data is looking to follow trends
utilizing Bollinger Bands for indicating direction and Stochastik fastD
to detect entry points and exits with overbought and oversold positions.
My first version codes long only trades. The rules work all fine, the
problem is this:

Stochastic crosses a 0.25 threshold from below more than once, i.e. in a
slight downward trend thus triggering multiple consecutive entry orders,
before any exits or stops have triggered. This essentially increases
position size.

The essential question: What is the solution to entering a trade more
than once?

Looking forward to your responses and insight. Any additional tips for
quantstrat thinking or coding are appreciated. Below find some hopefully
illustrating code snippets.

Kind regards,
Andreas

##Not run <- not sure that I am using this properly here.

# Create indicators

BBTMDir = function(HLC, n = 10, sd = 1, nFastK = 5, nFastD = 2) {

 ?bb_dir <- # rules not essential to the problem, values look something
like: round(runif(5))

# Stochastic overbought and oversold indicator. Symmetry for simplicity:

 ? sto_sig <- sigThreshold(label = "StochSig", data = sto, column =
"fastD",
 ????????????????????????? threshold = 0.25, relationship = "gt", cross
= TRUE) * 1 +
 ??? sigThreshold(label = "StochSig", data = sto, column = "fastD",
 ???????????????? threshold = 0.75, relationship = "lt", cross = TRUE) * -1
 ? merge(bb_dir, sto_sig)? # return the two columns

# ... standard boiler plate quantstrat setup ...

s <- add.indicator( s, 'BBTMDir', label='BBTM',
 ??????????????????? arguments=list( HLC = quote(HLC(mktdata))) )

# Entry and exit rules based on bb_dir => BBDIR.BBTM as filter and
StochSig.BBTM like this:

s <- add.signal( s, 'sigFormula', label='StochEntryLong',
 ???????????????? arguments = list(cross = TRUE, formula = "BBDir.BBTM
== 1 & StochSig.BBTM == 1"))
s <- add.signal( s, 'sigFormula', label='StochExitLong',
 ???????????????? arguments = list(cross = TRUE, formula = "BBDir.BBTM
== 1 & StochSig.BBTM == -1"))

# as I am still learning and testing this, there are only these two
simple rules for now:

s <- add.rule(
 ? s, name='ruleSignal', type='enter', label='ChgDirLong',
 ? arguments = list(
 ??? sigcol="StochEntryLong", sigval=TRUE, orderqty=orderQ,
 ??? TxnFees=.txnfees,
 ??? ordertype='market', orderside='long', orderset = "ocolong"
 ? )
)

s <- add.rule(
 ? s, name='ruleSignal', type='exit', label='ExitChgDir',
 ? arguments = list(
 ??? sigcol="StochExitLong", sigval=TRUE, replace = TRUE, orderqty="all",
 ??? ordertype='market', orderside='long', orderset = "ocolong"
 ? )
)

# ...

applyStrategy( ...


From j@ymon0703 @end|ng |rom gm@||@com  Thu May 28 18:36:48 2020
From: j@ymon0703 @end|ng |rom gm@||@com (Jasen Mackie)
Date: Thu, 28 May 2020 12:36:48 -0400
Subject: [R-SIG-Finance] R quantstrat - filter consecutive entries
In-Reply-To: <c189f102-c0fd-39d4-f349-8715af667c41@web.de>
References: <c189f102-c0fd-39d4-f349-8715af667c41@web.de>
Message-ID: <CAE8+bE2XK4D6tzSHGKTcHoG4PCXdSa9YxPXJnzMg2fcUgEyZkw@mail.gmail.com>

Hi Andreas

Thanks for the question. In future, feel free to ask a question by creating
an issue on the project repo -
https://github.com/braverock/quantstrat/issues.

You are looking for the ?sigCrossover function.

The project README
<https://github.com/braverock/quantstrat/blob/master/README.md> on GitHub
can also help with more learning materials and as usual look into the demo
folder for concrete examples.

Good luck.

Regards
Jasen

On Thu, 28 May 2020 at 12:18, Andreas Henneck <hennecke.andreas at web.de>
wrote:

> Dear all, being new to this list, kindly allow me to introduce myself: I
> am an engineer by education, marketer of automation products by
> profession and R fan of a few years. i am currently learning to program
> technical trading rules for backtesting. The purpose is to stablize
> investments and learn to trade. As neither a search through the last
> three years of e-mail from this list nor a search through stackexchange
> et al revealed an answer I would like to dare a post. I hope I  am not
> being to basic with my request.
>
> This first self-written strategy on EOD data is looking to follow trends
> utilizing Bollinger Bands for indicating direction and Stochastik fastD
> to detect entry points and exits with overbought and oversold positions.
> My first version codes long only trades. The rules work all fine, the
> problem is this:
>
> Stochastic crosses a 0.25 threshold from below more than once, i.e. in a
> slight downward trend thus triggering multiple consecutive entry orders,
> before any exits or stops have triggered. This essentially increases
> position size.
>
> The essential question: What is the solution to entering a trade more
> than once?
>
> Looking forward to your responses and insight. Any additional tips for
> quantstrat thinking or coding are appreciated. Below find some hopefully
> illustrating code snippets.
>
> Kind regards,
> Andreas
>
> ##Not run <- not sure that I am using this properly here.
>
> # Create indicators
>
> BBTMDir = function(HLC, n = 10, sd = 1, nFastK = 5, nFastD = 2) {
>
>   bb_dir <- # rules not essential to the problem, values look something
> like: round(runif(5))
>
> # Stochastic overbought and oversold indicator. Symmetry for simplicity:
>
>    sto_sig <- sigThreshold(label = "StochSig", data = sto, column =
> "fastD",
>                            threshold = 0.25, relationship = "gt", cross
> = TRUE) * 1 +
>      sigThreshold(label = "StochSig", data = sto, column = "fastD",
>                   threshold = 0.75, relationship = "lt", cross = TRUE) * -1
>    merge(bb_dir, sto_sig)  # return the two columns
>
> # ... standard boiler plate quantstrat setup ...
>
> s <- add.indicator( s, 'BBTMDir', label='BBTM',
>                      arguments=list( HLC = quote(HLC(mktdata))) )
>
> # Entry and exit rules based on bb_dir => BBDIR.BBTM as filter and
> StochSig.BBTM like this:
>
> s <- add.signal( s, 'sigFormula', label='StochEntryLong',
>                   arguments = list(cross = TRUE, formula = "BBDir.BBTM
> == 1 & StochSig.BBTM == 1"))
> s <- add.signal( s, 'sigFormula', label='StochExitLong',
>                   arguments = list(cross = TRUE, formula = "BBDir.BBTM
> == 1 & StochSig.BBTM == -1"))
>
> # as I am still learning and testing this, there are only these two
> simple rules for now:
>
> s <- add.rule(
>    s, name='ruleSignal', type='enter', label='ChgDirLong',
>    arguments = list(
>      sigcol="StochEntryLong", sigval=TRUE, orderqty=orderQ,
>      TxnFees=.txnfees,
>      ordertype='market', orderside='long', orderset = "ocolong"
>    )
> )
>
> s <- add.rule(
>    s, name='ruleSignal', type='exit', label='ExitChgDir',
>    arguments = list(
>      sigcol="StochExitLong", sigval=TRUE, replace = TRUE, orderqty="all",
>      ordertype='market', orderside='long', orderset = "ocolong"
>    )
> )
>
> # ...
>
> applyStrategy( ...
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From hennecke@@ndre@@ @end|ng |rom web@de  Fri May 29 09:45:06 2020
From: hennecke@@ndre@@ @end|ng |rom web@de (Andreas Henneck)
Date: Fri, 29 May 2020 09:45:06 +0200
Subject: [R-SIG-Finance] R quantstrat - filter consecutive entries
In-Reply-To: <CAE8+bE2XK4D6tzSHGKTcHoG4PCXdSa9YxPXJnzMg2fcUgEyZkw@mail.gmail.com>
References: <c189f102-c0fd-39d4-f349-8715af667c41@web.de>
 <CAE8+bE2XK4D6tzSHGKTcHoG4PCXdSa9YxPXJnzMg2fcUgEyZkw@mail.gmail.com>
Message-ID: <c31b155a-b1ef-8fdf-e5ff-74616e37604d@web.de>

Hi Jasen et al,

thanks for the quick response and invite. I'll be glad to do post
questions on github.

sigThreshold, cross = TRUE responds as programmed and the same as I
would expect sigCrossover to work, when passing one parameter as a
constant. Just wording for the long side: Two consecutive entry signals
occur, i.e. stoch crosses the 0.25 threshold from below on a second
lower low, while the BB crossing has not switched to "short" yet. It is
more a question of the strategy not detecting a lower low well and thus
filtering a bad order to begin with. So the ways I am looking to explore
are:

 ? - objective for quantstrat programing:? filter consecutive entries
after an order has already been placed and filled.? How can quantstrat
solve this?

 ? - objective for strategy: improve the filter to be more responsive to
detect the change of direction. The literature suggests MAs for filters.
Any tips on specific I should explore?

Thanks and kind regards,
Andreas


Am 28.05.2020 um 18:36 schrieb Jasen Mackie:
> Hi Andreas
>
> Thanks for the question. In future, feel free to ask a question by
> creating an issue on the project repo -
> https://github.com/braverock/quantstrat/issues.
>
> You are looking for the ?sigCrossover function.
>
> The project README
> <https://github.com/braverock/quantstrat/blob/master/README.md> on
> GitHub can also help with more learning materials and as usual look
> into the demo folder for concrete examples.
>
> Good luck.
>
> Regards
> Jasen
>
> On Thu, 28 May 2020 at 12:18, Andreas Henneck <hennecke.andreas at web.de
> <mailto:hennecke.andreas at web.de>> wrote:
>
>     Dear all, being new to this list, kindly allow me to introduce
>     myself: I
>     am an engineer by education, marketer of automation products by
>     profession and R fan of a few years. i am currently learning to
>     program
>     technical trading rules for backtesting. The purpose is to stablize
>     investments and learn to trade. As neither a search through the last
>     three years of e-mail from this list nor a search through
>     stackexchange
>     et al revealed an answer I would like to dare a post. I hope I? am not
>     being to basic with my request.
>
>     This first self-written strategy on EOD data is looking to follow
>     trends
>     utilizing Bollinger Bands for indicating direction and Stochastik
>     fastD
>     to detect entry points and exits with overbought and oversold
>     positions.
>     My first version codes long only trades. The rules work all fine, the
>     problem is this:
>
>     Stochastic crosses a 0.25 threshold from below more than once,
>     i.e. in a
>     slight downward trend thus triggering multiple consecutive entry
>     orders,
>     before any exits or stops have triggered. This essentially increases
>     position size.
>
>     The essential question: What is the solution to entering a trade more
>     than once?
>
>     Looking forward to your responses and insight. Any additional tips for
>     quantstrat thinking or coding are appreciated. Below find some
>     hopefully
>     illustrating code snippets.
>
>     Kind regards,
>     Andreas
>
>     ##Not run <- not sure that I am using this properly here.
>
>     # Create indicators
>
>     BBTMDir = function(HLC, n = 10, sd = 1, nFastK = 5, nFastD = 2) {
>
>     ??bb_dir <- # rules not essential to the problem, values look
>     something
>     like: round(runif(5))
>
>     # Stochastic overbought and oversold indicator. Symmetry for
>     simplicity:
>
>     ?? sto_sig <- sigThreshold(label = "StochSig", data = sto, column =
>     "fastD",
>     ?????????????????????????? threshold = 0.25, relationship = "gt",
>     cross
>     = TRUE) * 1 +
>     ???? sigThreshold(label = "StochSig", data = sto, column = "fastD",
>     ????????????????? threshold = 0.75, relationship = "lt", cross =
>     TRUE) * -1
>     ?? merge(bb_dir, sto_sig)? # return the two columns
>
>     # ... standard boiler plate quantstrat setup ...
>
>     s <- add.indicator( s, 'BBTMDir', label='BBTM',
>     ???????????????????? arguments=list( HLC = quote(HLC(mktdata))) )
>
>     # Entry and exit rules based on bb_dir => BBDIR.BBTM as filter and
>     StochSig.BBTM like this:
>
>     s <- add.signal( s, 'sigFormula', label='StochEntryLong',
>     ????????????????? arguments = list(cross = TRUE, formula = "BBDir.BBTM
>     == 1 & StochSig.BBTM == 1"))
>     s <- add.signal( s, 'sigFormula', label='StochExitLong',
>     ????????????????? arguments = list(cross = TRUE, formula = "BBDir.BBTM
>     == 1 & StochSig.BBTM == -1"))
>
>     # as I am still learning and testing this, there are only these two
>     simple rules for now:
>
>     s <- add.rule(
>     ?? s, name='ruleSignal', type='enter', label='ChgDirLong',
>     ?? arguments = list(
>     ???? sigcol="StochEntryLong", sigval=TRUE, orderqty=orderQ,
>     ???? TxnFees=.txnfees,
>     ???? ordertype='market', orderside='long', orderset = "ocolong"
>     ?? )
>     )
>
>     s <- add.rule(
>     ?? s, name='ruleSignal', type='exit', label='ExitChgDir',
>     ?? arguments = list(
>     ???? sigcol="StochExitLong", sigval=TRUE, replace = TRUE,
>     orderqty="all",
>     ???? ordertype='market', orderside='long', orderset = "ocolong"
>     ?? )
>     )
>
>     # ...
>
>     applyStrategy( ...
>
>     _______________________________________________
>     R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>

	[[alternative HTML version deleted]]


From j@ymon0703 @end|ng |rom gm@||@com  Fri May 29 16:08:50 2020
From: j@ymon0703 @end|ng |rom gm@||@com (Jasen Mackie)
Date: Fri, 29 May 2020 10:08:50 -0400
Subject: [R-SIG-Finance] R quantstrat - filter consecutive entries
In-Reply-To: <c31b155a-b1ef-8fdf-e5ff-74616e37604d@web.de>
References: <c189f102-c0fd-39d4-f349-8715af667c41@web.de>
 <CAE8+bE2XK4D6tzSHGKTcHoG4PCXdSa9YxPXJnzMg2fcUgEyZkw@mail.gmail.com>
 <c31b155a-b1ef-8fdf-e5ff-74616e37604d@web.de>
Message-ID: <CAE8+bE1FBGOxn=k5c436TpFBeHbN6y896g-DUDYHr0GY20kU0A@mail.gmail.com>

Right i see. A minimum reproducible example will be helpful to understand
the questions properly and the repo on GH would be the ideal place to
continue the discussion.

Thanks
Jasen

On Fri, 29 May 2020 at 03:45, Andreas Henneck <hennecke.andreas at web.de>
wrote:

> Hi Jasen et al,
>
> thanks for the quick response and invite. I'll be glad to do post
> questions on github.
>
> sigThreshold, cross = TRUE responds as programmed and the same as I would
> expect sigCrossover to work, when passing one parameter as a constant. Just
> wording for the long side: Two consecutive entry signals occur, i.e. stoch
> crosses the 0.25 threshold from below on a second lower low, while the BB
> crossing has not switched to "short" yet. It is more a question of the
> strategy not detecting a lower low well and thus filtering a bad order to
> begin with. So the ways I am looking to explore are:
>
>   - objective for quantstrat programing:  filter consecutive entries after
> an order has already been placed and filled.  How can quantstrat solve
> this?
>
>   - objective for strategy: improve the filter to be more responsive to
> detect the change of direction. The literature suggests MAs for filters.
> Any tips on specific I should explore?
> Thanks and kind regards,
> Andreas
>
>
> Am 28.05.2020 um 18:36 schrieb Jasen Mackie:
>
> Hi Andreas
>
> Thanks for the question. In future, feel free to ask a question by
> creating an issue on the project repo -
> https://github.com/braverock/quantstrat/issues.
>
> You are looking for the ?sigCrossover function.
>
> The project README
> <https://github.com/braverock/quantstrat/blob/master/README.md> on GitHub
> can also help with more learning materials and as usual look into the demo
> folder for concrete examples.
>
> Good luck.
>
> Regards
> Jasen
>
> On Thu, 28 May 2020 at 12:18, Andreas Henneck <hennecke.andreas at web.de>
> wrote:
>
>> Dear all, being new to this list, kindly allow me to introduce myself: I
>> am an engineer by education, marketer of automation products by
>> profession and R fan of a few years. i am currently learning to program
>> technical trading rules for backtesting. The purpose is to stablize
>> investments and learn to trade. As neither a search through the last
>> three years of e-mail from this list nor a search through stackexchange
>> et al revealed an answer I would like to dare a post. I hope I  am not
>> being to basic with my request.
>>
>> This first self-written strategy on EOD data is looking to follow trends
>> utilizing Bollinger Bands for indicating direction and Stochastik fastD
>> to detect entry points and exits with overbought and oversold positions.
>> My first version codes long only trades. The rules work all fine, the
>> problem is this:
>>
>> Stochastic crosses a 0.25 threshold from below more than once, i.e. in a
>> slight downward trend thus triggering multiple consecutive entry orders,
>> before any exits or stops have triggered. This essentially increases
>> position size.
>>
>> The essential question: What is the solution to entering a trade more
>> than once?
>>
>> Looking forward to your responses and insight. Any additional tips for
>> quantstrat thinking or coding are appreciated. Below find some hopefully
>> illustrating code snippets.
>>
>> Kind regards,
>> Andreas
>>
>> ##Not run <- not sure that I am using this properly here.
>>
>> # Create indicators
>>
>> BBTMDir = function(HLC, n = 10, sd = 1, nFastK = 5, nFastD = 2) {
>>
>>   bb_dir <- # rules not essential to the problem, values look something
>> like: round(runif(5))
>>
>> # Stochastic overbought and oversold indicator. Symmetry for simplicity:
>>
>>    sto_sig <- sigThreshold(label = "StochSig", data = sto, column =
>> "fastD",
>>                            threshold = 0.25, relationship = "gt", cross
>> = TRUE) * 1 +
>>      sigThreshold(label = "StochSig", data = sto, column = "fastD",
>>                   threshold = 0.75, relationship = "lt", cross = TRUE) *
>> -1
>>    merge(bb_dir, sto_sig)  # return the two columns
>>
>> # ... standard boiler plate quantstrat setup ...
>>
>> s <- add.indicator( s, 'BBTMDir', label='BBTM',
>>                      arguments=list( HLC = quote(HLC(mktdata))) )
>>
>> # Entry and exit rules based on bb_dir => BBDIR.BBTM as filter and
>> StochSig.BBTM like this:
>>
>> s <- add.signal( s, 'sigFormula', label='StochEntryLong',
>>                   arguments = list(cross = TRUE, formula = "BBDir.BBTM
>> == 1 & StochSig.BBTM == 1"))
>> s <- add.signal( s, 'sigFormula', label='StochExitLong',
>>                   arguments = list(cross = TRUE, formula = "BBDir.BBTM
>> == 1 & StochSig.BBTM == -1"))
>>
>> # as I am still learning and testing this, there are only these two
>> simple rules for now:
>>
>> s <- add.rule(
>>    s, name='ruleSignal', type='enter', label='ChgDirLong',
>>    arguments = list(
>>      sigcol="StochEntryLong", sigval=TRUE, orderqty=orderQ,
>>      TxnFees=.txnfees,
>>      ordertype='market', orderside='long', orderset = "ocolong"
>>    )
>> )
>>
>> s <- add.rule(
>>    s, name='ruleSignal', type='exit', label='ExitChgDir',
>>    arguments = list(
>>      sigcol="StochExitLong", sigval=TRUE, replace = TRUE, orderqty="all",
>>      ordertype='market', orderside='long', orderset = "ocolong"
>>    )
>> )
>>
>> # ...
>>
>> applyStrategy( ...
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>

	[[alternative HTML version deleted]]


From @j@y@h@h @end|ng |rom m@y|n@org  Wed Jun  3 10:46:36 2020
From: @j@y@h@h @end|ng |rom m@y|n@org (Ajay Shah)
Date: Wed, 3 Jun 2020 14:16:36 +0530
Subject: [R-SIG-Finance] Event studies package
Message-ID: <CA++P4r2nnkhW+wWOpxNiLbsSEhChzJ_yUgga2y9pEkD1XZ3tcw@mail.gmail.com>

Folks,

This is about the `eventstudies' package, which is a platform for running
event studies using modern methods, and doing methodological research on
improved methods for event studies.

We were in violation of CRAN guidelines and were not on CRAN for some time.
In that period, we were asking users to install directly from the github
page which justifiably made some people nervous. We have solved these
problems (with the help of R package maintainers) and we're back up at
https://cran.r-project.org/web/packages/eventstudies/index.html .

The package is being actively developed. We have a nice pipeline of new
capabilities that will come out in this year. We welcome your thoughts and
suggestions on what we should do better (e.g. on the Github project issues
page).

-- 
Ajay Shah
ajayshah at mayin.org
http://www.mayin.org/ajayshah

	[[alternative HTML version deleted]]


From roger@bo@ @end|ng |rom gm@||@com  Fri Jun  5 20:16:08 2020
From: roger@bo@ @end|ng |rom gm@||@com (Roger Bos)
Date: Fri, 5 Jun 2020 14:16:08 -0400
Subject: [R-SIG-Finance] Using optimize.portfolio
Message-ID: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>

All,

I am comparing optimize.portfolio from the PortfolioAnalytics package to
portfolio.optim from the tseries package.  portfolio.optim seems a bit
easier to use, but I like the set up of optimize.portfolio.  I have created
a minimal reprex below that compares the output of both in case that helps
answer my questions.
Here are my two primary questions:

1) What if I wanted to pass a custom covariance matrix to
optimize.portfolio, like from a risk model.  Is that possible?  I can pass
it to portfolio.optim because covmat is one of the parameters.
2) What if I wanted to pass forecasted returns to optimize.portfolio?  How
would that be done.

If there is anything that can be improved in this example, that would be
helpful as well.  Thank you in advance for any assistance, Roger.

###

library(PortfolioAnalytics)
library(tidyquant)

symbols <-
c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")

getYahooReturns <- function(symbols, return_column = "Ad") {
  returns <- list()
  for (symbol in symbols) {
    getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
.GlobalEnv, auto.assign = TRUE)
    return <- Return.calculate(Ad(get(symbol)))
    colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
    returns[[symbol]] <- return
  }
  returns <- do.call(cbind, returns)
  return(returns)
}

returns <- getYahooReturns(symbols)
returns <- returns[-1, ]
returns[is.na(returns)] <- 0

# portfolio.optim from tseries package
library(tseries)
sigma <- cov(returns)
reslow <- rep(0, ncol(returns))
reshigh <- rep(1, ncol(returns))
popt <- portfolio.optim(x = returns, covmat = sigma, reslow = reslow,
reshigh = reshigh)
popt$pw

pspec <- portfolio.spec(assets = symbols)
pspec <- add.constraint(portfolio=pspec, type="box",
                    min = 0, max = 1, min_sum = 0.99, max_sum = 1.01)
pspec <- add.objective(portfolio=pspec,
                       type="return",
                       name="mean")
pspec <- add.objective(portfolio=pspec,
                       type="risk",
                       name="var")

opt <- optimize.portfolio(R = returns,
                   portfolio = pspec,
                   optimize_method = "DEoptim", )
data.frame(optimize.portfolio = opt$weights, portfolio.optim =
round(popt$pw, 3))

	[[alternative HTML version deleted]]


From ||y@@k|pn|@ @end|ng |rom gm@||@com  Fri Jun  5 20:53:52 2020
From: ||y@@k|pn|@ @end|ng |rom gm@||@com (Ilya Kipnis)
Date: Fri, 5 Jun 2020 14:53:52 -0400
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
Message-ID: <CA+oJuEEe18T9fEr-d2xiFWCCGbSTW3nbO4+NXdgmtOJgu_VG2Q@mail.gmail.com>

Roger, I believe what you'd need is some custom risk/return functions. I
don't remember the exact syntax off the top of my head, but I do remember
that Ross Bennett covers this in his course on Datacamp. I highly recommend
it if you're going to be using PortfA.

On Fri, Jun 5, 2020 at 2:16 PM Roger Bos <roger.bos at gmail.com> wrote:

> All,
>
> I am comparing optimize.portfolio from the PortfolioAnalytics package to
> portfolio.optim from the tseries package.  portfolio.optim seems a bit
> easier to use, but I like the set up of optimize.portfolio.  I have created
> a minimal reprex below that compares the output of both in case that helps
> answer my questions.
> Here are my two primary questions:
>
> 1) What if I wanted to pass a custom covariance matrix to
> optimize.portfolio, like from a risk model.  Is that possible?  I can pass
> it to portfolio.optim because covmat is one of the parameters.
> 2) What if I wanted to pass forecasted returns to optimize.portfolio?  How
> would that be done.
>
> If there is anything that can be improved in this example, that would be
> helpful as well.  Thank you in advance for any assistance, Roger.
>
> ###
>
> library(PortfolioAnalytics)
> library(tidyquant)
>
> symbols <-
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
>
> getYahooReturns <- function(symbols, return_column = "Ad") {
>   returns <- list()
>   for (symbol in symbols) {
>     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
> .GlobalEnv, auto.assign = TRUE)
>     return <- Return.calculate(Ad(get(symbol)))
>     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>     returns[[symbol]] <- return
>   }
>   returns <- do.call(cbind, returns)
>   return(returns)
> }
>
> returns <- getYahooReturns(symbols)
> returns <- returns[-1, ]
> returns[is.na(returns)] <- 0
>
> # portfolio.optim from tseries package
> library(tseries)
> sigma <- cov(returns)
> reslow <- rep(0, ncol(returns))
> reshigh <- rep(1, ncol(returns))
> popt <- portfolio.optim(x = returns, covmat = sigma, reslow = reslow,
> reshigh = reshigh)
> popt$pw
>
> pspec <- portfolio.spec(assets = symbols)
> pspec <- add.constraint(portfolio=pspec, type="box",
>                     min = 0, max = 1, min_sum = 0.99, max_sum = 1.01)
> pspec <- add.objective(portfolio=pspec,
>                        type="return",
>                        name="mean")
> pspec <- add.objective(portfolio=pspec,
>                        type="risk",
>                        name="var")
>
> opt <- optimize.portfolio(R = returns,
>                    portfolio = pspec,
>                    optimize_method = "DEoptim", )
> data.frame(optimize.portfolio = opt$weights, portfolio.optim =
> round(popt$pw, 3))
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From br|@n @end|ng |rom br@verock@com  Fri Jun  5 22:05:43 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Fri, 05 Jun 2020 15:05:43 -0500
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
Message-ID: <b2745e29e5a4b779d27e982d25fa03487afd61dc.camel@braverock.com>

Foger,
See the vignette for custom moment and objective functions:

On Fri, 2020-06-05 at 14:16 -0400, Roger Bos wrote:
> All,
> I am comparing optimize.portfolio from the PortfolioAnalytics package
> toportfolio.optim from the tseries package.  portfolio.optim seems a
> biteasier to use, but I like the set up of optimize.portfolio.  I
> have createda minimal reprex below that compares the output of both
> in case that helpsanswer my questions.Here are my two primary
> questions:
> 1) What if I wanted to pass a custom covariance matrix
> tooptimize.portfolio, like from a risk model.  Is that possible?  I
> can passit to portfolio.optim because covmat is one of the
> parameters.2) What if I wanted to pass forecasted returns to
> optimize.portfolio?  Howwould that be done.
> If there is anything that can be improved in this example, that would
> behelpful as well.  Thank you in advance for any assistance, Roger.
> ###
> library(PortfolioAnalytics)library(tidyquant)
> symbols <-
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GIL
> D")
> getYahooReturns <- function(symbols, return_column = "Ad") {  returns
> <- list()  for (symbol in symbols) {    getSymbols(symbol, from =
> '2000-01-01', adjustOHLC = TRUE, env =.GlobalEnv, auto.assign =
> TRUE)    return <-
> Return.calculate(Ad(get(symbol)))    colnames(return) <-
> gsub("\\.Adjusted", "", colnames(return))    returns[[symbol]] <-
> return  }  returns <- do.call(cbind, returns)  return(returns)}
> returns <- getYahooReturns(symbols)returns <- returns[-1,
> ]returns[is.na(returns)] <- 0
> # portfolio.optim from tseries packagelibrary(tseries)sigma <-
> cov(returns)reslow <- rep(0, ncol(returns))reshigh <- rep(1,
> ncol(returns))popt <- portfolio.optim(x = returns, covmat = sigma,
> reslow = reslow,reshigh = reshigh)popt$pw
> pspec <- portfolio.spec(assets = symbols)pspec <-
> add.constraint(portfolio=pspec, type="box",                    min =
> 0, max = 1, min_sum = 0.99, max_sum = 1.01)pspec <-
> add.objective(portfolio=pspec,                       type="return",  
>                      name="mean")pspec <-
> add.objective(portfolio=pspec,                       type="risk",    
>                    name="var")
> opt <- optimize.portfolio(R = returns,                   portfolio =
> pspec,                   optimize_method = "DEoptim",
> )data.frame(optimize.portfolio = opt$weights, portfolio.optim
> =round(popt$pw, 3))
> 	[[alternative HTML version deleted]]
> _______________________________________________R-SIG-Finance at r-
> project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.--
> Also note that this is not the r-help list where general R questions
> should go.
https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
You can simply pass mu and sigma, but you probably want to do a little
bit more work to make it more extensible.

Hopefully this is enough of a pointer.  If not, I can work on an
example based on your example later.

Regards,

Brian
-- 
Brian G. Peterson
ph: +1.773.459.4973
im: bgpbraverock

	[[alternative HTML version deleted]]


From roger@bo@ @end|ng |rom gm@||@com  Fri Jun  5 22:31:23 2020
From: roger@bo@ @end|ng |rom gm@||@com (Roger Bos)
Date: Fri, 5 Jun 2020 16:31:23 -0400
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <b2745e29e5a4b779d27e982d25fa03487afd61dc.camel@braverock.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <b2745e29e5a4b779d27e982d25fa03487afd61dc.camel@braverock.com>
Message-ID: <CAPV07m96rJRGvv6UHk5SFBPvDgf6+bFmLm6exu9=PhkMf-95Dg@mail.gmail.com>

Thanks Brian.  That should get me started.  Appreciate the help.

On Fri, Jun 5, 2020, 4:05 PM Brian G. Peterson <brian at braverock.com> wrote:

> Foger,
>
> See the vignette for custom moment and objective functions:
>
> https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
>
>
> You can simply pass mu and sigma, but you probably want to do a little bit
> more work to make it more extensible.
>
> Hopefully this is enough of a pointer. If not, I can work on an example
> based on your example later.
>
> Regards,
>
> Brian
>
> --
>
> Brian G. Peterson
> ph: +1.773.459.4973
> im: bgpbraverock
>
> On Fri, 2020-06-05 at 14:16 -0400, Roger Bos wrote:
>
> All,
>
>
> I am comparing optimize.portfolio from the PortfolioAnalytics package to
>
> portfolio.optim from the tseries package.  portfolio.optim seems a bit
>
> easier to use, but I like the set up of optimize.portfolio.  I have created
>
> a minimal reprex below that compares the output of both in case that helps
>
> answer my questions.
>
> Here are my two primary questions:
>
>
> 1) What if I wanted to pass a custom covariance matrix to
>
> optimize.portfolio, like from a risk model.  Is that possible?  I can pass
>
> it to portfolio.optim because covmat is one of the parameters.
>
> 2) What if I wanted to pass forecasted returns to optimize.portfolio?  How
>
> would that be done.
>
>
> If there is anything that can be improved in this example, that would be
>
> helpful as well.  Thank you in advance for any assistance, Roger.
>
>
> ###
>
>
> library(PortfolioAnalytics)
>
> library(tidyquant)
>
>
> symbols <-
>
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
>
>
> getYahooReturns <- function(symbols, return_column = "Ad") {
>
>   returns <- list()
>
>   for (symbol in symbols) {
>
>     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
>
> .GlobalEnv, auto.assign = TRUE)
>
>     return <- Return.calculate(Ad(get(symbol)))
>
>     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>
>     returns[[symbol]] <- return
>
>   }
>
>   returns <- do.call(cbind, returns)
>
>   return(returns)
>
> }
>
>
> returns <- getYahooReturns(symbols)
>
> returns <- returns[-1, ]
>
> returns[is.na(returns)] <- 0
>
>
> # portfolio.optim from tseries package
>
> library(tseries)
>
> sigma <- cov(returns)
>
> reslow <- rep(0, ncol(returns))
>
> reshigh <- rep(1, ncol(returns))
>
> popt <- portfolio.optim(x = returns, covmat = sigma, reslow = reslow,
>
> reshigh = reshigh)
>
> popt$pw
>
>
> pspec <- portfolio.spec(assets = symbols)
>
> pspec <- add.constraint(portfolio=pspec, type="box",
>
>                     min = 0, max = 1, min_sum = 0.99, max_sum = 1.01)
>
> pspec <- add.objective(portfolio=pspec,
>
>                        type="return",
>
>                        name="mean")
>
> pspec <- add.objective(portfolio=pspec,
>
>                        type="risk",
>
>                        name="var")
>
>
> opt <- optimize.portfolio(R = returns,
>
>                    portfolio = pspec,
>
>                    optimize_method = "DEoptim", )
>
> data.frame(optimize.portfolio = opt$weights, portfolio.optim =
>
> round(popt$pw, 3))
>
>
> 	[[alternative HTML version deleted]]
>
>
> _______________________________________________
>
> R-SIG-Finance at r-project.org
>
>  mailing list
>
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
> -- Subscriber-posting only. If you want to post, subscribe first.
>
> -- Also note that this is not the r-help list where general R questions should go.
>
>

	[[alternative HTML version deleted]]


From @|ex|o@ @end|ng |rom 4d@c@pe@com  Fri Jun  5 23:28:23 2020
From: @|ex|o@ @end|ng |rom 4d@c@pe@com (alexios galanos)
Date: Fri, 5 Jun 2020 14:28:23 -0700
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <CAPV07m96rJRGvv6UHk5SFBPvDgf6+bFmLm6exu9=PhkMf-95Dg@mail.gmail.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <b2745e29e5a4b779d27e982d25fa03487afd61dc.camel@braverock.com>
 <CAPV07m96rJRGvv6UHk5SFBPvDgf6+bFmLm6exu9=PhkMf-95Dg@mail.gmail.com>
Message-ID: <0baba01c-e109-4e3c-9e87-4d21d4661fcd@4dscape.com>

You might (or not) find parma useful (for mainly convex problems):

library(parma)

# with covariance matrix
parmspec <- parmaspec(S = sigma, risk = "EV", riskType = "minrisk", LB = 
reslow, UB = reshigh)
parm <- parmasolve(parmspec, solver = "QP")
round(weights(parm),3)
sqrt(parmarisk(parm))

# with scenario matrix
parmspec <- parmaspec(scenario = returns, risk = "EV", riskType = 
"minrisk", LB = reslow, UB = reshigh)
parm <- parmasolve(parmspec, solver = "NLP")
round(weights(parm),3)
sqrt(parmarisk(parm))

# optimal reward to risk (scenario matrix)
parmspec <- parmaspec(scenario = returns, risk = "EV", forecast = 
colMeans(returns), riskType = "optimal", LB = reslow, UB = reshigh)
parm <- parmasolve(parmspec)
round(weights(parm),3)

# optimal reward to risk (covariance matrix)
parmspec <- parmaspec(S = sigma, risk = "EV", forecast = 
colMeans(returns), riskType = "optimal", LB = reslow, UB = reshigh)
parm <- parmasolve(parmspec)
round(weights(parm),3)

Alexios



On 6/5/20 1:31 PM, Roger Bos wrote:
> Thanks Brian.  That should get me started.  Appreciate the help.
> 
> On Fri, Jun 5, 2020, 4:05 PM Brian G. Peterson <brian at braverock.com> wrote:
> 
>> Foger,
>>
>> See the vignette for custom moment and objective functions:
>>
>> https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
>>
>>
>> You can simply pass mu and sigma, but you probably want to do a little bit
>> more work to make it more extensible.
>>
>> Hopefully this is enough of a pointer. If not, I can work on an example
>> based on your example later.
>>
>> Regards,
>>
>> Brian
>>
>> --
>>
>> Brian G. Peterson
>> ph: +1.773.459.4973
>> im: bgpbraverock
>>
>> On Fri, 2020-06-05 at 14:16 -0400, Roger Bos wrote:
>>
>> All,
>>
>>
>> I am comparing optimize.portfolio from the PortfolioAnalytics package to
>>
>> portfolio.optim from the tseries package.  portfolio.optim seems a bit
>>
>> easier to use, but I like the set up of optimize.portfolio.  I have created
>>
>> a minimal reprex below that compares the output of both in case that helps
>>
>> answer my questions.
>>
>> Here are my two primary questions:
>>
>>
>> 1) What if I wanted to pass a custom covariance matrix to
>>
>> optimize.portfolio, like from a risk model.  Is that possible?  I can pass
>>
>> it to portfolio.optim because covmat is one of the parameters.
>>
>> 2) What if I wanted to pass forecasted returns to optimize.portfolio?  How
>>
>> would that be done.
>>
>>
>> If there is anything that can be improved in this example, that would be
>>
>> helpful as well.  Thank you in advance for any assistance, Roger.
>>
>>
>> ###
>>
>>
>> library(PortfolioAnalytics)
>>
>> library(tidyquant)
>>
>>
>> symbols <-
>>
>> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
>>
>>
>> getYahooReturns <- function(symbols, return_column = "Ad") {
>>
>>    returns <- list()
>>
>>    for (symbol in symbols) {
>>
>>      getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
>>
>> .GlobalEnv, auto.assign = TRUE)
>>
>>      return <- Return.calculate(Ad(get(symbol)))
>>
>>      colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>>
>>      returns[[symbol]] <- return
>>
>>    }
>>
>>    returns <- do.call(cbind, returns)
>>
>>    return(returns)
>>
>> }
>>
>>
>> returns <- getYahooReturns(symbols)
>>
>> returns <- returns[-1, ]
>>
>> returns[is.na(returns)] <- 0
>>
>>
>> # portfolio.optim from tseries package
>>
>> library(tseries)
>>
>> sigma <- cov(returns)
>>
>> reslow <- rep(0, ncol(returns))
>>
>> reshigh <- rep(1, ncol(returns))
>>
>> popt <- portfolio.optim(x = returns, covmat = sigma, reslow = reslow,
>>
>> reshigh = reshigh)
>>
>> popt$pw
>>
>>
>> pspec <- portfolio.spec(assets = symbols)
>>
>> pspec <- add.constraint(portfolio=pspec, type="box",
>>
>>                      min = 0, max = 1, min_sum = 0.99, max_sum = 1.01)
>>
>> pspec <- add.objective(portfolio=pspec,
>>
>>                         type="return",
>>
>>                         name="mean")
>>
>> pspec <- add.objective(portfolio=pspec,
>>
>>                         type="risk",
>>
>>                         name="var")
>>
>>
>> opt <- optimize.portfolio(R = returns,
>>
>>                     portfolio = pspec,
>>
>>                     optimize_method = "DEoptim", )
>>
>> data.frame(optimize.portfolio = opt$weights, portfolio.optim =
>>
>> round(popt$pw, 3))
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>>
>> R-SIG-Finance at r-project.org
>>
>>   mailing list
>>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>
>>
>> -- Subscriber-posting only. If you want to post, subscribe first.
>>
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From e@ @end|ng |rom enr|co@chum@nn@net  Sat Jun  6 14:33:18 2020
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Sat, 06 Jun 2020 14:33:18 +0200
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 (Roger Bos's message of "Fri, 5 Jun 2020 14:16:08 -0400")
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
Message-ID: <87o8pw5q7l.fsf@enricoschumann.net>

On Fri, 05 Jun 2020, Roger Bos writes:

> All,
>
> I am comparing optimize.portfolio from the PortfolioAnalytics package to
> portfolio.optim from the tseries package.  portfolio.optim seems a bit
> easier to use, but I like the set up of optimize.portfolio.  I have created
> a minimal reprex below that compares the output of both in case that helps
> answer my questions.
> Here are my two primary questions:
>
> 1) What if I wanted to pass a custom covariance matrix to
> optimize.portfolio, like from a risk model.  Is that possible?  I can pass
> it to portfolio.optim because covmat is one of the parameters.
> 2) What if I wanted to pass forecasted returns to optimize.portfolio?  How
> would that be done.
>
> If there is anything that can be improved in this example, that would be
> helpful as well.  Thank you in advance for any assistance, Roger.
>
> ###
>
> library(PortfolioAnalytics)
> library(tidyquant)
>
> symbols <-
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
>
> getYahooReturns <- function(symbols, return_column = "Ad") {
>   returns <- list()
>   for (symbol in symbols) {
>     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
> .GlobalEnv, auto.assign = TRUE)
>     return <- Return.calculate(Ad(get(symbol)))
>     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>     returns[[symbol]] <- return
>   }
>   returns <- do.call(cbind, returns)
>   return(returns)
> }
>
> returns <- getYahooReturns(symbols)
> returns <- returns[-1, ]
> returns[is.na(returns)] <- 0
>
> # portfolio.optim from tseries package
> library(tseries)
> sigma <- cov(returns)
> reslow <- rep(0, ncol(returns))
> reshigh <- rep(1, ncol(returns))
> popt <- portfolio.optim(x = returns, covmat = sigma, reslow = reslow,
> reshigh = reshigh)
> popt$pw
>
> pspec <- portfolio.spec(assets = symbols)
> pspec <- add.constraint(portfolio=pspec, type="box",
>                     min = 0, max = 1, min_sum = 0.99, max_sum = 1.01)
> pspec <- add.objective(portfolio=pspec,
>                        type="return",
>                        name="mean")
> pspec <- add.objective(portfolio=pspec,
>                        type="risk",
>                        name="var")
>
> opt <- optimize.portfolio(R = returns,
>                    portfolio = pspec,
>                    optimize_method = "DEoptim", )
> data.frame(optimize.portfolio = opt$weights, portfolio.optim =
> round(popt$pw, 3))
>

If all else fails, and supposing that 'PortfolioAnalytics' per
default computes means and covariances in the standard way, you could
create input data (time series) that have exactly the desired
covariances and means:

  https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451


-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


From br|@n @end|ng |rom br@verock@com  Sat Jun  6 14:38:26 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Sat, 06 Jun 2020 07:38:26 -0500
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <87o8pw5q7l.fsf@enricoschumann.net>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <87o8pw5q7l.fsf@enricoschumann.net>
Message-ID: <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>

On Sat, 2020-06-06 at 14:33 +0200, Enrico Schumann wrote:
> On Fri, 05 Jun 2020, Roger Bos writes:
> 
> > All,
> > 
> > I am comparing optimize.portfolio from the PortfolioAnalytics
> > package to
> > portfolio.optim from the tseries package.  portfolio.optim seems a
> > bit
> > easier to use, but I like the set up of optimize.portfolio.  I have
> > created
> > a minimal reprex below that compares the output of both in case
> > that helps
> > answer my questions.
> > Here are my two primary questions:
> > 
> > 1) What if I wanted to pass a custom covariance matrix to
> > optimize.portfolio, like from a risk model.  Is that possible?  I
> > can pass
> > it to portfolio.optim because covmat is one of the parameters.
> > 2) What if I wanted to pass forecasted returns to
> > optimize.portfolio?  How
> > would that be done.
> > 
> > If there is anything that can be improved in this example, that
> > would be
> > helpful as well.  Thank you in advance for any assistance, Roger.
> > 
> > ###
> > 
> > library(PortfolioAnalytics)
> > library(tidyquant)
> > 
> > symbols <-
> > c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","G
> > ILD")
> > 
> > getYahooReturns <- function(symbols, return_column = "Ad") {
> >   returns <- list()
> >   for (symbol in symbols) {
> >     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env
> > =
> > .GlobalEnv, auto.assign = TRUE)
> >     return <- Return.calculate(Ad(get(symbol)))
> >     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
> >     returns[[symbol]] <- return
> >   }
> >   returns <- do.call(cbind, returns)
> >   return(returns)
> > }
> > 
> > returns <- getYahooReturns(symbols)
> > returns <- returns[-1, ]
> > returns[is.na(returns)] <- 0
> > 
> > # portfolio.optim from tseries package
> > library(tseries)
> > sigma <- cov(returns)
> > reslow <- rep(0, ncol(returns))
> > reshigh <- rep(1, ncol(returns))
> > popt <- portfolio.optim(x = returns, covmat = sigma, reslow =
> > reslow,
> > reshigh = reshigh)
> > popt$pw
> > 
> > pspec <- portfolio.spec(assets = symbols)
> > pspec <- add.constraint(portfolio=pspec, type="box",
> >                     min = 0, max = 1, min_sum = 0.99, max_sum =
> > 1.01)
> > pspec <- add.objective(portfolio=pspec,
> >                        type="return",
> >                        name="mean")
> > pspec <- add.objective(portfolio=pspec,
> >                        type="risk",
> >                        name="var")
> > 
> > opt <- optimize.portfolio(R = returns,
> >                    portfolio = pspec,
> >                    optimize_method = "DEoptim", )
> > data.frame(optimize.portfolio = opt$weights, portfolio.optim =
> > round(popt$pw, 3))
> > 
> 
> If all else fails, and supposing that 'PortfolioAnalytics' per
> default computes means and covariances in the standard way, you could
> create input data (time series) that have exactly the desired
> covariances and means:
> 
>   
> https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451
> 

per default, PortfolioAnalytics uses sample moments as most users would
expect.  

As I already told the OP, the user may pass mu and sigma and m3 and m4
directly, or may construct custom moment functions to compute the
moments using any method they choose.

This is outlined in section 2 of the vignette:

https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf


and, of course, in the manual.


From roger@bo@ @end|ng |rom gm@||@com  Mon Jun  8 02:14:55 2020
From: roger@bo@ @end|ng |rom gm@||@com (Roger Bos)
Date: Sun, 7 Jun 2020 20:14:55 -0400
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <87o8pw5q7l.fsf@enricoschumann.net>
 <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>
Message-ID: <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>

Thank you to everyone for your suggestions, but I am still having trouble.
I see that there are two ways to pass custom moments into optimize
portfolio, a custom function and using momentargs list.  The example code
at the end of this email uses both of those methods, as well as the default
method.  I also compare those to portfolio.optim and parma.

I get quite different results for each method.  I know that they will not
be exactly the same, but surely I am doing something wrong given the
results I am getting.  I would hope that all three optimize portfolio
methods would give me the same results.  Here are the results I am getting:

             opt.portf opt.portf.fun opt.portf.args portfolio.optim parma
MSFT     0.372         0.190          0.448           0.253 0.000
AAPL     0.008         0.094          0.044           0.208 0.357
AMZN     0.000         0.076          0.000           0.055 0.119
NVDA     0.020         0.000          0.000           0.020 0.169
CSCO     0.000         0.004          0.002           0.000 0.000
ADBE     0.004         0.040          0.002           0.033 0.032
AMGN     0.298         0.348          0.382           0.253 0.000
ORCL     0.068         0.072          0.010           0.002 0.000
QCOM    0.072         0.000          0.000           0.000 0.000
GILD       0.158         0.176          0.112           0.177 0.322

opt.portf is optimize.portfolio with internal mu and sigma
opt.portf.fun is optimize.portfolio with mu and sigma provided in momentFUN
opt.portf.args is optimize.portfolio with mu and sigma provided in
momentargs

So if optimize portfolio just uses the column means for mu and cov for
sigma, why am I getting different results than when I use a custom function
or pass in the moments?  Obviously I am doing something wrong since I get
different results when using momentFUN and momentargs.  Thanks in advance
for any help, Roger.

###

library(tidyquant)
symbols <-
c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")

getYahooReturns <- function(symbols, return_column = "Ad") {
  returns <- list()
  for (symbol in symbols) {
    getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
.GlobalEnv, auto.assign = TRUE)
    return <- Return.calculate(Ad(get(symbol)))
    colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
    returns[[symbol]] <- return
  }
  returns <- do.call(cbind, returns)
  return(returns)
}

returns <- getYahooReturns(symbols)
returns <- returns[-1, ]
returns[is.na(returns)] <- 0

# portfolio.optim from tseries package
library(tseries)
LB <- rep(0, ncol(returns))
UB <- rep(1, ncol(returns))
popt <- portfolio.optim(x = returns, covmat = sigma, reslow = LB, reshigh =
UB)

library(parma)
# optimal reward to risk (covariance matrix)
parmspec <- parmaspec(S = cov(returns), risk = "EV", forecast =
colMeans(returns), riskType = "optimal", LB = LB, UB = UB)
parm <- parmasolve(parmspec)

library(PortfolioAnalytics)
simple.moments <- function(R, ...) {
  num_assets = ncol(R)
  out <- list()
  out$mu <- matrix(colMeans(R), ncol = 1)
  out$sigma <- cov(R)
  # out$m3 <- PerformanceAnalytics:::M3.MM(R)
  # out$m4 <- PerformanceAnalytics:::M4.MM(R)
  out$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
  out$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
  out
}

num_assets = ncol(returns)
momentargs <- list()
momentargs$mu <- matrix(colMeans(returns), ncol = 1)
momentargs$sigma <- cov(returns)
momentargs$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
momentargs$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)

pspec <- portfolio.spec(assets = symbols)
pspec <- add.constraint(portfolio=pspec, type="box", min = 0, max = 1,
min_sum = 0.99, max_sum = 1.01)
pspec <- add.objective(portfolio=pspec, type="return", name="mean")
pspec <- add.objective(portfolio=pspec, type="risk", name="var")

opt      <- optimize.portfolio(R = returns, portfolio = pspec,
optimize_method = "DEoptim")
opt.fun  <- optimize.portfolio(R = returns, portfolio = pspec,
optimize_method = "DEoptim", momentFUN = "simple.moments")
opt.args <- optimize.portfolio(R = returns, portfolio = pspec,
optimize_method = "DEoptim", momentargs = momentargs)
data.frame(opt.portf = opt$weights,
           opt.portf.fun = opt.fun$weights,
           opt.portf.args = opt.args$weights,
           portfolio.optim = round(popt$pw, 3),
           parma = round(weights(parm), 3))


On Sat, Jun 6, 2020 at 8:38 AM Brian G. Peterson <brian at braverock.com>
wrote:

> On Sat, 2020-06-06 at 14:33 +0200, Enrico Schumann wrote:
> > On Fri, 05 Jun 2020, Roger Bos writes:
> >
> > > All,
> > >
> > > I am comparing optimize.portfolio from the PortfolioAnalytics
> > > package to
> > > portfolio.optim from the tseries package.  portfolio.optim seems a
> > > bit
> > > easier to use, but I like the set up of optimize.portfolio.  I have
> > > created
> > > a minimal reprex below that compares the output of both in case
> > > that helps
> > > answer my questions.
> > > Here are my two primary questions:
> > >
> > > 1) What if I wanted to pass a custom covariance matrix to
> > > optimize.portfolio, like from a risk model.  Is that possible?  I
> > > can pass
> > > it to portfolio.optim because covmat is one of the parameters.
> > > 2) What if I wanted to pass forecasted returns to
> > > optimize.portfolio?  How
> > > would that be done.
> > >
> > > If there is anything that can be improved in this example, that
> > > would be
> > > helpful as well.  Thank you in advance for any assistance, Roger.
> > >
> > > ###
> > >
> > > library(PortfolioAnalytics)
> > > library(tidyquant)
> > >
> > > symbols <-
> > > c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","G
> > > ILD")
> > >
> > > getYahooReturns <- function(symbols, return_column = "Ad") {
> > >   returns <- list()
> > >   for (symbol in symbols) {
> > >     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env
> > > =
> > > .GlobalEnv, auto.assign = TRUE)
> > >     return <- Return.calculate(Ad(get(symbol)))
> > >     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
> > >     returns[[symbol]] <- return
> > >   }
> > >   returns <- do.call(cbind, returns)
> > >   return(returns)
> > > }
> > >
> > > returns <- getYahooReturns(symbols)
> > > returns <- returns[-1, ]
> > > returns[is.na(returns)] <- 0
> > >
> > > # portfolio.optim from tseries package
> > > library(tseries)
> > > sigma <- cov(returns)
> > > reslow <- rep(0, ncol(returns))
> > > reshigh <- rep(1, ncol(returns))
> > > popt <- portfolio.optim(x = returns, covmat = sigma, reslow =
> > > reslow,
> > > reshigh = reshigh)
> > > popt$pw
> > >
> > > pspec <- portfolio.spec(assets = symbols)
> > > pspec <- add.constraint(portfolio=pspec, type="box",
> > >                     min = 0, max = 1, min_sum = 0.99, max_sum =
> > > 1.01)
> > > pspec <- add.objective(portfolio=pspec,
> > >                        type="return",
> > >                        name="mean")
> > > pspec <- add.objective(portfolio=pspec,
> > >                        type="risk",
> > >                        name="var")
> > >
> > > opt <- optimize.portfolio(R = returns,
> > >                    portfolio = pspec,
> > >                    optimize_method = "DEoptim", )
> > > data.frame(optimize.portfolio = opt$weights, portfolio.optim =
> > > round(popt$pw, 3))
> > >
> >
> > If all else fails, and supposing that 'PortfolioAnalytics' per
> > default computes means and covariances in the standard way, you could
> > create input data (time series) that have exactly the desired
> > covariances and means:
> >
> >
> >
> https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451
> >
>
> per default, PortfolioAnalytics uses sample moments as most users would
> expect.
>
> As I already told the OP, the user may pass mu and sigma and m3 and m4
> directly, or may construct custom moment functions to compute the
> moments using any method they choose.
>
> This is outlined in section 2 of the vignette:
>
>
> https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
>
>
> and, of course, in the manual.
>
>

	[[alternative HTML version deleted]]


From @|ex|o@ @end|ng |rom 4d@c@pe@com  Mon Jun  8 02:44:10 2020
From: @|ex|o@ @end|ng |rom 4d@c@pe@com (alexios galanos)
Date: Sun, 7 Jun 2020 17:44:10 -0700
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <87o8pw5q7l.fsf@enricoschumann.net>
 <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>
 <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>
Message-ID: <e467c6eb-e799-c58a-0b84-ada22d43a971@4dscape.com>

Roger,

The portfolio.optim function calculates the minimum risk portfolio given 
a desired level of portfolio return (the default pm input is mean(x)). 
Here is an example versus parma:

LB <- rep(0, ncol(returns))
UB <- rep(1, ncol(returns))
popt <- portfolio.optim(x = returns, reslow = LB, reshigh = UB)

library(parma)
# optimal reward to risk (covariance matrix)
parmspec <- parmaspec(scenario = returns, risk = "EV", forecast = 
colMeans(returns), riskType = "minrisk", LB = LB, UB = UB, target = 
mean(returns))
parm <- parmasolve(parmspec)

round(cbind(weights(parm), popt$pw), 3)
       [,1]  [,2]
MSFT 0.253 0.253
AAPL 0.208 0.208
AMZN 0.055 0.055
NVDA 0.020 0.020
CSCO 0.000 0.000
ADBE 0.033 0.033
AMGN 0.253 0.253
ORCL 0.002 0.002
QCOM 0.000 0.000
GILD 0.177 0.177

Exact same results.

Regards,

Alexios


On 6/7/20 5:14 PM, Roger Bos wrote:
> Thank you to everyone for your suggestions, but I am still having trouble.
> I see that there are two ways to pass custom moments into optimize
> portfolio, a custom function and using momentargs list.  The example code
> at the end of this email uses both of those methods, as well as the default
> method.  I also compare those to portfolio.optim and parma.
> 
> I get quite different results for each method.  I know that they will not
> be exactly the same, but surely I am doing something wrong given the
> results I am getting.  I would hope that all three optimize portfolio
> methods would give me the same results.  Here are the results I am getting:
> 
>               opt.portf opt.portf.fun opt.portf.args portfolio.optim parma
> MSFT     0.372         0.190          0.448           0.253 0.000
> AAPL     0.008         0.094          0.044           0.208 0.357
> AMZN     0.000         0.076          0.000           0.055 0.119
> NVDA     0.020         0.000          0.000           0.020 0.169
> CSCO     0.000         0.004          0.002           0.000 0.000
> ADBE     0.004         0.040          0.002           0.033 0.032
> AMGN     0.298         0.348          0.382           0.253 0.000
> ORCL     0.068         0.072          0.010           0.002 0.000
> QCOM    0.072         0.000          0.000           0.000 0.000
> GILD       0.158         0.176          0.112           0.177 0.322
> 
> opt.portf is optimize.portfolio with internal mu and sigma
> opt.portf.fun is optimize.portfolio with mu and sigma provided in momentFUN
> opt.portf.args is optimize.portfolio with mu and sigma provided in
> momentargs
> 
> So if optimize portfolio just uses the column means for mu and cov for
> sigma, why am I getting different results than when I use a custom function
> or pass in the moments?  Obviously I am doing something wrong since I get
> different results when using momentFUN and momentargs.  Thanks in advance
> for any help, Roger.
> 
> ###
> 
> library(tidyquant)
> symbols <-
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
> 
> getYahooReturns <- function(symbols, return_column = "Ad") {
>    returns <- list()
>    for (symbol in symbols) {
>      getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
> .GlobalEnv, auto.assign = TRUE)
>      return <- Return.calculate(Ad(get(symbol)))
>      colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>      returns[[symbol]] <- return
>    }
>    returns <- do.call(cbind, returns)
>    return(returns)
> }
> 
> returns <- getYahooReturns(symbols)
> returns <- returns[-1, ]
> returns[is.na(returns)] <- 0
> 
> # portfolio.optim from tseries package
> library(tseries)
> LB <- rep(0, ncol(returns))
> UB <- rep(1, ncol(returns))
> popt <- portfolio.optim(x = returns, covmat = sigma, reslow = LB, reshigh =
> UB)
> 
> library(parma)
> # optimal reward to risk (covariance matrix)
> parmspec <- parmaspec(S = cov(returns), risk = "EV", forecast =
> colMeans(returns), riskType = "optimal", LB = LB, UB = UB)
> parm <- parmasolve(parmspec)
> 
> library(PortfolioAnalytics)
> simple.moments <- function(R, ...) {
>    num_assets = ncol(R)
>    out <- list()
>    out$mu <- matrix(colMeans(R), ncol = 1)
>    out$sigma <- cov(R)
>    # out$m3 <- PerformanceAnalytics:::M3.MM(R)
>    # out$m4 <- PerformanceAnalytics:::M4.MM(R)
>    out$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
>    out$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
>    out
> }
> 
> num_assets = ncol(returns)
> momentargs <- list()
> momentargs$mu <- matrix(colMeans(returns), ncol = 1)
> momentargs$sigma <- cov(returns)
> momentargs$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
> momentargs$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
> 
> pspec <- portfolio.spec(assets = symbols)
> pspec <- add.constraint(portfolio=pspec, type="box", min = 0, max = 1,
> min_sum = 0.99, max_sum = 1.01)
> pspec <- add.objective(portfolio=pspec, type="return", name="mean")
> pspec <- add.objective(portfolio=pspec, type="risk", name="var")
> 
> opt      <- optimize.portfolio(R = returns, portfolio = pspec,
> optimize_method = "DEoptim")
> opt.fun  <- optimize.portfolio(R = returns, portfolio = pspec,
> optimize_method = "DEoptim", momentFUN = "simple.moments")
> opt.args <- optimize.portfolio(R = returns, portfolio = pspec,
> optimize_method = "DEoptim", momentargs = momentargs)
> data.frame(opt.portf = opt$weights,
>             opt.portf.fun = opt.fun$weights,
>             opt.portf.args = opt.args$weights,
>             portfolio.optim = round(popt$pw, 3),
>             parma = round(weights(parm), 3))
> 
> 
> On Sat, Jun 6, 2020 at 8:38 AM Brian G. Peterson <brian at braverock.com>
> wrote:
> 
>> On Sat, 2020-06-06 at 14:33 +0200, Enrico Schumann wrote:
>>> On Fri, 05 Jun 2020, Roger Bos writes:
>>>
>>>> All,
>>>>
>>>> I am comparing optimize.portfolio from the PortfolioAnalytics
>>>> package to
>>>> portfolio.optim from the tseries package.  portfolio.optim seems a
>>>> bit
>>>> easier to use, but I like the set up of optimize.portfolio.  I have
>>>> created
>>>> a minimal reprex below that compares the output of both in case
>>>> that helps
>>>> answer my questions.
>>>> Here are my two primary questions:
>>>>
>>>> 1) What if I wanted to pass a custom covariance matrix to
>>>> optimize.portfolio, like from a risk model.  Is that possible?  I
>>>> can pass
>>>> it to portfolio.optim because covmat is one of the parameters.
>>>> 2) What if I wanted to pass forecasted returns to
>>>> optimize.portfolio?  How
>>>> would that be done.
>>>>
>>>> If there is anything that can be improved in this example, that
>>>> would be
>>>> helpful as well.  Thank you in advance for any assistance, Roger.
>>>>
>>>> ###
>>>>
>>>> library(PortfolioAnalytics)
>>>> library(tidyquant)
>>>>
>>>> symbols <-
>>>> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","G
>>>> ILD")
>>>>
>>>> getYahooReturns <- function(symbols, return_column = "Ad") {
>>>>    returns <- list()
>>>>    for (symbol in symbols) {
>>>>      getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env
>>>> =
>>>> .GlobalEnv, auto.assign = TRUE)
>>>>      return <- Return.calculate(Ad(get(symbol)))
>>>>      colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>>>>      returns[[symbol]] <- return
>>>>    }
>>>>    returns <- do.call(cbind, returns)
>>>>    return(returns)
>>>> }
>>>>
>>>> returns <- getYahooReturns(symbols)
>>>> returns <- returns[-1, ]
>>>> returns[is.na(returns)] <- 0
>>>>
>>>> # portfolio.optim from tseries package
>>>> library(tseries)
>>>> sigma <- cov(returns)
>>>> reslow <- rep(0, ncol(returns))
>>>> reshigh <- rep(1, ncol(returns))
>>>> popt <- portfolio.optim(x = returns, covmat = sigma, reslow =
>>>> reslow,
>>>> reshigh = reshigh)
>>>> popt$pw
>>>>
>>>> pspec <- portfolio.spec(assets = symbols)
>>>> pspec <- add.constraint(portfolio=pspec, type="box",
>>>>                      min = 0, max = 1, min_sum = 0.99, max_sum =
>>>> 1.01)
>>>> pspec <- add.objective(portfolio=pspec,
>>>>                         type="return",
>>>>                         name="mean")
>>>> pspec <- add.objective(portfolio=pspec,
>>>>                         type="risk",
>>>>                         name="var")
>>>>
>>>> opt <- optimize.portfolio(R = returns,
>>>>                     portfolio = pspec,
>>>>                     optimize_method = "DEoptim", )
>>>> data.frame(optimize.portfolio = opt$weights, portfolio.optim =
>>>> round(popt$pw, 3))
>>>>
>>>
>>> If all else fails, and supposing that 'PortfolioAnalytics' per
>>> default computes means and covariances in the standard way, you could
>>> create input data (time series) that have exactly the desired
>>> covariances and means:
>>>
>>>
>>>
>> https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451
>>>
>>
>> per default, PortfolioAnalytics uses sample moments as most users would
>> expect.
>>
>> As I already told the OP, the user may pass mu and sigma and m3 and m4
>> directly, or may construct custom moment functions to compute the
>> moments using any method they choose.
>>
>> This is outlined in section 2 of the vignette:
>>
>>
>> https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
>>
>>
>> and, of course, in the manual.
>>
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From roger@bo@ @end|ng |rom gm@||@com  Mon Jun  8 02:54:22 2020
From: roger@bo@ @end|ng |rom gm@||@com (Roger Bos)
Date: Sun, 7 Jun 2020 20:54:22 -0400
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <e467c6eb-e799-c58a-0b84-ada22d43a971@4dscape.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <87o8pw5q7l.fsf@enricoschumann.net>
 <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>
 <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>
 <e467c6eb-e799-c58a-0b84-ada22d43a971@4dscape.com>
Message-ID: <CAPV07m800TehQ+XwVwuXQmtu06t1Yuu8LZEExvkwON1aPJZFjQ@mail.gmail.com>

Thank you Alexios.  That is very helpful.

On Sun, Jun 7, 2020 at 8:44 PM alexios galanos <alexios at 4dscape.com> wrote:

> Roger,
>
> The portfolio.optim function calculates the minimum risk portfolio given
> a desired level of portfolio return (the default pm input is mean(x)).
> Here is an example versus parma:
>
> LB <- rep(0, ncol(returns))
> UB <- rep(1, ncol(returns))
> popt <- portfolio.optim(x = returns, reslow = LB, reshigh = UB)
>
> library(parma)
> # optimal reward to risk (covariance matrix)
> parmspec <- parmaspec(scenario = returns, risk = "EV", forecast =
> colMeans(returns), riskType = "minrisk", LB = LB, UB = UB, target =
> mean(returns))
> parm <- parmasolve(parmspec)
>
> round(cbind(weights(parm), popt$pw), 3)
>        [,1]  [,2]
> MSFT 0.253 0.253
> AAPL 0.208 0.208
> AMZN 0.055 0.055
> NVDA 0.020 0.020
> CSCO 0.000 0.000
> ADBE 0.033 0.033
> AMGN 0.253 0.253
> ORCL 0.002 0.002
> QCOM 0.000 0.000
> GILD 0.177 0.177
>
> Exact same results.
>
> Regards,
>
> Alexios
>
>
> On 6/7/20 5:14 PM, Roger Bos wrote:
> > Thank you to everyone for your suggestions, but I am still having
> trouble.
> > I see that there are two ways to pass custom moments into optimize
> > portfolio, a custom function and using momentargs list.  The example code
> > at the end of this email uses both of those methods, as well as the
> default
> > method.  I also compare those to portfolio.optim and parma.
> >
> > I get quite different results for each method.  I know that they will not
> > be exactly the same, but surely I am doing something wrong given the
> > results I am getting.  I would hope that all three optimize portfolio
> > methods would give me the same results.  Here are the results I am
> getting:
> >
> >               opt.portf opt.portf.fun opt.portf.args portfolio.optim
> parma
> > MSFT     0.372         0.190          0.448           0.253 0.000
> > AAPL     0.008         0.094          0.044           0.208 0.357
> > AMZN     0.000         0.076          0.000           0.055 0.119
> > NVDA     0.020         0.000          0.000           0.020 0.169
> > CSCO     0.000         0.004          0.002           0.000 0.000
> > ADBE     0.004         0.040          0.002           0.033 0.032
> > AMGN     0.298         0.348          0.382           0.253 0.000
> > ORCL     0.068         0.072          0.010           0.002 0.000
> > QCOM    0.072         0.000          0.000           0.000 0.000
> > GILD       0.158         0.176          0.112           0.177 0.322
> >
> > opt.portf is optimize.portfolio with internal mu and sigma
> > opt.portf.fun is optimize.portfolio with mu and sigma provided in
> momentFUN
> > opt.portf.args is optimize.portfolio with mu and sigma provided in
> > momentargs
> >
> > So if optimize portfolio just uses the column means for mu and cov for
> > sigma, why am I getting different results than when I use a custom
> function
> > or pass in the moments?  Obviously I am doing something wrong since I get
> > different results when using momentFUN and momentargs.  Thanks in advance
> > for any help, Roger.
> >
> > ###
> >
> > library(tidyquant)
> > symbols <-
> > c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
> >
> > getYahooReturns <- function(symbols, return_column = "Ad") {
> >    returns <- list()
> >    for (symbol in symbols) {
> >      getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
> > .GlobalEnv, auto.assign = TRUE)
> >      return <- Return.calculate(Ad(get(symbol)))
> >      colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
> >      returns[[symbol]] <- return
> >    }
> >    returns <- do.call(cbind, returns)
> >    return(returns)
> > }
> >
> > returns <- getYahooReturns(symbols)
> > returns <- returns[-1, ]
> > returns[is.na(returns)] <- 0
> >
> > # portfolio.optim from tseries package
> > library(tseries)
> > LB <- rep(0, ncol(returns))
> > UB <- rep(1, ncol(returns))
> > popt <- portfolio.optim(x = returns, covmat = sigma, reslow = LB,
> reshigh =
> > UB)
> >
> > library(parma)
> > # optimal reward to risk (covariance matrix)
> > parmspec <- parmaspec(S = cov(returns), risk = "EV", forecast =
> > colMeans(returns), riskType = "optimal", LB = LB, UB = UB)
> > parm <- parmasolve(parmspec)
> >
> > library(PortfolioAnalytics)
> > simple.moments <- function(R, ...) {
> >    num_assets = ncol(R)
> >    out <- list()
> >    out$mu <- matrix(colMeans(R), ncol = 1)
> >    out$sigma <- cov(R)
> >    # out$m3 <- PerformanceAnalytics:::M3.MM(R)
> >    # out$m4 <- PerformanceAnalytics:::M4.MM(R)
> >    out$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
> >    out$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
> >    out
> > }
> >
> > num_assets = ncol(returns)
> > momentargs <- list()
> > momentargs$mu <- matrix(colMeans(returns), ncol = 1)
> > momentargs$sigma <- cov(returns)
> > momentargs$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
> > momentargs$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
> >
> > pspec <- portfolio.spec(assets = symbols)
> > pspec <- add.constraint(portfolio=pspec, type="box", min = 0, max = 1,
> > min_sum = 0.99, max_sum = 1.01)
> > pspec <- add.objective(portfolio=pspec, type="return", name="mean")
> > pspec <- add.objective(portfolio=pspec, type="risk", name="var")
> >
> > opt      <- optimize.portfolio(R = returns, portfolio = pspec,
> > optimize_method = "DEoptim")
> > opt.fun  <- optimize.portfolio(R = returns, portfolio = pspec,
> > optimize_method = "DEoptim", momentFUN = "simple.moments")
> > opt.args <- optimize.portfolio(R = returns, portfolio = pspec,
> > optimize_method = "DEoptim", momentargs = momentargs)
> > data.frame(opt.portf = opt$weights,
> >             opt.portf.fun = opt.fun$weights,
> >             opt.portf.args = opt.args$weights,
> >             portfolio.optim = round(popt$pw, 3),
> >             parma = round(weights(parm), 3))
> >
> >
> > On Sat, Jun 6, 2020 at 8:38 AM Brian G. Peterson <brian at braverock.com>
> > wrote:
> >
> >> On Sat, 2020-06-06 at 14:33 +0200, Enrico Schumann wrote:
> >>> On Fri, 05 Jun 2020, Roger Bos writes:
> >>>
> >>>> All,
> >>>>
> >>>> I am comparing optimize.portfolio from the PortfolioAnalytics
> >>>> package to
> >>>> portfolio.optim from the tseries package.  portfolio.optim seems a
> >>>> bit
> >>>> easier to use, but I like the set up of optimize.portfolio.  I have
> >>>> created
> >>>> a minimal reprex below that compares the output of both in case
> >>>> that helps
> >>>> answer my questions.
> >>>> Here are my two primary questions:
> >>>>
> >>>> 1) What if I wanted to pass a custom covariance matrix to
> >>>> optimize.portfolio, like from a risk model.  Is that possible?  I
> >>>> can pass
> >>>> it to portfolio.optim because covmat is one of the parameters.
> >>>> 2) What if I wanted to pass forecasted returns to
> >>>> optimize.portfolio?  How
> >>>> would that be done.
> >>>>
> >>>> If there is anything that can be improved in this example, that
> >>>> would be
> >>>> helpful as well.  Thank you in advance for any assistance, Roger.
> >>>>
> >>>> ###
> >>>>
> >>>> library(PortfolioAnalytics)
> >>>> library(tidyquant)
> >>>>
> >>>> symbols <-
> >>>> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","G
> >>>> ILD")
> >>>>
> >>>> getYahooReturns <- function(symbols, return_column = "Ad") {
> >>>>    returns <- list()
> >>>>    for (symbol in symbols) {
> >>>>      getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env
> >>>> =
> >>>> .GlobalEnv, auto.assign = TRUE)
> >>>>      return <- Return.calculate(Ad(get(symbol)))
> >>>>      colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
> >>>>      returns[[symbol]] <- return
> >>>>    }
> >>>>    returns <- do.call(cbind, returns)
> >>>>    return(returns)
> >>>> }
> >>>>
> >>>> returns <- getYahooReturns(symbols)
> >>>> returns <- returns[-1, ]
> >>>> returns[is.na(returns)] <- 0
> >>>>
> >>>> # portfolio.optim from tseries package
> >>>> library(tseries)
> >>>> sigma <- cov(returns)
> >>>> reslow <- rep(0, ncol(returns))
> >>>> reshigh <- rep(1, ncol(returns))
> >>>> popt <- portfolio.optim(x = returns, covmat = sigma, reslow =
> >>>> reslow,
> >>>> reshigh = reshigh)
> >>>> popt$pw
> >>>>
> >>>> pspec <- portfolio.spec(assets = symbols)
> >>>> pspec <- add.constraint(portfolio=pspec, type="box",
> >>>>                      min = 0, max = 1, min_sum = 0.99, max_sum =
> >>>> 1.01)
> >>>> pspec <- add.objective(portfolio=pspec,
> >>>>                         type="return",
> >>>>                         name="mean")
> >>>> pspec <- add.objective(portfolio=pspec,
> >>>>                         type="risk",
> >>>>                         name="var")
> >>>>
> >>>> opt <- optimize.portfolio(R = returns,
> >>>>                     portfolio = pspec,
> >>>>                     optimize_method = "DEoptim", )
> >>>> data.frame(optimize.portfolio = opt$weights, portfolio.optim =
> >>>> round(popt$pw, 3))
> >>>>
> >>>
> >>> If all else fails, and supposing that 'PortfolioAnalytics' per
> >>> default computes means and covariances in the standard way, you could
> >>> create input data (time series) that have exactly the desired
> >>> covariances and means:
> >>>
> >>>
> >>>
> >>
> https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451
> >>>
> >>
> >> per default, PortfolioAnalytics uses sample moments as most users would
> >> expect.
> >>
> >> As I already told the OP, the user may pass mu and sigma and m3 and m4
> >> directly, or may construct custom moment functions to compute the
> >> moments using any method they choose.
> >>
> >> This is outlined in section 2 of the vignette:
> >>
> >>
> >>
> https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
> >>
> >>
> >> and, of course, in the manual.
> >>
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> should go.
> >
>

	[[alternative HTML version deleted]]


From br|@n @end|ng |rom br@verock@com  Mon Jun  8 02:59:08 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Sun, 07 Jun 2020 19:59:08 -0500
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <87o8pw5q7l.fsf@enricoschumann.net>
 <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>
 <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>
Message-ID: <63d09fafa927daf218f6e130e72e7fbd20a0d567.camel@braverock.com>

Roger,
If no Return cleaning method is specified, the default portfolio
moments function will use pairwise complete observations:

if you pass momentargs, the internal calculations for mu and sigma will
be replaced by momentargs$mu and momentargs$sigma
Alexios has already pointed out the return target, which is not
specified in your objectives for optimize.portfolio.
I also note that you're using DEoptim, which is unecessarily slow (and
may not always converge to the same result) for a simple mean variance
optimization.  You probably want optimize.method='ROI', which will use
the same direct quadratic approach.  DEoptim (or 'random' or 'GEnSA',
or 'pso') make sense for more complex objectives that aren't amenable
to convex solvers.
Regards,
Brian
 
-- 
Brian G. Peterson
ph: +1.773.459.4973
im: bgpbraverock
On Sun, 2020-06-07 at 20:14 -0400, Roger Bos wrote:
> Thank you to everyone for your suggestions, but I am still having
> trouble.I see that there are two ways to pass custom moments into
> optimizeportfolio, a custom function and using momentargs list.  The
> example codeat the end of this email uses both of those methods, as
> well as the defaultmethod.  I also compare those to portfolio.optim
> and parma.
> I get quite different results for each method.  I know that they will
> notbe exactly the same, but surely I am doing something wrong given
> theresults I am getting.  I would hope that all three optimize
> portfoliomethods would give me the same results.  Here are the
> results I am getting:
>              opt.portf opt.portf.fun opt.portf.args portfolio.optim
> parmaMSFT     0.372         0.190          0.448           0.253
> 0.000AAPL     0.008         0.094          0.044           0.208
> 0.357AMZN     0.000         0.076          0.000           0.055
> 0.119NVDA     0.020         0.000          0.000           0.020
> 0.169CSCO     0.000         0.004          0.002           0.000
> 0.000ADBE     0.004         0.040          0.002           0.033
> 0.032AMGN     0.298         0.348          0.382           0.253
> 0.000ORCL     0.068         0.072          0.010           0.002
> 0.000QCOM    0.072         0.000          0.000           0.000
> 0.000GILD       0.158         0.176          0.112           0.177
> 0.322
> opt.portf is optimize.portfolio with internal mu and
> sigmaopt.portf.fun is optimize.portfolio with mu and sigma provided
> in momentFUNopt.portf.args is optimize.portfolio with mu and sigma
> provided inmomentargs
> So if optimize portfolio just uses the column means for mu and cov
> forsigma, why am I getting different results than when I use a custom
> functionor pass in the moments?  Obviously I am doing something wrong
> since I getdifferent results when using momentFUN and
> momentargs.  Thanks in advancefor any help, Roger.
> ###
> library(tidyquant)symbols <-
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GIL
> D")
> getYahooReturns <- function(symbols, return_column = "Ad") {  returns
> <- list()  for (symbol in symbols) {    getSymbols(symbol, from =
> '2000-01-01', adjustOHLC = TRUE, env =.GlobalEnv, auto.assign =
> TRUE)    return <-
> Return.calculate(Ad(get(symbol)))    colnames(return) <-
> gsub("\\.Adjusted", "", colnames(return))    returns[[symbol]] <-
> return  }  returns <- do.call(cbind, returns)  return(returns)}
> returns <- getYahooReturns(symbols)returns <- returns[-1,
> ]returns[is.na(returns)] <- 0
> # portfolio.optim from tseries packagelibrary(tseries)LB <- rep(0,
> ncol(returns))UB <- rep(1, ncol(returns))popt <- portfolio.optim(x =
> returns, covmat = sigma, reslow = LB, reshigh =UB)
> library(parma)# optimal reward to risk (covariance matrix)parmspec <-
> parmaspec(S = cov(returns), risk = "EV", forecast =colMeans(returns),
> riskType = "optimal", LB = LB, UB = UB)parm <- parmasolve(parmspec)
> library(PortfolioAnalytics)simple.moments <- function(R, ...)
> {  num_assets = ncol(R)  out <- list()  out$mu <- matrix(colMeans(R),
> ncol = 1)  out$sigma <- cov(R)  # out$m3 <-
> PerformanceAnalytics:::M3.MM(R)  # out$m4 <-
> PerformanceAnalytics:::M4.MM(R)  out$m3 <- matrix(0, nrow =
> num_assets, ncol = num_assets^2)  out$m4 <- matrix(0, nrow =
> num_assets, ncol = num_assets^3)  out}
> num_assets = ncol(returns)momentargs <- list()momentargs$mu <-
> matrix(colMeans(returns), ncol = 1)momentargs$sigma <-
> cov(returns)momentargs$m3 <- matrix(0, nrow = num_assets, ncol =
> num_assets^2)momentargs$m4 <- matrix(0, nrow = num_assets, ncol =
> num_assets^3)
> pspec <- portfolio.spec(assets = symbols)pspec <-
> add.constraint(portfolio=pspec, type="box", min = 0, max = 1,min_sum
> = 0.99, max_sum = 1.01)pspec <- add.objective(portfolio=pspec,
> type="return", name="mean")pspec <- add.objective(portfolio=pspec,
> type="risk", name="var")
> opt      <- optimize.portfolio(R = returns, portfolio =
> pspec,optimize_method = "DEoptim")opt.fun  <- optimize.portfolio(R =
> returns, portfolio = pspec,optimize_method = "DEoptim", momentFUN =
> "simple.moments")opt.args <- optimize.portfolio(R = returns,
> portfolio = pspec,optimize_method = "DEoptim", momentargs =
> momentargs)data.frame(opt.portf =
> opt$weights,           opt.portf.fun =
> opt.fun$weights,           opt.portf.args =
> opt.args$weights,           portfolio.optim = round(popt$pw,
> 3),           parma = round(weights(parm), 3))
> 
> On Sat, Jun 6, 2020 at 8:38 AM Brian G. Peterson <brian at braverock.com
> >wrote:
> > On Sat, 2020-06-06 at 14:33 +0200, Enrico Schumann wrote:
> > > On Fri, 05 Jun 2020, Roger Bos writes:
> > > > All,
> > > > I am comparing optimize.portfolio from the
> > > > PortfolioAnalyticspackage toportfolio.optim from the tseries
> > > > package.  portfolio.optim seems abiteasier to use, but I like
> > > > the set up of optimize.portfolio.  I havecreateda minimal
> > > > reprex below that compares the output of both in casethat
> > > > helpsanswer my questions.Here are my two primary questions:
> > > > 1) What if I wanted to pass a custom covariance matrix
> > > > tooptimize.portfolio, like from a risk model.  Is that
> > > > possible?  Ican passit to portfolio.optim because covmat is one
> > > > of the parameters.2) What if I wanted to pass forecasted
> > > > returns tooptimize.portfolio?  Howwould that be done.
> > > > If there is anything that can be improved in this example,
> > > > thatwould behelpful as well.  Thank you in advance for any
> > > > assistance, Roger.
> > > > ###
> > > > library(PortfolioAnalytics)library(tidyquant)
> > > > symbols <-
> > > > c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM
> > > > ","GILD")
> > > > getYahooReturns <- function(symbols, return_column = "Ad")
> > > > {  returns <- list()  for (symbol in symbols)
> > > > {    getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE,
> > > > env=.GlobalEnv, auto.assign = TRUE)    return <-
> > > > Return.calculate(Ad(get(symbol)))    colnames(return) <-
> > > > gsub("\\.Adjusted", "", colnames(return))    returns[[symbol]]
> > > > <- return  }  returns <- do.call(cbind,
> > > > returns)  return(returns)}
> > > > returns <- getYahooReturns(symbols)returns <- returns[-1,
> > > > ]returns[is.na(returns)] <- 0
> > > > # portfolio.optim from tseries packagelibrary(tseries)sigma <-
> > > > cov(returns)reslow <- rep(0, ncol(returns))reshigh <- rep(1,
> > > > ncol(returns))popt <- portfolio.optim(x = returns, covmat =
> > > > sigma, reslow =reslow,reshigh = reshigh)popt$pw
> > > > pspec <- portfolio.spec(assets = symbols)pspec <-
> > > > add.constraint(portfolio=pspec,
> > > > type="box",                    min = 0, max = 1, min_sum =
> > > > 0.99, max_sum =1.01)pspec <-
> > > > add.objective(portfolio=pspec,                       type="retu
> > > > rn",                       name="mean")pspec <-
> > > > add.objective(portfolio=pspec,                       type="risk
> > > > ",                       name="var")
> > > > opt <- optimize.portfolio(R =
> > > > returns,                   portfolio =
> > > > pspec,                   optimize_method = "DEoptim",
> > > > )data.frame(optimize.portfolio = opt$weights, portfolio.optim
> > > > =round(popt$pw, 3))
> > > 
> > > If all else fails, and supposing that 'PortfolioAnalytics'
> > > perdefault computes means and covariances in the standard way,
> > > you couldcreate input data (time series) that have exactly the
> > > desiredcovariances and means:
> > > 
> > > 
> > https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451
> > 
> > per default, PortfolioAnalytics uses sample moments as most users
> > wouldexpect.
> > As I already told the OP, the user may pass mu and sigma and m3 and
> > m4directly, or may construct custom moment functions to compute
> > themoments using any method they choose.
> > This is outlined in section 2 of the vignette:
> > 
> > https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
> > 
> > 
> > and, of course, in the manual.
> > 
> 
> 	[[alternative HTML version deleted]]
> _______________________________________________R-SIG-Finance at r-
> project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.--
> Also note that this is not the r-help list where general R questions
> should go.
cov(tmpR, use = "pairwise.complete.obs")

	[[alternative HTML version deleted]]


From roger@bo@ @end|ng |rom gm@||@com  Mon Jun  8 13:17:47 2020
From: roger@bo@ @end|ng |rom gm@||@com (Roger Bos)
Date: Mon, 8 Jun 2020 07:17:47 -0400
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <63d09fafa927daf218f6e130e72e7fbd20a0d567.camel@braverock.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <87o8pw5q7l.fsf@enricoschumann.net>
 <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>
 <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>
 <63d09fafa927daf218f6e130e72e7fbd20a0d567.camel@braverock.com>
Message-ID: <CAPV07m9F-uUMERusrksizpmkftS+XEqXGTvMO1ZdRkeRuQRRjw@mail.gmail.com>

Thank you Brian and Alexios.  In case anyone is interested, here is the
code that produces the exact same results for all five methods:

library(tidyquant)
symbols <-
c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")

getYahooReturns <- function(symbols, return_column = "Ad") {
  returns <- list()
  for (symbol in symbols) {
    getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
.GlobalEnv, auto.assign = TRUE)
    return <- Return.calculate(Ad(get(symbol)))
    colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
    returns[[symbol]] <- return
  }
  returns <- do.call(cbind, returns)
  return(returns)
}

returns <- getYahooReturns(symbols)
returns <- returns[-1, ]
returns[is.na(returns)] <- 0

# portfolio.optim from tseries package
library(tseries)
LB <- rep(0, ncol(returns))
UB <- rep(1, ncol(returns))
popt <- portfolio.optim(x = returns, covmat = sigma, reslow = LB, reshigh =
UB)

library(parma)
# optimal reward to risk (covariance matrix)
parmspec <- parmaspec(S = cov(returns), risk = "EV", forecast =
colMeans(returns), riskType = "minrisk", LB = LB, UB = UB, target =
mean(returns))
parm <- parmasolve(parmspec)

library(PortfolioAnalytics)
simple.moments <- function(R, ...) {
  num_assets = ncol(R)
  out <- list()
  out$mu <- matrix(colMeans(R), ncol = 1)
  out$sigma <- cov(R, use = "pairwise.complete.obs")
  # out$m3 <- PerformanceAnalytics:::M3.MM(R)
  # out$m4 <- PerformanceAnalytics:::M4.MM(R)
  out$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
  out$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
  out
}

num_assets = ncol(returns)
momentargs <- list()
momentargs$mu <- matrix(colMeans(returns), ncol = 1)
momentargs$sigma <- cov(returns, use = "pairwise.complete.obs")
momentargs$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
momentargs$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)

pspec <- portfolio.spec(assets = symbols)
pspec <- add.constraint(portfolio=pspec, type = "box", min = 0, max = 1,
min_sum = 0.99, max_sum = 1.01)
pspec <- add.objective(portfolio=pspec, type = "return", name = "mean")
pspec <- add.objective(portfolio=pspec, type = "risk", name = "var")
pspec <- add.constraint(portfolio=pspec, type = "return", return_target =
mean(returns))

opt      <- optimize.portfolio(R = returns, portfolio = pspec,
optimize_method = "ROI")
opt.fun  <- optimize.portfolio(R = returns, portfolio = pspec,
optimize_method = "ROI", momentFUN = "simple.moments")
opt.args <- optimize.portfolio(R = returns, portfolio = pspec,
optimize_method = "ROI", momentargs = momentargs)
data.frame(opt.portf = round(opt$weights, 3),
           opt.portf.fun = round(opt.fun$weights, 3),
           opt.portf.args = round(opt.args$weights, 3),
           portfolio.optim = round(popt$pw, 3),
           parma = round(weights(parm), 3))


On Sun, Jun 7, 2020 at 8:59 PM Brian G. Peterson <brian at braverock.com>
wrote:

> Roger,
>
> If no Return cleaning method is specified, the default portfolio moments
> function will use pairwise complete observations:
>
> cov(tmpR, use = "pairwise.complete.obs")
>
> if you pass momentargs, the internal calculations for mu and sigma will be
> replaced by momentargs$mu and momentargs$sigma
>
> Alexios has already pointed out the return target, which is not specified
> in your objectives for optimize.portfolio.
>
> I also note that you're using DEoptim, which is unecessarily slow (and may
> not always converge to the same result) for a simple mean variance
> optimization.  You probably want optimize.method='ROI', which will use the
> same direct quadratic approach.  DEoptim (or 'random' or 'GEnSA', or 'pso')
> make sense for more complex objectives that aren't amenable to convex
> solvers.
>
> Regards,
>
> Brian
>
>
>
> --
>
> Brian G. Peterson
> ph: +1.773.459.4973
> im: bgpbraverock
>
> On Sun, 2020-06-07 at 20:14 -0400, Roger Bos wrote:
>
> Thank you to everyone for your suggestions, but I am still having trouble.
>
> I see that there are two ways to pass custom moments into optimize
>
> portfolio, a custom function and using momentargs list.  The example code
>
> at the end of this email uses both of those methods, as well as the default
>
> method.  I also compare those to portfolio.optim and parma.
>
>
> I get quite different results for each method.  I know that they will not
>
> be exactly the same, but surely I am doing something wrong given the
>
> results I am getting.  I would hope that all three optimize portfolio
>
> methods would give me the same results.  Here are the results I am getting:
>
>
>              opt.portf opt.portf.fun opt.portf.args portfolio.optim parma
>
> MSFT     0.372         0.190          0.448           0.253 0.000
>
> AAPL     0.008         0.094          0.044           0.208 0.357
>
> AMZN     0.000         0.076          0.000           0.055 0.119
>
> NVDA     0.020         0.000          0.000           0.020 0.169
>
> CSCO     0.000         0.004          0.002           0.000 0.000
>
> ADBE     0.004         0.040          0.002           0.033 0.032
>
> AMGN     0.298         0.348          0.382           0.253 0.000
>
> ORCL     0.068         0.072          0.010           0.002 0.000
>
> QCOM    0.072         0.000          0.000           0.000 0.000
>
> GILD       0.158         0.176          0.112           0.177 0.322
>
>
> opt.portf is optimize.portfolio with internal mu and sigma
>
> opt.portf.fun is optimize.portfolio with mu and sigma provided in momentFUN
>
> opt.portf.args is optimize.portfolio with mu and sigma provided in
>
> momentargs
>
>
> So if optimize portfolio just uses the column means for mu and cov for
>
> sigma, why am I getting different results than when I use a custom function
>
> or pass in the moments?  Obviously I am doing something wrong since I get
>
> different results when using momentFUN and momentargs.  Thanks in advance
>
> for any help, Roger.
>
>
> ###
>
>
> library(tidyquant)
>
> symbols <-
>
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
>
>
> getYahooReturns <- function(symbols, return_column = "Ad") {
>
>   returns <- list()
>
>   for (symbol in symbols) {
>
>     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
>
> .GlobalEnv, auto.assign = TRUE)
>
>     return <- Return.calculate(Ad(get(symbol)))
>
>     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>
>     returns[[symbol]] <- return
>
>   }
>
>   returns <- do.call(cbind, returns)
>
>   return(returns)
>
> }
>
>
> returns <- getYahooReturns(symbols)
>
> returns <- returns[-1, ]
>
> returns[is.na(returns)] <- 0
>
>
> # portfolio.optim from tseries package
>
> library(tseries)
>
> LB <- rep(0, ncol(returns))
>
> UB <- rep(1, ncol(returns))
>
> popt <- portfolio.optim(x = returns, covmat = sigma, reslow = LB, reshigh =
>
> UB)
>
>
> library(parma)
>
> # optimal reward to risk (covariance matrix)
>
> parmspec <- parmaspec(S = cov(returns), risk = "EV", forecast =
>
> colMeans(returns), riskType = "optimal", LB = LB, UB = UB)
>
> parm <- parmasolve(parmspec)
>
>
> library(PortfolioAnalytics)
>
> simple.moments <- function(R, ...) {
>
>   num_assets = ncol(R)
>
>   out <- list()
>
>   out$mu <- matrix(colMeans(R), ncol = 1)
>
>   out$sigma <- cov(R)
>
>   # out$m3 <- PerformanceAnalytics:::M3.MM(R)
>
>   # out$m4 <- PerformanceAnalytics:::M4.MM(R)
>
>   out$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
>
>   out$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
>
>   out
>
> }
>
>
> num_assets = ncol(returns)
>
> momentargs <- list()
>
> momentargs$mu <- matrix(colMeans(returns), ncol = 1)
>
> momentargs$sigma <- cov(returns)
>
> momentargs$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
>
> momentargs$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
>
>
> pspec <- portfolio.spec(assets = symbols)
>
> pspec <- add.constraint(portfolio=pspec, type="box", min = 0, max = 1,
>
> min_sum = 0.99, max_sum = 1.01)
>
> pspec <- add.objective(portfolio=pspec, type="return", name="mean")
>
> pspec <- add.objective(portfolio=pspec, type="risk", name="var")
>
>
> opt      <- optimize.portfolio(R = returns, portfolio = pspec,
>
> optimize_method = "DEoptim")
>
> opt.fun  <- optimize.portfolio(R = returns, portfolio = pspec,
>
> optimize_method = "DEoptim", momentFUN = "simple.moments")
>
> opt.args <- optimize.portfolio(R = returns, portfolio = pspec,
>
> optimize_method = "DEoptim", momentargs = momentargs)
>
> data.frame(opt.portf = opt$weights,
>
>            opt.portf.fun = opt.fun$weights,
>
>            opt.portf.args = opt.args$weights,
>
>            portfolio.optim = round(popt$pw, 3),
>
>            parma = round(weights(parm), 3))
>
>
>
> On Sat, Jun 6, 2020 at 8:38 AM Brian G. Peterson <
>
> brian at braverock.com
>
> >
>
> wrote:
>
>
> On Sat, 2020-06-06 at 14:33 +0200, Enrico Schumann wrote:
>
> On Fri, 05 Jun 2020, Roger Bos writes:
>
>
> All,
>
>
> I am comparing optimize.portfolio from the PortfolioAnalytics
>
> package to
>
> portfolio.optim from the tseries package.  portfolio.optim seems a
>
> bit
>
> easier to use, but I like the set up of optimize.portfolio.  I have
>
> created
>
> a minimal reprex below that compares the output of both in case
>
> that helps
>
> answer my questions.
>
> Here are my two primary questions:
>
>
> 1) What if I wanted to pass a custom covariance matrix to
>
> optimize.portfolio, like from a risk model.  Is that possible?  I
>
> can pass
>
> it to portfolio.optim because covmat is one of the parameters.
>
> 2) What if I wanted to pass forecasted returns to
>
> optimize.portfolio?  How
>
> would that be done.
>
>
> If there is anything that can be improved in this example, that
>
> would be
>
> helpful as well.  Thank you in advance for any assistance, Roger.
>
>
> ###
>
>
> library(PortfolioAnalytics)
>
> library(tidyquant)
>
>
> symbols <-
>
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","G
>
> ILD")
>
>
> getYahooReturns <- function(symbols, return_column = "Ad") {
>
>   returns <- list()
>
>   for (symbol in symbols) {
>
>     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env
>
> =
>
> .GlobalEnv, auto.assign = TRUE)
>
>     return <- Return.calculate(Ad(get(symbol)))
>
>     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>
>     returns[[symbol]] <- return
>
>   }
>
>   returns <- do.call(cbind, returns)
>
>   return(returns)
>
> }
>
>
> returns <- getYahooReturns(symbols)
>
> returns <- returns[-1, ]
>
> returns[is.na(returns)] <- 0
>
>
> # portfolio.optim from tseries package
>
> library(tseries)
>
> sigma <- cov(returns)
>
> reslow <- rep(0, ncol(returns))
>
> reshigh <- rep(1, ncol(returns))
>
> popt <- portfolio.optim(x = returns, covmat = sigma, reslow =
>
> reslow,
>
> reshigh = reshigh)
>
> popt$pw
>
>
> pspec <- portfolio.spec(assets = symbols)
>
> pspec <- add.constraint(portfolio=pspec, type="box",
>
>                     min = 0, max = 1, min_sum = 0.99, max_sum =
>
> 1.01)
>
> pspec <- add.objective(portfolio=pspec,
>
>                        type="return",
>
>                        name="mean")
>
> pspec <- add.objective(portfolio=pspec,
>
>                        type="risk",
>
>                        name="var")
>
>
> opt <- optimize.portfolio(R = returns,
>
>                    portfolio = pspec,
>
>                    optimize_method = "DEoptim", )
>
> data.frame(optimize.portfolio = opt$weights, portfolio.optim =
>
> round(popt$pw, 3))
>
>
>
> If all else fails, and supposing that 'PortfolioAnalytics' per
>
> default computes means and covariances in the standard way, you could
>
> create input data (time series) that have exactly the desired
>
> covariances and means:
>
>
>
>
> https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451
>
>
>
>
> per default, PortfolioAnalytics uses sample moments as most users would
>
> expect.
>
>
> As I already told the OP, the user may pass mu and sigma and m3 and m4
>
> directly, or may construct custom moment functions to compute the
>
> moments using any method they choose.
>
>
> This is outlined in section 2 of the vignette:
>
>
>
> https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
>
>
>
>
> and, of course, in the manual.
>
>
>
>
> 	[[alternative HTML version deleted]]
>
>
> _______________________________________________
>
> R-SIG-Finance at r-project.org
>
>  mailing list
>
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
> -- Subscriber-posting only. If you want to post, subscribe first.
>
> -- Also note that this is not the r-help list where general R questions should go.
>
>

	[[alternative HTML version deleted]]


From p|t@b@@m @end|ng |rom x|r|@@c@|n  Mon Jun  8 14:24:35 2020
From: p|t@b@@m @end|ng |rom x|r|@@c@|n (Pitabas Mohanty)
Date: Mon, 8 Jun 2020 17:54:35 +0530
Subject: [R-SIG-Finance] query on adjRatios() function from TTR package
Message-ID: <CA+QHwdq4XSBD09yTXKj5+VfngGXSm2p3GBp_t=y9OKMnWM_NhA@mail.gmail.com>

Hi

Can anyone tell me how to find the adjusted closing price when there are
multiple split events on the same day? In India, a few companies have
announced stock split and stock dividend on the same day. When I use the
adjRatios() function, it only adjusts for the first event and not the
second event.

Any help will be greatly appreciated.

Regards

	[[alternative HTML version deleted]]


From jo@h@m@u|r|ch @end|ng |rom gm@||@com  Mon Jun  8 14:33:15 2020
From: jo@h@m@u|r|ch @end|ng |rom gm@||@com (Joshua Ulrich)
Date: Mon, 8 Jun 2020 07:33:15 -0500
Subject: [R-SIG-Finance] query on adjRatios() function from TTR package
In-Reply-To: <CA+QHwdq4XSBD09yTXKj5+VfngGXSm2p3GBp_t=y9OKMnWM_NhA@mail.gmail.com>
References: <CA+QHwdq4XSBD09yTXKj5+VfngGXSm2p3GBp_t=y9OKMnWM_NhA@mail.gmail.com>
Message-ID: <CAPPM_gQadiE64LeuGU9K2rKf1vD2hzD4wdhXZ8VJtop1dkp=3A@mail.gmail.com>

On Mon, Jun 8, 2020 at 7:26 AM Pitabas Mohanty <pitabasm at xlri.ac.in> wrote:
>
> Hi
>
> Can anyone tell me how to find the adjusted closing price when there are
> multiple split events on the same day? In India, a few companies have
> announced stock split and stock dividend on the same day. When I use the
> adjRatios() function, it only adjusts for the first event and not the
> second event.
>
> Any help will be greatly appreciated.
>
Can you please provide an example, so I can investigate?

> Regards
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com


From e@ @end|ng |rom enr|co@chum@nn@net  Mon Jun  8 14:47:23 2020
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Mon, 08 Jun 2020 14:47:23 +0200
Subject: [R-SIG-Finance] query on adjRatios() function from TTR package
In-Reply-To: <CA+QHwdq4XSBD09yTXKj5+VfngGXSm2p3GBp_t=y9OKMnWM_NhA@mail.gmail.com>
 (Pitabas Mohanty's message of "Mon, 8 Jun 2020 17:54:35 +0530")
References: <CA+QHwdq4XSBD09yTXKj5+VfngGXSm2p3GBp_t=y9OKMnWM_NhA@mail.gmail.com>
Message-ID: <87o8ptsp0k.fsf@enricoschumann.net>

On Mon, 08 Jun 2020, Pitabas Mohanty writes:

> Hi
>
> Can anyone tell me how to find the adjusted closing price when there are
> multiple split events on the same day? In India, a few companies have
> announced stock split and stock dividend on the same day. When I use the
> adjRatios() function, it only adjusts for the first event and not the
> second event.
>
> Any help will be greatly appreciated.
>

Function 'split_adjust' in package 'PMwR' supports
several splits on a single timestamp.  Suppose a stock
split two times 2-for-1 on timestamp 2.  Then:

  split_adjust(x = c(100, 25, 25),  ## prices
               t = c(2, 2),         ## index when split occurs
               ratio = c(2, 2))     ## split ratio
  ## [1] 25 25 25

  split_adjust(x = c(100, 25, 49), t = c(2, 2),
               ratio = c(2,2), backward = FALSE)
  ## [1] 100 100 100
  
-- 
Enrico Schumann (maintainer of PMwR)
Lucerne, Switzerland
http://enricoschumann.net


From roger@bo@ @end|ng |rom gm@||@com  Mon Jun  8 20:13:52 2020
From: roger@bo@ @end|ng |rom gm@||@com (Roger Bos)
Date: Mon, 8 Jun 2020 14:13:52 -0400
Subject: [R-SIG-Finance] Using optimize.portfolio
In-Reply-To: <452381003.1000223.1591628011040@mail.yahoo.com>
References: <CAPV07m8yEregOBg8YKQYpcE0HAi4Vhh0r0KGy9M8CrbDH+XLsg@mail.gmail.com>
 <87o8pw5q7l.fsf@enricoschumann.net>
 <0247c8fd35064189bb67eafbb36742e66e16fec0.camel@braverock.com>
 <CAPV07m94xq5mzy-DvPWd2_Bp9FpUO3tgCUNnZ=+QtcELaB9CyA@mail.gmail.com>
 <63d09fafa927daf218f6e130e72e7fbd20a0d567.camel@braverock.com>
 <CAPV07m9F-uUMERusrksizpmkftS+XEqXGTvMO1ZdRkeRuQRRjw@mail.gmail.com>
 <452381003.1000223.1591628011040@mail.yahoo.com>
Message-ID: <CAPV07m8ZY0OvBbswXzr0zY=dzKWiCKHHVsPhxCj-3d6VSCoM0Q@mail.gmail.com>

Vivek,

Originally, I used sigma <- cov(returns), but then I changed it to sigma <-
cov(returns, use = "pairwise.complete.obs") per Brian's suggestion.

Thanks,

Roger


On Mon, Jun 8, 2020 at 10:53 AM Vivek Rao <vivekrao4 at yahoo.com> wrote:

> Thanks for posting your code. When I try to run it I get the error
>
> Error in portfolio.optim.default(x = returns, covmat = sigma, reslow =
> LB,  :
>   covmat is not a matrix
> Calls: portfolio.optim -> portfolio.optim.default
> Execution halted
>
> Could you post to the group the code that computes sigma? Thanks.
>
> Vivek Rao
> Boston, MA
>
>
> On Monday, June 8, 2020, 07:18:37 AM EDT, Roger Bos <roger.bos at gmail.com>
> wrote:
>
>
>
>
>
> Thank you Brian and Alexios.  In case anyone is interested, here is the
> code that produces the exact same results for all five methods:
>
> library(tidyquant)
> symbols <-
> c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
>
> getYahooReturns <- function(symbols, return_column = "Ad") {
>   returns <- list()
>   for (symbol in symbols) {
>     getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
> .GlobalEnv, auto.assign = TRUE)
>     return <- Return.calculate(Ad(get(symbol)))
>     colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
>     returns[[symbol]] <- return
>   }
>   returns <- do.call(cbind, returns)
>   return(returns)
> }
>
> returns <- getYahooReturns(symbols)
> returns <- returns[-1, ]
> returns[is.na(returns)] <- 0
>
> # portfolio.optim from tseries package
> library(tseries)
> LB <- rep(0, ncol(returns))
> UB <- rep(1, ncol(returns))
> popt <- portfolio.optim(x = returns, covmat = sigma, reslow = LB, reshigh =
> UB)
>
> library(parma)
> # optimal reward to risk (covariance matrix)
> parmspec <- parmaspec(S = cov(returns), risk = "EV", forecast =
> colMeans(returns), riskType = "minrisk", LB = LB, UB = UB, target =
> mean(returns))
> parm <- parmasolve(parmspec)
>
> library(PortfolioAnalytics)
> simple.moments <- function(R, ...) {
>   num_assets = ncol(R)
>   out <- list()
>   out$mu <- matrix(colMeans(R), ncol = 1)
>   out$sigma <- cov(R, use = "pairwise.complete.obs")
>   # out$m3 <- PerformanceAnalytics:::M3.MM(R)
>   # out$m4 <- PerformanceAnalytics:::M4.MM(R)
>   out$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
>   out$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
>   out
> }
>
> num_assets = ncol(returns)
> momentargs <- list()
> momentargs$mu <- matrix(colMeans(returns), ncol = 1)
> momentargs$sigma <- cov(returns, use = "pairwise.complete.obs")
> momentargs$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
> momentargs$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
>
> pspec <- portfolio.spec(assets = symbols)
> pspec <- add.constraint(portfolio=pspec, type = "box", min = 0, max = 1,
> min_sum = 0.99, max_sum = 1.01)
> pspec <- add.objective(portfolio=pspec, type = "return", name = "mean")
> pspec <- add.objective(portfolio=pspec, type = "risk", name = "var")
> pspec <- add.constraint(portfolio=pspec, type = "return", return_target =
> mean(returns))
>
> opt      <- optimize.portfolio(R = returns, portfolio = pspec,
> optimize_method = "ROI")
> opt.fun  <- optimize.portfolio(R = returns, portfolio = pspec,
> optimize_method = "ROI", momentFUN = "simple.moments")
> opt.args <- optimize.portfolio(R = returns, portfolio = pspec,
> optimize_method = "ROI", momentargs = momentargs)
> data.frame(opt.portf = round(opt$weights, 3),
>           opt.portf.fun = round(opt.fun$weights, 3),
>           opt.portf.args = round(opt.args$weights, 3),
>           portfolio.optim = round(popt$pw, 3),
>           parma = round(weights(parm), 3))
>
>
> On Sun, Jun 7, 2020 at 8:59 PM Brian G. Peterson <brian at braverock.com>
> wrote:
>
> > Roger,
> >
> > If no Return cleaning method is specified, the default portfolio moments
> > function will use pairwise complete observations:
> >
> > cov(tmpR, use = "pairwise.complete.obs")
> >
> > if you pass momentargs, the internal calculations for mu and sigma will
> be
> > replaced by momentargs$mu and momentargs$sigma
> >
> > Alexios has already pointed out the return target, which is not specified
> > in your objectives for optimize.portfolio.
> >
> > I also note that you're using DEoptim, which is unecessarily slow (and
> may
> > not always converge to the same result) for a simple mean variance
> > optimization.  You probably want optimize.method='ROI', which will use
> the
> > same direct quadratic approach.  DEoptim (or 'random' or 'GEnSA', or
> 'pso')
> > make sense for more complex objectives that aren't amenable to convex
> > solvers.
> >
> > Regards,
> >
> > Brian
> >
> >
> >
> > --
> >
> > Brian G. Peterson
> > ph: +1.773.459.4973
> > im: bgpbraverock
> >
> > On Sun, 2020-06-07 at 20:14 -0400, Roger Bos wrote:
> >
> > Thank you to everyone for your suggestions, but I am still having
> trouble.
> >
> > I see that there are two ways to pass custom moments into optimize
> >
> > portfolio, a custom function and using momentargs list.  The example code
> >
> > at the end of this email uses both of those methods, as well as the
> default
> >
> > method.  I also compare those to portfolio.optim and parma.
> >
> >
> > I get quite different results for each method.  I know that they will not
> >
> > be exactly the same, but surely I am doing something wrong given the
> >
> > results I am getting.  I would hope that all three optimize portfolio
> >
> > methods would give me the same results.  Here are the results I am
> getting:
> >
> >
> >              opt.portf opt.portf.fun opt.portf.args portfolio.optim parma
> >
> > MSFT    0.372        0.190          0.448          0.253 0.000
> >
> > AAPL    0.008        0.094          0.044          0.208 0.357
> >
> > AMZN    0.000        0.076          0.000          0.055 0.119
> >
> > NVDA    0.020        0.000          0.000          0.020 0.169
> >
> > CSCO    0.000        0.004          0.002          0.000 0.000
> >
> > ADBE    0.004        0.040          0.002          0.033 0.032
> >
> > AMGN    0.298        0.348          0.382          0.253 0.000
> >
> > ORCL    0.068        0.072          0.010          0.002 0.000
> >
> > QCOM    0.072        0.000          0.000          0.000 0.000
> >
> > GILD      0.158        0.176          0.112          0.177 0.322
> >
> >
> > opt.portf is optimize.portfolio with internal mu and sigma
> >
> > opt.portf.fun is optimize.portfolio with mu and sigma provided in
> momentFUN
> >
> > opt.portf.args is optimize.portfolio with mu and sigma provided in
> >
> > momentargs
> >
> >
> > So if optimize portfolio just uses the column means for mu and cov for
> >
> > sigma, why am I getting different results than when I use a custom
> function
> >
> > or pass in the moments?  Obviously I am doing something wrong since I get
> >
> > different results when using momentFUN and momentargs.  Thanks in advance
> >
> > for any help, Roger.
> >
> >
> > ###
> >
> >
> > library(tidyquant)
> >
> > symbols <-
> >
> > c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","GILD")
> >
> >
> > getYahooReturns <- function(symbols, return_column = "Ad") {
> >
> >  returns <- list()
> >
> >  for (symbol in symbols) {
> >
> >    getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env =
> >
> > .GlobalEnv, auto.assign = TRUE)
> >
> >    return <- Return.calculate(Ad(get(symbol)))
> >
> >    colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
> >
> >    returns[[symbol]] <- return
> >
> >  }
> >
> >  returns <- do.call(cbind, returns)
> >
> >  return(returns)
> >
> > }
> >
> >
> > returns <- getYahooReturns(symbols)
> >
> > returns <- returns[-1, ]
> >
> > returns[is.na(returns)] <- 0
> >
> >
> > # portfolio.optim from tseries package
> >
> > library(tseries)
> >
> > LB <- rep(0, ncol(returns))
> >
> > UB <- rep(1, ncol(returns))
> >
> > popt <- portfolio.optim(x = returns, covmat = sigma, reslow = LB,
> reshigh =
> >
> > UB)
> >
> >
> > library(parma)
> >
> > # optimal reward to risk (covariance matrix)
> >
> > parmspec <- parmaspec(S = cov(returns), risk = "EV", forecast =
> >
> > colMeans(returns), riskType = "optimal", LB = LB, UB = UB)
> >
> > parm <- parmasolve(parmspec)
> >
> >
> > library(PortfolioAnalytics)
> >
> > simple.moments <- function(R, ...) {
> >
> >  num_assets = ncol(R)
> >
> >  out <- list()
> >
> >  out$mu <- matrix(colMeans(R), ncol = 1)
> >
> >  out$sigma <- cov(R)
> >
> >  # out$m3 <- PerformanceAnalytics:::M3.MM(R)
> >
> >  # out$m4 <- PerformanceAnalytics:::M4.MM(R)
> >
> >  out$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
> >
> >  out$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
> >
> >  out
> >
> > }
> >
> >
> > num_assets = ncol(returns)
> >
> > momentargs <- list()
> >
> > momentargs$mu <- matrix(colMeans(returns), ncol = 1)
> >
> > momentargs$sigma <- cov(returns)
> >
> > momentargs$m3 <- matrix(0, nrow = num_assets, ncol = num_assets^2)
> >
> > momentargs$m4 <- matrix(0, nrow = num_assets, ncol = num_assets^3)
> >
> >
> > pspec <- portfolio.spec(assets = symbols)
> >
> > pspec <- add.constraint(portfolio=pspec, type="box", min = 0, max = 1,
> >
> > min_sum = 0.99, max_sum = 1.01)
> >
> > pspec <- add.objective(portfolio=pspec, type="return", name="mean")
> >
> > pspec <- add.objective(portfolio=pspec, type="risk", name="var")
> >
> >
> > opt      <- optimize.portfolio(R = returns, portfolio = pspec,
> >
> > optimize_method = "DEoptim")
> >
> > opt.fun  <- optimize.portfolio(R = returns, portfolio = pspec,
> >
> > optimize_method = "DEoptim", momentFUN = "simple.moments")
> >
> > opt.args <- optimize.portfolio(R = returns, portfolio = pspec,
> >
> > optimize_method = "DEoptim", momentargs = momentargs)
> >
> > data.frame(opt.portf = opt$weights,
> >
> >            opt.portf.fun = opt.fun$weights,
> >
> >            opt.portf.args = opt.args$weights,
> >
> >            portfolio.optim = round(popt$pw, 3),
> >
> >            parma = round(weights(parm), 3))
> >
> >
> >
> > On Sat, Jun 6, 2020 at 8:38 AM Brian G. Peterson <
> >
> > brian at braverock.com
> >
> > >
> >
> > wrote:
> >
> >
> > On Sat, 2020-06-06 at 14:33 +0200, Enrico Schumann wrote:
> >
> > On Fri, 05 Jun 2020, Roger Bos writes:
> >
> >
> > All,
> >
> >
> > I am comparing optimize.portfolio from the PortfolioAnalytics
> >
> > package to
> >
> > portfolio.optim from the tseries package.  portfolio.optim seems a
> >
> > bit
> >
> > easier to use, but I like the set up of optimize.portfolio.  I have
> >
> > created
> >
> > a minimal reprex below that compares the output of both in case
> >
> > that helps
> >
> > answer my questions.
> >
> > Here are my two primary questions:
> >
> >
> > 1) What if I wanted to pass a custom covariance matrix to
> >
> > optimize.portfolio, like from a risk model.  Is that possible?  I
> >
> > can pass
> >
> > it to portfolio.optim because covmat is one of the parameters.
> >
> > 2) What if I wanted to pass forecasted returns to
> >
> > optimize.portfolio?  How
> >
> > would that be done.
> >
> >
> > If there is anything that can be improved in this example, that
> >
> > would be
> >
> > helpful as well.  Thank you in advance for any assistance, Roger.
> >
> >
> > ###
> >
> >
> > library(PortfolioAnalytics)
> >
> > library(tidyquant)
> >
> >
> > symbols <-
> >
> > c("MSFT","AAPL","AMZN","NVDA","CSCO","ADBE","AMGN","ORCL","QCOM","G
> >
> > ILD")
> >
> >
> > getYahooReturns <- function(symbols, return_column = "Ad") {
> >
> >  returns <- list()
> >
> >  for (symbol in symbols) {
> >
> >    getSymbols(symbol, from = '2000-01-01', adjustOHLC = TRUE, env
> >
> > =
> >
> > .GlobalEnv, auto.assign = TRUE)
> >
> >    return <- Return.calculate(Ad(get(symbol)))
> >
> >    colnames(return) <- gsub("\\.Adjusted", "", colnames(return))
> >
> >    returns[[symbol]] <- return
> >
> >  }
> >
> >  returns <- do.call(cbind, returns)
> >
> >  return(returns)
> >
> > }
> >
> >
> > returns <- getYahooReturns(symbols)
> >
> > returns <- returns[-1, ]
> >
> > returns[is.na(returns)] <- 0
> >
> >
> > # portfolio.optim from tseries package
> >
> > library(tseries)
> >
> > sigma <- cov(returns)
> >
> > reslow <- rep(0, ncol(returns))
> >
> > reshigh <- rep(1, ncol(returns))
> >
> > popt <- portfolio.optim(x = returns, covmat = sigma, reslow =
> >
> > reslow,
> >
> > reshigh = reshigh)
> >
> > popt$pw
> >
> >
> > pspec <- portfolio.spec(assets = symbols)
> >
> > pspec <- add.constraint(portfolio=pspec, type="box",
> >
> >                    min = 0, max = 1, min_sum = 0.99, max_sum =
> >
> > 1.01)
> >
> > pspec <- add.objective(portfolio=pspec,
> >
> >                        type="return",
> >
> >                        name="mean")
> >
> > pspec <- add.objective(portfolio=pspec,
> >
> >                        type="risk",
> >
> >                        name="var")
> >
> >
> > opt <- optimize.portfolio(R = returns,
> >
> >                    portfolio = pspec,
> >
> >                    optimize_method = "DEoptim", )
> >
> > data.frame(optimize.portfolio = opt$weights, portfolio.optim =
> >
> > round(popt$pw, 3))
> >
> >
> >
> > If all else fails, and supposing that 'PortfolioAnalytics' per
> >
> > default computes means and covariances in the standard way, you could
> >
> > create input data (time series) that have exactly the desired
> >
> > covariances and means:
> >
> >
> >
> >
> >
> https://stackoverflow.com/questions/58293991/how-to-use-fportfolio-package-in-r-for-non-time-series-input/58302451#58302451
> >
> >
> >
> >
> > per default, PortfolioAnalytics uses sample moments as most users would
> >
> > expect.
> >
> >
> > As I already told the OP, the user may pass mu and sigma and m3 and m4
> >
> > directly, or may construct custom moment functions to compute the
> >
> > moments using any method they choose.
> >
> >
> > This is outlined in section 2 of the vignette:
> >
> >
> >
> >
> https://cran.r-project.org/web/packages/PortfolioAnalytics/vignettes/custom_moments_objectives.pdf
> >
> >
> >
> >
> > and, of course, in the manual.
> >
> >
> >
> >
> >     [[alternative HTML version deleted]]
> >
> >
> > _______________________________________________
> >
> > R-SIG-Finance at r-project.org
> >
> >  mailing list
> >
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >
> >
> > -- Subscriber-posting only. If you want to post, subscribe first.
> >
> > -- Also note that this is not the r-help list where general R questions
> should go.
> >
> >
>
>     [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From p|t@b@@m @end|ng |rom x|r|@@c@|n  Tue Jun  9 10:00:53 2020
From: p|t@b@@m @end|ng |rom x|r|@@c@|n (Pitabas Mohanty)
Date: Tue, 9 Jun 2020 13:30:53 +0530
Subject: [R-SIG-Finance] query on adjRatios() function from TTR package
In-Reply-To: <87o8ptsp0k.fsf@enricoschumann.net>
References: <CA+QHwdq4XSBD09yTXKj5+VfngGXSm2p3GBp_t=y9OKMnWM_NhA@mail.gmail.com>
 <87o8ptsp0k.fsf@enricoschumann.net>
Message-ID: <CA+QHwdpxThoTgDHoOvaZAGsq9hYRLKYGuq-6=__Z_DiGuWmx5Q@mail.gmail.com>

Yes, it is working. I could finally compute the adjusted closing prices.

Thank you so much.

On Mon, Jun 8, 2020 at 6:17 PM Enrico Schumann <es at enricoschumann.net>
wrote:

> On Mon, 08 Jun 2020, Pitabas Mohanty writes:
>
> > Hi
> >
> > Can anyone tell me how to find the adjusted closing price when there are
> > multiple split events on the same day? In India, a few companies have
> > announced stock split and stock dividend on the same day. When I use the
> > adjRatios() function, it only adjusts for the first event and not the
> > second event.
> >
> > Any help will be greatly appreciated.
> >
>
> Function 'split_adjust' in package 'PMwR' supports
> several splits on a single timestamp.  Suppose a stock
> split two times 2-for-1 on timestamp 2.  Then:
>
>   split_adjust(x = c(100, 25, 25),  ## prices
>                t = c(2, 2),         ## index when split occurs
>                ratio = c(2, 2))     ## split ratio
>   ## [1] 25 25 25
>
>   split_adjust(x = c(100, 25, 49), t = c(2, 2),
>                ratio = c(2,2), backward = FALSE)
>   ## [1] 100 100 100
>
> --
> Enrico Schumann (maintainer of PMwR)
> Lucerne, Switzerland
> http://enricoschumann.net
>

	[[alternative HTML version deleted]]


From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Wed Jun 10 11:38:57 2020
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Wed, 10 Jun 2020 15:08:57 +0530
Subject: [R-SIG-Finance] Back testing
Message-ID: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>

Hi,

I was looking for an idea how banks backtest their models for Expected
Shortfall. Backtesting VaR is well documented but I failed to get any
practical idea about backtesting ES.

Any pointer towards the best practice will be really helpful.

Thanks,


From |eo@e@ @end|ng |rom out|ook@com  Wed Jun 10 13:51:28 2020
From: |eo@e@ @end|ng |rom out|ook@com (leo sea)
Date: Wed, 10 Jun 2020 11:51:28 +0000
Subject: [R-SIG-Finance] Back testing
In-Reply-To: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
Message-ID: <PR3P194MB084296245EFB0ECB4B1EF5E8CD830@PR3P194MB0842.EURP194.PROD.OUTLOOK.COM>

Hi
I am also interested in in ES backtesting.
Good idea
Thanks

T?l?chargez Outlook pour Android<https://aka.ms/ghei36>

________________________________
From: R-SIG-Finance <r-sig-finance-bounces at r-project.org> on behalf of Christofer Bogaso <bogaso.christofer at gmail.com>
Sent: Wednesday, June 10, 2020 11:38:57 AM
To: r-sig-finance at r-project.org <r-sig-finance at r-project.org>
Subject: [R-SIG-Finance] Back testing

Hi,

I was looking for an idea how banks backtest their models for Expected
Shortfall. Backtesting VaR is well documented but I failed to get any
practical idea about backtesting ES.

Any pointer towards the best practice will be really helpful.

Thanks,

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

	[[alternative HTML version deleted]]


From br|@n @end|ng |rom br@verock@com  Wed Jun 10 19:22:57 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Wed, 10 Jun 2020 12:22:57 -0500
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
Message-ID: <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>

On Wed, 2020-06-10 at 15:08 +0530, Christofer Bogaso wrote:
> I was looking for an idea how banks backtest their models for
> Expected
> Shortfall. Backtesting VaR is well documented but I failed to get any
> practical idea about backtesting ES.
> 
> Any pointer towards the best practice will be really helpful.

If you are using Normal VaR, then you know the Expected Shortfall
estimate too.

If you are using a different mechanism, then of course the mean loss
when the loss exceeds the VaR may be significantly different than the
Normal ES.

So, to backetesting...  the newest Basel standard replaces VaR with ES,
and requires that banks justify their use of a particular ES model that
they are using to calculate required regulatory capital.

To the best of my knowledge, the most widely used and cited approaches
are outlined here:

https://dlu-umich.github.io/docs/Research_Insight_Backtesting_Expected_Shortfall_December_2014.pdf

Generally, I like the overall methodology presented by this paper.  The
only complexity is the need to store (or be able to recalculate) the
full distribution of the tail.  I don't see this as a giant roadblock,
since the tail distribution contains additional information of interest
anyway, the shape of the tail is useful in model validation and
fitting, and disk is cheap.

The models presented in the reference above, while not to my knowledge
directly implemented in R, should be able to be constructed from data
in the recent R packages by Ardia et. al. GAS:

https://journal.r-project.org/archive/2018/RJ-2018-064/RJ-2018-064.pdf

and MSGARCH:

https://www.sciencedirect.com/science/article/pii/S0169207018300840

Regards,

Brian


-- 
Brian G. Peterson
ph: +1.773.459.4973
im: bgpbraverock


From d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com  Wed Jun 10 20:08:55 2020
From: d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com (=?UTF-8?Q?Daniel_Cegie=C5=82ka?=)
Date: Wed, 10 Jun 2020 20:08:55 +0200
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
Message-ID: <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>

?r., 10 cze 2020 o 19:23 Brian G. Peterson <brian at braverock.com> napisa?(a):
>
> On Wed, 2020-06-10 at 15:08 +0530, Christofer Bogaso wrote:
> > I was looking for an idea how banks backtest their models for
> > Expected
> > Shortfall. Backtesting VaR is well documented but I failed to get any
> > practical idea about backtesting ES.
> >
> > Any pointer towards the best practice will be really helpful.
>
> If you are using Normal VaR, then you know the Expected Shortfall
> estimate too.
>
> If you are using a different mechanism, then of course the mean loss
> when the loss exceeds the VaR may be significantly different than the
> Normal ES.
>
> So, to backetesting...  the newest Basel standard replaces VaR with ES,
> and requires that banks justify their use of a particular ES model that
> they are using to calculate required regulatory capital.

In my opinion, there is one aspect that introduces some confusion. ES
(CVaR) is now common, but many people, perhaps out of habit, maybe for
historical reasons, still use the term VaR instead of the correct name
(ES).

Best regards,
Daniel


> Regards,
>
> Brian
>
>
> --
> Brian G. Peterson
> ph: +1.773.459.4973
> im: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From br|@n @end|ng |rom br@verock@com  Wed Jun 10 20:44:10 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Wed, 10 Jun 2020 13:44:10 -0500
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
 <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
Message-ID: <dc3fefb61a5530b5359bd0d04b7cfd276a71b7c4.camel@braverock.com>

On Wed, 2020-06-10 at 20:08 +0200, Daniel Cegie?ka wrote:
> ?r., 10 cze 2020 o 19:23 Brian G. Peterson <
> brian at braverock.com
> > napisa?(a):
> > So, to backtesting...  the newest Basel standard replaces VaR with
> > ES,
> > and requires that banks justify their use of a particular ES model
> > that
> > they are using to calculate required regulatory capital.
> 
> In my opinion, there is one aspect that introduces some confusion. ES
> (CVaR) is now common, but many people, perhaps out of habit, maybe
> for
> historical reasons, still use the term VaR instead of the correct
> name
> (ES).

VaR and ES (CVaR, ETL) are mathematically related to each other, since
ES is the mean loss when the loss exceeds the VaR quantile.

Confusingly, one of the permissible tests of a bank's ES model under
Basel is the 'VaR test' which measures the number of VaR exceeding
events, and the degree of the loss eceeding VaR to evaluate whether the
*ES* model is likely valid.  This test has been widely criticized, and
should likely be avoided as anything other than a quick check of
possible suitability.

Regards,

Brian


From @|ex|o@ @end|ng |rom 4d@c@pe@com  Wed Jun 10 21:13:58 2020
From: @|ex|o@ @end|ng |rom 4d@c@pe@com (alexios galanos)
Date: Wed, 10 Jun 2020 12:13:58 -0700
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
 <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
Message-ID: <27691ebc-19ac-3be0-85a0-43055bef7d33@4dscape.com>



On 6/10/20 11:08 AM, Daniel Cegie?ka wrote:
> ?r., 10 cze 2020 o 19:23 Brian G. Peterson <brian at braverock.com> napisa?(a):
>>
>> On Wed, 2020-06-10 at 15:08 +0530, Christofer Bogaso wrote:
>>> I was looking for an idea how banks backtest their models for
>>> Expected
>>> Shortfall. Backtesting VaR is well documented but I failed to get any
>>> practical idea about backtesting ES.
>>>
>>> Any pointer towards the best practice will be really helpful.
>>
>> If you are using Normal VaR, then you know the Expected Shortfall
>> estimate too.
>>
>> If you are using a different mechanism, then of course the mean loss
>> when the loss exceeds the VaR may be significantly different than the
>> Normal ES.
>>
>> So, to backetesting...  the newest Basel standard replaces VaR with ES,
>> and requires that banks justify their use of a particular ES model that
>> they are using to calculate required regulatory capital.
> 
> In my opinion, there is one aspect that introduces some confusion. ES
> (CVaR) is now common, but many people, perhaps out of habit, maybe for
> historical reasons, still use the term VaR instead of the correct name
> (ES).

Not sure I follow. VaR and ES are different measures. VaR is a
quantile while ES is the average loss conditional on that quantile
(i.e. the expected loss conditional that the loss is greater than
the quantile of the loss distribution).

Regards,

Alexios

> 
> Best regards,
> Daniel
> 
> 
>> Regards,
>>
>> Brian
>>
>>
>> --
>> Brian G. Peterson
>> ph: +1.773.459.4973
>> im: bgpbraverock
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com  Wed Jun 10 21:48:25 2020
From: d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com (=?UTF-8?Q?Daniel_Cegie=C5=82ka?=)
Date: Wed, 10 Jun 2020 21:48:25 +0200
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <27691ebc-19ac-3be0-85a0-43055bef7d33@4dscape.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
 <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
 <27691ebc-19ac-3be0-85a0-43055bef7d33@4dscape.com>
Message-ID: <CAPLrYET4B4KFcZ9WEvhtM1=nGSoeBAs4Q3xnudSSBS19efeTBA@mail.gmail.com>

?r., 10 cze 2020 o 21:14 alexios galanos <alexios at 4dscape.com> napisa?(a):
>
>
>
> On 6/10/20 11:08 AM, Daniel Cegie?ka wrote:
> > ?r., 10 cze 2020 o 19:23 Brian G. Peterson <brian at braverock.com> napisa?(a):
> >>
> >> On Wed, 2020-06-10 at 15:08 +0530, Christofer Bogaso wrote:
> >>> I was looking for an idea how banks backtest their models for
> >>> Expected
> >>> Shortfall. Backtesting VaR is well documented but I failed to get any
> >>> practical idea about backtesting ES.
> >>>
> >>> Any pointer towards the best practice will be really helpful.
> >>
> >> If you are using Normal VaR, then you know the Expected Shortfall
> >> estimate too.
> >>
> >> If you are using a different mechanism, then of course the mean loss
> >> when the loss exceeds the VaR may be significantly different than the
> >> Normal ES.
> >>
> >> So, to backetesting...  the newest Basel standard replaces VaR with ES,
> >> and requires that banks justify their use of a particular ES model that
> >> they are using to calculate required regulatory capital.
> >
> > In my opinion, there is one aspect that introduces some confusion. ES
> > (CVaR) is now common, but many people, perhaps out of habit, maybe for
> > historical reasons, still use the term VaR instead of the correct name
> > (ES).
>
> Not sure I follow. VaR and ES are different measures. VaR is a
> quantile while ES is the average loss conditional on that quantile
> (i.e. the expected loss conditional that the loss is greater than
> the quantile of the loss distribution).

I agree that these names should not be confused. However, I
encountered that the _name_ "VaR" is used for ES. In my opinion, this
is due to a mental shortcut, or it's a historical habit. Such
imprecise use of the names often leads to misunderstanding.

Daniel

> Regards,
>
> Alexios
>
> >
> > Best regards,
> > Daniel
> >
> >
> >> Regards,
> >>
> >> Brian
> >>
> >>
> >> --
> >> Brian G. Peterson
> >> ph: +1.773.459.4973
> >> im: bgpbraverock
> >>
> >> _______________________________________________
> >> R-SIG-Finance at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> -- Subscriber-posting only. If you want to post, subscribe first.
> >> -- Also note that this is not the r-help list where general R questions should go.
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions should go.
> >


From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Sat Jun 13 18:47:45 2020
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Sat, 13 Jun 2020 22:17:45 +0530
Subject: [R-SIG-Finance] Back testing
In-Reply-To: <PR3P194MB084296245EFB0ECB4B1EF5E8CD830@PR3P194MB0842.EURP194.PROD.OUTLOOK.COM>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <PR3P194MB084296245EFB0ECB4B1EF5E8CD830@PR3P194MB0842.EURP194.PROD.OUTLOOK.COM>
Message-ID: <CA+dpOJ=7jjMH5a8tKCe7rhh889ENJeo65dEW1NYZd3xQEaO9AA@mail.gmail.com>

Thanks Brian, the resources are really helpful.

However I am not sure if I fully understood the implementation part of
the MSCI's approach. It basically defines different test-statistics
r.g. Z1, Z2, etc. For Z1, it asserts that under null, the expected
value for Z1 will be zero. I failed to see what distribution would it
take under H0, so that I can complete the significance testing and/or
defining some confidence interval under null.

Ideally, with realised daily PnL and forecasted ES, we will have a
time series of Z1 - if my understanding is perfect. To carry out if
E[Z1] = 0, can I do some t-test or some non-parametric test for
testing mean =0?

I think, this should be valid as only assumption was that PnL has to
be independent, may not be identically distributed. My only concern
is, can I use an ordinary significance table for t-test? I am little
concerned because, testing would be done on Z1's values, which are
calculated values, not the original dataset. So a non-parametric test
may be more appropriate.

Any pointer on above thinking is highly appreciated.

On Wed, Jun 10, 2020 at 5:21 PM leo sea <leosea at outlook.com> wrote:
>
> Hi
> I am also interested in in ES backtesting.
> Good idea
> Thanks
>
> T?l?chargez Outlook pour Android
>
> ________________________________
> From: R-SIG-Finance <r-sig-finance-bounces at r-project.org> on behalf of Christofer Bogaso <bogaso.christofer at gmail.com>
> Sent: Wednesday, June 10, 2020 11:38:57 AM
> To: r-sig-finance at r-project.org <r-sig-finance at r-project.org>
> Subject: [R-SIG-Finance] Back testing
>
> Hi,
>
> I was looking for an idea how banks backtest their models for Expected
> Shortfall. Backtesting VaR is well documented but I failed to get any
> practical idea about backtesting ES.
>
> Any pointer towards the best practice will be really helpful.
>
> Thanks,
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From p|t@goetz @end|ng |rom w|w|@un|-h@||e@de  Mon Jun 15 16:34:38 2020
From: p|t@goetz @end|ng |rom w|w|@un|-h@||e@de (=?UTF-8?B?UGl0IEfDtnR6?=)
Date: Mon, 15 Jun 2020 16:34:38 +0200
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <CAPLrYET4B4KFcZ9WEvhtM1=nGSoeBAs4Q3xnudSSBS19efeTBA@mail.gmail.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
 <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
 <27691ebc-19ac-3be0-85a0-43055bef7d33@4dscape.com>
 <CAPLrYET4B4KFcZ9WEvhtM1=nGSoeBAs4Q3xnudSSBS19efeTBA@mail.gmail.com>
Message-ID: <5EE786FE020000F800113B85@gwia0.itz.uni-halle.de>

Hello everyone,

I work at a university in 
germany and we are also currently working on forecasting ES and (of 
course) backtesting of said forecasts.

Over the last few months some students, who are writing their masters
thesis at our chair, had to some litarature research.
Thats why I wanted to give you a very brief overview of their findings:

The
 most widely applied ES backtests seems to be the backtest by McNeil, 
Frey and Embrechts (2000), implemented for example in the rugarch 
package.
(the test was already mentioned here by Alexios)

In addition to the already mentioned tests and the paper by Acerby and
Szekely I wanted to add the following:


A
 Hitsequence based backtest was introduced for by Du, Escanciano (2017).
 As far as I am concerned, this test has not yet been implemented in a 
package, but their code is available online. In a broader view, this 
test is a special case of a spectral measure test by Costanzino, Curran 
(2014), which was then extended to a Basel-Like traffic light approach 
in 2018 (Not sure about the availability of code).

In
 Emmer et al. (2015) it is suggested, that a suitable ES forecast can be
 approximated by only 4 different VaR forecasts. This also suggests, 
that you can backtest ES, forecasted by a model that forecasts both, ES 
and VaR, such as GARCH, by backtesting th 4 different VaR forecasts.
However this approach seems to need more empirical valuation.

I
 also wanted to mention the paper by Gneiting (2011), showing that the 
ES lacks elicitability property. This can lead to complications, when 
you try to backtest the ES itself as a point forecast.However, this 
property can be used to construct a model comparison like backtest as in
 Fissler et al. (2015).

More reacently, a 
quantile regression based approach has been suggested by Coupier, 
Leymarie (2020). I have not yet read said paper and therefore I can not 
tell you anything about it.

I hope that this message gives you some new insights and some usefull
information.

Best regards,
Pit




Research Associate
Martin-Luther-Universit?t Halle-Wittenberg
Chair of Finance & Banking
 
Gro?e Steinstra?e 73 | D-06108 Halle | Germany
Tel 0049 345 5523452

 
>>> Daniel Cegie?ka <daniel.cegielka at gmail.com> 10.06.20 21.49 Uhr >>>
?r., 10 cze 2020 o 21:14 alexios galanos <alexios at 4dscape.com>
napisa?(a):
>
>
>
> On 6/10/20 11:08 AM, Daniel Cegie?ka wrote:
> > ?r., 10 cze 2020 o 19:23 Brian G. Peterson <brian at braverock.com>
napisa?(a):
> >>
> >> On Wed, 2020-06-10 at 15:08 +0530, Christofer Bogaso wrote:
> >>> I was looking for an idea how banks backtest their models for
> >>> Expected
> >>> Shortfall. Backtesting VaR is well documented but I failed to get
any
> >>> practical idea about backtesting ES.
> >>>
> >>> Any pointer towards the best practice will be really helpful.
> >>
> >> If you are using Normal VaR, then you know the Expected Shortfall
> >> estimate too.
> >>
> >> If you are using a different mechanism, then of course the mean
loss
> >> when the loss exceeds the VaR may be significantly different than
the
> >> Normal ES.
> >>
> >> So, to backetesting...  the newest Basel standard replaces VaR with
ES,
> >> and requires that banks justify their use of a particular ES model
that
> >> they are using to calculate required regulatory capital.
> >
> > In my opinion, there is one aspect that introduces some confusion.
ES
> > (CVaR) is now common, but many people, perhaps out of habit, maybe
for
> > historical reasons, still use the term VaR instead of the correct
name
> > (ES).
>
> Not sure I follow. VaR and ES are different measures. VaR is a
> quantile while ES is the average loss conditional on that quantile
> (i.e. the expected loss conditional that the loss is greater than
> the quantile of the loss distribution).

I agree that these names should not be confused. However, I
encountered that the _name_ "VaR" is used for ES. In my opinion, this
is due to a mental shortcut, or it's a historical > Alexios
>
> >
> > Best regards,
> > Daniel
> >
> >
> >> Regards,
> >>
> >> Brian
> >>
> >>
> >> --
> >> Brian G. Peterson
> >> ph: +1.773.459.4973
> >> im: bgpbraverock
> >>
> >> _______________________________________________
> >> R-SIG-Finance at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> -- Subscriber-posting only. If you want to post, subscribe first.
> >> -- Also note that this is not the r-help list where general R
questions should go.
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R
questions should go.
> >

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20200615/c247ef71/attachment.html>

From @|ex|o@ @end|ng |rom 4d@c@pe@com  Mon Jun 15 17:00:47 2020
From: @|ex|o@ @end|ng |rom 4d@c@pe@com (alexios galanos)
Date: Mon, 15 Jun 2020 08:00:47 -0700
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <5EE786FE020000F800113B85@gwia0.itz.uni-halle.de>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
 <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
 <27691ebc-19ac-3be0-85a0-43055bef7d33@4dscape.com>
 <CAPLrYET4B4KFcZ9WEvhtM1=nGSoeBAs4Q3xnudSSBS19efeTBA@mail.gmail.com>
 <5EE786FE020000F800113B85@gwia0.itz.uni-halle.de>
Message-ID: <01f84599-cd26-b538-3ea8-a03934db9500@4dscape.com>

Hi Pit and thanks for sharing.

I was not aware of the Gneiting paper, but the Gneiting and Raftery 
(2007) paper discusses scoring rules and their mean interval score (MIS) 
has been used in the M4 competition (implemented in the greybox package).

Best,

Alexios

On 6/15/20 7:34 AM, Pit G?tz wrote:
> Hello everyone,
> 
> I work at a university in germany and we are also currently working on 
> forecasting ES and (of course) backtesting of said forecasts.
> 
> Over the last few months some students, who are writing their masters 
> thesis at our chair, had to some litarature research.
> Thats why I wanted to give you a very brief overview of their findings:
> 
> The most widely applied ES backtests seems to be the backtest by McNeil, 
> Frey and Embrechts (2000), implemented for example in the rugarch package.
> (the test was already mentioned here by Alexios)
> 
> In addition to the already mentioned tests and the paper by Acerby and 
> Szekely I wanted to add the following:
> 
> A Hitsequence based backtest was introduced for by Du, Escanciano 
> (2017). As far as I am concerned, this test has not yet been implemented 
> in a package, but their code is available online. In a broader view, 
> this test is a special case of a spectral measure test by Costanzino, 
> Curran (2014), which was then extended to a Basel-Like traffic light 
> approach in 2018 (Not sure about the availability of code).
> 
> In Emmer et al. (2015) it is suggested, that a suitable ES forecast can 
> be approximated by only 4 different VaR forecasts. This also suggests, 
> that you can backtest ES, forecasted by a model that forecasts both, ES 
> and VaR, such as GARCH, by backtesting th 4 different VaR forecasts.
> However this approach seems to need more empirical valuation.
> 
> I also wanted to mention the paper by Gneiting (2011), showing that the 
> ES lacks elicitability property. This can lead to complications, when 
> you try to backtest the ES itself as a point forecast.However, this 
> property can be used to construct a model comparison like backtest as in 
> Fissler et al. (2015).
> 
> More reacently, a quantile regression based approach has been suggested 
> by Coupier, Leymarie (2020). I have not yet read said paper and 
> therefore I can not tell you anything about it.
> 
> I hope that this message gives you some new insights and some usefull 
> information.
> 
> Best regards,
> Pit
> 
> 
> 
> Research Associate
> 
> *Martin-Luther-Universit?t Halle-Wittenberg*
> 
> Chair of Finance & Banking
> 
> Gro?e Steinstra?e 73 | D-06108 Halle | Germany
> Tel 0049?345 5523452
> 
> 
>>>> Daniel?Cegie?ka?<daniel.cegielka at gmail.com> 10.06.20 21.49 Uhr >>>
> ?r., 10 cze 2020 o 21:14 alexios galanos <alexios at 4dscape.com> napisa?(a):
>  >
>  >
>  >
>  > On 6/10/20 11:08 AM, Daniel Cegie?ka wrote:
>  > > ?r., 10 cze 2020 o 19:23 Brian G. Peterson <brian at braverock.com> 
> napisa?(a):
>  > >>
>  > >> On Wed, 2020-06-10 at 15:08 +0530, Christofer Bogaso wrote:
>  > >>> I was looking for an idea how banks backtest their models for
>  > >>> Expected
>  > >>> Shortfall. Backtesting VaR is well documented but I failed to get any
>  > >>> practical idea about backtesting ES.
>  > >>>
>  > >>> Any pointer towards the best practice will be really helpful.
>  > >>
>  > >> If you are using Normal VaR, then you know the Expected Shortfall
>  > >> estimate too.
>  > >>
>  > >> If you are using a different mechanism, then of course the mean loss
>  > >> when the loss exceeds the VaR may be significantly different than the
>  > >> Normal ES.
>  > >>
>  > >> So, to backetesting... the newest Basel standard replaces VaR with ES,
>  > >> and requires that banks justify their use of a particular ES model 
> that
>  > >> they are using to calculate required regulatory capital.
>  > >
>  > > In my opinion, there is one aspect that introduces some confusion. ES
>  > > (CVaR) is now common, but many people, perhaps out of habit, maybe for
>  > > historical reasons, still use the term VaR instead of the correct name
>  > > (ES).
>  >
>  > Not sure I follow. VaR and ES are different measures. VaR is a
>  > quantile while ES is the average loss conditional on that quantile
>  > (i.e. the expected loss conditional that the loss is greater than
>  > the quantile of the loss distribution).
> 
> I agree that these names should not be confused. However, I
> encountered that the _name_ "VaR" is used for ES. In my opinion, this
> is due to a mental shortcut, or it's a historical habit. Such
> imprecise use of the names often leads to misunderstanding.
> 
> Daniel
> 
>  > Regards,
>  >
>  > Alexios
>  >
>  > >
>  > > Best regards,
>  > > Daniel
>  > >
>  > >
>  > >> Regards,
>  > >>
>  > >> Brian
>  > >>
>  > >>
>  > >> --
>  > >> Brian G. Peterson
>  > >> ph: +1.773.459.4973
>  > >> im: bgpbraverock
>  > >>
>  > >> _______________________________________________
>  > >> R-SIG-Finance at r-project.org mailing list
>  > >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>  > >> -- Subscriber-posting only. If you want to post, subscribe first.
>  > >> -- Also note that this is not the r-help list where general R 
> questions should go.
>  > >
>  > > _______________________________________________
>  > > R-SIG-Finance at r-project.org mailing list
>  > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>  > > -- Subscriber-posting only. If you want to post, subscribe first.
>  > > -- Also note that this is not the r-help list where general R 
> questions should go.
>  > >
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions 
> should go.


From em@nue|e@cecere @end|ng |rom |nchc@p|t@|@com  Tue Jun 16 11:20:54 2020
From: em@nue|e@cecere @end|ng |rom |nchc@p|t@|@com (=?UTF-8?Q?Emanuele_Cecere?=)
Date: Tue, 16 Jun 2020 09:20:54 +0000
Subject: [R-SIG-Finance] Hi everyone C# - R - and igraph library
References: <mail.5ee88ef5.12ba.77460c494d997a43@storage.wm.amazon.com>
Message-ID: <01020172bc6e71de-21984cc6-6e49-4be0-86e1-bdda8f3780cb-000000@eu-west-1.amazonses.com>

Hi everyone
we have a problem with igraph library
?we have forced to use R 3.4.4.?because the state of the art is in C# and we use?R.NET?that takes to interface C# with R but only with 3.4.4 ver. If you know another way to interface C# with the latest R ver please let us?know.?We still have to install 5 libraries of which the first is igraph
?this following is what I managed to install into Windows Server 2012
?1) I installed?R version?3.4.4 (I am forced to use this this ver.)
2) I installed?RTools 3.4
3) I installed?PanDoc 2.9
4) I opened librery?local323.zip into the RTools into one folder?local323, (but not installed as I don't know in wiche way to configure it)
5) I opended librery?winglpk-4.65.zip into the directory RTools and into one folder?glpk-4.65 (the same above)
6) I changed Makeconf file into the directory C:\Program Files\R\R-3.4.4\etc\i386 and?C:\Program Files\R\R-3.4.4\etc\x64 as follows:
?LOCAL_SOFT = C:/Rtools/local323

ifneq ($(strip $(LOCAL_SOFT)),)
LOCAL_CPPFLAGS = -I"$(LOCAL_SOFT)/include/libxml2" -I"C:/Rtools/glpk-4.65/src"
LOCAL_LIBS = -L"$(LOCAL_SOFT)/lib$(R_ARCH)" -L"$(LOCAL_SOFT)/lib" -L"C:/Rtools/glpk-4.65/w32"
endif
?and
?LOCAL_SOFT = C:/Rtools/local323

ifneq ($(strip $(LOCAL_SOFT)),)
LOCAL_CPPFLAGS = -I"$(LOCAL_SOFT)/include/libxml2" -I"C:/Rtools/glpk-4.65/src"
LOCAL_LIBS = -L"$(LOCAL_SOFT)/lib$(R_ARCH)" -L"$(LOCAL_SOFT)/lib" -L"C:/Rtools/glpk-4.65/w64"
endif
?7) I was able to install all the libreries listed below
?askpass_1.1.zip
assertthat_0.2.1.zip
backports_1.1.4.zip
base64enc_0.1-3.zip
BH_1.69.0-1.zip
brew_1.0-6.zip
broom_0.5.2.zip
callr_3.2.0.zip
cellranger_1.1.0.zip
clipr_0.7.0.zip
clisymbols_1.2.0.zip
cli_1.1.0.zip
colorspace_1.4-1.zip
commonmark_1.7.zip
covr_3.2.1.zip
crayon_1.3.4.zip
crosstalk_1.0.0.zip
curl_3.3.zip
data.table_1.12.2.zip
desc_1.2.0.zip
digest_0.6.18.zip
DistributionUtils_0.6-0.zip
dplyr_0.8.0.1.zip
ellipsis_0.1.0.zip
evaluate_0.14.zip
fansi_0.4.0.zip
farver_1.1.0.zip
fs_1.2.7.zip
GeneralizedHyperbolic_0.8-4.zip
generics_0.0.2.zip
ggplot2_3.2.1.zip
gh_1.0.1.zip
git2r_0.25.2.zip
glue_1.3.1.zip
gtable_0.3.0.zip
hexbin_1.27.2.zip
highr_0.8.zip
hms_0.4.2.zip
htmltools_0.3.6.zip
htmlwidgets_1.5.1.zip
httpuv_1.5.1.zip
httr_1.4.1.zip
ini_0.3.1.zip
installr_0.22.0.zip
jsonlite_1.6.zip
knitr_1.26.zip
labeling_0.3.zip
later_0.8.0.zip
lazyeval_0.2.2.zip
lubridate_1.7.4.zip
magrittr_1.5.zip
markdown_0.9.zip
memoise_1.1.0.zip
mime_0.6.zip
munsell_0.5.0.zip
openssl_1.3.zip
openxlsx_4.1.0.zip
output.txt
PerformanceAnalytics_1.5.2.zip
pillar_1.4.2.zip
pkgbuild_1.0.3.zip
pkgconfig_2.0.3.zip
pkgload_1.0.2.zip
plogr_0.2.0.zip
plyr_1.8.4.zip
praise_1.0.0.zip
prettyunits_1.0.2.zip
processx_3.3.0.zip
progress_1.2.1.zip
promises_1.0.1.zip
ps_1.3.0.zip
purrr_0.3.2.zip
quadprog_1.5-5.zip
quantmod_0.4-15.zip
R6_2.4.1.zip
RColorBrewer_1.1-2.zip
Rcpp_1.0.1.zip
readr_1.3.1.zip
readxl_1.3.1.zip
rematch_1.0.1.zip
remotes_2.1.0.zip
reshape2_1.4.3.zip
rex_1.1.2.zip
rlang_0.3.4.zip
rlist_0.4.6.1.zip
rmarkdown_1.18.zip
roxygen2_6.1.1.zip
rprojroot_1.3-2.zip
rstudioapi_0.10.zip
rversions_2.0.1.zip
rvest_0.3.5.zip
scales_1.0.0.zip
selectr_0.4-2.zip
sessioninfo_1.1.1.zip
shiny_1.3.2.zip
sourcetools_0.1.7.zip
stringi_1.4.3.zip
stringr_1.4.0.zip
sys_3.2.zip
testthat_2.1.1.zip
tibble_2.1.1.zip
tidyr_0.8.3.zip
tidyselect_0.2.5.zip
timeDate_3043.102.zip
timeSeries_3042.102.zip
tinytex_0.17.zip
TTR_0.23-4.zip
utf8_1.1.4.zip
VarianceGamma_0.4-0.zip
vctrs_0.1.0.zip
viridisLite_0.3.0.zip
whisker_0.4.zip
withr_2.1.2.zip
xfun_0.11.zip
xml2_1.2.0.zip
XML_3.98-1.19.zip
xopen_1.0.0.zip
xtable_1.8-4.zip
xts_0.11-2.zip
yaml_2.2.0.zip
zeallot_0.1.0.zip
zip_2.0.1.zip
zoo_1.8-5.zip
?8) I stopped myself during installation of the libreries igraph 1.2.4.1. I listed below the libreries that I have to install, the command that I use to install and the error that?igraph returns me?l'errore
?"base", "3.4.4", ""
"boot", "1.3-20", ""
"class", "7.3-14", ""
"cluster", "2.0.6", ""
"codetools", "0.2-15", ""
"compiler", "3.4.4", ""
"datasets", "3.4.4", ""
"foreign", "0.8-69", ""
"graphics", "3.4.4", ""
"grDevices", "3.4.4", ""
"grid", "3.4.4", ""
"KernSmooth", "2.23-15", ""
"lattice", "0.20-35", ""
"MASS", "7.3-49", ""
"Matrix", "1.2-12", ""
"methods", "3.4.4", ""
"mgcv", "1.8-23", ""
"nlme", "3.1-131.1", ""
"nnet", "7.3-12", ""
"parallel", "3.4.4", ""
"rpart", "4.1-13", ""
"spatial", "7.3-11", ""
"splines", "3.4.4", ""
"stats", "3.4.4", ""
"stats4", "3.4.4", ""
"survival", "2.41-3", ""
"tcltk", "3.4.4", ""
"tools", "3.4.4", ""
"translations", "3.4.4", ""
"utils", "3.4.4", ""
"askpass", "1.1", "sys (>= 2.1)"
"assertthat", "0.2.1", "tools"
"backports", "1.1.4", "utils"
"base64enc", "0.1-3", ""
"BH", "1.69.0-1", ""
"brew", "1.0-6", ""
"broom", "0.5.2", "backports, dplyr, generics (>= 0.0.2), methods, nlme, purrr, reshape2, stringr, tibble, tidyr"
"callr", "3.2.0", "processx"
"cellranger", "1.1.0", "rematch, tibble"
"cli", "1.1.0", "assertthat, crayon (>= 1.3.4), methods, utils"
"clipr", "0.7.0", "utils"
"clisymbols", "1.2.0", ""
"colorspace", "1.4-1", "graphics, grDevices, stats"
"commonmark", "1.7", ""
"covr", "3.2.1", "digest, stats, utils, jsonlite, rex, httr, crayon, withr (>=1.0.2)"
"crayon", "1.3.4", "grDevices, methods, utils"
"crosstalk", "1.0.0", "htmltools (>= 0.3.5), jsonlite, lazyeval, R6, shiny (>= 0.11),ggplot2"
"curl", "3.3", ""
"data.table", "1.12.2", "methods"
"desc", "1.2.0", "assertthat, utils, R6, crayon, rprojroot"
"digest", "0.6.18", ""
"DistributionUtils", "0.6-0", ""
"dplyr", "0.8.0.1", "assertthat (>= 0.2.0), glue (>= 1.1.1), magrittr (>= 1.5),methods, pkgconfig (>= 2.0.1), R6 (>= 2.2.2), Rcpp (>= 1.0.0),rlang (>= 0.3.0), tibble (>= 2.0.0), tidyselect (>= 0.2.5),utils"
"ellipsis", "0.1.0", ""
"evaluate", "0.14", "methods"
"fansi", "0.4.0", ""
"farver", "1.1.0", "Rcpp (>= 0.12.15)"
"fs", "1.2.7", "methods, Rcpp"
"GeneralizedHyperbolic", "0.8-4", "DistributionUtils, MASS"
"generics", "0.0.2", "methods"
"ggplot2", "3.2.1", "digest, grDevices, grid, gtable (>= 0.1.1), lazyeval, MASS,mgcv, reshape2, rlang (>= 0.3.0), scales (>= 0.5.0), stats,tibble, viridisLite, withr (>= 2.0.0)"
"gh", "1.0.1", "ini, jsonlite, httr"
"git2r", "0.25.2", "graphics, utils"
"glue", "1.3.1", "methods"
"gtable", "0.3.0", "grid"
"hexbin", "1.27.2", "lattice, grid, graphics, grDevices, stats, utils"
"highcharter", "0.7.0", "htmlwidgets, magrittr, purrr, rlist, assertthat, zoo, dplyr(>= 0.7.0), tibble (>= 1.1), stringr, broom, xts, quantmod,tidyr, htmltools, jsonlite, igraph, lubridate, crosstalk, yaml,rlang(>= 0.1.1), whisker"
"highr", "0.8", ""
"hms", "0.4.2", ""
"htmltools", "0.3.6", "utils, digest, Rcpp"
"htmlwidgets", "1.5.1", "grDevices, htmltools (>= 0.3), jsonlite (>= 0.9.16), yaml"
"httpuv", "1.5.1", "Rcpp (>= 0.11.0), utils, R6, promises, later (>= 0.8.0)"
"httr", "1.4.1", "curl (>= 3.0.0), jsonlite, mime, openssl (>= 0.8), R6"
"igraph", "1.2.4.1", "graphics, grDevices, magrittr, Matrix, pkgconfig (>= 2.0.0),stats, utils"
"ini", "0.3.1", ""
"installr", "0.22.0", "stringr"
"jsonlite", "1.6", ""
"kableExtra", "1.1.0", "knitr (>= 1.16), magrittr, stringr (>= 1.0), xml2 (>= 1.1.1),rvest, rmarkdown (>= 1.6.0), readr, scales, viridisLite, stats,grDevices, htmltools, rstudioapi, glue, tools, webshot, digest"
"knitr", "1.26", "evaluate (>= 0.10), highr, markdown, stringr (>= 0.6), yaml(>= 2.1.19), methods, xfun, tools"
"labeling", "0.3", ""
"later", "0.8.0", "Rcpp (>= 0.12.9), rlang"
"lazyeval", "0.2.2", ""
"lubridate", "1.7.4", "stringr, Rcpp (>= 0.12.13),"
"magrittr", "1.5", ""
"markdown", "0.9", "utils, mime (>= 0.3)"
"memoise", "1.1.0", "digest (>= 0.6.3)"
"mime", "0.6", "tools"
"munsell", "0.5.0", "colorspace, methods"
"openssl", "1.3", "askpass"
"openxlsx", "4.1.0", "methods, Rcpp, grDevices, stats, utils, zip"
"PerformanceAnalytics", "1.5.2", "methods, quadprog, zoo"
"pillar", "1.4.2", "cli, crayon (>= 1.3.4), fansi, rlang (>= 0.3.0), utf8 (>=1.1.0), vctrs"
"pkgbuild", "1.0.3", "callr"
"pkgconfig", "2.0.3", "utils"
"pkgload", "1.0.2", "desc, methods, pkgbuild, rlang, rprojroot, rstudioapi, utils,withr, pkgbuild"
"plogr", "0.2.0", ""
"plotly", "4.9.1", "tools, scales, httr, jsonlite (>= 1.6), magrittr, digest,viridisLite, base64enc, htmltools (>= 0.3.6), htmlwidgets (>=1.3), tidyr, hexbin, RColorBrewer, dplyr, tibble, lazyeval (>=0.2.0), rlang, crosstalk, purrr, data.table, promises"
"plyr", "1.8.4", "Rcpp (>= 0.11.0)"
"praise", "1.0.0", ""
"prettyunits", "1.0.2", "magrittr, assertthat, methods"
"processx", "3.3.0", "ps (>= 1.2.0), R6, utils"
"progress", "1.2.1", ""
"promises", "1.0.1", "R6, Rcpp, later, rlang, stats, magrittr"
"ps", "1.3.0", "utils"
"purrr", "0.3.2", "magrittr (>= 1.5), rlang (>= 0.3.1)"
"quadprog", "1.5-5", ""
"quantmod", "0.4-15", "curl,xts,zoo,TTR"
"R6", "2.4.1", ""
"RColorBrewer", "1.1-2", ""
"Rcpp", "1.0.1", "methods, utils"
"readr", "1.3.1", "Rcpp (>= 0.12.0.5), tibble, hms (>= 0.4.1), R6, clipr, crayon,methods"
"readxl", "1.3.1", "cellranger, Rcpp (>= 0.12.18), tibble (>= 1.3.1), utils, progress"
"rematch", "1.0.1", ""
"remotes", "2.1.0", "methods, stats, tools, utils"
"reshape2", "1.4.3", "plyr (>= 1.8.1), Rcpp, stringr"
"rex", "1.1.2", "magrittr, lazyeval"
"rlang", "0.3.4", ""
"rlist", "0.4.6.1", "yaml, jsonlite, XML, data.table"
"rmarkdown", "1.18", "tools, utils, knitr (>= 1.22), yaml (>= 2.1.19), htmltools (>=0.3.5), evaluate (>= 0.13), base64enc, jsonlite, mime, tinytex(>= 0.11), xfun, methods, stringr (>= 1.2.0)"
"roxygen2", "6.1.1", "brew, commonmark, desc (>= 1.2.0), digest, methods, pkgload(>= 1.0.2), purrr, R6 (>= 2.1.2), Rcpp (>= 0.11.0), stringi,stringr (>= 1.0.0), utils, xml2"
"rprojroot", "1.3-2", "backports"
"rstudioapi", "0.10", ""
"rversions", "2.0.1", "curl, utils, xml2 (>= 1.0.0)"
"rvest", "0.3.5", "httr (>= 0.5), magrittr, selectr"
"scales", "1.0.0", "labeling, munsell (>= 0.5), R6, RColorBrewer, Rcpp, viridisLite"
"selectr", "0.4-2", "methods, stringr, R6"
"sessioninfo", "1.1.1", "cli, tools, utils, withr"
"shiny", "1.3.2", ""
"sourcetools", "0.1.7", ""
"stringi", "1.4.3", "tools, utils, stats"
"stringr", "1.4.0", "glue (>= 1.2.0), magrittr, stringi (>= 1.1.7)"
"sys", "3.2", ""
"testthat", "2.1.1", "cli, crayon (>= 1.3.4), digest, magrittr, methods, praise, R6(>= 2.2.0), rlang (>= 0.3.0), withr (>= 2.0.0)"
"tibble", "2.1.1", "cli (>= 1.0.1), crayon (>= 1.3.4), fansi (>= 0.4.0), methods,pillar (>= 1.3.1), pkgconfig (>= 2.0.2), rlang (>= 0.3.1),utils"
"tidyr", "0.8.3", "dplyr (>= 0.7.0), glue, magrittr, purrr, Rcpp, rlang, stringi,tibble, tidyselect (>= 0.2.5), utils"
"tidyselect", "0.2.5", "glue (>= 1.3.0), purrr, rlang (>= 0.2.2), Rcpp (>= 0.12.0)"
"timeDate", "3043102", ""
"timeSeries", "3042102", ""
"tinytex", "0.17", "xfun (>= 0.5)"
"TTR", "0.23-4", "xts (>= 0.10-0), zoo, curl"
"utf8", "1.1.4", ""
"VarianceGamma", "0.4-0", "grDevices, graphics, stats, DistributionUtils,GeneralizedHyperbolic"
"vctrs", "0.1.0", "backports, digest, glue, rlang, zeallot"
"viridisLite", "0.3.0", ""
"whisker", "0.4", ""
"withr", "2.1.2", "stats, graphics, grDevices"
"xfun", "0.11", "stats, tools"
"XML", "3.98-1.19", ""
"xml2", "1.2.0", "Rcpp"
"xopen", "1.0.0", "processx"
"xtable", "1.8-4", "stats, utils"
"xts", "0.11-2", "methods"
"yaml", "2.2.0", ""
"zeallot", "0.1.0", ""
"zip", "2.0.1", ""
"zoo", "1.8-5", "utils, graphics, grDevices, lattice (>= 0.20-27)"

Command

"C:\Program Files\R\R-3.4.4\bin\R.exe" CMD INSTALL --build --compile-both "C:\Projects\Source\PortfolioEL\R\resource\library_download\igraph_1.2.4.1.tar.gz"
?the error highlights the following sequence

c:/Rtools/mingw_32/bin/g++? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"???? -O2 -Wall? -mtune=generic -c simpleraytracer/T
riangle.cpp -o simpleraytracer/Triangle.o
c:/Rtools/mingw_32/bin/g++? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"???? -O2 -Wall? -mtune=generic -c simpleraytracer/u
nit_limiter.cpp -o simpleraytracer/unit_limiter.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/R.c -o uuid/R.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/clear.c -o uuid/clear.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/compare.c -o uuid/compare.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/copy.c -o uuid/copy.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/gen_uuid.c -o uuid/gen_uuid.o
uuid/gen_uuid.c: In function 'get_clock':
uuid/gen_uuid.c:433:3: warning: implicit declaration of function 'ftruncate' [-W
implicit-function-declaration]
?? if (ftruncate(state_fd, len) < 0) {
?? ^
uuid/gen_uuid.c: At top level:
uuid/gen_uuid.c:134:12: warning: 'getuid' defined but not used [-Wunused-functio
n]
?static int getuid (void)
??????????? ^
uuid/gen_uuid.c:317:12: warning: 'flock' defined but not used [-Wunused-function
]
?static int flock(int fd, int op)
??????????? ^
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/isnull.c -o uuid/isnull.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/pack.c -o uuid/pack.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/parse.c -o uuid/parse.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/unpack.c -o uuid/unpack.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c uuid/unparse.c -o uuid/unparse.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c rinterface.c -o rinterface.o
rinterface.c: In function 'R_igraph_status_handler':
rinterface.c:2321:7: warning: variable 'ecint' set but not used [-Wunused-but-se
t-variable]
?? int ecint;
?????? ^
rinterface.c: In function 'R_igraph_is_chordal':
rinterface.c:7828:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_igraph_cohesive_blocks':
rinterface.c:8154:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_igraph_community_leading_eigenvector':
rinterface.c:8293:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_igraph_scg_semiprojectors':
rinterface.c:8423:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_igraph_laplacian':
rinterface.c:8493:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_igraph_scg_adjacency':
rinterface.c:8567:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_igraph_scg_stochastic':
rinterface.c:8769:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_igraph_scg_laplacian':
rinterface.c:8971:7: warning: variable 'c_result' set but not used [-Wunused-but
-set-variable]
?? int c_result;
?????? ^
rinterface.c: In function 'R_SEXP_to_attr_comb':
rinterface.c:177:35: warning: 'n' may be used uninitialized in this function [-W
maybe-uninitialized]
???? if (isNull(names) || strlen(n)==0) {
?????????????????????????????????? ^
rinterface.c: In function 'R_igraph_get_shortest_paths':
rinterface.c:4512:28: warning: 'evects' may be used uninitialized in this functi
on [-Wmaybe-uninitialized]
?? igraph_vector_t *vects, *evects;
??????????????????????????? ^
rinterface.c:4512:20: warning: 'vects' may be used uninitialized in this functio
n [-Wmaybe-uninitialized]
?? igraph_vector_t *vects, *evects;
??????????????????? ^
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c rinterface_extra.c -o rinterface_extra
.o
c:/Rtools/mingw_32/bin/gcc? -I"C:/PROGRA~1/R/R-34~1.4/include" -DNDEBUG -I/inclu
de/libxml2 -I/include -DLIBXML_STATIC -DUSING_R -DHAVE_FMEMOPEN=0 -DHAVE_OPEN_ME
MSTREAM=0 -DHAVE_RINTF -DWin32 -DHAVE_LIBXML -Wall -DPACKAGE_VERSION=\"1.2.4\" -
DHAVE_FMIN=1 -DHAVE_LOG2=1 -DHAVE_SNPRINTF -Ics -I/include -DHAVE_GLPK=1 -Iplfit
?-Iprpack -DIGRAPH_THREAD_LOCAL= -DPRPACK_IGRAPH_SUPPORT -I. -Iinclude -ICHOLMOD
/Include -IAMD/Include -ICOLAMD/Include -ISuiteSparse_config -DNDEBUG -DNPARTITI
ON -DNTIMER -DNCAMD -DNPRINT -I/include??? -I"C:/Rtools/local323/include/libxml2
" -I"C:/Rtools/glpk-4.65/src"? -DINTERNAL_ARPACK -I. -I/include -DHAVE_GFORTRAN
? -O3 -Wall? -std=gnu99 -mtune=generic -c lazyeval.c -o lazyeval.o
c:/Rtools/mingw_32/bin/g++ -shared -s -static-libgcc -o igraph.dll tmp.def AMD/S
ource/amd.o AMD/Source/amd_1.o AMD/Source/amd_2.o AMD/Source/amd_aat.o AMD/Sourc
e/amd_control.o AMD/Source/amd_defaults.o AMD/Source/amd_dump.o AMD/Source/amd_g
lobal.o AMD/Source/amd_info.o AMD/Source/amd_order.o AMD/Source/amd_post_tree.o
AMD/Source/amd_postorder.o AMD/Source/amd_preprocess.o AMD/Source/amd_valid.o AM
D/Source/amdbar.o CHOLMOD/Check/cholmod_check.o CHOLMOD/Check/cholmod_read.o CHO
LMOD/Check/cholmod_write.o CHOLMOD/Cholesky/cholmod_amd.o CHOLMOD/Cholesky/cholm
od_analyze.o CHOLMOD/Cholesky/cholmod_colamd.o CHOLMOD/Cholesky/cholmod_etree.o
CHOLMOD/Cholesky/cholmod_factorize.o CHOLMOD/Cholesky/cholmod_postorder.o CHOLMO
D/Cholesky/cholmod_rcond.o CHOLMOD/Cholesky/cholmod_resymbol.o CHOLMOD/Cholesky/
cholmod_rowcolcounts.o CHOLMOD/Cholesky/cholmod_rowfac.o CHOLMOD/Cholesky/cholmo
d_solve.o CHOLMOD/Cholesky/cholmod_spsolve.o CHOLMOD/Core/cholmod_aat.o CHOLMOD/
Core/cholmod_add.o CHOLMOD/Core/cholmod_band.o CHOLMOD/Core/cholmod_change_facto
r.o CHOLMOD/Core/cholmod_common.o CHOLMOD/Core/cholmod_complex.o CHOLMOD/Core/ch
olmod_copy.o CHOLMOD/Core/cholmod_dense.o CHOLMOD/Core/cholmod_error.o CHOLMOD/C
ore/cholmod_factor.o CHOLMOD/Core/cholmod_memory.o CHOLMOD/Core/cholmod_sparse.o
?CHOLMOD/Core/cholmod_transpose.o CHOLMOD/Core/cholmod_triplet.o CHOLMOD/Core/ch
olmod_version.o CHOLMOD/MatrixOps/cholmod_drop.o CHOLMOD/MatrixOps/cholmod_horzc
at.o CHOLMOD/MatrixOps/cholmod_norm.o CHOLMOD/MatrixOps/cholmod_scale.o CHOLMOD/
MatrixOps/cholmod_sdmult.o CHOLMOD/MatrixOps/cholmod_ssmult.o CHOLMOD/MatrixOps/
cholmod_submatrix.o CHOLMOD/MatrixOps/cholmod_symmetry.o CHOLMOD/MatrixOps/cholm
od_vertcat.o CHOLMOD/Modify/cholmod_rowadd.o CHOLMOD/Modify/cholmod_rowdel.o CHO
LMOD/Modify/cholmod_updown.o CHOLMOD/Partition/cholmod_camd.o CHOLMOD/Partition/
cholmod_ccolamd.o CHOLMOD/Partition/cholmod_csymamd.o CHOLMOD/Partition/cholmod_
metis.o CHOLMOD/Partition/cholmod_nesdis.o CHOLMOD/Supernodal/cholmod_super_nume
ric.o CHOLMOD/Supernodal/cholmod_super_solve.o CHOLMOD/Supernodal/cholmod_super_
symbolic.o COLAMD/Source/colamd.o COLAMD/Source/colamd_global.o DensityGrid.o De
nsityGrid_3d.o NetDataTypes.o NetRoutines.o SuiteSparse_config/SuiteSparse_confi
g.o adjlist.o arpack.o array.o atlas.o attributes.o basic_query.o bfgs.o bigint.
o bignum.o bipartite.o blas.o bliss.o bliss/bliss_heap.o bliss/defs.o bliss/grap
h.o bliss/orbit.o bliss/partition.o bliss/uintseqhash.o bliss/utils.o cattribute
s.o centrality.o cliquer/cliquer.o cliquer/cliquer_graph.o cliquer/reorder.o cli
ques.o clustertool.o cocitation.o cohesive_blocks.o coloring.o community.o compl
ex.o components.o conversion.o cores.o cs/cs_add.o cs/cs_amd.o cs/cs_chol.o cs/c
s_cholsol.o cs/cs_compress.o cs/cs_counts.o cs/cs_cumsum.o cs/cs_dfs.o cs/cs_dmp
erm.o cs/cs_droptol.o cs/cs_dropzeros.o cs/cs_dupl.o cs/cs_entry.o cs/cs_ereach.
o cs/cs_etree.o cs/cs_fkeep.o cs/cs_gaxpy.o cs/cs_happly.o cs/cs_house.o cs/cs_i
pvec.o cs/cs_leaf.o cs/cs_load.o cs/cs_lsolve.o cs/cs_ltsolve.o cs/cs_lu.o cs/cs
_lusol.o cs/cs_malloc.o cs/cs_maxtrans.o cs/cs_multiply.o cs/cs_norm.o cs/cs_per
mute.o cs/cs_pinv.o cs/cs_post.o cs/cs_print.o cs/cs_pvec.o cs/cs_qr.o cs/cs_qrs
ol.o cs/cs_randperm.o cs/cs_reach.o cs/cs_scatter.o cs/cs_scc.o cs/cs_schol.o cs
/cs_spsolve.o cs/cs_sqr.o cs/cs_symperm.o cs/cs_tdfs.o cs/cs_transpose.o cs/cs_u
pdown.o cs/cs_usolve.o cs/cs_util.o cs/cs_utsolve.o decomposition.o distances.o
dotproduct.o dqueue.o drl_graph.o drl_graph_3d.o drl_layout.o drl_layout_3d.o dr
l_parse.o eigen.o embedding.o fast_community.o feedback_arc_set.o flow.o foreign
-dl-lexer.o foreign-dl-parser.o foreign-gml-lexer.o foreign-gml-parser.o foreign
-graphml.o foreign-lgl-lexer.o foreign-lgl-parser.o foreign-ncol-lexer.o foreign
-ncol-parser.o foreign-pajek-lexer.o foreign-pajek-parser.o foreign.o forestfire
.o fortran_intrinsics.o games.o gengraph_box_list.o gengraph_degree_sequence.o g
engraph_graph_molloy_hash.o gengraph_graph_molloy_optimized.o gengraph_mr-connec
ted.o gengraph_powerlaw.o gengraph_random.o glet.o glpk_support.o gml_tree.o hac
ks.o heap.o igraph_buckets.o igraph_cliquer.o igraph_error.o igraph_estack.o igr
aph_fixed_vectorlist.o igraph_grid.o igraph_hashtable.o igraph_heap.o igraph_hrg
.o igraph_hrg_types.o igraph_marked_queue.o igraph_psumtree.o igraph_set.o igrap
h_stack.o igraph_strvector.o igraph_trie.o infomap.o infomap_FlowGraph.o infomap
_Greedy.o infomap_Node.o interrupt.o iterators.o lad.o lapack.o layout.o layout_
dh.o layout_fr.o layout_gem.o layout_kk.o lsap.o matching.o math.o matrix.o maxi
mal_cliques.o memory.o microscopic_update.o mixing.o motifs.o operators.o optima
l_modularity.o other.o paths.o plfit/error.o plfit/gss.o plfit/kolmogorov.o plfi
t/lbfgs.o plfit/options.o plfit/plfit.o plfit/zeta.o pottsmodel_2.o progress.o p
rpack.o prpack/prpack_base_graph.o prpack/prpack_igraph_graph.o prpack/prpack_pr
eprocessed_ge_graph.o prpack/prpack_preprocessed_gs_graph.o prpack/prpack_prepro
cessed_scc_graph.o prpack/prpack_preprocessed_schur_graph.o prpack/prpack_result
.o prpack/prpack_solver.o prpack/prpack_utils.o qsort.o qsort_r.o random.o rando
m_walk.o sbm.o scan.o scg.o scg_approximate_methods.o scg_exact_scg.o scg_kmeans
.o scg_optimal_method.o scg_utils.o separators.o sir.o spanning_trees.o sparsema
t.o spectral_properties.o spmatrix.o st-cuts.o statusbar.o structural_properties
.o structure_generators.o sugiyama.o topology.o triangles.o type_indexededgelist
.o types.o vector.o vector_ptr.o version.o visitors.o walktrap.o walktrap_commun
ities.o walktrap_graph.o walktrap_heap.o zeroin.o dgetv0.o dlaqrb.o dmout.o dnai
tr.o dnapps.o dnaup2.o dnaupd.o dnconv.o dneigh.o dneupd.o dngets.o dsaitr.o dsa
pps.o dsaup2.o dsaupd.o dsconv.o dseigt.o dsesrt.o dseupd.o dsgets.o dsortc.o ds
ortr.o dstatn.o dstats.o dstqrb.o dvout.o ivout.o second.o simpleraytracer/Color
.o simpleraytracer/Light.o simpleraytracer/Point.o simpleraytracer/RIgraphRay.o
simpleraytracer/Ray.o simpleraytracer/RayTracer.o simpleraytracer/RayVector.o si
mpleraytracer/Shape.o simpleraytracer/Sphere.o simpleraytracer/Triangle.o simple
raytracer/unit_limiter.o uuid/R.o uuid/clear.o uuid/compare.o uuid/copy.o uuid/g
en_uuid.o uuid/isnull.o uuid/pack.o uuid/parse.o uuid/unpack.o uuid/unparse.o ri
nterface.o rinterface_extra.o lazyeval.o -L/lib -lxml2 -liconv -lz -lws2_32 -L/l
ib -lglpk -lgmp -L/lib -LC:/PROGRA~1/R/R-34~1.4/bin/i386 -lRblas -LC:/PROGRA~1/R
/R-34~1.4/bin/i386 -lRlapack -LC:/Rtools/local323/lib/i386 -LC:/Rtools/local323/
lib -LC:/Rtools/glpk-4.65/w32 -lgfortran -lm -lquadmath -LC:/PROGRA~1/R/R-34~1.4
/bin/i386 -lR
C:/Rtools/mingw_32/bin/../lib/gcc/i686-w64-mingw32/4.9.3/../../../../i686-w64-mi
ngw32/bin/ld.exe: cannot find -lglpk
collect2.exe: error: ld returned 1 exit status
no DLL was created
ERROR: compilation failed for package 'igraph'
* removing 'C:/Program Files/R/R-3.4.4/library/igraph'
?I hope it helps
?Thank you very much
?Emanuele

Emanuele Cecere - C.E.O.

emanuele.cecere at inchcapital.com

?
InchCapital s.r.l.

Via Cusago, 59 - 20153 Milano

Tel.: 02/49716863 - Mobile: 3282005906

?
?
?
Se non desidera ricevere i nostri approfondimenti, n? le e-mail sui contenuti relativi a The Inch Magazine www.inchcapital.com la invitiamo comunicarcelo stesso mezzo.
La nostra?Privacy Policy pubblicata sul sito www.inchcapital.com spiega le modalit? di elaborazione dei suoi dati personali e quali sono i suoi diritti in materia di riservatezza dei dati.

Importante avvertenza legale:?Il presente documento ha scopo puramente informativo e non rappresenta una sollecitazione all'acquisto o alla vendita di un titolo n? alla presentazione di un'offerta di acquisto o sottoscrizione. Fatta eccezione per i casi consentiti dalla legge in vigore sui diritti d?autore, ? fatto divieto di riprodurre, adattare, caricare su parti terze, collegare, inquadrare, pubblicare, distribuire o trasmettere queste informazioni in qualsiasi forma con qualsiasi processo senza lo specifico consenso scritto di InchCapital s.r.l. che non sar? resa responsabile in alcun modo per eventuali perdite o danni subiti in seguito all?utilizzo o all?accesso a queste informazioni.

?
?

	[[alternative HTML version deleted]]


From @eb@@t|@n@b@yer @end|ng |rom un|-kon@t@nz@de  Tue Jun 16 17:57:12 2020
From: @eb@@t|@n@b@yer @end|ng |rom un|-kon@t@nz@de (Sebastian Bayer)
Date: Tue, 16 Jun 2020 17:57:12 +0200
Subject: [R-SIG-Finance] Back testing Expected Shortfall
In-Reply-To: <01f84599-cd26-b538-3ea8-a03934db9500@4dscape.com>
References: <CA+dpOJkH=Hm+6=1z6S4nHGLTK9hJnz+7dfdn9zfAztZnBhN88Q@mail.gmail.com>
 <42e24c2182eb6f7ddc43f2c428b845ebed48d0ba.camel@braverock.com>
 <CAPLrYEQnWGedWAopXdnSKULEKVfUWpQGOhA_CNr0fRHdQF3CzQ@mail.gmail.com>
 <27691ebc-19ac-3be0-85a0-43055bef7d33@4dscape.com>
 <CAPLrYET4B4KFcZ9WEvhtM1=nGSoeBAs4Q3xnudSSBS19efeTBA@mail.gmail.com>
 <5EE786FE020000F800113B85@gwia0.itz.uni-halle.de>
 <01f84599-cd26-b538-3ea8-a03934db9500@4dscape.com>
Message-ID: <CA+akxBN-oiM7YOWhw-CHx3nRZdXgspug2Abwu+Zz6DADQ_L-Lg@mail.gmail.com>

Hi all,

We have been working on an ES backtest that only requires expected
shortfall forecasts (no quantiles or other inputs) besides the returns.
This is in striking contrast to all other available backtests.

The paper is going to be published in the next few days in JFEC. This is
the abstract:

This paper introduces novel backtests for the risk measure Expected
Shortfall (ES) following the testing idea
of Mincer and Zarnowitz (1969). Estimating a regression model for the ES
stand-alone is infeasible, and thus,
our tests are based on a joint regression model for the Value at Risk and
the ES, which allows for different
test specifications. These ES backtests are the first which solely backtest
the ES in the sense that they only
require ES forecasts as input variables. As the tests are potentially
subject to model misspecification, we
provide asymptotic theory under misspecification for the underlying joint
regression. We find that employing
a misspecification robust covariance estimator substantially improves the
tests? performance. We compare our
backtests to existing joint VaR and ES backtests and find that our tests
outperform the existing alternatives
throughout all considered simulations. In an empirical illustration, we
apply our backtests to ES forecasts for
200 stocks of the S&P 500 index.

You can find the last working paper version here:
https://arxiv.org/pdf/1801.04112.pdf
We also have an R package:
https://cran.r-project.org/web/packages/esback/index.html
Here's an example how to apply the backtest:
https://github.com/BayerSe/esback#examples

Regards

Am Mo., 15. Juni 2020 um 17:01 Uhr schrieb alexios galanos <
alexios at 4dscape.com>:

> Hi Pit and thanks for sharing.
>
> I was not aware of the Gneiting paper, but the Gneiting and Raftery
> (2007) paper discusses scoring rules and their mean interval score (MIS)
> has been used in the M4 competition (implemented in the greybox package).
>
> Best,
>
> Alexios
>
> On 6/15/20 7:34 AM, Pit G?tz wrote:
> > Hello everyone,
> >
> > I work at a university in germany and we are also currently working on
> > forecasting ES and (of course) backtesting of said forecasts.
> >
> > Over the last few months some students, who are writing their masters
> > thesis at our chair, had to some litarature research.
> > Thats why I wanted to give you a very brief overview of their findings:
> >
> > The most widely applied ES backtests seems to be the backtest by McNeil,
> > Frey and Embrechts (2000), implemented for example in the rugarch
> package.
> > (the test was already mentioned here by Alexios)
> >
> > In addition to the already mentioned tests and the paper by Acerby and
> > Szekely I wanted to add the following:
> >
> > A Hitsequence based backtest was introduced for by Du, Escanciano
> > (2017). As far as I am concerned, this test has not yet been implemented
> > in a package, but their code is available online. In a broader view,
> > this test is a special case of a spectral measure test by Costanzino,
> > Curran (2014), which was then extended to a Basel-Like traffic light
> > approach in 2018 (Not sure about the availability of code).
> >
> > In Emmer et al. (2015) it is suggested, that a suitable ES forecast can
> > be approximated by only 4 different VaR forecasts. This also suggests,
> > that you can backtest ES, forecasted by a model that forecasts both, ES
> > and VaR, such as GARCH, by backtesting th 4 different VaR forecasts.
> > However this approach seems to need more empirical valuation.
> >
> > I also wanted to mention the paper by Gneiting (2011), showing that the
> > ES lacks elicitability property. This can lead to complications, when
> > you try to backtest the ES itself as a point forecast.However, this
> > property can be used to construct a model comparison like backtest as in
> > Fissler et al. (2015).
> >
> > More reacently, a quantile regression based approach has been suggested
> > by Coupier, Leymarie (2020). I have not yet read said paper and
> > therefore I can not tell you anything about it.
> >
> > I hope that this message gives you some new insights and some usefull
> > information.
> >
> > Best regards,
> > Pit
> >
> >
> >
> > Research Associate
> >
> > *Martin-Luther-Universit?t Halle-Wittenberg*
> >
> > Chair of Finance & Banking
> >
> > Gro?e Steinstra?e 73 | D-06108 Halle | Germany
> > Tel 0049 345 5523452
> >
> >
> >>>> Daniel Cegie?ka <daniel.cegielka at gmail.com> 10.06.20 21.49 Uhr >>>
> > ?r., 10 cze 2020 o 21:14 alexios galanos <alexios at 4dscape.com>
> napisa?(a):
> >  >
> >  >
> >  >
> >  > On 6/10/20 11:08 AM, Daniel Cegie?ka wrote:
> >  > > ?r., 10 cze 2020 o 19:23 Brian G. Peterson <brian at braverock.com>
> > napisa?(a):
> >  > >>
> >  > >> On Wed, 2020-06-10 at 15:08 +0530, Christofer Bogaso wrote:
> >  > >>> I was looking for an idea how banks backtest their models for
> >  > >>> Expected
> >  > >>> Shortfall. Backtesting VaR is well documented but I failed to get
> any
> >  > >>> practical idea about backtesting ES.
> >  > >>>
> >  > >>> Any pointer towards the best practice will be really helpful.
> >  > >>
> >  > >> If you are using Normal VaR, then you know the Expected Shortfall
> >  > >> estimate too.
> >  > >>
> >  > >> If you are using a different mechanism, then of course the mean
> loss
> >  > >> when the loss exceeds the VaR may be significantly different than
> the
> >  > >> Normal ES.
> >  > >>
> >  > >> So, to backetesting... the newest Basel standard replaces VaR with
> ES,
> >  > >> and requires that banks justify their use of a particular ES model
> > that
> >  > >> they are using to calculate required regulatory capital.
> >  > >
> >  > > In my opinion, there is one aspect that introduces some confusion.
> ES
> >  > > (CVaR) is now common, but many people, perhaps out of habit, maybe
> for
> >  > > historical reasons, still use the term VaR instead of the correct
> name
> >  > > (ES).
> >  >
> >  > Not sure I follow. VaR and ES are different measures. VaR is a
> >  > quantile while ES is the average loss conditional on that quantile
> >  > (i.e. the expected loss conditional that the loss is greater than
> >  > the quantile of the loss distribution).
> >
> > I agree that these names should not be confused. However, I
> > encountered that the _name_ "VaR" is used for ES. In my opinion, this
> > is due to a mental shortcut, or it's a historical habit. Such
> > imprecise use of the names often leads to misunderstanding.
> >
> > Daniel
> >
> >  > Regards,
> >  >
> >  > Alexios
> >  >
> >  > >
> >  > > Best regards,
> >  > > Daniel
> >  > >
> >  > >
> >  > >> Regards,
> >  > >>
> >  > >> Brian
> >  > >>
> >  > >>
> >  > >> --
> >  > >> Brian G. Peterson
> >  > >> ph: +1.773.459.4973
> >  > >> im: bgpbraverock
> >  > >>
> >  > >> _______________________________________________
> >  > >> R-SIG-Finance at r-project.org mailing list
> >  > >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >  > >> -- Subscriber-posting only. If you want to post, subscribe first.
> >  > >> -- Also note that this is not the r-help list where general R
> > questions should go.
> >  > >
> >  > > _______________________________________________
> >  > > R-SIG-Finance at r-project.org mailing list
> >  > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >  > > -- Subscriber-posting only. If you want to post, subscribe first.
> >  > > -- Also note that this is not the r-help list where general R
> > questions should go.
> >  > >
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From cpkk @end|ng |rom @t-@ndrew@@@c@uk  Thu Jun 18 16:58:00 2020
From: cpkk @end|ng |rom @t-@ndrew@@@c@uk (Christopher Kromm)
Date: Thu, 18 Jun 2020 15:58:00 +0100
Subject: [R-SIG-Finance] Yahoo Finance Stock data (FTSEMIB.MI) Issue
Message-ID: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>

To whom it may concern,

I am interested in the FTSE MIB (or Milano Indice di Borsa) index. I am
trying to download the data up to the present date (18 June 2020). I am
using the get.hist.quote command in R from the tseries package.

I noticed the FTSE MIB  from yahoo has no pricing of any kind (open,
closed, adjusted, etc.) from 12 February 2018 to present. It appears from
the Yahoo site that the prices exist to the present day based on the
summary charts, but the other charts don't seem to show data. I am assuming
this stock is still used, which is why I am a bit confused by all the
missing data.

Is it possible to obtain this FTSE MIB data without all the missing data
from Yahoo Finance?

If this is possible, how?

If I cannot get the data from Yahoo Finance, are there alternative
suggested sources for an R user to get this data?

Thank you.

Here is the url and the Yahoo Finance data symbol.

https://finance.yahoo.com/quote/FTSEMIB.MI?p=FTSEMIB.MI

Symbol: FTSEMIB.MI

	[[alternative HTML version deleted]]


From d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com  Thu Jun 18 18:48:36 2020
From: d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com (=?utf-8?Q?Daniel_Cegie=C5=82ka?=)
Date: Thu, 18 Jun 2020 18:48:36 +0200
Subject: [R-SIG-Finance] Yahoo Finance Stock data (FTSEMIB.MI) Issue
In-Reply-To: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
References: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
Message-ID: <49FD5B6D-53C3-47EE-A013-7362D305700B@gmail.com>


I did it quickly, but you can write some script in R.

curl and json (5 years):

curl 'https://charts.borsaitaliana.it/charts/services/ChartWService.asmx/GetPrices' -H 'Connection: keep-alive' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'DNT: 1' -H 'X-Requested-With: XMLHttpRequest' -H 'Content-Type: application/json; charset=UTF-8' -H 'Origin: https://charts.borsaitaliana.it' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-Mode: cors' -H 'Referer: https://charts.borsaitaliana.it/charts/Bit/SummaryChart.aspx?code=CB.FTSEMIB&lang=en' -H 'Accept-Encoding: gzip, deflate, br' --data-binary '{"request":{"SampleTime":"1d","TimeFrame":"5y","RequestedDataSetType":"ohlc","ChartPriceType":"price","Key":"FTSEMIB.IDX","OffSet":0,"FromDate":null,"ToDate":null,"UseDelay":true,"KeyType":"Topic","KeyType2":"Topic","Language":"en-US"}}' --compressed > FTSEMIB.json


And try fromJSON() etc.

btw:

[1592352000000,19585.89,19625.63,19876.12,19487.39,19585.89]

1592352000000 <--- it looks like POSIX time in milliseconds :)

so you need an extra trick:

> x <- 1592352000000
> z <- x/1000
> z
[1] 1592352000
> class(z) <- 'POSIXct'
> z
[1] "2020-06-17 02:00:00 CEST"


Best regards,
Daniel



> On 18 Jun 2020, at 16:58, Christopher Kromm via R-SIG-Finance <r-sig-finance at r-project.org> wrote:
> 
> To whom it may concern,
> 
> I am interested in the FTSE MIB (or Milano Indice di Borsa) index. I am
> trying to download the data up to the present date (18 June 2020). I am
> using the get.hist.quote command in R from the tseries package.
> 
> I noticed the FTSE MIB  from yahoo has no pricing of any kind (open,
> closed, adjusted, etc.) from 12 February 2018 to present. It appears from
> the Yahoo site that the prices exist to the present day based on the
> summary charts, but the other charts don't seem to show data. I am assuming
> this stock is still used, which is why I am a bit confused by all the
> missing data.
> 
> Is it possible to obtain this FTSE MIB data without all the missing data
> from Yahoo Finance?
> 
> If this is possible, how?
> 
> If I cannot get the data from Yahoo Finance, are there alternative
> suggested sources for an R user to get this data?
> 
> Thank you.
> 
> Here is the url and the Yahoo Finance data symbol.
> 
> https://finance.yahoo.com/quote/FTSEMIB.MI?p=FTSEMIB.MI
> 
> Symbol: FTSEMIB.MI
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jr@| @end|ng |rom po@teo@no  Thu Jun 18 19:48:06 2020
From: jr@| @end|ng |rom po@teo@no (Rasmus Liland)
Date: Thu, 18 Jun 2020 19:48:06 +0200
Subject: [R-SIG-Finance] Yahoo Finance Stock data (FTSEMIB.MI) Issue
In-Reply-To: <49FD5B6D-53C3-47EE-A013-7362D305700B@gmail.com>
References: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
 <49FD5B6D-53C3-47EE-A013-7362D305700B@gmail.com>
Message-ID: <20200618174806.GB35011@posteo.no>

On 2020-06-18 18:48 +0200, Daniel Cegie?ka wrote:
> On 18 Jun 2020, at 16:58, Christopher Kromm wrote:
> > 
> > If I cannot get the data from Yahoo 
> > Finance, are there alternative suggested 
> > sources for an R user to get this data?
> 
> curl 'https://charts.borsaitaliana.it/charts/services/ChartWService.asmx/GetPrices' -H 'Connection: keep-alive' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'DNT: 1' -H 'X-Requested-With: XMLHttpRequest' -H 'Content-Type: application/json; charset=UTF-8' -H 'Origin: https://charts.borsaitaliana.it' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-Mode: cors' -H 'Referer: https://charts.borsaitaliana.it/charts/Bit/SummaryChart.aspx?code=CB.FTSEMIB&lang=en' -H 'Accept-Encoding: gzip, deflate, br' --data-binary '{"request":{"SampleTime":"1d","TimeFrame":"5y","RequestedDataSetType":"ohlc","ChartPriceType":"price","Key":"FTSEMIB.IDX","OffSet":0,"FromDate":null,"ToDate":null,"UseDelay":true,"KeyType":"Topic","KeyType2":"Topic","Language":"en-US"}}' --compressed > FTSEMIB.json

Dear Daniel Cegie?ka,

that's a great answer!  Are you (or others) 
able to elaborate more on how you determined 
the headers to send?

Best,
Rasmus

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20200618/4364aa1f/attachment.sig>

From d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com  Thu Jun 18 21:08:36 2020
From: d@n|e|@ceg|e|k@ @end|ng |rom gm@||@com (=?utf-8?Q?Daniel_Cegie=C5=82ka?=)
Date: Thu, 18 Jun 2020 21:08:36 +0200
Subject: [R-SIG-Finance] Yahoo Finance Stock data (FTSEMIB.MI) Issue
In-Reply-To: <20200618174806.GB35011@posteo.no>
References: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
 <49FD5B6D-53C3-47EE-A013-7362D305700B@gmail.com>
 <20200618174806.GB35011@posteo.no>
Message-ID: <095357CE-CE1D-446E-BE3D-0BFD531E792A@gmail.com>



> On 18 Jun 2020, at 19:48, Rasmus Liland <jral at posteo.no> wrote:
> 
> On 2020-06-18 18:48 +0200, Daniel Cegie?ka wrote:
>> On 18 Jun 2020, at 16:58, Christopher Kromm wrote:
>>> 
>>> If I cannot get the data from Yahoo 
>>> Finance, are there alternative suggested 
>>> sources for an R user to get this data?
>> 
>> curl 'https://charts.borsaitaliana.it/charts/services/ChartWService.asmx/GetPrices' -H 'Connection: keep-alive' -H 'Accept: application/json, text/javascript, */*; q=0.01' -H 'DNT: 1' -H 'X-Requested-With: XMLHttpRequest' -H 'Content-Type: application/json; charset=UTF-8' -H 'Origin: https://charts.borsaitaliana.it' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-Mode: cors' -H 'Referer: https://charts.borsaitaliana.it/charts/Bit/SummaryChart.aspx?code=CB.FTSEMIB&lang=en' -H 'Accept-Encoding: gzip, deflate, br' --data-binary '{"request":{"SampleTime":"1d","TimeFrame":"5y","RequestedDataSetType":"ohlc","ChartPriceType":"price","Key":"FTSEMIB.IDX","OffSet":0,"FromDate":null,"ToDate":null,"UseDelay":true,"KeyType":"Topic","KeyType2":"Topic","Language":"en-US"}}' --compressed > FTSEMIB.json
> 
> Dear Daniel Cegie?ka,

Daniel :)

> that's a great answer!  Are you (or others) 
> able to elaborate more on how you determined 
> the headers to send?
> 

Let's start that web scraping is probably legal now (in US):

https://towardsdatascience.com/web-scraping-is-now-legal-6bf0e5730a78 <https://towardsdatascience.com/web-scraping-is-now-legal-6bf0e5730a78>

Scraping requires some experience and intuition. There is no other way than web debugging - and each one is different. However, current web browsers are very powerful and have many useful add-ons. Sometimes it takes a minute, and sometimes it requires a lot of work. A good source for learning is getSymbols:

https://github.com/joshuaulrich/quantmod/blob/master/R/getSymbols.R <https://github.com/joshuaulrich/quantmod/blob/master/R/getSymbols.R>

And

https://stackoverflow.com/questions/44030983/yahoo-finance-url-not-working <https://stackoverflow.com/questions/44030983/yahoo-finance-url-not-working>

Best


> Best,
> Rasmus


	[[alternative HTML version deleted]]


From m@rkpmc @end|ng |rom gm@||@com  Thu Jun 18 22:49:09 2020
From: m@rkpmc @end|ng |rom gm@||@com (Mark McClellan)
Date: Thu, 18 Jun 2020 15:49:09 -0500
Subject: [R-SIG-Finance] Yahoo Finance Stock data (FTSEMIB.MI) Issue
In-Reply-To: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
References: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
Message-ID: <CABwSZmG7TO_95xdDbKaiVjhOa=aZUbvgqwc1La5nDLhvCaNsmA@mail.gmail.com>

Take a look at the Y! json url. It's there. Here's a URL that will get you
1min bars.
https://l1-query.finance.yahoo.com/v8/finance/chart/FTSEMIB.MI?interval=1m&range=1d&indicators=quote&includeTimestamps=true

Cheers,

Mark

On Thu, Jun 18, 2020 at 9:58 AM Christopher Kromm via R-SIG-Finance <
r-sig-finance at r-project.org> wrote:

> To whom it may concern,
>
> I am interested in the FTSE MIB (or Milano Indice di Borsa) index. I am
> trying to download the data up to the present date (18 June 2020). I am
> using the get.hist.quote command in R from the tseries package.
>
> I noticed the FTSE MIB  from yahoo has no pricing of any kind (open,
> closed, adjusted, etc.) from 12 February 2018 to present. It appears from
> the Yahoo site that the prices exist to the present day based on the
> summary charts, but the other charts don't seem to show data. I am assuming
> this stock is still used, which is why I am a bit confused by all the
> missing data.
>
> Is it possible to obtain this FTSE MIB data without all the missing data
> from Yahoo Finance?
>
> If this is possible, how?
>
> If I cannot get the data from Yahoo Finance, are there alternative
> suggested sources for an R user to get this data?
>
> Thank you.
>
> Here is the url and the Yahoo Finance data symbol.
>
> https://finance.yahoo.com/quote/FTSEMIB.MI?p=FTSEMIB.MI
>
> Symbol: FTSEMIB.MI
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


-- 
2.72

	[[alternative HTML version deleted]]


From cpkk @end|ng |rom @t-@ndrew@@@c@uk  Thu Jun 18 23:26:00 2020
From: cpkk @end|ng |rom @t-@ndrew@@@c@uk (Christopher Kromm)
Date: Thu, 18 Jun 2020 22:26:00 +0100
Subject: [R-SIG-Finance] Yahoo Finance Stock data (FTSEMIB.MI) Issue
In-Reply-To: <CABwSZmG7TO_95xdDbKaiVjhOa=aZUbvgqwc1La5nDLhvCaNsmA@mail.gmail.com>
References: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
 <CABwSZmG7TO_95xdDbKaiVjhOa=aZUbvgqwc1La5nDLhvCaNsmA@mail.gmail.com>
Message-ID: <CAPw+TzU1wKpb9=M_32q_m0UNyDRt744Qp_Hrfhs7bW9H3sqtKA@mail.gmail.com>

Thank you very much. That was very helpful.

On Thu, 18 Jun 2020 at 21:49, Mark McClellan <markpmc at gmail.com> wrote:

>
> Take a look at the Y! json url. It's there. Here's a URL that will get you
> 1min bars.
>
> https://l1-query.finance.yahoo.com/v8/finance/chart/FTSEMIB.MI?interval=1m&range=1d&indicators=quote&includeTimestamps=true
>
> Cheers,
>
> Mark
>
> On Thu, Jun 18, 2020 at 9:58 AM Christopher Kromm via R-SIG-Finance <
> r-sig-finance at r-project.org> wrote:
>
>> To whom it may concern,
>>
>> I am interested in the FTSE MIB (or Milano Indice di Borsa) index. I am
>> trying to download the data up to the present date (18 June 2020). I am
>> using the get.hist.quote command in R from the tseries package.
>>
>> I noticed the FTSE MIB  from yahoo has no pricing of any kind (open,
>> closed, adjusted, etc.) from 12 February 2018 to present. It appears from
>> the Yahoo site that the prices exist to the present day based on the
>> summary charts, but the other charts don't seem to show data. I am
>> assuming
>> this stock is still used, which is why I am a bit confused by all the
>> missing data.
>>
>> Is it possible to obtain this FTSE MIB data without all the missing data
>> from Yahoo Finance?
>>
>> If this is possible, how?
>>
>> If I cannot get the data from Yahoo Finance, are there alternative
>> suggested sources for an R user to get this data?
>>
>> Thank you.
>>
>> Here is the url and the Yahoo Finance data symbol.
>>
>> https://finance.yahoo.com/quote/FTSEMIB.MI?p=FTSEMIB.MI
>>
>> Symbol: FTSEMIB.MI
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>
> --
> 2.72
>

	[[alternative HTML version deleted]]


From jr@| @end|ng |rom po@teo@no  Fri Jun 19 17:48:08 2020
From: jr@| @end|ng |rom po@teo@no (Rasmus Liland)
Date: Fri, 19 Jun 2020 17:48:08 +0200
Subject: [R-SIG-Finance] Yahoo Finance Stock data (FTSEMIB.MI) Issue
In-Reply-To: <095357CE-CE1D-446E-BE3D-0BFD531E792A@gmail.com>
References: <CAPw+TzUZ4vPcFDyhiy0aPMqnJH5uiGeoimB9agALr1aKsRhHAA@mail.gmail.com>
 <49FD5B6D-53C3-47EE-A013-7362D305700B@gmail.com>
 <20200618174806.GB35011@posteo.no>
 <095357CE-CE1D-446E-BE3D-0BFD531E792A@gmail.com>
Message-ID: <20200619154808.GC35011@posteo.no>

On 2020-06-18 21:08 +0200, Daniel Cegie?ka wrote:
> On 18 Jun 2020, at 19:48, Rasmus Liland wrote:
> > 
> > Dear Daniel Cegie?ka,
> 
> Daniel :)

Ok, Daniel it is then :)

> > Are you (or others) able to elaborate 
> > more on how you determined the headers to 
> > send?
> 
> Let's start that web scraping is probably 
> legal now (in US):
> 
> https://towardsdatascience.com/web-scraping-is-now-legal-6bf0e5730a78

So as long as you don't log in to Facebook 
through your bot, it seems to be legal at 
least :/

> Scraping requires some experience and 
> intuition. There is no other way than web 
> debugging - and each one is different.  
> However, current web browsers are very 
> powerful and have many useful add-ons.  
> Sometimes it takes a minute, and sometimes 
> it requires a lot of work. A good source 
> for learning is getSymbols:
> 
> https://github.com/joshuaulrich/quantmod/blob/master/R/getSymbols.R
> 
> And
> 
> https://stackoverflow.com/questions/44030983/yahoo-finance-url-not-working

Such a well balanced answer, every website 
being different, right, so it depends on 
whether you meet an interface like Angular 
like Yahoo changed to. 

Thanks for good pointers on this. 

Best,
Rasmus

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20200619/2f8548dd/attachment.sig>

From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Sun Jun 21 21:46:56 2020
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Mon, 22 Jun 2020 01:16:56 +0530
Subject: [R-SIG-Finance] Valuation of FID
Message-ID: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>

Hi,

I had placed this question in some other forums, however failed to
garner sufficient information till date. Presenting the same here
hoping to get some insightful ideas from experts here.

Typically in a Bond the Principal is constant over it's life. However
I have come across a Bond whose principal is variable, say, average of
S&P quote for the last one month and coupon is paid based on that,
coupon rate being constant. I was looking for some idea how such bond
can be priced?

Any idea will be highly appreciated.

Thanks and regards,


From er|cjberger @end|ng |rom gm@||@com  Sun Jun 21 22:16:55 2020
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Sun, 21 Jun 2020 23:16:55 +0300
Subject: [R-SIG-Finance] Valuation of FID
In-Reply-To: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
References: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
Message-ID: <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>

Hi Christofer,
For this instrument its value today would be the sum of the present
value (pv) of its coupons and the pv of its redemption value.
You have not specified how the redemption value is determined, so I
won't deal with it. Regarding the coupons, you also did not say the
rate of the coupon, so let's say that is fixed, say at C (e.g. C=3%).
Each coupon appears to be C x (Avg Value of the Index), which seems to
be like holding C of an Average Rate Option (with a zero strike
price), also called an Average Price option (in this case an Average
Price Call). Since each coupon is a position in such an option, the
set of coupons is a portfolio of Average Price Calls. Hull and White
discuss valuation for such options, including a reference to Kemna and
Vorst (1990) who treated the case when the average is calculated as a
geometric average and the option is European.

Hopefully this provides enough clues for you to take it from here.

Best,
Eric

On Sun, Jun 21, 2020 at 10:47 PM Christofer Bogaso
<bogaso.christofer at gmail.com> wrote:
>
> Hi,
>
> I had placed this question in some other forums, however failed to
> garner sufficient information till date. Presenting the same here
> hoping to get some insightful ideas from experts here.
>
> Typically in a Bond the Principal is constant over it's life. However
> I have come across a Bond whose principal is variable, say, average of
> S&P quote for the last one month and coupon is paid based on that,
> coupon rate being constant. I was looking for some idea how such bond
> can be priced?
>
> Any idea will be highly appreciated.
>
> Thanks and regards,
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From br|@n @end|ng |rom br@verock@com  Mon Jun 22 14:44:34 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Mon, 22 Jun 2020 07:44:34 -0500
Subject: [R-SIG-Finance] Valuation of FID
In-Reply-To: <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>
References: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
 <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>
Message-ID: <7d0ae743f836af97c823840f1946787bf01aa870.camel@braverock.com>

This sounds more like a swap contract than a bond.  The principal is
some quantity of S&P (futures, index value* some initial capital,
something).
Perhaps look at pricing swaps.
On Sun, 2020-06-21 at 23:16 +0300, Eric Berger wrote:
> Hi Christofer,For this instrument its value today would be the sum of
> the presentvalue (pv) of its coupons and the pv of its redemption
> value.You have not specified how the redemption value is determined,
> so Iwon't deal with it. Regarding the coupons, you also did not say
> therate of the coupon, so let's say that is fixed, say at C (e.g.
> C=3%).Each coupon appears to be C x (Avg Value of the Index), which
> seems tobe like holding C of an Average Rate Option (with a zero
> strikeprice), also called an Average Price option (in this case an
> AveragePrice Call). Since each coupon is a position in such an
> option, theset of coupons is a portfolio of Average Price Calls. Hull
> and Whitediscuss valuation for such options, including a reference to
> Kemna andVorst (1990) who treated the case when the average is
> calculated as ageometric average and the option is European.
> Hopefully this provides enough clues for you to take it from here.
> Best,Eric
> On Sun, Jun 21, 2020 at 10:47 PM Christofer Bogaso<
> bogaso.christofer at gmail.com> wrote:
> > Hi,
> > I had placed this question in some other forums, however failed
> > togarner sufficient information till date. Presenting the same
> > herehoping to get some insightful ideas from experts here.
> > Typically in a Bond the Principal is constant over it's life.
> > HoweverI have come across a Bond whose principal is variable, say,
> > average ofS&P quote for the last one month and coupon is paid based
> > on that,coupon rate being constant. I was looking for some idea how
> > such bondcan be priced?
> > Any idea will be highly appreciated.
> > Thanks and regards,
> > _______________________________________________R-SIG-Finance at r-
> > project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.--
> > Also note that this is not the r-help list where general R
> > questions should go.
> 
> _______________________________________________R-SIG-Finance at r-
> project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.--
> Also note that this is not the r-help list where general R questions
> should go.
-- 
Brian



	[[alternative HTML version deleted]]


From er|cjberger @end|ng |rom gm@||@com  Mon Jun 22 14:59:51 2020
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Mon, 22 Jun 2020 15:59:51 +0300
Subject: [R-SIG-Finance] Valuation of FID
In-Reply-To: <7d0ae743f836af97c823840f1946787bf01aa870.camel@braverock.com>
References: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
 <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>
 <7d0ae743f836af97c823840f1946787bf01aa870.camel@braverock.com>
Message-ID: <CAGgJW77XYKqU3_B6dF8ghgm6hS5w334gxtQxujLCbKpGSE0A4A@mail.gmail.com>

Christofer provided only a sketch of the structure, but presumably it
is part of a general class of financial instruments called Structured
Notes.
There is a very short entry in Wikipedia that gives a bit of a flavor.
https://en.wikipedia.org/wiki/Structured_note

Structured notes would normally have a "buyer" who pays the
issuer/sponsor when the deal is entered.
By contrast, swaps generally have a value of zero at initiation. (Pre
the 'big bang' in the CDS market, this was true of CDS swaps also.)


On Mon, Jun 22, 2020 at 3:44 PM Brian G. Peterson <brian at braverock.com> wrote:
>
> This sounds more like a swap contract than a bond. The principal is some quantity of S&P (futures, index value* some initial capital, something).
>
> Perhaps look at pricing swaps.
>
> --
>
> Brian
>
> On Sun, 2020-06-21 at 23:16 +0300, Eric Berger wrote:
>
> Hi Christofer,
>
> For this instrument its value today would be the sum of the present
>
> value (pv) of its coupons and the pv of its redemption value.
>
> You have not specified how the redemption value is determined, so I
>
> won't deal with it. Regarding the coupons, you also did not say the
>
> rate of the coupon, so let's say that is fixed, say at C (e.g. C=3%).
>
> Each coupon appears to be C x (Avg Value of the Index), which seems to
>
> be like holding C of an Average Rate Option (with a zero strike
>
> price), also called an Average Price option (in this case an Average
>
> Price Call). Since each coupon is a position in such an option, the
>
> set of coupons is a portfolio of Average Price Calls. Hull and White
>
> discuss valuation for such options, including a reference to Kemna and
>
> Vorst (1990) who treated the case when the average is calculated as a
>
> geometric average and the option is European.
>
>
> Hopefully this provides enough clues for you to take it from here.
>
>
> Best,
>
> Eric
>
>
> On Sun, Jun 21, 2020 at 10:47 PM Christofer Bogaso
>
> <
>
> bogaso.christofer at gmail.com
>
> > wrote:
>
>
> Hi,
>
>
> I had placed this question in some other forums, however failed to
>
> garner sufficient information till date. Presenting the same here
>
> hoping to get some insightful ideas from experts here.
>
>
> Typically in a Bond the Principal is constant over it's life. However
>
> I have come across a Bond whose principal is variable, say, average of
>
> S&P quote for the last one month and coupon is paid based on that,
>
> coupon rate being constant. I was looking for some idea how such bond
>
> can be priced?
>
>
> Any idea will be highly appreciated.
>
>
> Thanks and regards,
>
>
> _______________________________________________
>
> R-SIG-Finance at r-project.org
>
>  mailing list
>
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
> -- Subscriber-posting only. If you want to post, subscribe first.
>
> -- Also note that this is not the r-help list where general R questions should go.
>
>
> _______________________________________________
>
> R-SIG-Finance at r-project.org
>
>  mailing list
>
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
> -- Subscriber-posting only. If you want to post, subscribe first.
>
> -- Also note that this is not the r-help list where general R questions should go.


From br|@n @end|ng |rom br@verock@com  Mon Jun 22 15:59:38 2020
From: br|@n @end|ng |rom br@verock@com (Brian G. Peterson)
Date: Mon, 22 Jun 2020 08:59:38 -0500
Subject: [R-SIG-Finance] Valuation of FID
In-Reply-To: <CAGgJW77XYKqU3_B6dF8ghgm6hS5w334gxtQxujLCbKpGSE0A4A@mail.gmail.com>
References: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
 <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>
 <7d0ae743f836af97c823840f1946787bf01aa870.camel@braverock.com>
 <CAGgJW77XYKqU3_B6dF8ghgm6hS5w334gxtQxujLCbKpGSE0A4A@mail.gmail.com>
Message-ID: <f78a316f0c640dcf82dab968dc83527486976717.camel@braverock.com>

Eric,

Agreed that this could be constructed as a structured note.

In that case there is an initial principal payment, which may be
leveraged.  Additionally, the principal may be 'principal-protected',
or not.

A structured note may be priced like a swap (if the note is not
principal protected), or it may be priced with a zero coupon bond and
embedded call option (for a principal protected note) or as a more
complex structure depending on the waterfall of payments to note
holders.  Especially in a leveraged and non-principal-protected
structure, the payoffs can be quite complex.

As you point out, the OP did not give us [m]any details about the
contract specification for what he is trying to price.  So I think we
need more specifics to add any more clarity to this thread.

-- 
Brian


On Mon, 2020-06-22 at 15:59 +0300, Eric Berger wrote:
> Christofer provided only a sketch of the structure, but presumably it
> is part of a general class of financial instruments called Structured
> Notes.
> There is a very short entry in Wikipedia that gives a bit of a
> flavor.
> https://en.wikipedia.org/wiki/Structured_note
> 
> 
> Structured notes would normally have a "buyer" who pays the
> issuer/sponsor when the deal is entered.
> By contrast, swaps generally have a value of zero at initiation. (Pre
> the 'big bang' in the CDS market, this was true of CDS swaps also.)
> 
> 
> On Mon, Jun 22, 2020 at 3:44 PM Brian G. Peterson <
> brian at braverock.com
> > wrote:
> > This sounds more like a swap contract than a bond. The principal is
> > some quantity of S&P (futures, index value* some initial capital,
> > something).
> > 
> > Perhaps look at pricing swaps.
> > 
> > --
> > 
> > Brian
> > 
> > On Sun, 2020-06-21 at 23:16 +0300, Eric Berger wrote:
> > 
> > Hi Christofer,
> > 
> > For this instrument its value today would be the sum of the present
> > 
> > value (pv) of its coupons and the pv of its redemption value.
> > 
> > You have not specified how the redemption value is determined, so I
> > 
> > won't deal with it. Regarding the coupons, you also did not say the
> > 
> > rate of the coupon, so let's say that is fixed, say at C (e.g.
> > C=3%).
> > 
> > Each coupon appears to be C x (Avg Value of the Index), which seems
> > to
> > 
> > be like holding C of an Average Rate Option (with a zero strike
> > 
> > price), also called an Average Price option (in this case an
> > Average
> > 
> > Price Call). Since each coupon is a position in such an option, the
> > 
> > set of coupons is a portfolio of Average Price Calls. Hull and
> > White
> > 
> > discuss valuation for such options, including a reference to Kemna
> > and
> > 
> > Vorst (1990) who treated the case when the average is calculated as
> > a
> > 
> > geometric average and the option is European.
> > 
> > 
> > Hopefully this provides enough clues for you to take it from here.
> > 
> > 
> > Best,
> > 
> > Eric
> > 
> > 
> > On Sun, Jun 21, 2020 at 10:47 PM Christofer Bogaso
> > 
> > <
> > 
> > bogaso.christofer at gmail.com
> > 
> > 
> > > wrote:
> > 
> > 
> > Hi,
> > 
> > 
> > I had placed this question in some other forums, however failed to
> > 
> > garner sufficient information till date. Presenting the same here
> > 
> > hoping to get some insightful ideas from experts here.
> > 
> > 
> > Typically in a Bond the Principal is constant over it's life.
> > However
> > 
> > I have come across a Bond whose principal is variable, say, average
> > of
> > 
> > S&P quote for the last one month and coupon is paid based on that,
> > 
> > coupon rate being constant. I was looking for some idea how such
> > bond
> > 
> > can be priced?
> > 
> > 
> > Any idea will be highly appreciated.
> > 
> > 
> > Thanks and regards,
> > 
> > 
> > _______________________________________________
> > 
> > R-SIG-Finance at r-project.org
> > 
> > 
> >  mailing list
> > 
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > 
> > 
> > 
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > 
> > -- Also note that this is not the r-help list where general R
> > questions should go.
> > 
> > 
> > _______________________________________________
> > 
> > R-SIG-Finance at r-project.org
> > 
> > 
> >  mailing list
> > 
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > 
> > 
> > 
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > 
> > -- Also note that this is not the r-help list where general R
> > questions should go.
> 
> _______________________________________________
> R-SIG-Finance at r-project.org
>  mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> 
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R
> questions should go.


From v|vekr@o4 @end|ng |rom y@hoo@com  Mon Jun 22 22:46:03 2020
From: v|vekr@o4 @end|ng |rom y@hoo@com (Vivek Rao)
Date: Mon, 22 Jun 2020 20:46:03 +0000 (UTC)
Subject: [R-SIG-Finance] GARCH models that use range data
References: <947063792.867188.1592858763537.ref@mail.yahoo.com>
Message-ID: <947063792.867188.1592858763537@mail.yahoo.com>

Packages such as rugarch fit GARCH models to returns. Usually one fits the model to close-to-close (CC) returns. Is there an R package or R code that uses OHLC data to predict CC return volatility within a GARCH framework? The basic GARCH(1,1) model

s(t+1)^2 = w + a*r(t)^2 + b*s(t)^2

where s(t) is the conditional standard deviation and r(t) is the return could be augmented by a term depending on the high-low range hl(t) = log(high(t)/low(t)) to give

s(t+1)^2 = w + a*r(t)^2 + b*s(t)^2 + c*hl(t)^2

Vivek Rao


From bog@@o@chr|@to|er @end|ng |rom gm@||@com  Tue Jun 23 15:12:00 2020
From: bog@@o@chr|@to|er @end|ng |rom gm@||@com (Christofer Bogaso)
Date: Tue, 23 Jun 2020 18:42:00 +0530
Subject: [R-SIG-Finance] Valuation of FID
In-Reply-To: <f78a316f0c640dcf82dab968dc83527486976717.camel@braverock.com>
References: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
 <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>
 <7d0ae743f836af97c823840f1946787bf01aa870.camel@braverock.com>
 <CAGgJW77XYKqU3_B6dF8ghgm6hS5w334gxtQxujLCbKpGSE0A4A@mail.gmail.com>
 <f78a316f0c640dcf82dab968dc83527486976717.camel@braverock.com>
Message-ID: <CA+dpOJn_wqC+kQW6r0nrqC1jqTBOOpGVnTzCjcBSEqhwNWY8+A@mail.gmail.com>

With the caveat that the exact nature of this instrument is a bit
proprietary, Eric's solution quite fit to this pricing problem.

I am curious to understand if there is any implementation in R (or
other software like python) to price such Average Price Calls option.

Thanks,

On Mon, Jun 22, 2020 at 7:30 PM Brian G. Peterson <brian at braverock.com> wrote:
>
> Eric,
>
> Agreed that this could be constructed as a structured note.
>
> In that case there is an initial principal payment, which may be
> leveraged.  Additionally, the principal may be 'principal-protected',
> or not.
>
> A structured note may be priced like a swap (if the note is not
> principal protected), or it may be priced with a zero coupon bond and
> embedded call option (for a principal protected note) or as a more
> complex structure depending on the waterfall of payments to note
> holders.  Especially in a leveraged and non-principal-protected
> structure, the payoffs can be quite complex.
>
> As you point out, the OP did not give us [m]any details about the
> contract specification for what he is trying to price.  So I think we
> need more specifics to add any more clarity to this thread.
>
> --
> Brian
>
>
> On Mon, 2020-06-22 at 15:59 +0300, Eric Berger wrote:
> > Christofer provided only a sketch of the structure, but presumably it
> > is part of a general class of financial instruments called Structured
> > Notes.
> > There is a very short entry in Wikipedia that gives a bit of a
> > flavor.
> > https://en.wikipedia.org/wiki/Structured_note
> >
> >
> > Structured notes would normally have a "buyer" who pays the
> > issuer/sponsor when the deal is entered.
> > By contrast, swaps generally have a value of zero at initiation. (Pre
> > the 'big bang' in the CDS market, this was true of CDS swaps also.)
> >
> >
> > On Mon, Jun 22, 2020 at 3:44 PM Brian G. Peterson <
> > brian at braverock.com
> > > wrote:
> > > This sounds more like a swap contract than a bond. The principal is
> > > some quantity of S&P (futures, index value* some initial capital,
> > > something).
> > >
> > > Perhaps look at pricing swaps.
> > >
> > > --
> > >
> > > Brian
> > >
> > > On Sun, 2020-06-21 at 23:16 +0300, Eric Berger wrote:
> > >
> > > Hi Christofer,
> > >
> > > For this instrument its value today would be the sum of the present
> > >
> > > value (pv) of its coupons and the pv of its redemption value.
> > >
> > > You have not specified how the redemption value is determined, so I
> > >
> > > won't deal with it. Regarding the coupons, you also did not say the
> > >
> > > rate of the coupon, so let's say that is fixed, say at C (e.g.
> > > C=3%).
> > >
> > > Each coupon appears to be C x (Avg Value of the Index), which seems
> > > to
> > >
> > > be like holding C of an Average Rate Option (with a zero strike
> > >
> > > price), also called an Average Price option (in this case an
> > > Average
> > >
> > > Price Call). Since each coupon is a position in such an option, the
> > >
> > > set of coupons is a portfolio of Average Price Calls. Hull and
> > > White
> > >
> > > discuss valuation for such options, including a reference to Kemna
> > > and
> > >
> > > Vorst (1990) who treated the case when the average is calculated as
> > > a
> > >
> > > geometric average and the option is European.
> > >
> > >
> > > Hopefully this provides enough clues for you to take it from here.
> > >
> > >
> > > Best,
> > >
> > > Eric
> > >
> > >
> > > On Sun, Jun 21, 2020 at 10:47 PM Christofer Bogaso
> > >
> > > <
> > >
> > > bogaso.christofer at gmail.com
> > >
> > >
> > > > wrote:
> > >
> > >
> > > Hi,
> > >
> > >
> > > I had placed this question in some other forums, however failed to
> > >
> > > garner sufficient information till date. Presenting the same here
> > >
> > > hoping to get some insightful ideas from experts here.
> > >
> > >
> > > Typically in a Bond the Principal is constant over it's life.
> > > However
> > >
> > > I have come across a Bond whose principal is variable, say, average
> > > of
> > >
> > > S&P quote for the last one month and coupon is paid based on that,
> > >
> > > coupon rate being constant. I was looking for some idea how such
> > > bond
> > >
> > > can be priced?
> > >
> > >
> > > Any idea will be highly appreciated.
> > >
> > >
> > > Thanks and regards,
> > >
> > >
> > > _______________________________________________
> > >
> > > R-SIG-Finance at r-project.org
> > >
> > >
> > >  mailing list
> > >
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > >
> > >
> > >
> > > -- Subscriber-posting only. If you want to post, subscribe first.
> > >
> > > -- Also note that this is not the r-help list where general R
> > > questions should go.
> > >
> > >
> > > _______________________________________________
> > >
> > > R-SIG-Finance at r-project.org
> > >
> > >
> > >  mailing list
> > >
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > >
> > >
> > >
> > > -- Subscriber-posting only. If you want to post, subscribe first.
> > >
> > > -- Also note that this is not the r-help list where general R
> > > questions should go.
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org
> >  mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R
> > questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From er|cjberger @end|ng |rom gm@||@com  Tue Jun 23 15:32:07 2020
From: er|cjberger @end|ng |rom gm@||@com (Eric Berger)
Date: Tue, 23 Jun 2020 16:32:07 +0300
Subject: [R-SIG-Finance] Valuation of FID
In-Reply-To: <CA+dpOJn_wqC+kQW6r0nrqC1jqTBOOpGVnTzCjcBSEqhwNWY8+A@mail.gmail.com>
References: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
 <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>
 <7d0ae743f836af97c823840f1946787bf01aa870.camel@braverock.com>
 <CAGgJW77XYKqU3_B6dF8ghgm6hS5w334gxtQxujLCbKpGSE0A4A@mail.gmail.com>
 <f78a316f0c640dcf82dab968dc83527486976717.camel@braverock.com>
 <CA+dpOJn_wqC+kQW6r0nrqC1jqTBOOpGVnTzCjcBSEqhwNWY8+A@mail.gmail.com>
Message-ID: <CAGgJW74BdffUZjaNBVYmrNR8GYNChxLie5TF3bowr4CJreMWhA@mail.gmail.com>

Hi Christofer,
There is a tremendous amount of functionality in the C++ library QuantLib.
Some of that functionality can be easily accessed from R via the
package RQuantLib (developed by Dirk Eddelbuettel.)
I suggest you check QuantLib to see if they have pricing models for
Average Price Calls.
If so, then see if you can access those functions from RQuantLib. (If
not, you might need to access QuantLib with the help of Rcpp.)

Hope that helps,
Eric

On Tue, Jun 23, 2020 at 4:12 PM Christofer Bogaso
<bogaso.christofer at gmail.com> wrote:
>
> With the caveat that the exact nature of this instrument is a bit
> proprietary, Eric's solution quite fit to this pricing problem.
>
> I am curious to understand if there is any implementation in R (or
> other software like python) to price such Average Price Calls option.
>
> Thanks,
>
> On Mon, Jun 22, 2020 at 7:30 PM Brian G. Peterson <brian at braverock.com> wrote:
> >
> > Eric,
> >
> > Agreed that this could be constructed as a structured note.
> >
> > In that case there is an initial principal payment, which may be
> > leveraged.  Additionally, the principal may be 'principal-protected',
> > or not.
> >
> > A structured note may be priced like a swap (if the note is not
> > principal protected), or it may be priced with a zero coupon bond and
> > embedded call option (for a principal protected note) or as a more
> > complex structure depending on the waterfall of payments to note
> > holders.  Especially in a leveraged and non-principal-protected
> > structure, the payoffs can be quite complex.
> >
> > As you point out, the OP did not give us [m]any details about the
> > contract specification for what he is trying to price.  So I think we
> > need more specifics to add any more clarity to this thread.
> >
> > --
> > Brian
> >
> >
> > On Mon, 2020-06-22 at 15:59 +0300, Eric Berger wrote:
> > > Christofer provided only a sketch of the structure, but presumably it
> > > is part of a general class of financial instruments called Structured
> > > Notes.
> > > There is a very short entry in Wikipedia that gives a bit of a
> > > flavor.
> > > https://en.wikipedia.org/wiki/Structured_note
> > >
> > >
> > > Structured notes would normally have a "buyer" who pays the
> > > issuer/sponsor when the deal is entered.
> > > By contrast, swaps generally have a value of zero at initiation. (Pre
> > > the 'big bang' in the CDS market, this was true of CDS swaps also.)
> > >
> > >
> > > On Mon, Jun 22, 2020 at 3:44 PM Brian G. Peterson <
> > > brian at braverock.com
> > > > wrote:
> > > > This sounds more like a swap contract than a bond. The principal is
> > > > some quantity of S&P (futures, index value* some initial capital,
> > > > something).
> > > >
> > > > Perhaps look at pricing swaps.
> > > >
> > > > --
> > > >
> > > > Brian
> > > >
> > > > On Sun, 2020-06-21 at 23:16 +0300, Eric Berger wrote:
> > > >
> > > > Hi Christofer,
> > > >
> > > > For this instrument its value today would be the sum of the present
> > > >
> > > > value (pv) of its coupons and the pv of its redemption value.
> > > >
> > > > You have not specified how the redemption value is determined, so I
> > > >
> > > > won't deal with it. Regarding the coupons, you also did not say the
> > > >
> > > > rate of the coupon, so let's say that is fixed, say at C (e.g.
> > > > C=3%).
> > > >
> > > > Each coupon appears to be C x (Avg Value of the Index), which seems
> > > > to
> > > >
> > > > be like holding C of an Average Rate Option (with a zero strike
> > > >
> > > > price), also called an Average Price option (in this case an
> > > > Average
> > > >
> > > > Price Call). Since each coupon is a position in such an option, the
> > > >
> > > > set of coupons is a portfolio of Average Price Calls. Hull and
> > > > White
> > > >
> > > > discuss valuation for such options, including a reference to Kemna
> > > > and
> > > >
> > > > Vorst (1990) who treated the case when the average is calculated as
> > > > a
> > > >
> > > > geometric average and the option is European.
> > > >
> > > >
> > > > Hopefully this provides enough clues for you to take it from here.
> > > >
> > > >
> > > > Best,
> > > >
> > > > Eric
> > > >
> > > >
> > > > On Sun, Jun 21, 2020 at 10:47 PM Christofer Bogaso
> > > >
> > > > <
> > > >
> > > > bogaso.christofer at gmail.com
> > > >
> > > >
> > > > > wrote:
> > > >
> > > >
> > > > Hi,
> > > >
> > > >
> > > > I had placed this question in some other forums, however failed to
> > > >
> > > > garner sufficient information till date. Presenting the same here
> > > >
> > > > hoping to get some insightful ideas from experts here.
> > > >
> > > >
> > > > Typically in a Bond the Principal is constant over it's life.
> > > > However
> > > >
> > > > I have come across a Bond whose principal is variable, say, average
> > > > of
> > > >
> > > > S&P quote for the last one month and coupon is paid based on that,
> > > >
> > > > coupon rate being constant. I was looking for some idea how such
> > > > bond
> > > >
> > > > can be priced?
> > > >
> > > >
> > > > Any idea will be highly appreciated.
> > > >
> > > >
> > > > Thanks and regards,
> > > >
> > > >
> > > > _______________________________________________
> > > >
> > > > R-SIG-Finance at r-project.org
> > > >
> > > >
> > > >  mailing list
> > > >
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > > >
> > > >
> > > >
> > > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > >
> > > > -- Also note that this is not the r-help list where general R
> > > > questions should go.
> > > >
> > > >
> > > > _______________________________________________
> > > >
> > > > R-SIG-Finance at r-project.org
> > > >
> > > >
> > > >  mailing list
> > > >
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > > >
> > > >
> > > >
> > > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > >
> > > > -- Also note that this is not the r-help list where general R
> > > > questions should go.
> > >
> > > _______________________________________________
> > > R-SIG-Finance at r-project.org
> > >  mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > >
> > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > -- Also note that this is not the r-help list where general R
> > > questions should go.
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions should go.


From e@ @end|ng |rom enr|co@chum@nn@net  Tue Jun 23 16:20:21 2020
From: e@ @end|ng |rom enr|co@chum@nn@net (Enrico Schumann)
Date: Tue, 23 Jun 2020 16:20:21 +0200
Subject: [R-SIG-Finance] Valuation of FID
In-Reply-To: <CA+dpOJn_wqC+kQW6r0nrqC1jqTBOOpGVnTzCjcBSEqhwNWY8+A@mail.gmail.com>
 (Christofer Bogaso's message of "Tue, 23 Jun 2020 18:42:00 +0530")
References: <CA+dpOJ=Bd4aaL+rFEDZESUW=m0XZuM-+1Y5gnL9bmtH_1euKWg@mail.gmail.com>
 <CAGgJW77eUqYV+Em+vCDhOkgekZO+trjsN-vTcda1DrKAjy05dg@mail.gmail.com>
 <7d0ae743f836af97c823840f1946787bf01aa870.camel@braverock.com>
 <CAGgJW77XYKqU3_B6dF8ghgm6hS5w334gxtQxujLCbKpGSE0A4A@mail.gmail.com>
 <f78a316f0c640dcf82dab968dc83527486976717.camel@braverock.com>
 <CA+dpOJn_wqC+kQW6r0nrqC1jqTBOOpGVnTzCjcBSEqhwNWY8+A@mail.gmail.com>
Message-ID: <87zh8teue2.fsf@enricoschumann.net>

On Tue, 23 Jun 2020, Christofer Bogaso writes:

> With the caveat that the exact nature of this instrument is a bit
> proprietary, Eric's solution quite fit to this pricing problem.
>
> I am curious to understand if there is any implementation in R (or
> other software like python) to price such Average Price Calls option.
>
> Thanks,

Other than RQuantLib, mentioned by Eric, you may want to
search for "Asian options".  I am sure there are several
implementations available in R, e.g. in packages
"fExoticOptions" and "derivmkts".  But please do check if
they really provide what you need.

kind regards
    Enrico

> On Mon, Jun 22, 2020 at 7:30 PM Brian G. Peterson <brian at braverock.com> wrote:
>>
>> Eric,
>>
>> Agreed that this could be constructed as a structured note.
>>
>> In that case there is an initial principal payment, which may be
>> leveraged.  Additionally, the principal may be 'principal-protected',
>> or not.
>>
>> A structured note may be priced like a swap (if the note is not
>> principal protected), or it may be priced with a zero coupon bond and
>> embedded call option (for a principal protected note) or as a more
>> complex structure depending on the waterfall of payments to note
>> holders.  Especially in a leveraged and non-principal-protected
>> structure, the payoffs can be quite complex.
>>
>> As you point out, the OP did not give us [m]any details about the
>> contract specification for what he is trying to price.  So I think we
>> need more specifics to add any more clarity to this thread.
>>
>> --
>> Brian
>>
>>
>> On Mon, 2020-06-22 at 15:59 +0300, Eric Berger wrote:
>> > Christofer provided only a sketch of the structure, but presumably it
>> > is part of a general class of financial instruments called Structured
>> > Notes.
>> > There is a very short entry in Wikipedia that gives a bit of a
>> > flavor.
>> > https://en.wikipedia.org/wiki/Structured_note
>> >
>> >
>> > Structured notes would normally have a "buyer" who pays the
>> > issuer/sponsor when the deal is entered.
>> > By contrast, swaps generally have a value of zero at initiation. (Pre
>> > the 'big bang' in the CDS market, this was true of CDS swaps also.)
>> >
>> >
>> > On Mon, Jun 22, 2020 at 3:44 PM Brian G. Peterson <
>> > brian at braverock.com
>> > > wrote:
>> > > This sounds more like a swap contract than a bond. The principal is
>> > > some quantity of S&P (futures, index value* some initial capital,
>> > > something).
>> > >
>> > > Perhaps look at pricing swaps.
>> > >
>> > > --
>> > >
>> > > Brian
>> > >
>> > > On Sun, 2020-06-21 at 23:16 +0300, Eric Berger wrote:
>> > >
>> > > Hi Christofer,
>> > >
>> > > For this instrument its value today would be the sum of the present
>> > >
>> > > value (pv) of its coupons and the pv of its redemption value.
>> > >
>> > > You have not specified how the redemption value is determined, so I
>> > >
>> > > won't deal with it. Regarding the coupons, you also did not say the
>> > >
>> > > rate of the coupon, so let's say that is fixed, say at C (e.g.
>> > > C=3%).
>> > >
>> > > Each coupon appears to be C x (Avg Value of the Index), which seems
>> > > to
>> > >
>> > > be like holding C of an Average Rate Option (with a zero strike
>> > >
>> > > price), also called an Average Price option (in this case an
>> > > Average
>> > >
>> > > Price Call). Since each coupon is a position in such an option, the
>> > >
>> > > set of coupons is a portfolio of Average Price Calls. Hull and
>> > > White
>> > >
>> > > discuss valuation for such options, including a reference to Kemna
>> > > and
>> > >
>> > > Vorst (1990) who treated the case when the average is calculated as
>> > > a
>> > >
>> > > geometric average and the option is European.
>> > >
>> > >
>> > > Hopefully this provides enough clues for you to take it from here.
>> > >
>> > >
>> > > Best,
>> > >
>> > > Eric
>> > >
>> > >
>> > > On Sun, Jun 21, 2020 at 10:47 PM Christofer Bogaso
>> > >
>> > > <
>> > >
>> > > bogaso.christofer at gmail.com
>> > >
>> > >
>> > > > wrote:
>> > >
>> > >
>> > > Hi,
>> > >
>> > >
>> > > I had placed this question in some other forums, however failed to
>> > >
>> > > garner sufficient information till date. Presenting the same here
>> > >
>> > > hoping to get some insightful ideas from experts here.
>> > >
>> > >
>> > > Typically in a Bond the Principal is constant over it's life.
>> > > However
>> > >
>> > > I have come across a Bond whose principal is variable, say, average
>> > > of
>> > >
>> > > S&P quote for the last one month and coupon is paid based on that,
>> > >
>> > > coupon rate being constant. I was looking for some idea how such
>> > > bond
>> > >
>> > > can be priced?
>> > >
>> > >
>> > > Any idea will be highly appreciated.
>> > >
>> > >
>> > > Thanks and regards,
>> > >
>> > >
>> > > _______________________________________________
>> > >
>> > > R-SIG-Finance at r-project.org
>> > >
>> > >
>> > >  mailing list
>> > >
>> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > >
>> > >
>> > >
>> > > -- Subscriber-posting only. If you want to post, subscribe first.
>> > >
>> > > -- Also note that this is not the r-help list where general R
>> > > questions should go.
>> > >
>> > >
>> > > _______________________________________________
>> > >
>> > > R-SIG-Finance at r-project.org
>> > >
>> > >
>> > >  mailing list
>> > >
>> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > >
>> > >
>> > >
>> > > -- Subscriber-posting only. If you want to post, subscribe first.
>> > >
>> > > -- Also note that this is not the r-help list where general R
>> > > questions should go.
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org
>> >  mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R
>> > questions should go.
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Enrico Schumann
Lucerne, Switzerland
http://enricoschumann.net


