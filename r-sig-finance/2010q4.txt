From cmdr_rogue at hotmail.com  Fri Oct  1 03:09:19 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Thu, 30 Sep 2010 21:09:19 -0400
Subject: [R-SIG-Finance] SABR model
In-Reply-To: <475173.9775.qm@web57602.mail.re1.yahoo.com>
References: <475173.9775.qm@web57602.mail.re1.yahoo.com>
Message-ID: <BLU0-SMTP14047710850606771E2374EE2690@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20100930/c159203f/attachment.pl>

From brian at braverock.com  Fri Oct  1 04:26:25 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 30 Sep 2010 21:26:25 -0500
Subject: [R-SIG-Finance] SABR model
In-Reply-To: <BLU0-SMTP14047710850606771E2374EE2690@phx.gbl>
References: <475173.9775.qm@web57602.mail.re1.yahoo.com>
	<BLU0-SMTP14047710850606771E2374EE2690@phx.gbl>
Message-ID: <5cb0083639877cad1a50b5f70467d96c@braverock.com>

An open (or closed) source C++ version could probably be wrapped with
RCpp.

On Thu, 30 Sep 2010 21:09:19 -0400, Sarbo <cmdr_rogue at hotmail.com> wrote:
> The SABR model requires a good singular perturbation analysis engine. I
> haven't seen an implementation in R either, and the VBA implementation
> is probably the one in Haug's book, which is a very simplified version
> of the model. Someday I hope to code something like a SABR model in R,
> but that's going to be a long way off, I think.
> 
> On Mon, 2010-09-27 at 06:58 -0700, abe chan wrote:
> 
>> Hello All,
>> 
>> I have been looking for some SABR model implementation package/code in
R
>> and
>> have found nothing. I wonder if anyone has come across the codes should
>> they are
>> available. I can only found the model implementation in C++ and VBA
only
>> so far.
>> Thanks.
>> 
>> Abraham
>> 
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From thomasrbolton at yahoo.co.uk  Fri Oct  1 18:32:38 2010
From: thomasrbolton at yahoo.co.uk (thomasrbolton at yahoo.co.uk)
Date: Fri, 01 Oct 2010 09:32:38 -0700
Subject: [R-SIG-Finance] Backtesting Trading systems
Message-ID: <486688.25241.1285950758073.JavaMail.root@joe.nabble.com>

Hi Mark,

I was reading your post on the R forum re the above.
I am very interested in adapting your RSI trading strategy. 
I wondered if you completed this? 
Since, the algorithm posted is subject to errors, i.e. if say we have a number of consecutive crosses_over followed by a number of consecutive crosses_under the algorithm fails (i.e. if they are not alternate).

Any advice you can offer would be most appreciated.

Thank you

Tom


From brian at braverock.com  Fri Oct  1 19:19:19 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 01 Oct 2010 12:19:19 -0500
Subject: [R-SIG-Finance] Backtesting Trading systems
In-Reply-To: <486688.25241.1285950758073.JavaMail.root@joe.nabble.com>
References: <486688.25241.1285950758073.JavaMail.root@joe.nabble.com>
Message-ID: <4CA61817.5090604@braverock.com>

On 10/01/2010 11:32 AM, thomasrbolton at yahoo.co.uk wrote:
> I was reading your post on the R forum re the above.
> I am very interested in adapting your RSI trading strategy.
> I wondered if you completed this?
> Since, the algorithm posted is subject to errors, i.e. if say we have a number of consecutive crosses_over followed by a number of consecutive crosses_under the algorithm fails (i.e. if they are not alternate).

There is also a complete RSI demo for the package 'quantstrat' on R-Forge.

Regards,

   - Brian


From breman.mark at gmail.com  Fri Oct  1 19:51:52 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Fri, 1 Oct 2010 19:51:52 +0200
Subject: [R-SIG-Finance] Backtesting Trading systems
In-Reply-To: <486688.25241.1285950758073.JavaMail.root@joe.nabble.com>
References: <486688.25241.1285950758073.JavaMail.root@joe.nabble.com>
Message-ID: <AANLkTi=dWfD5BZteLDSejU9hzpwPrB2JC_-p_kEA=-U7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101001/e28903cd/attachment.pl>

From worik.stanton at gmail.com  Tue Oct  5 23:56:33 2010
From: worik.stanton at gmail.com (Worik)
Date: Wed, 06 Oct 2010 10:56:33 +1300
Subject: [R-SIG-Finance] xts question:  Extract rows with an NA
Message-ID: <4CAB9F11.6080000@gmail.com>

I wish to extract rows from an xts object that have a NA entry.  I can 
use na.omit to exclude those rows, but I can find no simple way to 
include them.

Is there such a way?

 > X <- xts(cbind(c(1,2,3), c(1,NA,5)), Sys.Date()+1:3)
 > X
            [,1] [,2]
2010-10-07    1    1
2010-10-08    2   NA
2010-10-09    3    5
 > na.omit(X)
            [,1] [,2]
2010-10-07    1    1
2010-10-09    3    5


I want:

 > na.only(X)

            [,1] [,2]
2010-10-08    2   NA


cheers
Worik

-- 
You do not have to be blind to not see what is going on right in front of you if it is behind your back
Pascall West
--


From worik.stanton at gmail.com  Wed Oct  6 00:04:28 2010
From: worik.stanton at gmail.com (Worik)
Date: Wed, 06 Oct 2010 11:04:28 +1300
Subject: [R-SIG-Finance] xts question:  Extract rows with an NA
In-Reply-To: <4CAB9F11.6080000@gmail.com>
References: <4CAB9F11.6080000@gmail.com>
Message-ID: <4CABA0EC.1040002@gmail.com>

On 06/10/10 10:56, Worik wrote:
> I wish to extract rows from an xts object that have a NA entry.  I can 
> use na.omit to exclude those rows, but I can find no simple way to 
> include them.
>
> Is there such a way?
>
> > X <- xts(cbind(c(1,2,3), c(1,NA,5)), Sys.Date()+1:3)

OK.  I can say:
 > X[is.na(X[,1]) | is.na(X[,2])]
            [,1] [,2]
2010-10-08    2   NA

This solves my immediate problem.  But is there a generic way that would 
work for any number of columns?

Worik


-- 
You do not have to be blind to not see what is going on right in front of you if it is behind your back
Pascall West
--


From josh.m.ulrich at gmail.com  Wed Oct  6 00:08:51 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 5 Oct 2010 17:08:51 -0500
Subject: [R-SIG-Finance] xts question: Extract rows with an NA
In-Reply-To: <4CABA0EC.1040002@gmail.com>
References: <4CAB9F11.6080000@gmail.com> <4CABA0EC.1040002@gmail.com>
Message-ID: <AANLkTik+Fx=zeygD6Xa8avmxazO3Y078mNSkVmgRjx7Z@mail.gmail.com>

You could use complete.cases():

> X[!complete.cases(X),]
           [,1] [,2]
2010-10-07    2   NA

Best,
--
Joshua Ulrich
FOSS Trading: www.fosstrading.com



On Tue, Oct 5, 2010 at 5:04 PM, Worik <worik.stanton at gmail.com> wrote:
> On 06/10/10 10:56, Worik wrote:
>>
>> I wish to extract rows from an xts object that have a NA entry. ?I can use
>> na.omit to exclude those rows, but I can find no simple way to include them.
>>
>> Is there such a way?
>>
>> > X <- xts(cbind(c(1,2,3), c(1,NA,5)), Sys.Date()+1:3)
>
> OK. ?I can say:
>> X[is.na(X[,1]) | is.na(X[,2])]
> ? ? ? ? ? [,1] [,2]
> 2010-10-08 ? ?2 ? NA
>
> This solves my immediate problem. ?But is there a generic way that would
> work for any number of columns?
>
> Worik
>
>
> --
> You do not have to be blind to not see what is going on right in front of
> you if it is behind your back
> Pascall West
> --
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From breman.mark at gmail.com  Wed Oct  6 11:28:15 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Wed, 6 Oct 2010 11:28:15 +0200
Subject: [R-SIG-Finance] Help needed with advanced tradesys package
Message-ID: <AANLkTin1T8k8sn_9nFv3c3OU_-sPzcSmCoMMihTcsz-W@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101006/b0fdb2c5/attachment.pl>

From Samuel.Meichtry at bkw-fmb.ch  Wed Oct  6 15:08:44 2010
From: Samuel.Meichtry at bkw-fmb.ch (Samuel.Meichtry at bkw-fmb.ch)
Date: Wed, 6 Oct 2010 15:08:44 +0200
Subject: [R-SIG-Finance] Matlab vs. R performance/convenience benchmarking
 for quantitative analysis business
Message-ID: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101006/8e2a1052/attachment.pl>

From fjpcaballero at gmail.com  Wed Oct  6 18:37:51 2010
From: fjpcaballero at gmail.com (fjpcaballero at gmail.com)
Date: Wed, 6 Oct 2010 12:37:51 -0400
Subject: [R-SIG-Finance] Matlab vs. R performance/convenience
	benchmarking for quantitative analysis business
In-Reply-To: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
References: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
Message-ID: <E27BD539-BA01-4423-BC17-0C6B32205449@gmail.com>

Note that this benchmark appears to be using non-optimized BLAS libraries.  Speed of matrix operations should be comparable to Matlab when using ATLAS, Intel mkl, vecLib, or Goto.  Loops are a different story.  Even with Ra and JIT, R is a far cry from Matlab.

My personal take:

Pro Matlab: compact and clean syntax, good IDE and tooling, more efficient (e.g. pass by reference, loop optimization), some very good toolboxes not available elsewhere (eg CVX, Murphy's BBN toolbox)

Against Matlab: it is a pain to work with anything that doesn't look like a matrix; lags behind R in methods available, licensing costs

Pro R: (much) broader selection of methods -- at least in machine learning, survival analysis, and finance; named arguments in functions, easier to work with mixed data (eg dataframes), better statistics-oriented graphics (e.g. Lattice, ggplot), better interactive graphics [for my taste] (rggobi, iplots), licensing costs

Against R: performance issues previously discussed, pretty ugly code, lack of a good IDE -- all the ones I have tested lack an integrated debugger and profiler, steep learning curve.



On Oct 6, 2010, at 9:08 AM, <Samuel.Meichtry at bkw-fmb.ch> wrote:

> Hello everyone,
> 
> At the moment we are trying to decide which software to use for quantitative analysis and the following Link about performance doesn't really vote for R (http://mlg.eng.cam.ac.uk/dave/rmbenchmark.php).
> 
> I am not against Matlab and cannot say anything about its convenience because I haven't worked with it for a long time. On the other hand Matlab is already heavily used in other departments in our company and we have to tell our project committee why we would like to use R instead.
> 
> Now I am very interested to know why you are using R in your business and not Matlab?
> Or do you use both of them?
> 
> Thank you very much for your feedback!
> 
> 
> Kind regards,
> Samuel Meichtry
> 
> 
> ____________________________________________
> BKW FMB Energie AG
> Energy Trading
> Samuel Meichtry
> Analyst Energy Trading
> Tel +41 31 330 53 99
> Fax +41 31 330 56 16
> e-mail samuel.meichtry at bkw-fmb.ch
> 
> *  Sie drucken dieses E-Mail nicht aus? Die Umwelt dankt!
> 
> 
> 
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ezivot at u.washington.edu  Wed Oct  6 20:02:18 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Wed, 6 Oct 2010 11:02:18 -0700
Subject: [R-SIG-Finance] Matlab vs. R
	performance/convenience	benchmarking for quantitative
	analysis business
In-Reply-To: <E27BD539-BA01-4423-BC17-0C6B32205449@gmail.com>
References: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
	<E27BD539-BA01-4423-BC17-0C6B32205449@gmail.com>
Message-ID: <005601cb6580$9df1a630$d9d4f290$@washington.edu>

Something in between free R and Matlab to consider is RevolutionR (I don't
work for them, please don't flame me). It uses optimized math libraries, has
a very nice IDE and is set-up for parallel computing out-of-the box. I don't
know what their corporate pricing is but it has to be cheaper than Matlab.
Below is a comparison (taken from the Revolution documentation) between the
optimized math libraries and the standard R libraries for certain
computations:

Calculation			Regular R			Optimized
libraries
Eigen				11.45				3.63
Svd				7.34				1.19
Qr				1.17				0.93
Lm				1.47				1.23
Matrix mult			1.75				0.09

Note: Mean times for various calculations below

set.seed(14)
x <- matrix(rnorm(1000000),nrow=1000)
xout <- numeric(20)
for (i in 1:20) xout[i] <- system.time(eigen(x))[3]
xout2 <- numeric(20)
for (i in 1:20) xout2[i] <- system.time(svd(x))[3]
xout3 <- numeric(20)
for (i in 1:20) xout3[i] <- system.time(qr(x))[3]
xout4 <- numeric(20)
for (i in 1:20) xout4[i] <- system.time(lm(x[,i]~x[,-i]))[3]
xout5 <- numeric(20)
for (i in 1:20) xout5[i] <- system.time(t(x)%*%x)[3]



Eric Zivot                  			               
Robert Richards Chaired Professor of Economics
Adjunct Professor of Finance                            
Adjunct Professor of Statistics
Department of Economics
Box 353330                  email:  ezivot at u.washington.edu 
University of Washington    phone:  206-543-6715            
Seattle, WA 98195-3330
www:  http://faculty.washington.edu/ezivot                  


-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of
fjpcaballero at gmail.com
Sent: Wednesday, October 06, 2010 9:38 AM
To: <Samuel.Meichtry at bkw-fmb.ch>
Cc: <r-sig-finance at stat.math.ethz.ch>
Subject: Re: [R-SIG-Finance] Matlab vs. R performance/convenience
benchmarking for quantitative analysis business

Note that this benchmark appears to be using non-optimized BLAS libraries.
Speed of matrix operations should be comparable to Matlab when using ATLAS,
Intel mkl, vecLib, or Goto.  Loops are a different story.  Even with Ra and
JIT, R is a far cry from Matlab.

My personal take:

Pro Matlab: compact and clean syntax, good IDE and tooling, more efficient
(e.g. pass by reference, loop optimization), some very good toolboxes not
available elsewhere (eg CVX, Murphy's BBN toolbox)

Against Matlab: it is a pain to work with anything that doesn't look like a
matrix; lags behind R in methods available, licensing costs

Pro R: (much) broader selection of methods -- at least in machine learning,
survival analysis, and finance; named arguments in functions, easier to work
with mixed data (eg dataframes), better statistics-oriented graphics (e.g.
Lattice, ggplot), better interactive graphics [for my taste] (rggobi,
iplots), licensing costs

Against R: performance issues previously discussed, pretty ugly code, lack
of a good IDE -- all the ones I have tested lack an integrated debugger and
profiler, steep learning curve.



On Oct 6, 2010, at 9:08 AM, <Samuel.Meichtry at bkw-fmb.ch> wrote:

> Hello everyone,
> 
> At the moment we are trying to decide which software to use for
quantitative analysis and the following Link about performance doesn't
really vote for R (http://mlg.eng.cam.ac.uk/dave/rmbenchmark.php).
> 
> I am not against Matlab and cannot say anything about its convenience
because I haven't worked with it for a long time. On the other hand Matlab
is already heavily used in other departments in our company and we have to
tell our project committee why we would like to use R instead.
> 
> Now I am very interested to know why you are using R in your business and
not Matlab?
> Or do you use both of them?
> 
> Thank you very much for your feedback!
> 
> 
> Kind regards,
> Samuel Meichtry
> 
> 
> ____________________________________________
> BKW FMB Energie AG
> Energy Trading
> Samuel Meichtry
> Analyst Energy Trading
> Tel +41 31 330 53 99
> Fax +41 31 330 56 16
> e-mail samuel.meichtry at bkw-fmb.ch
> 
> *  Sie drucken dieses E-Mail nicht aus? Die Umwelt dankt!
> 
> 
> 
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
should go.

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From tobias.verbeke at openanalytics.eu  Wed Oct  6 21:03:52 2010
From: tobias.verbeke at openanalytics.eu (Tobias Verbeke)
Date: Wed, 06 Oct 2010 21:03:52 +0200
Subject: [R-SIG-Finance] Matlab vs. R performance/convenience
 benchmarking for quantitative analysis business
In-Reply-To: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
References: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
Message-ID: <4CACC818.2070807@openanalytics.eu>

Hi Samuel,

We have been integrating R in corporate environments
(finance, pharmaceuticals, media, ...) for many years
and have done much more migrations from Matlab to R than
the other way around.

Some of the advantages:

1) the statistical community is using R as its lingua franca;
you therefore have much more chance to take benefit of novel
methods as R packages appear with the papers and as these are
likely to be taken up only later by the Matlab world.

2) you avoid all hassles of license management and have no
license fees to pay for server use of R whatever number of
CPUs, users, etc.

3) R packages have a much richer structure than Matlab toolboxes
and out-of-the-box support inclusion of technical documentation, 
functional user guides, automated software testing etc. inside
one standardized unit.

4) if there is a need to interact with suppliers or research
partners, R does not imply any threshold for these partners as
it can just be downloaded from the internet.

Matlab does have the advantage that you can make executables
of Matlab code to distribute to end users, but in R world this
type of problems is more commonly solved by working in
client-server mode (with desktop clients or web clients)
or embedding R inside the application.

In terms of the language, R is much more pragmatic than Matlab
and its data types are more suited to statistical analysis
(categorical variables, ordered categorical variables) than
the Matlab ones (where a plain string e.g. is represented as
a matrix). In some other domains of applied mathematics,
though, (say computational fluid dynamics or engineering)
Matlab is likely to have more functionality to offer.

With respect to the benchmark, it seems to be quite outdated
and besides progress made in recent years, there is quite a
number of tools to tackle performance issues if the application
requires it

http://cran.r-project.org/web/views/HighPerformanceComputing.html

Also, R can be used to conveniently wrap C, c++, Fortran or Java
code for parts of code where performance is important.

In terms of IDE, the Eclipse/StatET environment is the equivalent
of the Matlab GUI and used by most of our customers.

Best,
Tobias

-- 

Tobias Verbeke
Manager

OpenAnalytics BVBA
Kortestraat 30A
2220 Heist-op-den-Berg
Belgium

E tobias.verbeke at openanalytics.eu
M +32 499 36 33 15

http://www.openanalytics.eu


From fjpcaballero at gmail.com  Wed Oct  6 21:24:44 2010
From: fjpcaballero at gmail.com (fjpcaballero at gmail.com)
Date: Wed, 6 Oct 2010 15:24:44 -0400
Subject: [R-SIG-Finance] Matlab vs.
	R	performance/convenience	benchmarking for
	quantitative	analysis business
In-Reply-To: <4CACBFB2.4030707@openanalytics.eu>
References: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
	<E27BD539-BA01-4423-BC17-0C6B32205449@gmail.com>
	<005601cb6580$9df1a630$d9d4f290$@washington.edu>
	<4CACBFB2.4030707@openanalytics.eu>
Message-ID: <6656BD1F-9017-496C-82C9-DF040766E100@gmail.com>

Eclipse+StatEt is probably the best one, but unfortunately it is still missing a debugger, profiler, and even object inspection inside functions.

I tested ATLAS and Goto on Linux 64 and I couldn't match the performance of Revolution-R.  I guess credit shall go to Intel's compiler suite and Mkl, but that said, I once tried to compile R using Intel's suite and I gave up out of boredom after a day trying to get compiler suite installing correctly. I can easily imagine that budget-insensitive people may be more than willing to pay for the support.



On Oct 6, 2010, at 2:28 PM, Tobias Verbeke <tobias.verbeke at openanalytics.eu> wrote:

> L.S.
> 
> 1) For a good IDE one can use Eclipse with the StatET plug-ins
> for R development (which, moreover, is cross-platform);
> 
> 2) It is perfectly possible to use an optimized open source BLAS with
> R such as Atlas, so there are many more Optimized R versions than the
> Revolution marketing wants one to believe (and it is not at all
> necessary to get trapped in closed source environments to have
> equivalent tools).
> 
> Best,
> Tobias
> 
> On 10/06/2010 08:02 PM, Eric Zivot wrote:
>> Something in between free R and Matlab to consider is RevolutionR (I don't
>> work for them, please don't flame me). It uses optimized math libraries, has
>> a very nice IDE and is set-up for parallel computing out-of-the box. I don't
>> know what their corporate pricing is but it has to be cheaper than Matlab.
>> Below is a comparison (taken from the Revolution documentation) between the
>> optimized math libraries and the standard R libraries for certain
>> computations:
>> 
>> Calculation            Regular R            Optimized
>> libraries
>> Eigen                11.45                3.63
>> Svd                7.34                1.19
>> Qr                1.17                0.93
>> Lm                1.47                1.23
>> Matrix mult            1.75                0.09
>> 
>> Note: Mean times for various calculations below
>> 
>> set.seed(14)
>> x<- matrix(rnorm(1000000),nrow=1000)
>> xout<- numeric(20)
>> for (i in 1:20) xout[i]<- system.time(eigen(x))[3]
>> xout2<- numeric(20)
>> for (i in 1:20) xout2[i]<- system.time(svd(x))[3]
>> xout3<- numeric(20)
>> for (i in 1:20) xout3[i]<- system.time(qr(x))[3]
>> xout4<- numeric(20)
>> for (i in 1:20) xout4[i]<- system.time(lm(x[,i]~x[,-i]))[3]
>> xout5<- numeric(20)
>> for (i in 1:20) xout5[i]<- system.time(t(x)%*%x)[3]
>> 
>> 
>> 
>> Eric Zivot                              
>> Robert Richards Chaired Professor of Economics
>> Adjunct Professor of Finance
>> Adjunct Professor of Statistics
>> Department of Economics
>> Box 353330                  email:  ezivot at u.washington.edu
>> University of Washington    phone:  206-543-6715
>> Seattle, WA 98195-3330
>> www:  http://faculty.washington.edu/ezivot
>> 
>> 
>> -----Original Message-----
>> From: r-sig-finance-bounces at stat.math.ethz.ch
>> [mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of
>> fjpcaballero at gmail.com
>> Sent: Wednesday, October 06, 2010 9:38 AM
>> To:<Samuel.Meichtry at bkw-fmb.ch>
>> Cc:<r-sig-finance at stat.math.ethz.ch>
>> Subject: Re: [R-SIG-Finance] Matlab vs. R performance/convenience
>> benchmarking for quantitative analysis business
>> 
>> Note that this benchmark appears to be using non-optimized BLAS libraries.
>> Speed of matrix operations should be comparable to Matlab when using ATLAS,
>> Intel mkl, vecLib, or Goto.  Loops are a different story.  Even with Ra and
>> JIT, R is a far cry from Matlab.
>> 
>> My personal take:
>> 
>> Pro Matlab: compact and clean syntax, good IDE and tooling, more efficient
>> (e.g. pass by reference, loop optimization), some very good toolboxes not
>> available elsewhere (eg CVX, Murphy's BBN toolbox)
>> 
>> Against Matlab: it is a pain to work with anything that doesn't look like a
>> matrix; lags behind R in methods available, licensing costs
>> 
>> Pro R: (much) broader selection of methods -- at least in machine learning,
>> survival analysis, and finance; named arguments in functions, easier to work
>> with mixed data (eg dataframes), better statistics-oriented graphics (e.g.
>> Lattice, ggplot), better interactive graphics [for my taste] (rggobi,
>> iplots), licensing costs
>> 
>> Against R: performance issues previously discussed, pretty ugly code, lack
>> of a good IDE -- all the ones I have tested lack an integrated debugger and
>> profiler, steep learning curve.
>> 
>> 
>> 
>> On Oct 6, 2010, at 9:08 AM,<Samuel.Meichtry at bkw-fmb.ch>  wrote:
>> 
>>> Hello everyone,
>>> 
>>> At the moment we are trying to decide which software to use for
>> quantitative analysis and the following Link about performance doesn't
>> really vote for R (http://mlg.eng.cam.ac.uk/dave/rmbenchmark.php).
>>> 
>>> I am not against Matlab and cannot say anything about its convenience
>> because I haven't worked with it for a long time. On the other hand Matlab
>> is already heavily used in other departments in our company and we have to
>> tell our project committee why we would like to use R instead.
>>> 
>>> Now I am very interested to know why you are using R in your business and
>> not Matlab?
>>> Or do you use both of them?
>>> 
>>> Thank you very much for your feedback!
>>> 
>>> 
>>> Kind regards,
>>> Samuel Meichtry
>>> 
>>> 
>>> ____________________________________________
>>> BKW FMB Energie AG
>>> Energy Trading
>>> Samuel Meichtry
>>> Analyst Energy Trading
>>> Tel +41 31 330 53 99
>>> Fax +41 31 330 56 16
>>> e-mail samuel.meichtry at bkw-fmb.ch
>>> 
>>> *  Sie drucken dieses E-Mail nicht aus? Die Umwelt dankt!
>>> 
>>> 
>>> 
>>> 
>>>    [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>> should go.
>> 
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>> 
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>> 
> 


From tobias.verbeke at openanalytics.eu  Wed Oct  6 21:52:02 2010
From: tobias.verbeke at openanalytics.eu (Tobias Verbeke)
Date: Wed, 06 Oct 2010 21:52:02 +0200
Subject: [R-SIG-Finance] Matlab vs.
 R	performance/convenience	benchmarking for quantitative	analysis business
In-Reply-To: <6656BD1F-9017-496C-82C9-DF040766E100@gmail.com>
References: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
	<E27BD539-BA01-4423-BC17-0C6B32205449@gmail.com>
	<005601cb6580$9df1a630$d9d4f290$@washington.edu>
	<4CACBFB2.4030707@openanalytics.eu>
	<6656BD1F-9017-496C-82C9-DF040766E100@gmail.com>
Message-ID: <4CACD362.5080603@openanalytics.eu>

Hi,

I agree with most of your comments, but

1) my point is certainly not against paying for commercial
    services (I manage a consulting firm, by the way), but
    against losing the benefits open source and cross-platform
    software has in commercial environments;

2) according to the benchmarks of Dirk Eddelbuettel (slides 46
    to 49 of)

    http://dirk.eddelbuettel.com/papers/useR2010hpcTutorial.pdf

    differences between Goto and Intel seem to be really small

3) even if Atlas or Goto would not match the performance of
    the Intel BLAS, linear algebra routines are just a part
    of statistical routines and not always _the_ performance
    bottleneck in real life scenarios. Requests to speed up
    R code have so far only been a tiny, tiny part of requests
    we got.

Just wanted to put the marketing in perspective.

Best,
Tobias


On 10/06/2010 09:24 PM, fjpcaballero at gmail.com wrote:
> Eclipse+StatEt is probably the best one, but unfortunately it is still missing a debugger, profiler, and even object inspection inside functions.
>
> I tested ATLAS and Goto on Linux 64 and I couldn't match the performance of Revolution-R.  I guess credit shall go to Intel's compiler suite and Mkl, but that said, I once tried to compile R using Intel's suite and I gave up out of boredom after a day trying to get compiler suite installing correctly. I can easily imagine that budget-insensitive people may be more than willing to pay for the support.
>
>
>
> On Oct 6, 2010, at 2:28 PM, Tobias Verbeke<tobias.verbeke at openanalytics.eu>  wrote:
>
>> L.S.
>>
>> 1) For a good IDE one can use Eclipse with the StatET plug-ins
>> for R development (which, moreover, is cross-platform);
>>
>> 2) It is perfectly possible to use an optimized open source BLAS with
>> R such as Atlas, so there are many more Optimized R versions than the
>> Revolution marketing wants one to believe (and it is not at all
>> necessary to get trapped in closed source environments to have
>> equivalent tools).
>>
>> Best,
>> Tobias
>>
>> On 10/06/2010 08:02 PM, Eric Zivot wrote:
>>> Something in between free R and Matlab to consider is RevolutionR (I don't
>>> work for them, please don't flame me). It uses optimized math libraries, has
>>> a very nice IDE and is set-up for parallel computing out-of-the box. I don't
>>> know what their corporate pricing is but it has to be cheaper than Matlab.
>>> Below is a comparison (taken from the Revolution documentation) between the
>>> optimized math libraries and the standard R libraries for certain
>>> computations:
>>>
>>> Calculation            Regular R            Optimized
>>> libraries
>>> Eigen                11.45                3.63
>>> Svd                7.34                1.19
>>> Qr                1.17                0.93
>>> Lm                1.47                1.23
>>> Matrix mult            1.75                0.09
>>>
>>> Note: Mean times for various calculations below
>>>
>>> set.seed(14)
>>> x<- matrix(rnorm(1000000),nrow=1000)
>>> xout<- numeric(20)
>>> for (i in 1:20) xout[i]<- system.time(eigen(x))[3]
>>> xout2<- numeric(20)
>>> for (i in 1:20) xout2[i]<- system.time(svd(x))[3]
>>> xout3<- numeric(20)
>>> for (i in 1:20) xout3[i]<- system.time(qr(x))[3]
>>> xout4<- numeric(20)
>>> for (i in 1:20) xout4[i]<- system.time(lm(x[,i]~x[,-i]))[3]
>>> xout5<- numeric(20)
>>> for (i in 1:20) xout5[i]<- system.time(t(x)%*%x)[3]
>>>
>>>
>>>
>>> Eric Zivot
>>> Robert Richards Chaired Professor of Economics
>>> Adjunct Professor of Finance
>>> Adjunct Professor of Statistics
>>> Department of Economics
>>> Box 353330                  email:  ezivot at u.washington.edu
>>> University of Washington    phone:  206-543-6715
>>> Seattle, WA 98195-3330
>>> www:  http://faculty.washington.edu/ezivot
>>>
>>>
>>> -----Original Message-----
>>> From: r-sig-finance-bounces at stat.math.ethz.ch
>>> [mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of
>>> fjpcaballero at gmail.com
>>> Sent: Wednesday, October 06, 2010 9:38 AM
>>> To:<Samuel.Meichtry at bkw-fmb.ch>
>>> Cc:<r-sig-finance at stat.math.ethz.ch>
>>> Subject: Re: [R-SIG-Finance] Matlab vs. R performance/convenience
>>> benchmarking for quantitative analysis business
>>>
>>> Note that this benchmark appears to be using non-optimized BLAS libraries.
>>> Speed of matrix operations should be comparable to Matlab when using ATLAS,
>>> Intel mkl, vecLib, or Goto.  Loops are a different story.  Even with Ra and
>>> JIT, R is a far cry from Matlab.
>>>
>>> My personal take:
>>>
>>> Pro Matlab: compact and clean syntax, good IDE and tooling, more efficient
>>> (e.g. pass by reference, loop optimization), some very good toolboxes not
>>> available elsewhere (eg CVX, Murphy's BBN toolbox)
>>>
>>> Against Matlab: it is a pain to work with anything that doesn't look like a
>>> matrix; lags behind R in methods available, licensing costs
>>>
>>> Pro R: (much) broader selection of methods -- at least in machine learning,
>>> survival analysis, and finance; named arguments in functions, easier to work
>>> with mixed data (eg dataframes), better statistics-oriented graphics (e.g.
>>> Lattice, ggplot), better interactive graphics [for my taste] (rggobi,
>>> iplots), licensing costs
>>>
>>> Against R: performance issues previously discussed, pretty ugly code, lack
>>> of a good IDE -- all the ones I have tested lack an integrated debugger and
>>> profiler, steep learning curve.
>>>
>>>
>>>
>>> On Oct 6, 2010, at 9:08 AM,<Samuel.Meichtry at bkw-fmb.ch>   wrote:
>>>
>>>> Hello everyone,
>>>>
>>>> At the moment we are trying to decide which software to use for
>>> quantitative analysis and the following Link about performance doesn't
>>> really vote for R (http://mlg.eng.cam.ac.uk/dave/rmbenchmark.php).
>>>>
>>>> I am not against Matlab and cannot say anything about its convenience
>>> because I haven't worked with it for a long time. On the other hand Matlab
>>> is already heavily used in other departments in our company and we have to
>>> tell our project committee why we would like to use R instead.
>>>>
>>>> Now I am very interested to know why you are using R in your business and
>>> not Matlab?
>>>> Or do you use both of them?
>>>>
>>>> Thank you very much for your feedback!
>>>>
>>>>
>>>> Kind regards,
>>>> Samuel Meichtry
>>>>
>>>>
>>>> ____________________________________________
>>>> BKW FMB Energie AG
>>>> Energy Trading
>>>> Samuel Meichtry
>>>> Analyst Energy Trading
>>>> Tel +41 31 330 53 99
>>>> Fax +41 31 330 56 16
>>>> e-mail samuel.meichtry at bkw-fmb.ch
>>>>
>>>> *  Sie drucken dieses E-Mail nicht aus? Die Umwelt dankt!
>>>>
>>>>
>>>>
>>>>
>>>>     [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>>
>>
>


From edd at debian.org  Wed Oct  6 21:58:35 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 6 Oct 2010 14:58:35 -0500
Subject: [R-SIG-Finance] Matlab
	vs.	R	performance/convenience	benchmarking
	for	quantitative	analysis business
In-Reply-To: <6656BD1F-9017-496C-82C9-DF040766E100@gmail.com>
References: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
	<E27BD539-BA01-4423-BC17-0C6B32205449@gmail.com>
	<005601cb6580$9df1a630$d9d4f290$@washington.edu>
	<4CACBFB2.4030707@openanalytics.eu>
	<6656BD1F-9017-496C-82C9-DF040766E100@gmail.com>
Message-ID: <19628.54507.726774.805674@max.nulle.part>


On 6 October 2010 at 15:24, fjpcaballero at gmail.com wrote:
| I tested ATLAS and Goto on Linux 64 and I couldn't match the performance of
| Revolution-R.  I guess credit shall go to Intel's compiler suite and Mkl,
| but that said,  


I recently wrote a paper/package combination benchmarking different BLAS as
well as a GPU solution. Please see 

     http://dirk.eddelbuettel.com/blog/code/gcbd/ 

for two posts on this alongside with summary charts and links to the paper.

In short, Goto is pretty and about the same as MKL. The newest Atlas is also
pretty good when built multithreaded.

[ And the benchmark that Eric quotes looked surprisingly snake-oilish: wasn't
  that merely single-threaded versus multi-threaded BLAS?  You can easily do
  get that by swapping BLAS libraries as my paper argues. Moreover, for tests
  that do more realistic R work outside of core linear algebra, the effects
  will be nowhere near as drastic -- Amdahl's Law and all that.  ]

| I once tried to compile R using Intel's suite and I gave up out of boredom
| after a day trying to get compiler suite installing correctly. I can easily

I have been meaning to get back to testing Intel's 'icc' compiler but have
not gotten around to it as there are only so many hours in the day...

| imagine that budget-insensitive people may be more than willing to pay for
| the support. 

Well, you do get multithreaded BLAS for free in several places, and easy
solutions for parallel computing (such as the excellent multicore) are also
easy to deploy.  

As for the earlier Matlab comparison: I would second Tobias' points about
ease of deployment and lack of license hazzles, unsurpassed richness of CRAN
libraries, possibility of client/server computing (eg via Rapache by Jeff
Horner), and easy extensibility -- I am somewhat partial to Rcpp there.

Dirk


| On Oct 6, 2010, at 2:28 PM, Tobias Verbeke <tobias.verbeke at openanalytics.eu> wrote:
| 
| > L.S.
| > 
| > 1) For a good IDE one can use Eclipse with the StatET plug-ins
| > for R development (which, moreover, is cross-platform);
| > 
| > 2) It is perfectly possible to use an optimized open source BLAS with
| > R such as Atlas, so there are many more Optimized R versions than the
| > Revolution marketing wants one to believe (and it is not at all
| > necessary to get trapped in closed source environments to have
| > equivalent tools).
| > 
| > Best,
| > Tobias
| > 
| > On 10/06/2010 08:02 PM, Eric Zivot wrote:
| >> Something in between free R and Matlab to consider is RevolutionR (I don't
| >> work for them, please don't flame me). It uses optimized math libraries, has
| >> a very nice IDE and is set-up for parallel computing out-of-the box. I don't
| >> know what their corporate pricing is but it has to be cheaper than Matlab.
| >> Below is a comparison (taken from the Revolution documentation) between the
| >> optimized math libraries and the standard R libraries for certain
| >> computations:
| >> 
| >> Calculation            Regular R            Optimized
| >> libraries
| >> Eigen                11.45                3.63
| >> Svd                7.34                1.19
| >> Qr                1.17                0.93
| >> Lm                1.47                1.23
| >> Matrix mult            1.75                0.09
| >> 
| >> Note: Mean times for various calculations below
| >> 
| >> set.seed(14)
| >> x<- matrix(rnorm(1000000),nrow=1000)
| >> xout<- numeric(20)
| >> for (i in 1:20) xout[i]<- system.time(eigen(x))[3]
| >> xout2<- numeric(20)
| >> for (i in 1:20) xout2[i]<- system.time(svd(x))[3]
| >> xout3<- numeric(20)
| >> for (i in 1:20) xout3[i]<- system.time(qr(x))[3]
| >> xout4<- numeric(20)
| >> for (i in 1:20) xout4[i]<- system.time(lm(x[,i]~x[,-i]))[3]
| >> xout5<- numeric(20)
| >> for (i in 1:20) xout5[i]<- system.time(t(x)%*%x)[3]
| >> 
| >> 
| >> 
| >> Eric Zivot                              
| >> Robert Richards Chaired Professor of Economics
| >> Adjunct Professor of Finance
| >> Adjunct Professor of Statistics
| >> Department of Economics
| >> Box 353330                  email:  ezivot at u.washington.edu
| >> University of Washington    phone:  206-543-6715
| >> Seattle, WA 98195-3330
| >> www:  http://faculty.washington.edu/ezivot
| >> 
| >> 
| >> -----Original Message-----
| >> From: r-sig-finance-bounces at stat.math.ethz.ch
| >> [mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of
| >> fjpcaballero at gmail.com
| >> Sent: Wednesday, October 06, 2010 9:38 AM
| >> To:<Samuel.Meichtry at bkw-fmb.ch>
| >> Cc:<r-sig-finance at stat.math.ethz.ch>
| >> Subject: Re: [R-SIG-Finance] Matlab vs. R performance/convenience
| >> benchmarking for quantitative analysis business
| >> 
| >> Note that this benchmark appears to be using non-optimized BLAS libraries.
| >> Speed of matrix operations should be comparable to Matlab when using ATLAS,
| >> Intel mkl, vecLib, or Goto.  Loops are a different story.  Even with Ra and
| >> JIT, R is a far cry from Matlab.
| >> 
| >> My personal take:
| >> 
| >> Pro Matlab: compact and clean syntax, good IDE and tooling, more efficient
| >> (e.g. pass by reference, loop optimization), some very good toolboxes not
| >> available elsewhere (eg CVX, Murphy's BBN toolbox)
| >> 
| >> Against Matlab: it is a pain to work with anything that doesn't look like a
| >> matrix; lags behind R in methods available, licensing costs
| >> 
| >> Pro R: (much) broader selection of methods -- at least in machine learning,
| >> survival analysis, and finance; named arguments in functions, easier to work
| >> with mixed data (eg dataframes), better statistics-oriented graphics (e.g.
| >> Lattice, ggplot), better interactive graphics [for my taste] (rggobi,
| >> iplots), licensing costs
| >> 
| >> Against R: performance issues previously discussed, pretty ugly code, lack
| >> of a good IDE -- all the ones I have tested lack an integrated debugger and
| >> profiler, steep learning curve.
| >> 
| >> 
| >> 
| >> On Oct 6, 2010, at 9:08 AM,<Samuel.Meichtry at bkw-fmb.ch>  wrote:
| >> 
| >>> Hello everyone,
| >>> 
| >>> At the moment we are trying to decide which software to use for
| >> quantitative analysis and the following Link about performance doesn't
| >> really vote for R (http://mlg.eng.cam.ac.uk/dave/rmbenchmark.php).
| >>> 
| >>> I am not against Matlab and cannot say anything about its convenience
| >> because I haven't worked with it for a long time. On the other hand Matlab
| >> is already heavily used in other departments in our company and we have to
| >> tell our project committee why we would like to use R instead.
| >>> 
| >>> Now I am very interested to know why you are using R in your business and
| >> not Matlab?
| >>> Or do you use both of them?
| >>> 
| >>> Thank you very much for your feedback!
| >>> 
| >>> 
| >>> Kind regards,
| >>> Samuel Meichtry
| >>> 
| >>> 
| >>> ____________________________________________
| >>> BKW FMB Energie AG
| >>> Energy Trading
| >>> Samuel Meichtry
| >>> Analyst Energy Trading
| >>> Tel +41 31 330 53 99
| >>> Fax +41 31 330 56 16
| >>> e-mail samuel.meichtry at bkw-fmb.ch
| >>> 
| >>> *  Sie drucken dieses E-Mail nicht aus? Die Umwelt dankt!
| >>> 
| >>> 
| >>> 
| >>> 
| >>>    [[alternative HTML version deleted]]
| >>> 
| >>> _______________________________________________
| >>> R-SIG-Finance at stat.math.ethz.ch mailing list
| >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| >>> -- Subscriber-posting only. If you want to post, subscribe first.
| >>> -- Also note that this is not the r-help list where general R questions
| >> should go.
| >> 
| >> _______________________________________________
| >> R-SIG-Finance at stat.math.ethz.ch mailing list
| >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| >> -- Subscriber-posting only. If you want to post, subscribe first.
| >> -- Also note that this is not the r-help list where general R questions
| >> should go.
| >> 
| >> _______________________________________________
| >> R-SIG-Finance at stat.math.ethz.ch mailing list
| >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| >> -- Subscriber-posting only. If you want to post, subscribe first.
| >> -- Also note that this is not the r-help list where general R questions should go.
| >> 
| > 
| 
| _______________________________________________
| R-SIG-Finance at stat.math.ethz.ch mailing list
| https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| -- Subscriber-posting only. If you want to post, subscribe first.
| -- Also note that this is not the r-help list where general R questions should go.

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From stephen at organicfoodmarkets.com.au  Thu Oct  7 07:26:04 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Thu, 07 Oct 2010 16:26:04 +1100
Subject: [R-SIG-Finance] downloading prices for Australian 90 day bank bills
 and 3 and 10, year bonds
Message-ID: <4CAD59EC.2050002@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101007/0dee755c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101007/0dee755c/attachment.jpe>

From Patrick.Caldon at morningstar.com  Thu Oct  7 07:40:53 2010
From: Patrick.Caldon at morningstar.com (Patrick Caldon)
Date: Thu, 7 Oct 2010 00:40:53 -0500
Subject: [R-SIG-Finance] downloading prices for Australian 90 day bank
	bills and 3 and 10, year bonds
In-Reply-To: <4CAD59EC.2050002@organicfoodmarkets.com.au>
Message-ID: <6FE132B7E337C744AB4B49ED2307114D0600D5B1@msex89.morningstar.com>

Australian 90-Day Bank Bill prices are licensed by AFMA who started
charging fees on them as of about a year ago.  I don't think the
historical data is freely available anywhere now.

 

________________________________
Patrick Caldon
Quantitative Analyst
Morningstar Australasia Pty Ltd.

Morningstar, illuminating investing worldwide.

+61 2 9276 4473 voice
+61 2 9276 4545 fax
patrick.caldon at morningstar.com

This e-mail contains privileged and confidential information and is
intended only for the use of the person(s) named above. Any
dissemination, distribution or duplication of this communication without
prior written consent from Morningstar is strictly prohibited. If you
received this message in error please contact the sender immediately and
delete the materials from any computer.



________________________________

From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Stephen
Choularton
Sent: Thursday, 7 October 2010 4:26 PM
To: r-sig-finance at stat.math.ethz.ch
Subject: [R-SIG-Finance] downloading prices for Australian 90 day bank
bills and 3 and 10, year bonds



I have been trying to download these prices from Yahoo (of course they
may not keep them - does anyone know?) using all sorts of combinations
like IR.AX or IR.SFE or XTF or XTSYZ0.AX.  None of them work.

Can anyone point me to where I can find the correct symbols?

-- 
Stephen Choularton Ph.D., FIoD

9999 2226
0413 545 182


for insurance go to www.netinsure.com.au
for markets go to www.organicfoodmarkets.com.au

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101007/11bd365c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 16091 bytes
Desc: image001.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101007/11bd365c/attachment.jpe>

From guygreen at netvigator.com  Thu Oct  7 07:47:17 2010
From: guygreen at netvigator.com (Guy Green)
Date: Wed, 6 Oct 2010 22:47:17 -0700 (PDT)
Subject: [R-SIG-Finance] downloading prices for Australian 90 day bank
 bills and 3 and 10, year bonds
In-Reply-To: <4CAD59EC.2050002@organicfoodmarkets.com.au>
References: <4CAD59EC.2050002@organicfoodmarkets.com.au>
Message-ID: <1286430437137-2966214.post@n4.nabble.com>


Hi Stephen,

I don't think Yahoo has that information.  I've seen similar data for the US
(e.g. ^TYX, ^FVX, ^IRX for Treasury yields) but not for Australia.

You will find interest rate information on the Reserve Bank of Australia
website  http://www.rba.gov.au/statistics/tables/index.html#interest_rates
http://www.rba.gov.au/statistics/tables/index.html#interest_rates ,
downloadable as Excel files.

Guy

 
Stephen Choularton-3 wrote:
> 
>     I have been trying to download these prices from Yahoo (of course
>     they may not keep them - does anyone know?) using all sorts of
>     combinations like IR.AX or IR.SFE or XTF or XTSYZ0.AX.&nbsp; None of
> them
>     work. 
>     
>     Can anyone point me to where I can find the correct symbols? 
>     -- 
>       Stephen Choularton Ph.D., FIoD 
> 

-- 
View this message in context: http://r.789695.n4.nabble.com/downloading-prices-for-Australian-90-day-bank-bills-and-3-and-10-year-bonds-tp2966200p2966214.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From bkhei_jonathan at yahoo.com  Sat Oct  9 11:32:29 2010
From: bkhei_jonathan at yahoo.com (Jonathan Beokhokhei)
Date: Sat, 9 Oct 2010 02:32:29 -0700 (PDT)
Subject: [R-SIG-Finance] VECM estimation
Message-ID: <57004.95104.qm@web120419.mail.ne1.yahoo.com>

Dear all, I am working with some VECM estimation methodology, however could not find any complete package for doing so in R. I am aware of?the "urca" package, however could not find any function for :

1. Availing "t-ratio" with estimated individual estimated SD, for all parameters like Alpha, Beta, Sigma and other model parameters, under different setup for deterministic terms like simple constant, deterministic trend and orthogonal deterministic trend, with varying lag and rank parameters.

2. Performing residual analysis like plotting ACF, PACF for estimated residuals with confidence band and portmanteau testing etc.

Ofcourse I can write for my own, however it obviously not a good idea to reinventing the wheel. Is there any functions available for doing above?

Thank you for your time.





From john.kerpel at gmail.com  Sat Oct  9 17:25:42 2010
From: john.kerpel at gmail.com (John Kerpel)
Date: Sat, 9 Oct 2010 10:25:42 -0500
Subject: [R-SIG-Finance] VECM estimation
In-Reply-To: <57004.95104.qm@web120419.mail.ne1.yahoo.com>
References: <57004.95104.qm@web120419.mail.ne1.yahoo.com>
Message-ID: <AANLkTikm_xOy8mAz6gW4g3vMVNO_wFif2yq3ap7TqX79@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101009/103ab910/attachment.pl>

From Peter.Brecknock at bp.com  Sat Oct  9 18:07:55 2010
From: Peter.Brecknock at bp.com (Pete B)
Date: Sat, 9 Oct 2010 09:07:55 -0700 (PDT)
Subject: [R-SIG-Finance] VECM estimation
In-Reply-To: <57004.95104.qm@web120419.mail.ne1.yahoo.com>
References: <57004.95104.qm@web120419.mail.ne1.yahoo.com>
Message-ID: <1286640475063-2969678.post@n4.nabble.com>


Jonathan

The following CRAN link provides a full listing of packages that are useful
for computational econometrics

http://cran.r-project.org/web/views/Econometrics.html

HTH

Pete
-- 
View this message in context: http://r.789695.n4.nabble.com/VECM-estimation-tp2969418p2969678.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From me at censix.com  Sun Oct 10 11:07:46 2010
From: me at censix.com (me at censix.com)
Date: Sun, 10 Oct 2010 11:07:46 +0200 (CEST)
Subject: [R-SIG-Finance] Call to specific IBrokers function never returns -
 How to catch this error ?
Message-ID: <46011.78.234.67.201.1286701666.squirrel@censix.com>

Hi to the list

I am having some difficulties with a specific function from the otherwise
extremely useful "IBrokers" package that connects an R session with a TWS.
See the example code below.

The "reqContractDetails" function that should return either the contract
details (if the contract exists) or an error (if it doesnt) is giving me
problems.

if I run it with

contract <- twsEquity('OD7D','SMART',currency="EUR") # Corn ETF

then reqContractDetails(.....) returns the correct contract details

if instead I misspecify the contract currency as "USD", then
reqContractDetails(.....) is supposed to return an error, because the ETF
is denominated in Euro. But the call NEVER returns unless I abort the
command with crtl+c

Ths behaviour is the same during and outside trading hours.

My question is this:

Is there any quick workaround I can use here, i.e. some kind of timeout
mechanism within R in order to avoid that my code just stops executing and
waits ad infinitum ?

Thanks

Soren


############################################################################################################

########## This requires a running tws or gw that accepts incoming
connections on the standard port
########## Tested with IBrokers 0.2-7.

require(IBrokers)

tws <- twsConnect()

  tws  #print connection information. for info purposes only
  reqCurrentTime(tws) # check the server's timestamp

  contract <- twsEquity('OD7D','SMART',currency="EUR") # Corn ETF
  #contract <- twsEquity('OD7D','SMART',currency="USD") # Corn ETF that
does not exist

  #WARNING the reqContractDetails method will hang (never return!!) if
contract does not exist or is misspecified. avoid it!
  reqContractDetails(tws,contract) # request contract details.

  tmpData<-NULL
  tmpData<-reqHistoricalData(tws,contract, barSize = "1 day", duration =
"3 M") # request historical data
  (!is.null(tmpData)) && is.xts(tmpData) # did we get something back and
is it an xts series ?

twsDisconnect(tws)  # disconnect from the TWS


From cmdr_rogue at hotmail.com  Sun Oct 10 14:18:53 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Sun, 10 Oct 2010 08:18:53 -0400
Subject: [R-SIG-Finance] Matlab vs. R performance/convenience
 benchmarking for quantitative analysis business
In-Reply-To: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
References: <201010061308.o96D8nVi002398@hypatia.math.ethz.ch>
Message-ID: <BLU0-SMTP212DCAAA63145ABFDD053ECE2520@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101010/0a0f85f2/attachment.pl>

From jeff.a.ryan at gmail.com  Sun Oct 10 16:39:40 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sun, 10 Oct 2010 09:39:40 -0500
Subject: [R-SIG-Finance] Call to specific IBrokers function never
 returns - How to catch this error ?
In-Reply-To: <46011.78.234.67.201.1286701666.squirrel@censix.com>
References: <46011.78.234.67.201.1286701666.squirrel@censix.com>
Message-ID: <AANLkTins5DT9=8-Q7dewJJekVqfJd-MbKxDoaxJWZcx-@mail.gmail.com>

This was patched in version on CRAN (0.2-9 - possibly even 0.2-8).

> library(IBrokers)
Loading required package: xts
Loading required package: zoo
IBrokers version 0.2-9: (alpha)
Implementing API Version 9.63

This software comes with NO WARRANTY.  Not intended for production use!
See ?IBrokers for details
> tws <- twsConnect()
> contract <- twsEquity('OD7D','SMART',currency="EUR") # Corn ETF
> reqContractDetails(tws, contract)
[[1]]
List of 18
 $ version       : chr "6"
 $ contract      :List of 16
  ..$ conId          : chr "41638042"
  ..$ symbol         : chr "OD7D"
  ..$ sectype        : chr "STK"
  ..$ exch           : chr "SMART"
  ..$ primary        : chr "FWB"
  ..$ expiry         : chr ""
  ..$ strike         : chr "0.0"
  ..$ currency       : chr "EUR"
  ..$ right          : chr ""
  ..$ local          : chr "OD7D"
  ..$ multiplier     : chr ""
  ..$ combo_legs_desc: chr ""
  ..$ comboleg       : chr ""
  ..$ include_expired: chr ""
  ..$ secIdType      : chr ""
  ..$ secId          : chr ""
  ..- attr(*, "class")= chr "twsContract"
 $ marketName    : chr "XETRA"
 $ tradingClass  : chr "XETRA"
 $ conId         : chr "41638042"
 $ minTick       : chr "0.0010"
 $ orderTypes    : chr [1:35] "ACTIVETIM" "ADJUST" "ALERT" "ALLOC" ...
 $ validExchanges: chr [1:5] "SMART" "FWB" "IBIS" "MIBSX" ...
 $ priceMagnifier: chr "1"
 $ underConId    : chr "0"
 $ longName      : chr "ETFS CORN "
 $ contractMonth : chr ""
 $ industry      : chr "Funds"
 $ category      : chr "Commodity Fund"
 $ subcategory   : chr "Commodity"
 $ timeZoneId    : chr "MET"
 $ tradingHours  : chr "20101010:CLOSED;20101011:0900-2000"
 $ liquidHours   : chr "20101010:CLOSED;20101011:0900-1730"

> contract <- twsEquity('OD7D','SMART',currency="USD") # Corn ETF
> reqContractDetails(tws, contract)
list()
Warning message:
In reqContractDetails(tws, contract) : error in contract details

Best,
Jeff

On Sun, Oct 10, 2010 at 4:07 AM,  <me at censix.com> wrote:
> Hi to the list
>
> I am having some difficulties with a specific function from the otherwise
> extremely useful "IBrokers" package that connects an R session with a TWS.
> See the example code below.
>
> The "reqContractDetails" function that should return either the contract
> details (if the contract exists) or an error (if it doesnt) is giving me
> problems.
>
> if I run it with
>
> contract <- twsEquity('OD7D','SMART',currency="EUR") # Corn ETF
>
> then reqContractDetails(.....) returns the correct contract details
>
> if instead I misspecify the contract currency as "USD", then
> reqContractDetails(.....) is supposed to return an error, because the ETF
> is denominated in Euro. But the call NEVER returns unless I abort the
> command with crtl+c
>
> Ths behaviour is the same during and outside trading hours.
>
> My question is this:
>
> Is there any quick workaround I can use here, i.e. some kind of timeout
> mechanism within R in order to avoid that my code just stops executing and
> waits ad infinitum ?
>
> Thanks
>
> Soren
>
>
> ############################################################################################################
>
> ########## This requires a running tws or gw that accepts incoming
> connections on the standard port
> ########## Tested with IBrokers 0.2-7.
>
> require(IBrokers)
>
> tws <- twsConnect()
>
> ?tws ?#print connection information. for info purposes only
> ?reqCurrentTime(tws) # check the server's timestamp
>
> ?contract <- twsEquity('OD7D','SMART',currency="EUR") # Corn ETF
> ?#contract <- twsEquity('OD7D','SMART',currency="USD") # Corn ETF that
> does not exist
>
> ?#WARNING the reqContractDetails method will hang (never return!!) if
> contract does not exist or is misspecified. avoid it!
> ?reqContractDetails(tws,contract) # request contract details.
>
> ?tmpData<-NULL
> ?tmpData<-reqHistoricalData(tws,contract, barSize = "1 day", duration =
> "3 M") # request historical data
> ?(!is.null(tmpData)) && is.xts(tmpData) # did we get something back and
> is it an xts series ?
>
> twsDisconnect(tws) ?# disconnect from the TWS
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeff.a.ryan at gmail.com


From stephen at organicfoodmarkets.com.au  Mon Oct 11 04:11:10 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Mon, 11 Oct 2010 13:11:10 +1100
Subject: [R-SIG-Finance] finding symbols
Message-ID: <4CB2723E.8070102@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101011/36e41c4a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101011/36e41c4a/attachment.jpe>

From matthieu.stigler at gmail.com  Mon Oct 11 09:57:52 2010
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Mon, 11 Oct 2010 09:57:52 +0200
Subject: [R-SIG-Finance] VECM estimation
In-Reply-To: <1286640475063-2969678.post@n4.nabble.com>
References: <57004.95104.qm@web120419.mail.ne1.yahoo.com>
	<1286640475063-2969678.post@n4.nabble.com>
Message-ID: <4CB2C380.4070002@gmail.com>

Jonathan

Combination of package vars and urca will provide what you need, showing 
different p-values of the lags and alpha coefficients, including 
deterministic regressor (but no orthogonal one), and various 
specification tests. P-values for beta are, as far as I know, not 
available, but function blrtest() from urca can test for the betas.

Package tsDyn, which deals with nonlinear VAR and VECM, has a few 
alternative VAR and VECM() estimation and representation functions, with 
a toLatex() method to export the VAR/VECM matrix equation into Latex.

Hope this helps

Matthieu



Le 09. 10. 10 18:07, Pete B a ?crit :
> Jonathan
>
> The following CRAN link provides a full listing of packages that are useful
> for computational econometrics
>
> http://cran.r-project.org/web/views/Econometrics.html
>
> HTH
>
> Pete
>


From brian at braverock.com  Mon Oct 11 10:45:31 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 11 Oct 2010 03:45:31 -0500
Subject: [R-SIG-Finance] finding symbols
In-Reply-To: <4CB2723E.8070102@organicfoodmarkets.com.au>
References: <4CB2723E.8070102@organicfoodmarkets.com.au>
Message-ID: <111b97dfbfc5fb5febbda8a45d324d8d@braverock.com>

On Mon, 11 Oct 2010 13:11:10 +1100, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Hi
> 
>  I wonder if anyone can point me to a good reference for the symbols I
> often require to get financial data.? I seem to run into trouble finding
> the right suffices (for the exchanges) as well as the prefixes.? 
> 
>  Any help much appreciated.
>  -- 
>  Stephen Choularton Ph.D., FIoD

Typically, the exchange is the 'source of record' for the
instrument/contract/symbol information.

Alternately, your data provider, as that's one of the reasons you pay
them. (Yahoo and Google not counting here, use their search facilities).

Cheers,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From stephen at organicfoodmarkets.com.au  Tue Oct 12 04:47:46 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 12 Oct 2010 13:47:46 +1100
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
Message-ID: <4CB3CC52.9070806@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/a039e967/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/a039e967/attachment.jpe>

From cmdr_rogue at hotmail.com  Tue Oct 12 11:43:32 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Tue, 12 Oct 2010 05:43:32 -0400
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <4CB3CC52.9070806@organicfoodmarkets.com.au>
References: <4CB3CC52.9070806@organicfoodmarkets.com.au>
Message-ID: <BLU0-SMTP21220AA5FD288F890EED317E2540@phx.gbl>

By half-life, do you mean the speed of mean-reversion?

If so, there's a bit of algebraic tomfoolery that's required to
discretise the equation and then fit the data to it. I don't have the
time right now to go into all the details but it's not hard- you can
parameterise the process using simple linear regression. If you need
help with that I'll try and get back to you tonight about it.

On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:

> Hi
> 
> Wonder if anyone could point me how I use this method to discover the
> half life of a mean reverting process.  
> 
> I am looking into pair trading and the time it takes for a
> cointegrated pair to revert to the norm.
> 
> -- 
> Stephen Choularton Ph.D., FIoD
> 
> 9999 2226
> 0413 545 182
> 
> 
> for insurance go to www.netinsure.com.au
> for markets go to www.organicfoodmarkets.com.au
> 
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment.jpe>

From bjorn.skogtro at gmail.com  Tue Oct 12 12:33:45 2010
From: bjorn.skogtro at gmail.com (Bjorn Skogtro)
Date: Tue, 12 Oct 2010 12:33:45 +0200
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
Message-ID: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/130a6263/attachment.pl>

From paulteetor at yahoo.com  Tue Oct 12 16:54:28 2010
From: paulteetor at yahoo.com (Paul Teetor)
Date: Tue, 12 Oct 2010 09:54:28 -0500
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
Message-ID: <13095DF41733441FB124D345EA837ED7@XI>

Stephen:

I do mean-reversion trading, and I use a half-life analysis to judge the
wisdom of a trade. If the estimated half-life is too long, it doesn't make
sense to take the trade. It's a time-vs-risk thing.

In the past, I used the log(2)/speed formula mentioned by Bjorn, below. (His
link is very useful, BTW.) However, I was very unhappy with the estimates
provided by that formula. They did not match my actual trading experience.

I did some research on the topic, and got some useful results. I added a
momentum term to my model, measuruing the current slope of the spread. The
slope answers an important question: is the spread currently reverting
(moving towards the mean) or is it averting (moving away from the mean)? The
half-life is different, depending upon the current phase (reversion vs.
aversion). I found this conditioning term was statistically significant, so
I condition my estimate on it. I generate historical data and partition it
according to the market's reversion/aversion state. The two partitions shows
a different half-life, with the reverting phase having a (much) shorter
half-life than the averting phase. Both phases show an exponentally
distributed half-life, but with different means. I use those historical
estimates now in my trading, instead of the O-U estimate.

In retrospect, the problem with the O-U model is that it assumes the
mean-reverting process is always reverting. That is not quite correct. In my
experience, the spreads can alternate between periods of mean-aversion and
mean-reversion.

I hope that helps (and I hope it makes sense!).

Paul


-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Bjorn Skogtro
Sent: Tuesday, October 12, 2010 5:34 AM
To: r-sig-finance at stat.math.ethz.ch
Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck

Hi Stephen,

You could take a look at

http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model

for the linear regression method, or take a look at the package "sde" which
contains some examples using GMM (not for the Ornstein-Uhlenbeck process,
though, only the CIR).

The half-life is given as log(2)/mean-reversion speed.

Do keep an eye on the partition of the time-axis, e.g. what frequency you
are using (daily, yearly) for interpreting the half-life.

BR,
Bjxrn






> ------------------------------
>
> Message: 2
> Date: Tue, 12 Oct 2010 05:43:32 -0400
> From: Sarbo <cmdr_rogue at hotmail.com>
> To: r-sig-finance at stat.math.ethz.ch
> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
> Message-ID: <BLU0-SMTP21220AA5FD288F890EED317E2540 at phx.gbl>
> Content-Type: text/plain; charset="utf-8"
>
> By half-life, do you mean the speed of mean-reversion?
>
> If so, there's a bit of algebraic tomfoolery that's required to 
> discretise the equation and then fit the data to it. I don't have the 
> time right now to go into all the details but it's not hard- you can 
> parameterise the process using simple linear regression. If you need 
> help with that I'll try and get back to you tonight about it.
>
> On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:
>
> > Hi
> >
> > Wonder if anyone could point me how I use this method to discover 
> > the half life of a mean reverting process.
> >
> > I am looking into pair trading and the time it takes for a 
> > cointegrated pair to revert to the norm.
> >
> > --
> > Stephen Choularton Ph.D., FIoD
> >
> > 9999 2226
> > 0413 545 182
> >
> >
> > for insurance go to www.netinsure.com.au for markets go to 
> > www.organicfoodmarkets.com.au
> >
> >
> > _______________________________________________
> > R-SIG-Finance at stat.math.ethz.ch mailing list 
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R 
> > questions
> should go.
>
>
> -------------- next part -------------- An HTML attachment was 
> scrubbed...
> URL: <
> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e3
> 2fc7/attachment-0001.html
> >
> -------------- next part -------------- A non-text attachment was 
> scrubbed...
> Name: CoS2010Winner.JPG
> Type: image/jpeg
> Size: 16091 bytes
> Desc: not available
> URL: <
> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e3
> 2fc7/attachment-0001.jpe
> >
>
> ------------------------------
>
> _______________________________________________
> R-SIG-Finance mailing list
> R-SIG-Finance at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
> End of R-SIG-Finance Digest, Vol 77, Issue 8
> ********************************************

	[[alternative HTML version deleted]]


From stefano.iacus at unimi.it  Tue Oct 12 17:41:19 2010
From: stefano.iacus at unimi.it (stefano iacus)
Date: Tue, 12 Oct 2010 17:41:19 +0200
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
Message-ID: <0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>

just for completeness: OU process is gaussian and transitiion density is known in exact form. So maximum likelihood estimation works fine and I suggest to avoid GMM.

sde package contains exact transition density for this process (e.g. ?dcOU) which you can use to build the likelihood to pass to mle() function.

This example taken from the "inst" directory of the package sde. For the parametrization of the model see ?dcOU


# ex3.01.R
OU.lik <- function(theta1, theta2, theta3){
  n <- length(X)
  dt <- deltat(X)
  -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
 }

require(stats4)
require(sde)
set.seed(123)
X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1), 
      method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit
summary(fit)

# ex3.01.R (cont.)
prof <- profile(fit)
par(mfrow=c(1,3))
plot(prof)
par(mfrow=c(1,1))
vcov(fit)
confint(fit)
 
# ex3.01.R (cont.)
set.seed(123)
X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1), 
      method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2
summary(fit2)


I hope this helps out

stefano

On 12 Oct 2010, at 12:33, Bjorn Skogtro wrote:

> Hi Stephen,
> 
> You could take a look at
> 
> http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model
> 
> for the linear regression method, or take a look at the package "sde" which
> contains some examples using GMM (not for the Ornstein-Uhlenbeck process,
> though, only the CIR).
> 
> The half-life is given as log(2)/mean-reversion speed.
> 
> Do keep an eye on the partition of the time-axis, e.g. what frequency you
> are using (daily, yearly) for interpreting the half-life.
> 
> BR,
> Bj?rn
> 
> 
> 
> 
> 
> 
>> ------------------------------
>> 
>> Message: 2
>> Date: Tue, 12 Oct 2010 05:43:32 -0400
>> From: Sarbo <cmdr_rogue at hotmail.com>
>> To: r-sig-finance at stat.math.ethz.ch
>> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
>> Message-ID: <BLU0-SMTP21220AA5FD288F890EED317E2540 at phx.gbl>
>> Content-Type: text/plain; charset="utf-8"
>> 
>> By half-life, do you mean the speed of mean-reversion?
>> 
>> If so, there's a bit of algebraic tomfoolery that's required to
>> discretise the equation and then fit the data to it. I don't have the
>> time right now to go into all the details but it's not hard- you can
>> parameterise the process using simple linear regression. If you need
>> help with that I'll try and get back to you tonight about it.
>> 
>> On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:
>> 
>>> Hi
>>> 
>>> Wonder if anyone could point me how I use this method to discover the
>>> half life of a mean reverting process.
>>> 
>>> I am looking into pair trading and the time it takes for a
>>> cointegrated pair to revert to the norm.
>>> 
>>> --
>>> Stephen Choularton Ph.D., FIoD
>>> 
>>> 9999 2226
>>> 0413 545 182
>>> 
>>> 
>>> for insurance go to www.netinsure.com.au
>>> for markets go to www.organicfoodmarkets.com.au
>>> 
>>> 
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>> should go.
>> 
>> 
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <
>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.html
>>> 
>> -------------- next part --------------
>> A non-text attachment was scrubbed...
>> Name: CoS2010Winner.JPG
>> Type: image/jpeg
>> Size: 16091 bytes
>> Desc: not available
>> URL: <
>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.jpe
>>> 
>> 
>> ------------------------------
>> 
>> _______________________________________________
>> R-SIG-Finance mailing list
>> R-SIG-Finance at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> 
>> 
>> End of R-SIG-Finance Digest, Vol 77, Issue 8
>> ********************************************
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


-----------------------------------
Stefano M. Iacus
Department of Economics,
Business and Statistics
University of Milan
Via Conservatorio, 7
I-20123 Milan - Italy
Ph.: +39 02 50321 461
Fax: +39 02 50321 505
http://www.economia.unimi.it/iacus
------------------------------------------------------------------------------------
Please don't send me Word or PowerPoint attachments if not 
absolutely necessary. See:
http://www.gnu.org/philosophy/no-word-attachments.html


From bjorn.skogtro at gmail.com  Tue Oct 12 17:46:42 2010
From: bjorn.skogtro at gmail.com (Bjorn Skogtro)
Date: Tue, 12 Oct 2010 17:46:42 +0200
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <13095DF41733441FB124D345EA837ED7@XI>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
	<13095DF41733441FB124D345EA837ED7@XI>
Message-ID: <AANLkTinZovvdoiRx3X2L-nJ-Ud9vcHN6v+gS1J=bXENU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/af5d8be8/attachment.pl>

From patrick at burns-stat.com  Tue Oct 12 18:00:07 2010
From: patrick at burns-stat.com (Patrick Burns)
Date: Tue, 12 Oct 2010 17:00:07 +0100
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>
Message-ID: <4CB48607.2040609@burns-stat.com>

The OU process is Gaussian, but the
market didn't get the memo that *it*
has to be Gaussian.

On 12/10/2010 16:41, stefano iacus wrote:
> just for completeness: OU process is gaussian and transitiion density is known in exact form. So maximum likelihood estimation works fine and I suggest to avoid GMM.
>
> sde package contains exact transition density for this process (e.g. ?dcOU) which you can use to build the likelihood to pass to mle() function.
>
> This example taken from the "inst" directory of the package sde. For the parametrization of the model see ?dcOU
>
>
> # ex3.01.R
> OU.lik<- function(theta1, theta2, theta3){
>    n<- length(X)
>    dt<- deltat(X)
>    -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
>   }
>
> require(stats4)
> require(sde)
> set.seed(123)
> X<- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>        method="L-BFGS-B", lower=c(-Inf,0,0)) ->  fit
> summary(fit)
>
> # ex3.01.R (cont.)
> prof<- profile(fit)
> par(mfrow=c(1,3))
> plot(prof)
> par(mfrow=c(1,1))
> vcov(fit)
> confint(fit)
>
> # ex3.01.R (cont.)
> set.seed(123)
> X<- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>        method="L-BFGS-B", lower=c(-Inf,0,0)) ->  fit2
> summary(fit2)
>
>
> I hope this helps out
>
> stefano
>
> On 12 Oct 2010, at 12:33, Bjorn Skogtro wrote:
>
>> Hi Stephen,
>>
>> You could take a look at
>>
>> http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model
>>
>> for the linear regression method, or take a look at the package "sde" which
>> contains some examples using GMM (not for the Ornstein-Uhlenbeck process,
>> though, only the CIR).
>>
>> The half-life is given as log(2)/mean-reversion speed.
>>
>> Do keep an eye on the partition of the time-axis, e.g. what frequency you
>> are using (daily, yearly) for interpreting the half-life.
>>
>> BR,
>> Bj?rn
>>
>>
>>
>>
>>
>>
>>> ------------------------------
>>>
>>> Message: 2
>>> Date: Tue, 12 Oct 2010 05:43:32 -0400
>>> From: Sarbo<cmdr_rogue at hotmail.com>
>>> To: r-sig-finance at stat.math.ethz.ch
>>> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
>>> Message-ID:<BLU0-SMTP21220AA5FD288F890EED317E2540 at phx.gbl>
>>> Content-Type: text/plain; charset="utf-8"
>>>
>>> By half-life, do you mean the speed of mean-reversion?
>>>
>>> If so, there's a bit of algebraic tomfoolery that's required to
>>> discretise the equation and then fit the data to it. I don't have the
>>> time right now to go into all the details but it's not hard- you can
>>> parameterise the process using simple linear regression. If you need
>>> help with that I'll try and get back to you tonight about it.
>>>
>>> On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:
>>>
>>>> Hi
>>>>
>>>> Wonder if anyone could point me how I use this method to discover the
>>>> half life of a mean reverting process.
>>>>
>>>> I am looking into pair trading and the time it takes for a
>>>> cointegrated pair to revert to the norm.
>>>>
>>>> --
>>>> Stephen Choularton Ph.D., FIoD
>>>>
>>>> 9999 2226
>>>> 0413 545 182
>>>>
>>>>
>>>> for insurance go to www.netinsure.com.au
>>>> for markets go to www.organicfoodmarkets.com.au
>>>>
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>>
>>> -------------- next part --------------
>>> An HTML attachment was scrubbed...
>>> URL:<
>>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.html
>>>>
>>> -------------- next part --------------
>>> A non-text attachment was scrubbed...
>>> Name: CoS2010Winner.JPG
>>> Type: image/jpeg
>>> Size: 16091 bytes
>>> Desc: not available
>>> URL:<
>>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.jpe
>>>>
>>>
>>> ------------------------------
>>>
>>> _______________________________________________
>>> R-SIG-Finance mailing list
>>> R-SIG-Finance at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>
>>>
>>> End of R-SIG-Finance Digest, Vol 77, Issue 8
>>> ********************************************
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
> -----------------------------------
> Stefano M. Iacus
> Department of Economics,
> Business and Statistics
> University of Milan
> Via Conservatorio, 7
> I-20123 Milan - Italy
> Ph.: +39 02 50321 461
> Fax: +39 02 50321 505
> http://www.economia.unimi.it/iacus
> ------------------------------------------------------------------------------------
> Please don't send me Word or PowerPoint attachments if not
> absolutely necessary. See:
> http://www.gnu.org/philosophy/no-word-attachments.html
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog


From stefano.iacus at unimi.it  Tue Oct 12 18:11:59 2010
From: stefano.iacus at unimi.it (stefano iacus)
Date: Tue, 12 Oct 2010 18:11:59 +0200
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <4CB48607.2040609@burns-stat.com>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>
	<4CB48607.2040609@burns-stat.com>
Message-ID: <39218047-6B0D-44A3-85D3-F209CA112C0D@unimi.it>

that's another point and I completely agree with you :-)

so the real point is not trying to fit wrong models on the (so to say) "wrong" data 


stefano

On 12 Oct 2010, at 18:00, Patrick Burns wrote:

> The OU process is Gaussian, but the
> market didn't get the memo that *it*
> has to be Gaussian.
> 
> On 12/10/2010 16:41, stefano iacus wrote:
>> just for completeness: OU process is gaussian and transitiion density is known in exact form. So maximum likelihood estimation works fine and I suggest to avoid GMM.
>> 
>> sde package contains exact transition density for this process (e.g. ?dcOU) which you can use to build the likelihood to pass to mle() function.
>> 
>> This example taken from the "inst" directory of the package sde. For the parametrization of the model see ?dcOU
>> 
>> 
>> # ex3.01.R
>> OU.lik<- function(theta1, theta2, theta3){
>>   n<- length(X)
>>   dt<- deltat(X)
>>   -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
>>  }
>> 
>> require(stats4)
>> require(sde)
>> set.seed(123)
>> X<- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
>> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>>       method="L-BFGS-B", lower=c(-Inf,0,0)) ->  fit
>> summary(fit)
>> 
>> # ex3.01.R (cont.)
>> prof<- profile(fit)
>> par(mfrow=c(1,3))
>> plot(prof)
>> par(mfrow=c(1,1))
>> vcov(fit)
>> confint(fit)
>> 
>> # ex3.01.R (cont.)
>> set.seed(123)
>> X<- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
>> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>>       method="L-BFGS-B", lower=c(-Inf,0,0)) ->  fit2
>> summary(fit2)
>> 
>> 
>> I hope this helps out
>> 
>> stefano
>> 
>> On 12 Oct 2010, at 12:33, Bjorn Skogtro wrote:
>> 
>>> Hi Stephen,
>>> 
>>> You could take a look at
>>> 
>>> http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model
>>> 
>>> for the linear regression method, or take a look at the package "sde" which
>>> contains some examples using GMM (not for the Ornstein-Uhlenbeck process,
>>> though, only the CIR).
>>> 
>>> The half-life is given as log(2)/mean-reversion speed.
>>> 
>>> Do keep an eye on the partition of the time-axis, e.g. what frequency you
>>> are using (daily, yearly) for interpreting the half-life.
>>> 
>>> BR,
>>> Bj?rn
>>> 
>>> 
>>> 
>>> 
>>> 
>>> 
>>>> ------------------------------
>>>> 
>>>> Message: 2
>>>> Date: Tue, 12 Oct 2010 05:43:32 -0400
>>>> From: Sarbo<cmdr_rogue at hotmail.com>
>>>> To: r-sig-finance at stat.math.ethz.ch
>>>> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
>>>> Message-ID:<BLU0-SMTP21220AA5FD288F890EED317E2540 at phx.gbl>
>>>> Content-Type: text/plain; charset="utf-8"
>>>> 
>>>> By half-life, do you mean the speed of mean-reversion?
>>>> 
>>>> If so, there's a bit of algebraic tomfoolery that's required to
>>>> discretise the equation and then fit the data to it. I don't have the
>>>> time right now to go into all the details but it's not hard- you can
>>>> parameterise the process using simple linear regression. If you need
>>>> help with that I'll try and get back to you tonight about it.
>>>> 
>>>> On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:
>>>> 
>>>>> Hi
>>>>> 
>>>>> Wonder if anyone could point me how I use this method to discover the
>>>>> half life of a mean reverting process.
>>>>> 
>>>>> I am looking into pair trading and the time it takes for a
>>>>> cointegrated pair to revert to the norm.
>>>>> 
>>>>> --
>>>>> Stephen Choularton Ph.D., FIoD
>>>>> 
>>>>> 9999 2226
>>>>> 0413 545 182
>>>>> 
>>>>> 
>>>>> for insurance go to www.netinsure.com.au
>>>>> for markets go to www.organicfoodmarkets.com.au
>>>>> 
>>>>> 
>>>>> _______________________________________________
>>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>> 
>>>> 
>>>> -------------- next part --------------
>>>> An HTML attachment was scrubbed...
>>>> URL:<
>>>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.html
>>>>> 
>>>> -------------- next part --------------
>>>> A non-text attachment was scrubbed...
>>>> Name: CoS2010Winner.JPG
>>>> Type: image/jpeg
>>>> Size: 16091 bytes
>>>> Desc: not available
>>>> URL:<
>>>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.jpe
>>>>> 
>>>> 
>>>> ------------------------------
>>>> 
>>>> _______________________________________________
>>>> R-SIG-Finance mailing list
>>>> R-SIG-Finance at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> 
>>>> 
>>>> End of R-SIG-Finance Digest, Vol 77, Issue 8
>>>> ********************************************
>>> 
>>> 	[[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>> 
>> 
>> -----------------------------------
>> Stefano M. Iacus
>> Department of Economics,
>> Business and Statistics
>> University of Milan
>> Via Conservatorio, 7
>> I-20123 Milan - Italy
>> Ph.: +39 02 50321 461
>> Fax: +39 02 50321 505
>> http://www.economia.unimi.it/iacus
>> ------------------------------------------------------------------------------------
>> Please don't send me Word or PowerPoint attachments if not
>> absolutely necessary. See:
>> http://www.gnu.org/philosophy/no-word-attachments.html
>> 
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>> 
> 
> -- 
> Patrick Burns
> patrick at burns-stat.com
> http://www.burns-stat.com
> http://www.portfolioprobe.com/blog
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


-----------------------------------
Stefano M. Iacus
Department of Economics,
Business and Statistics
University of Milan
Via Conservatorio, 7
I-20123 Milan - Italy
Ph.: +39 02 50321 461
Fax: +39 02 50321 505
http://www.economia.unimi.it/iacus
------------------------------------------------------------------------------------
Please don't send me Word or PowerPoint attachments if not 
absolutely necessary. See:
http://www.gnu.org/philosophy/no-word-attachments.html


From jeff.hamann at moneytree.com  Tue Oct 12 18:34:38 2010
From: jeff.hamann at moneytree.com (Jeff Hamann)
Date: Tue, 12 Oct 2010 09:34:38 -0700
Subject: [R-SIG-Finance] plotting vertical lines on months in xyplot
Message-ID: <6640D837-86EA-4D86-9419-FA41B5CA395F@moneytree.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/6b748cd3/attachment.pl>

From peter at braverock.com  Wed Oct 13 15:31:01 2010
From: peter at braverock.com (Peter Carl)
Date: Wed, 13 Oct 2010 08:31:01 -0500
Subject: [R-SIG-Finance] Using Benford's law for reported returns?
Message-ID: <b96bdb706716b8bc443dca64082f6da8.squirrel@mail.braverock.com>

I was recently inspired by a post on Drew Conway's blog:

http://www.drewconway.com/zia/?p=2234

to take a look at using Benford's law to look at returns as reported by
hedge funds.  I've made some headway:

https://r-forge.r-project.org/scm/viewvc.php/pkg/PerformanceAnalytics/sandbox/Benford.R?view=markup&root=returnanalytics

Currently this code can be used to calculate the theoretical proportions
and digit counts/percentages for first and n-th digits tests.  But as I've
been digging through Nigrini's papers, I'm realizing that this topic is
something of a deep hole, and these tests I've implemented may have only
modest utility.  Other tests might be more useful such as first-two
digits, number duplication, rounding, and last-two digits.

I'm aware of code in VGAM and rattle packages for Benford's distribution,
but the functionality is somewhat limited to what I've done already.

Does anyone have additional code in this vein that they would be willing
to share, or would you be willing to collaborate to extend these
functions?  Or, if you are a user of such analysis, I would be interested
to know if you've found it useful.

Thanks in advance,

pcc
-- 
Peter Carl
http://www.braverock.com/~peter


From stephen at organicfoodmarkets.com.au  Wed Oct 13 22:29:12 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Thu, 14 Oct 2010 07:29:12 +1100
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>
Message-ID: <4CB61698.6070601@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101014/48eb8702/attachment.html>

From joe.stuart at gmail.com  Thu Oct 14 02:01:41 2010
From: joe.stuart at gmail.com (Joe Stuart)
Date: Wed, 13 Oct 2010 19:01:41 -0500
Subject: [R-SIG-Finance] New 3 course online certificate in
 computational finance using R
In-Reply-To: <AANLkTimmvgXLjjwfB=sxnBQkAQ+e2b6OLCUj58-cBkWP@mail.gmail.com>
References: <AANLkTimmvgXLjjwfB=sxnBQkAQ+e2b6OLCUj58-cBkWP@mail.gmail.com>
Message-ID: <AANLkTi=3Lnvty+4A=qFCF+DOFjhTz_r6b6PPSc9qKpRO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101013/e2d0a966/attachment.pl>

From fantunes at fc.ul.pt  Thu Oct 14 16:05:04 2010
From: fantunes at fc.ul.pt (Fernando Antunes)
Date: Thu, 14 Oct 2010 15:05:04 +0100
Subject: [R-SIG-Finance]  Error in getSymbols with adjust=TRUE
Message-ID: <4CB70E10.9000603@fc.ul.pt>

Dear all,

I am getting the following error when I use getSymbols with adjust=TRUE

#No error with adjust=FLASE
 >setDefaults(getSymbols.yahoo, adjust=FALSE)
 > getSymbols("MSFT", src='yahoo')
[1] "MSFT"

#But with adjust=TRUE
 > setDefaults(getSymbols.yahoo, adjust=TRUE)
 > getSymbols("MSFT", src='yahoo')
Error in sprintf("%.2d", to.d) :
   invalid format '%.2d'; use format %f, %e, %g or %a for numeric objects

Previously, I had no problems with this. My session info is (under 
REvolution):
 > sessionInfo()
R version 2.11.1 (2010-05-31)
i386-pc-mingw32

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] quantmod_0.3-13  TTR_0.20-2       Defaults_1.1-1   xts_0.7-5
[5] zoo_1.6-4        Revobase_4.0.0   RevoScaleR_1.0-0 lattice_0.18-8

loaded via a namespace (and not attached):
[1] grid_2.11.1       pkgXMLBuilder_1.0 revoIpe_1.0       tools_2.11.1
[5] XML_3.1-0


Thanks for any help.
Fernando


From karlavhv142 at hotmail.com  Thu Oct 14 16:20:06 2010
From: karlavhv142 at hotmail.com (karla hernandez villafuerte)
Date: Thu, 14 Oct 2010 08:20:06 -0600
Subject: [R-SIG-Finance] Coefficients, Principal Component Regression. pcr
Message-ID: <COL124-W2563D1DEC714416B27A0B5E5560@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101014/3e332e6c/attachment.pl>

From William.Alpert at barrons.com  Thu Oct 14 20:32:05 2010
From: William.Alpert at barrons.com (Alpert, William)
Date: Thu, 14 Oct 2010 14:32:05 -0400
Subject: [R-SIG-Finance] Internship advert
Message-ID: <02BF89F8F8F5434281FB674D2BC513C33C99F43378@SBKMXSMB09.win.dowjones.net>

Of interest, perhaps, to a finance student who has lost their way !

Bill Alpert
Sr. Editor
Barron's
1.212.416.2742 w
william.alpert at barrons.com
***

Do some good.  Intern at Barron's, the New York financial publication with a decades-long tradition of investigative journalism and a more recent commitment to data analytic exposure of fraud in finance, business and healthcare.  Bring us your zeal and your data munging skills and we'll teach you how to be a writer, stock analyst and gumshoe investigator.  We assemble unique data sets to scrutinize activities like Jim Cramer's CNBC stock picking, for-profit colleges, Medicare rip-offs and the hyping of US-listed China stocks.  Our stories achieve instant reform of bad situations. Please help us make Wall Street safe for the little guy.

We will hire one programmer-journalist intern to work from June through August of 2011. Desirable skills would include programming fluency in R (for data analysis and visualization), a scripting language (like Perl or Python) and SQL.  If you can write, you will also get stories published under your byline.

As part of the Dow Jones News Fund, the program provides free pre-internship training seminars, 10 weeks' salary, $1,000 scholarships for interns returning to school, and a travel allowance. The salary is not princely, so it helps if you have a place to stay in the New York area.

APPLICATION DEADLINE: November 1, 2010

Apply online at https://www.newsfund.org  Click Programs...then Internship Applications...make sure to complete the business reporting form.

Also, send a resume, writing and code samples to me  -- Bill Alpert -- at william.alpert at barrons.com and call me with any questions at 212.416.2742.


From jeff.a.ryan at gmail.com  Thu Oct 14 20:50:50 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Thu, 14 Oct 2010 13:50:50 -0500
Subject: [R-SIG-Finance] Error in getSymbols with adjust=TRUE
In-Reply-To: <4CB70E10.9000603@fc.ul.pt>
References: <4CB70E10.9000603@fc.ul.pt>
Message-ID: <AANLkTikRv4cFkvqgCLtj54bFz6ok7C84yVnbsCuFxUhO@mail.gmail.com>

Hi Fernando,

The version on R-forge (550) is now patched - thanks to a contribution
from Josh Ulrich.

Thanks,
Jeff

On Thu, Oct 14, 2010 at 9:05 AM, Fernando Antunes <fantunes at fc.ul.pt> wrote:
> Dear all,
>
> I am getting the following error when I use getSymbols with adjust=TRUE
>
> #No error with adjust=FLASE
>>setDefaults(getSymbols.yahoo, adjust=FALSE)
>> getSymbols("MSFT", src='yahoo')
> [1] "MSFT"
>
> #But with adjust=TRUE
>> setDefaults(getSymbols.yahoo, adjust=TRUE)
>> getSymbols("MSFT", src='yahoo')
> Error in sprintf("%.2d", to.d) :
> ?invalid format '%.2d'; use format %f, %e, %g or %a for numeric objects
>
> Previously, I had no problems with this. My session info is (under
> REvolution):
>> sessionInfo()
> R version 2.11.1 (2010-05-31)
> i386-pc-mingw32
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>
> other attached packages:
> [1] quantmod_0.3-13 ?TTR_0.20-2 ? ? ? Defaults_1.1-1 ? xts_0.7-5
> [5] zoo_1.6-4 ? ? ? ?Revobase_4.0.0 ? RevoScaleR_1.0-0 lattice_0.18-8
>
> loaded via a namespace (and not attached):
> [1] grid_2.11.1 ? ? ? pkgXMLBuilder_1.0 revoIpe_1.0 ? ? ? tools_2.11.1
> [5] XML_3.1-0
>
>
> Thanks for any help.
> Fernando
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeff.a.ryan at gmail.com


From wobwu22 at yahoo.de  Sat Oct 16 00:49:28 2010
From: wobwu22 at yahoo.de (Wolfgang Wu)
Date: Fri, 15 Oct 2010 23:49:28 +0100 (BST)
Subject: [R-SIG-Finance] (no subject)
Message-ID: <352871.646.qm@web29603.mail.ird.yahoo.com>

http://lhrmww.biz-opportunity.ru Yes,Yo uCanPr ogressW ithY ourTa lent On li ne




From ariascos at gmail.com  Sat Oct 16 02:05:21 2010
From: ariascos at gmail.com (Alvaro Riascos)
Date: Fri, 15 Oct 2010 19:05:21 -0500
Subject: [R-SIG-Finance] problem with frontierPlot
Message-ID: <AANLkTi=tvNU7+vqBoZ+BVYm1PT3qUvJvudbiTLGMpnAk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101015/fe031dd4/attachment.pl>

From santosh.srinivas at gmail.com  Sat Oct 16 05:41:54 2010
From: santosh.srinivas at gmail.com (Santosh Srinivas)
Date: Sat, 16 Oct 2010 09:11:54 +0530
Subject: [R-SIG-Finance] problem with frontierPlot
In-Reply-To: <AANLkTi=tvNU7+vqBoZ+BVYm1PT3qUvJvudbiTLGMpnAk@mail.gmail.com>
References: <AANLkTi=tvNU7+vqBoZ+BVYm1PT3qUvJvudbiTLGMpnAk@mail.gmail.com>
Message-ID: <4cb91f0b.26798e0a.2b58.2cd3@mx.google.com>

I tried this and seems to work

Lines <- "1970-01-31  0.0119702858  0.0074246655
 1970-02-28  0.0077859145 -0.0022183674
 1970-03-31 -0.0097686600  0.0028156804
 1970-04-30 -0.0010947363  0.0069857716
 1970-05-31  0.0001146949 -0.0001990794
 1970-06-30 -0.0014999062  0.0043774220
 1970-07-31 -0.0116682300 -0.0072369087
 1970-08-31  0.0088064660  0.0046168054
 1970-09-30  0.0019717544 -0.0030457644
 1970-10-31  0.0173595036 -0.0031445935
 "

 library(zoo)
 z <- read.zoo(textConnection(Lines), format="%Y-%m-%d")
 library("fPortfolio")
 y <- timeSeries(z)
 Frontier = portfolioFrontier(y)
 frontierPlot(Frontier, pch = 19, xlim = c(0, 0.05), ylim = c(0, 0.005))
 grid()
 abline(h = 0, col = "grey")
 abline(v = 0, col = "grey")



-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Alvaro Riascos
Sent: 16 October 2010 05:35
To: r-sig-finance at stat.math.ethz.ch
Subject: [R-SIG-Finance] problem with frontierPlot

Dear R users:

I am new to R. I find weird that frontierPlot is unable to plot the
following dataExample time series object (see below).

Frontier=portfolioFrontier(dataExample)

works nicely but:

frontierPlot(Frontier)

doesn't work. Thanks for your help!

#####
> dataExample
GMT
                Series 7      Series 8
1970-01-31  0.0119702858  0.0074246655
1970-02-28  0.0077859145 -0.0022183674
1970-03-31 -0.0097686600  0.0028156804
1970-04-30 -0.0010947363  0.0069857716
1970-05-31  0.0001146949 -0.0001990794
1970-06-30 -0.0014999062  0.0043774220
1970-07-31 -0.0116682300 -0.0072369087
1970-08-31  0.0088064660  0.0046168054
1970-09-30  0.0019717544 -0.0030457644
1970-10-31  0.0173595036 -0.0031445935
             Series 9
1970-01-31  -9.648918
1970-02-28  12.257963
1970-03-31 -18.029950
1970-04-30 -21.304943
1970-05-31  -1.023360
1970-06-30  -4.760405
1970-07-31 -75.510609
1970-08-31 -43.097188
1970-09-30 -15.257833
1970-10-31 -40.216935

> Frontier = portfolioFrontier(dataExample)

> frontierPlot(Frontier)

Error en dimnames(x) <- dn :
  la longitud de 'dimnames' [1] no es igual a la extensisn del arreglo #####

	[[alternative HTML version deleted]]


From matthieu.stigler at gmail.com  Sat Oct 16 11:15:46 2010
From: matthieu.stigler at gmail.com (mat)
Date: Sat, 16 Oct 2010 11:15:46 +0200
Subject: [R-SIG-Finance] Coefficients,
 Principal Component Regression. pcr
In-Reply-To: <COL124-W2563D1DEC714416B27A0B5E5560@phx.gbl>
References: <COL124-W2563D1DEC714416B27A0B5E5560@phx.gbl>
Message-ID: <4CB96D42.7050402@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101016/95cd84ef/attachment.pl>

From noah at smartmediacorp.com  Sat Oct 16 19:35:54 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Sat, 16 Oct 2010 10:35:54 -0700
Subject: [R-SIG-Finance] Data Sources
Message-ID: <4CB9E27A.7050607@smartmediacorp.com>

  Hi,

I'm taking a graduate level course on derivatives and options.  As we're 
learning more about the subject, I'd love to start modeling some things 
in R and trying out some ideas.

Are there any reliable (and hopefully affordable on a student's budget) 
data feeds for financial data - mainly options in the US markets?  I've 
seen Interactive Brokers, and it looks great, but they have a $10K 
minimum in order to open an account.

Thanks!

-N


From ustaudinger at gmail.com  Sat Oct 16 20:14:32 2010
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Sat, 16 Oct 2010 20:14:32 +0200
Subject: [R-SIG-Finance] Data Sources
In-Reply-To: <4CB9E27A.7050607@smartmediacorp.com>
References: <4CB9E27A.7050607@smartmediacorp.com>
Message-ID: <AANLkTiktx7XZrj7L1n7BiK8Ya-7Qt4V3k1PEsubi-mCG@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101016/1ccd0075/attachment.pl>

From noah at smartmediacorp.com  Sun Oct 17 01:46:55 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Sat, 16 Oct 2010 16:46:55 -0700
Subject: [R-SIG-Finance] Data Sources
In-Reply-To: <AANLkTiktx7XZrj7L1n7BiK8Ya-7Qt4V3k1PEsubi-mCG@mail.gmail.com>
References: <4CB9E27A.7050607@smartmediacorp.com>
	<AANLkTiktx7XZrj7L1n7BiK8Ya-7Qt4V3k1PEsubi-mCG@mail.gmail.com>
Message-ID: <4CBA396F.7060101@smartmediacorp.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101016/7bb52f80/attachment.pl>

From ustaudinger at gmail.com  Sun Oct 17 01:53:03 2010
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Sun, 17 Oct 2010 01:53:03 +0200
Subject: [R-SIG-Finance] Data Sources
In-Reply-To: <4CBA396F.7060101@smartmediacorp.com>
References: <4CB9E27A.7050607@smartmediacorp.com>
	<AANLkTiktx7XZrj7L1n7BiK8Ya-7Qt4V3k1PEsubi-mCG@mail.gmail.com>
	<4CBA396F.7060101@smartmediacorp.com>
Message-ID: <001201cb6d8d$4603c6a0$d20b53e0$@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101017/9fa368fc/attachment.pl>

From mdelvaux at gmail.com  Sun Oct 17 02:10:09 2010
From: mdelvaux at gmail.com (Marc Delvaux)
Date: Sat, 16 Oct 2010 17:10:09 -0700
Subject: [R-SIG-Finance] Data Sources
In-Reply-To: <001201cb6d8d$4603c6a0$d20b53e0$@gmail.com>
References: <4CB9E27A.7050607@smartmediacorp.com>
	<AANLkTiktx7XZrj7L1n7BiK8Ya-7Qt4V3k1PEsubi-mCG@mail.gmail.com>
	<4CBA396F.7060101@smartmediacorp.com>
	<001201cb6d8d$4603c6a0$d20b53e0$@gmail.com>
Message-ID: <AANLkTimbdwgeu-qLEF1sEksQzX=CgCJGnc=m5AvvdJgK@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101016/d5d55cc8/attachment.pl>

From guygreen at netvigator.com  Sun Oct 17 04:44:06 2010
From: guygreen at netvigator.com (Guy Green)
Date: Sat, 16 Oct 2010 19:44:06 -0700 (PDT)
Subject: [R-SIG-Finance] Data Sources
In-Reply-To: <4CBA396F.7060101@smartmediacorp.com>
References: <4CB9E27A.7050607@smartmediacorp.com>
	<AANLkTiktx7XZrj7L1n7BiK8Ya-7Qt4V3k1PEsubi-mCG@mail.gmail.com>
	<4CBA396F.7060101@smartmediacorp.com>
Message-ID: <1287283446846-2998758.post@n4.nabble.com>


Noah,

Have a look at www.eoddata.com for relatively low-cost historical data.

Guy
-- 
View this message in context: http://r.789695.n4.nabble.com/Data-Sources-tp2998445p2998758.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From gerigk at gmail.com  Sun Oct 17 13:08:16 2010
From: gerigk at gmail.com (arthur)
Date: Sun, 17 Oct 2010 04:08:16 -0700 (PDT)
Subject: [R-SIG-Finance] Regression with ARMA errors and Student T
	innovations
Message-ID: <1287313696302-2998970.post@n4.nabble.com>


Is there a package that can do this?
And if not would you recommend coding the joint likelihood in R and then use
optim()?
The MA-part scares me a bit because of computation time.

I am not a C coder so I would like to avoid reading through C code of ARMA
regression + Normal innovations (like gls() ) and adapt that to Student T.

Thanks a lot for your help,

Arthur
-- 
View this message in context: http://r.789695.n4.nabble.com/Regression-with-ARMA-errors-and-Student-T-innovations-tp2998970p2998970.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From alexios at 4dscape.com  Sun Oct 17 18:06:58 2010
From: alexios at 4dscape.com (alexios)
Date: Sun, 17 Oct 2010 17:06:58 +0100
Subject: [R-SIG-Finance] Regression with ARMA errors and Student
	T	innovations
In-Reply-To: <1287313696302-2998970.post@n4.nabble.com>
References: <1287313696302-2998970.post@n4.nabble.com>
Message-ID: <4CBB1F22.4060005@4dscape.com>

You can do this with the rgarch package on r-forge which at present can
be downloaded from: rgarch.r-forge.r-project.org/download.html.

The functions you are likely to need are 'arfimaspec' and 'arfimafit'.
There are also methods for filtering, forecasting, simulation and
rolling estimation (see the documentation).

Extensive examples can be found in 'unit.test13.R' In the
'inst/src/rgarch.tests' folder of the source package or the
'rgarch.tests' folder of the binary package.

Regards,

Alexios Ghalanos


On 10/17/2010 12:08 PM, arthur wrote:
> 
> Is there a package that can do this?
> And if not would you recommend coding the joint likelihood in R and then use
> optim()?
> The MA-part scares me a bit because of computation time.
> 
> I am not a C coder so I would like to avoid reading through C code of ARMA
> regression + Normal innovations (like gls() ) and adapt that to Student T.
> 
> Thanks a lot for your help,
> 
> Arthur


From cmdr_rogue at hotmail.com  Mon Oct 18 01:13:34 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Sun, 17 Oct 2010 19:13:34 -0400
Subject: [R-SIG-Finance] Coefficients,
 Principal Component Regression. pcr
In-Reply-To: <COL124-W2563D1DEC714416B27A0B5E5560@phx.gbl>
References: <COL124-W2563D1DEC714416B27A0B5E5560@phx.gbl>
Message-ID: <BLU0-SMTP15857E2684B97BD18B4B7DCE2590@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101017/93e1f36f/attachment.pl>

From stephen at organicfoodmarkets.com.au  Tue Oct 19 00:03:55 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 19 Oct 2010 09:03:55 +1100
Subject: [R-SIG-Finance] Ornstein-Uhlenbeck
In-Reply-To: <4CB61698.6070601@organicfoodmarkets.com.au>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>
	<4CB61698.6070601@organicfoodmarkets.com.au>
Message-ID: <4CBCC44B.6060003@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/f4f8db8c/attachment.html>

From aeolus_lu at hotmail.com  Tue Oct 19 03:35:21 2010
From: aeolus_lu at hotmail.com (Yihao Lu aeolus_lu)
Date: Mon, 18 Oct 2010 21:35:21 -0400
Subject: [R-SIG-Finance] Mean reversion
In-Reply-To: <4CBCC44B.6060003@organicfoodmarkets.com.au>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>,
	<4CB61698.6070601@organicfoodmarkets.com.au>,
	<4CBCC44B.6060003@organicfoodmarkets.com.au>
Message-ID: <COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>


I am doing rolling ADF test on some time series to check mean reversion.?When I use short period rolling, I find the residue is not stationary at all. However, when I use horizon longer than 5 years, I find very significant stationary. On the other hand, I find the half life is only around 30 days.
Is there anyone who can give me some possible explanation or guide me to some reference? thanks

Best,
Yihao







________________________________
> Date: Tue, 19 Oct 2010 09:03:55 +1100
> From: stephen at organicfoodmarkets.com.au
> To: r-sig-finance at stat.math.ethz.ch
> CC: bjorn.skogtro at gmail.com
> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
>
> Hi
>
> I am still trying to sort this one out. Any comments from anyone would
> be most welcome.
>
> Stephen Choularton Ph.D., FIoD
>
>
>
> On 14/10/2010 7:29 AM, Stephen Choularton wrote:
> Thanks for this help.
>
> Trying to make sense of it so I have added some notes to the code. I
> have marked them #?#
>
> Delighted if you can tell me if I am write or wrong, add any comments,
> answers.
>
>
> #?# This appears to be the function that is doing the 'Ornstein-Uhlenbeck
> #?# process work' particularly via dcOU
> #?# I have noted in several places that I am after:
> #?# 'the half-life of the decay equals ln(2)/?'
> #?# 'The half-life is given as log(2)/mean-reversion speed.'
> #?# and I see theta appearing at a number of points in the code.
> #?# Can you tell me why 3 thetas viz theta1, theta2, theta3 and what they do?
> #?# eg is one of these the theta I am after?
>
> # ex3.01.R
> OU.lik <- function(theta1, theta2, theta3){
> n <- length(X)
> dt <- deltat(X)
> -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
> }
>
> require(stats4)
> require(sde)
>
> #?# random numer generation seed
> set.seed(123)
>
> #?# creation of a data set
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
> #?# If I Look at X its like this:
> #?# Time Series:
> #?# Start = 0
> #?# End = 1000
> #?# Frequency = 1
> #?# [1] 1.00000000 etc
> #?# What sort of data object is it and how would I coerce an object with one
> #?# column from a read.csv into it?
>
>
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit
> summary(fit)
>
> #?# This gives:
>
> #?# Maximum likelihood estimation
>
> #?# Call:
> #?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,
> #?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))
>
> #?# Coefficients:
> #?# Estimate Std. Error
> #?# theta1 3.355322 0.28159504
> #?# theta2 1.106107 0.09010627
> #?# theta3 2.052815 0.07624441
>
> #?# -2 log L: 3366.389
>
> #?# What's this telling me?
>
> # ex3.01.R (cont.)
> prof <- profile(fit)
> par(mfrow=c(1,3))
> plot(prof)
> par(mfrow=c(1,1))
> vcov(fit)
> confint(fit)
>
> #?# This provides me with this output using 'fit' from before:
>
> #?# > vcov(fit)
> #?# theta1 theta2 theta3
> #?# theta1 0.07929576 0.024620718 0.016634557
> #?# theta2 0.02462072 0.008119141 0.005485549
> #?# theta3 0.01663456 0.005485549 0.005813209
> #?# > confint(fit)
> #?# Profiling...
> #?# 2.5 % 97.5 %
> #?# theta1 2.8448980 3.960982
> #?# theta2 0.9433338 1.300629
> #?# theta3 1.9147136 2.216113
>
> #?# and 'fit' is:
>
> #?# Call:
> #?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,
> #?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))
>
> #?# Coefficients:
> #?# theta1 theta2 theta3
> #?# 3.355322 1.106107 2.052815
>
> #?# plus some graphic output
>
> #?# Again, what's this telling me.
>
> #?# This looks like a further example?
> # ex3.01.R (cont.)
> set.seed(123)
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2
> summary(fit2)
>
>
>
>
> Please excuse the length of this email (and my lack of understanding)
>
> Hope you can help and thanks.
>
>
>
>
> Stephen Choularton Ph.D., FIoD
>
>
> On 13/10/2010 2:41 AM, stefano iacus wrote:
>
> just for completeness: OU process is gaussian and transitiion density is known in exact form. So maximum likelihood estimation works fine and I suggest to avoid GMM.
>
> sde package contains exact transition density for this process (e.g. ?dcOU) which you can use to build the likelihood to pass to mle() function.
>
> This example taken from the "inst" directory of the package sde. For the parametrization of the model see ?dcOU
>
>
> # ex3.01.R
> OU.lik <- function(theta1, theta2, theta3){
> n <- length(X)
> dt <- deltat(X)
> -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
> }
>
> require(stats4)
> require(sde)
> set.seed(123)
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit
> summary(fit)
>
> # ex3.01.R (cont.)
> prof <- profile(fit)
> par(mfrow=c(1,3))
> plot(prof)
> par(mfrow=c(1,1))
> vcov(fit)
> confint(fit)
>
> # ex3.01.R (cont.)
> set.seed(123)
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2
> summary(fit2)
>
>
> I hope this helps out
>
> stefano
>
> On 12 Oct 2010, at 12:33, Bjorn Skogtro wrote:
>
>
>
> Hi Stephen,
>
> You could take a look at
>
> http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model
>
> for the linear regression method, or take a look at the package "sde" which
> contains some examples using GMM (not for the Ornstein-Uhlenbeck process,
> though, only the CIR).
>
> The half-life is given as log(2)/mean-reversion speed.
>
> Do keep an eye on the partition of the time-axis, e.g. what frequency you
> are using (daily, yearly) for interpreting the half-life.
>
> BR,
> Bj?rn
>
>
>
>
>
>
>
>
> ------------------------------
>
> Message: 2
> Date: Tue, 12 Oct 2010 05:43:32 -0400
> From: Sarbo
> To: r-sig-finance at stat.math.ethz.ch
> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
> Message-ID:
> Content-Type: text/plain; charset="utf-8"
>
> By half-life, do you mean the speed of mean-reversion?
>
> If so, there's a bit of algebraic tomfoolery that's required to
> discretise the equation and then fit the data to it. I don't have the
> time right now to go into all the details but it's not hard- you can
> parameterise the process using simple linear regression. If you need
> help with that I'll try and get back to you tonight about it.
>
> On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:
>
>
>
> Hi
>
> Wonder if anyone could point me how I use this method to discover the
> half life of a mean reverting process.
>
> I am looking into pair trading and the time it takes for a
> cointegrated pair to revert to the norm.
>
> --
> Stephen Choularton Ph.D., FIoD
>
> 9999 2226
> 0413 545 182
>
>
> for insurance go to www.netinsure.com.au
> for markets go to www.organicfoodmarkets.com.au
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
>
>
> should go.
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.html
>
>
> -------------- next part --------------
> A non-text attachment was scrubbed...
> Name: CoS2010Winner.JPG
> Type: image/jpeg
> Size: 16091 bytes
> Desc: not available
> URL: <
> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.jpe
>
>
> ------------------------------
>
> _______________________________________________
> R-SIG-Finance mailing list
> R-SIG-Finance at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
> End of R-SIG-Finance Digest, Vol 77, Issue 8
> ********************************************
>
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> -----------------------------------
> Stefano M. Iacus
> Department of Economics,
> Business and Statistics
> University of Milan
> Via Conservatorio, 7
> I-20123 Milan - Italy
> Ph.: +39 02 50321 461
> Fax: +39 02 50321 505
> http://www.economia.unimi.it/iacus
> ------------------------------------------------------------------------------------
> Please don't send me Word or PowerPoint attachments if not
> absolutely necessary. See:
> http://www.gnu.org/philosophy/no-word-attachments.html
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com
>
>
>
>
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com
>
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance --
> Subscriber-posting only. If you want to post, subscribe first. -- Also
> note that this is not the r-help list where general R questions should
> go.
 		 	   		  

From stephen at organicfoodmarkets.com.au  Tue Oct 19 03:50:46 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 19 Oct 2010 12:50:46 +1100
Subject: [R-SIG-Finance] Mean reversion
In-Reply-To: <COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>,
	<4CB61698.6070601@organicfoodmarkets.com.au>,
	<4CBCC44B.6060003@organicfoodmarkets.com.au>
	<COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
Message-ID: <4CBCF976.1070406@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/afd1867c/attachment.html>

From aeolus_lu at hotmail.com  Tue Oct 19 04:20:55 2010
From: aeolus_lu at hotmail.com (Yihao Lu aeolus_lu)
Date: Mon, 18 Oct 2010 22:20:55 -0400
Subject: [R-SIG-Finance] Mean reversion
In-Reply-To: <4CBCF976.1070406@organicfoodmarkets.com.au>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>,
	<4CB61698.6070601@organicfoodmarkets.com.au>,
	<4CBCC44B.6060003@organicfoodmarkets.com.au>
	<COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>,
	<4CBCF976.1070406@organicfoodmarkets.com.au>
Message-ID: <COL120-W27E889C078705E4E27DE68885B0@phx.gbl>


regarding your problem, i think Bjorn's link is very helpful. it even has the matlab code attached. several lines, you can translate it into R and do a comparison on the data, you will have the idea which theta is the rate you should look at.



Best,
Yihao







________________________________
> Date: Tue, 19 Oct 2010 12:50:46 +1100
> From: stephen at organicfoodmarkets.com.au
> To: aeolus_lu at hotmail.com
> CC: r-sig-finance at stat.math.ethz.ch
> Subject: Re: [R-SIG-Finance] Mean reversion
>
> Wish I could, but as you can see I am having even greater problems ;-)
>
> Stephen Choularton Ph.D., FIoD
>
> On 19/10/2010 12:35 PM, Yihao Lu aeolus_lu wrote:
>
>
> I am doing rolling ADF test on some time series to check mean reversion. When I use short period rolling, I find the residue is not stationary at all. However, when I use horizon longer than 5 years, I find very significant stationary. On the other hand, I find the half life is only around 30 days.
> Is there anyone who can give me some possible explanation or guide me to some reference? thanks
>
> Best,
> Yihao
>
>
>
>
>
>
>
> ________________________________
>
>
> Date: Tue, 19 Oct 2010 09:03:55 +1100
> From: stephen at organicfoodmarkets.com.au
> To: r-sig-finance at stat.math.ethz.ch
> CC: bjorn.skogtro at gmail.com
> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
>
> Hi
>
> I am still trying to sort this one out. Any comments from anyone would
> be most welcome.
>
> Stephen Choularton Ph.D., FIoD
>
>
>
> On 14/10/2010 7:29 AM, Stephen Choularton wrote:
> Thanks for this help.
>
> Trying to make sense of it so I have added some notes to the code. I
> have marked them #?#
>
> Delighted if you can tell me if I am write or wrong, add any comments,
> answers.
>
>
> #?# This appears to be the function that is doing the 'Ornstein-Uhlenbeck
> #?# process work' particularly via dcOU
> #?# I have noted in several places that I am after:
> #?# 'the half-life of the decay equals ln(2)/?'
> #?# 'The half-life is given as log(2)/mean-reversion speed.'
> #?# and I see theta appearing at a number of points in the code.
> #?# Can you tell me why 3 thetas viz theta1, theta2, theta3 and what they do?
> #?# eg is one of these the theta I am after?
>
> # ex3.01.R
> OU.lik <- function(theta1, theta2, theta3){
> n <- length(X)
> dt <- deltat(X)
> -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
> }
>
> require(stats4)
> require(sde)
>
> #?# random numer generation seed
> set.seed(123)
>
> #?# creation of a data set
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
> #?# If I Look at X its like this:
> #?# Time Series:
> #?# Start = 0
> #?# End = 1000
> #?# Frequency = 1
> #?# [1] 1.00000000 etc
> #?# What sort of data object is it and how would I coerce an object with one
> #?# column from a read.csv into it?
>
>
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit
> summary(fit)
>
> #?# This gives:
>
> #?# Maximum likelihood estimation
>
> #?# Call:
> #?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,
> #?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))
>
> #?# Coefficients:
> #?# Estimate Std. Error
> #?# theta1 3.355322 0.28159504
> #?# theta2 1.106107 0.09010627
> #?# theta3 2.052815 0.07624441
>
> #?# -2 log L: 3366.389
>
> #?# What's this telling me?
>
> # ex3.01.R (cont.)
> prof <- profile(fit)
> par(mfrow=c(1,3))
> plot(prof)
> par(mfrow=c(1,1))
> vcov(fit)
> confint(fit)
>
> #?# This provides me with this output using 'fit' from before:
>
> #?# > vcov(fit)
> #?# theta1 theta2 theta3
> #?# theta1 0.07929576 0.024620718 0.016634557
> #?# theta2 0.02462072 0.008119141 0.005485549
> #?# theta3 0.01663456 0.005485549 0.005813209
> #?# > confint(fit)
> #?# Profiling...
> #?# 2.5 % 97.5 %
> #?# theta1 2.8448980 3.960982
> #?# theta2 0.9433338 1.300629
> #?# theta3 1.9147136 2.216113
>
> #?# and 'fit' is:
>
> #?# Call:
> #?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,
> #?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))
>
> #?# Coefficients:
> #?# theta1 theta2 theta3
> #?# 3.355322 1.106107 2.052815
>
> #?# plus some graphic output
>
> #?# Again, what's this telling me.
>
> #?# This looks like a further example?
> # ex3.01.R (cont.)
> set.seed(123)
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2
> summary(fit2)
>
>
>
>
> Please excuse the length of this email (and my lack of understanding)
>
> Hope you can help and thanks.
>
>
>
>
> Stephen Choularton Ph.D., FIoD
>
>
> On 13/10/2010 2:41 AM, stefano iacus wrote:
>
> just for completeness: OU process is gaussian and transitiion density is known in exact form. So maximum likelihood estimation works fine and I suggest to avoid GMM.
>
> sde package contains exact transition density for this process (e.g. ?dcOU) which you can use to build the likelihood to pass to mle() function.
>
> This example taken from the "inst" directory of the package sde. For the parametrization of the model see ?dcOU
>
>
> # ex3.01.R
> OU.lik <- function(theta1, theta2, theta3){
> n <- length(X)
> dt <- deltat(X)
> -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
> }
>
> require(stats4)
> require(sde)
> set.seed(123)
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit
> summary(fit)
>
> # ex3.01.R (cont.)
> prof <- profile(fit)
> par(mfrow=c(1,3))
> plot(prof)
> par(mfrow=c(1,1))
> vcov(fit)
> confint(fit)
>
> # ex3.01.R (cont.)
> set.seed(123)
> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2
> summary(fit2)
>
>
> I hope this helps out
>
> stefano
>
> On 12 Oct 2010, at 12:33, Bjorn Skogtro wrote:
>
>
>
> Hi Stephen,
>
> You could take a look at
>
> http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model
>
> for the linear regression method, or take a look at the package "sde" which
> contains some examples using GMM (not for the Ornstein-Uhlenbeck process,
> though, only the CIR).
>
> The half-life is given as log(2)/mean-reversion speed.
>
> Do keep an eye on the partition of the time-axis, e.g. what frequency you
> are using (daily, yearly) for interpreting the half-life.
>
> BR,
> Bj?rn
>
>
>
>
>
>
>
>
> ------------------------------
>
> Message: 2
> Date: Tue, 12 Oct 2010 05:43:32 -0400
> From: Sarbo
> To: r-sig-finance at stat.math.ethz.ch
> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
> Message-ID:
> Content-Type: text/plain; charset="utf-8"
>
> By half-life, do you mean the speed of mean-reversion?
>
> If so, there's a bit of algebraic tomfoolery that's required to
> discretise the equation and then fit the data to it. I don't have the
> time right now to go into all the details but it's not hard- you can
> parameterise the process using simple linear regression. If you need
> help with that I'll try and get back to you tonight about it.
>
> On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:
>
>
>
> Hi
>
> Wonder if anyone could point me how I use this method to discover the
> half life of a mean reverting process.
>
> I am looking into pair trading and the time it takes for a
> cointegrated pair to revert to the norm.
>
> --
> Stephen Choularton Ph.D., FIoD
>
> 9999 2226
> 0413 545 182
>
>
> for insurance go to www.netinsure.com.au
> for markets go to www.organicfoodmarkets.com.au
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
>
>
> should go.
>
>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.html
>
>
> -------------- next part --------------
> A non-text attachment was scrubbed...
> Name: CoS2010Winner.JPG
> Type: image/jpeg
> Size: 16091 bytes
> Desc: not available
> URL: <
> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.jpe
>
>
> ------------------------------
>
> _______________________________________________
> R-SIG-Finance mailing list
> R-SIG-Finance at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>
>
> End of R-SIG-Finance Digest, Vol 77, Issue 8
> ********************************************
>
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> -----------------------------------
> Stefano M. Iacus
> Department of Economics,
> Business and Statistics
> University of Milan
> Via Conservatorio, 7
> I-20123 Milan - Italy
> Ph.: +39 02 50321 461
> Fax: +39 02 50321 505
> http://www.economia.unimi.it/iacus
> ------------------------------------------------------------------------------------
> Please don't send me Word or PowerPoint attachments if not
> absolutely necessary. See:
> http://www.gnu.org/philosophy/no-word-attachments.html
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com
>
>
>
>
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com
>
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance --
> Subscriber-posting only. If you want to post, subscribe first. -- Also
> note that this is not the r-help list where general R questions should
> go.
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
>
>
> No virus found in this incoming message.
> Checked by AVG - www.avg.com
> Version: 9.0.862 / Virus Database: 271.1.1/3204 - Release Date: 10/18/10 17:34:00
>
>


From stephen at organicfoodmarkets.com.au  Tue Oct 19 04:46:24 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 19 Oct 2010 13:46:24 +1100
Subject: [R-SIG-Finance] cointegration
In-Reply-To: <COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>,
	<4CB61698.6070601@organicfoodmarkets.com.au>,
	<4CBCC44B.6060003@organicfoodmarkets.com.au>
	<COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
Message-ID: <4CBD0680.4030706@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/4abd0c83/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CoS2010Winner.JPG
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/4abd0c83/attachment.jpe>

From ezivot at u.washington.edu  Tue Oct 19 05:28:40 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Mon, 18 Oct 2010 20:28:40 -0700 (PDT)
Subject: [R-SIG-Finance] Mean reversion
In-Reply-To: <COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
Message-ID: <alpine.LRH.2.01.1010182028400.31492@hymn11.u.washington.edu>

You have to be careful when interpreting rolling ADF tests because the usual critical values for evaluating the tests are not valid. See the 1992 Journal of Business and Economic Statistics paper by Banerjee, Lumsdaine and Stock.

****************************************************************
*  Eric Zivot                  			               *
*  Professor and Gary Waterman Distinguished Scholar           *
*  Department of Economics                                     *
*  Adjunct Professor of Finance                                *
*  Adjunct Professor of Statistics
*  Box 353330                  email:  ezivot at u.washington.edu *
*  University of Washington    phone:  206-543-6715            *
*  Seattle, WA 98195-3330                                      *                                                           *
*  www:  http://faculty.washington.edu/ezivot                  *
****************************************************************

On Mon, 18 Oct 2010, Yihao Lu aeolus_lu wrote:

>
> I am doing rolling ADF test on some time series to check mean reversion.?When I use short period rolling, I find the residue is not stationary at all. However, when I use horizon longer than 5 years, I find very significant stationary. On the other hand, I find the half life is only around 30 days.
> Is there anyone who can give me some possible explanation or guide me to some reference? thanks
>
> Best,
> Yihao
>
>
>
>
>
>
>
> ________________________________
>> Date: Tue, 19 Oct 2010 09:03:55 +1100
>> From: stephen at organicfoodmarkets.com.au
>> To: r-sig-finance at stat.math.ethz.ch
>> CC: bjorn.skogtro at gmail.com
>> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
>>
>> Hi
>>
>> I am still trying to sort this one out. Any comments from anyone would
>> be most welcome.
>>
>> Stephen Choularton Ph.D., FIoD
>>
>>
>>
>> On 14/10/2010 7:29 AM, Stephen Choularton wrote:
>> Thanks for this help.
>>
>> Trying to make sense of it so I have added some notes to the code. I
>> have marked them #?#
>>
>> Delighted if you can tell me if I am write or wrong, add any comments,
>> answers.
>>
>>
>> #?# This appears to be the function that is doing the 'Ornstein-Uhlenbeck
>> #?# process work' particularly via dcOU
>> #?# I have noted in several places that I am after:
>> #?# 'the half-life of the decay equals ln(2)/?'
>> #?# 'The half-life is given as log(2)/mean-reversion speed.'
>> #?# and I see theta appearing at a number of points in the code.
>> #?# Can you tell me why 3 thetas viz theta1, theta2, theta3 and what they do?
>> #?# eg is one of these the theta I am after?
>>
>> # ex3.01.R
>> OU.lik <- function(theta1, theta2, theta3){
>> n <- length(X)
>> dt <- deltat(X)
>> -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
>> }
>>
>> require(stats4)
>> require(sde)
>>
>> #?# random numer generation seed
>> set.seed(123)
>>
>> #?# creation of a data set
>> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
>> #?# If I Look at X its like this:
>> #?# Time Series:
>> #?# Start = 0
>> #?# End = 1000
>> #?# Frequency = 1
>> #?# [1] 1.00000000 etc
>> #?# What sort of data object is it and how would I coerce an object with one
>> #?# column from a read.csv into it?
>>
>>
>> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit
>> summary(fit)
>>
>> #?# This gives:
>>
>> #?# Maximum likelihood estimation
>>
>> #?# Call:
>> #?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,
>> #?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))
>>
>> #?# Coefficients:
>> #?# Estimate Std. Error
>> #?# theta1 3.355322 0.28159504
>> #?# theta2 1.106107 0.09010627
>> #?# theta3 2.052815 0.07624441
>>
>> #?# -2 log L: 3366.389
>>
>> #?# What's this telling me?
>>
>> # ex3.01.R (cont.)
>> prof <- profile(fit)
>> par(mfrow=c(1,3))
>> plot(prof)
>> par(mfrow=c(1,1))
>> vcov(fit)
>> confint(fit)
>>
>> #?# This provides me with this output using 'fit' from before:
>>
>> #?# > vcov(fit)
>> #?# theta1 theta2 theta3
>> #?# theta1 0.07929576 0.024620718 0.016634557
>> #?# theta2 0.02462072 0.008119141 0.005485549
>> #?# theta3 0.01663456 0.005485549 0.005813209
>> #?# > confint(fit)
>> #?# Profiling...
>> #?# 2.5 % 97.5 %
>> #?# theta1 2.8448980 3.960982
>> #?# theta2 0.9433338 1.300629
>> #?# theta3 1.9147136 2.216113
>>
>> #?# and 'fit' is:
>>
>> #?# Call:
>> #?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,
>> #?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))
>>
>> #?# Coefficients:
>> #?# theta1 theta2 theta3
>> #?# 3.355322 1.106107 2.052815
>>
>> #?# plus some graphic output
>>
>> #?# Again, what's this telling me.
>>
>> #?# This looks like a further example?
>> # ex3.01.R (cont.)
>> set.seed(123)
>> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
>> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2
>> summary(fit2)
>>
>>
>>
>>
>> Please excuse the length of this email (and my lack of understanding)
>>
>> Hope you can help and thanks.
>>
>>
>>
>>
>> Stephen Choularton Ph.D., FIoD
>>
>>
>> On 13/10/2010 2:41 AM, stefano iacus wrote:
>>
>> just for completeness: OU process is gaussian and transitiion density is known in exact form. So maximum likelihood estimation works fine and I suggest to avoid GMM.
>>
>> sde package contains exact transition density for this process (e.g. ?dcOU) which you can use to build the likelihood to pass to mle() function.
>>
>> This example taken from the "inst" directory of the package sde. For the parametrization of the model see ?dcOU
>>
>>
>> # ex3.01.R
>> OU.lik <- function(theta1, theta2, theta3){
>> n <- length(X)
>> dt <- deltat(X)
>> -sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))
>> }
>>
>> require(stats4)
>> require(sde)
>> set.seed(123)
>> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)
>> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit
>> summary(fit)
>>
>> # ex3.01.R (cont.)
>> prof <- profile(fit)
>> par(mfrow=c(1,3))
>> plot(prof)
>> par(mfrow=c(1,1))
>> vcov(fit)
>> confint(fit)
>>
>> # ex3.01.R (cont.)
>> set.seed(123)
>> X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)
>> mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),
>> method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2
>> summary(fit2)
>>
>>
>> I hope this helps out
>>
>> stefano
>>
>> On 12 Oct 2010, at 12:33, Bjorn Skogtro wrote:
>>
>>
>>
>> Hi Stephen,
>>
>> You could take a look at
>>
>> http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model
>>
>> for the linear regression method, or take a look at the package "sde" which
>> contains some examples using GMM (not for the Ornstein-Uhlenbeck process,
>> though, only the CIR).
>>
>> The half-life is given as log(2)/mean-reversion speed.
>>
>> Do keep an eye on the partition of the time-axis, e.g. what frequency you
>> are using (daily, yearly) for interpreting the half-life.
>>
>> BR,
>> Bj?rn
>>
>>
>>
>>
>>
>>
>>
>>
>> ------------------------------
>>
>> Message: 2
>> Date: Tue, 12 Oct 2010 05:43:32 -0400
>> From: Sarbo
>> To: r-sig-finance at stat.math.ethz.ch
>> Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck
>> Message-ID:
>> Content-Type: text/plain; charset="utf-8"
>>
>> By half-life, do you mean the speed of mean-reversion?
>>
>> If so, there's a bit of algebraic tomfoolery that's required to
>> discretise the equation and then fit the data to it. I don't have the
>> time right now to go into all the details but it's not hard- you can
>> parameterise the process using simple linear regression. If you need
>> help with that I'll try and get back to you tonight about it.
>>
>> On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:
>>
>>
>>
>> Hi
>>
>> Wonder if anyone could point me how I use this method to discover the
>> half life of a mean reverting process.
>>
>> I am looking into pair trading and the time it takes for a
>> cointegrated pair to revert to the norm.
>>
>> --
>> Stephen Choularton Ph.D., FIoD
>>
>> 9999 2226
>> 0413 545 182
>>
>>
>> for insurance go to www.netinsure.com.au
>> for markets go to www.organicfoodmarkets.com.au
>>
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>>
>>
>> should go.
>>
>>
>> -------------- next part --------------
>> An HTML attachment was scrubbed...
>> URL: <
>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.html
>>
>>
>> -------------- next part --------------
>> A non-text attachment was scrubbed...
>> Name: CoS2010Winner.JPG
>> Type: image/jpeg
>> Size: 16091 bytes
>> Desc: not available
>> URL: <
>> https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.jpe
>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> R-SIG-Finance mailing list
>> R-SIG-Finance at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>
>>
>> End of R-SIG-Finance Digest, Vol 77, Issue 8
>> ********************************************
>>
>>
>> [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>
>>
>> -----------------------------------
>> Stefano M. Iacus
>> Department of Economics,
>> Business and Statistics
>> University of Milan
>> Via Conservatorio, 7
>> I-20123 Milan - Italy
>> Ph.: +39 02 50321 461
>> Fax: +39 02 50321 505
>> http://www.economia.unimi.it/iacus
>> ------------------------------------------------------------------------------------
>> Please don't send me Word or PowerPoint attachments if not
>> absolutely necessary. See:
>> http://www.gnu.org/philosophy/no-word-attachments.html
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>
>>
>>
>>
>> No virus found in this incoming message.
>> Checked by AVG - www.avg.com
>>
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>
>>
>>
>>
>> No virus found in this incoming message.
>> Checked by AVG - www.avg.com
>>
>>
>>
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance --
>> Subscriber-posting only. If you want to post, subscribe first. -- Also
>> note that this is not the r-help list where general R questions should
>> go.
> 		 	   		  
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

From cmdr_rogue at hotmail.com  Tue Oct 19 12:59:37 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Tue, 19 Oct 2010 06:59:37 -0400
Subject: [R-SIG-Finance] Mean reversion
In-Reply-To: <COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>
	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>
	, <4CB61698.6070601@organicfoodmarkets.com.au>
	, <4CBCC44B.6060003@organicfoodmarkets.com.au>
	<COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
Message-ID: <BLU0-SMTP79BDF0C3CE2DC969FD904EE25B0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/4d6727a2/attachment.pl>

From paulteetor at yahoo.com  Tue Oct 19 16:03:01 2010
From: paulteetor at yahoo.com (Paul Teetor)
Date: Tue, 19 Oct 2010 09:03:01 -0500
Subject: [R-SIG-Finance] cointegration
In-Reply-To: <4CBD0680.4030706@organicfoodmarkets.com.au>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>,
	<4CB61698.6070601@organicfoodmarkets.com.au>,
	<4CBCC44B.6060003@organicfoodmarkets.com.au><COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>
	<4CBD0680.4030706@organicfoodmarkets.com.au>
Message-ID: <4C087900780F4B39BD687C6A92ABDA4C@XI>

Stephen,
 
It depends what you mean by "logic".
 
If you mean statistical logic, I'll defer to Eric Zivot and Sarbo who are far wiser than I am. I will note, however, that you are testing for a p-value of 0.05, so I expect 5% of your test results to be misleading. In other words, for every 20 pairs tested by your batch job, I expect one will be suspect.
 
"Spurious cointegration" is a serious problem. I suggest Googling that topic. You may be suprised what you learn. (The irony, of course, is that cointegration was supposed to cure "spurious correlation." Oh well.)
 
If you mean financial logic, I strongly suggest not blindly risking money on your statistical test. Some filtering is required. Look for trades that make sense.
 
For example, my software reports that the stocks of MSFT and GOOG form a mean-reverting pair. But I would not trade that spread: too much idiosyncratic risk. My software also reports that Corn futures and Soybean Oil futures form a mean-reverting pair. But I would not trade that spread because the economic connection between corn and bean oil is too weak.
 
Hope that helps.
 
Paul

  _____  

From: r-sig-finance-bounces at stat.math.ethz.ch [mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Stephen Choularton
Sent: Monday, October 18, 2010 9:46 PM
To: r-sig-finance at stat.math.ethz.ch
Subject: [R-SIG-Finance] cointegration


Hi Folks

I'm using this to find cointegrated stocks on the AX.

library(xts)
library(quantmod)

# quickly re-source this file
s <- function() source('meanrev.R')

checkPairFromYahoo <- function(sym1, sym2, dateFilter='::')
{
  t.xts <- getCombined(sym1, sym2, dateFilter=dateFilter)

  cat("Date range is", format(start(t.xts)), "to", format(end(t.xts)), "\n")

  # Build linear model
  m <- buildLM(t.xts)

  # Note beta -- http://en.wikipedia.org/wiki/Beta_(finance)
  beta <- getBeta(m)
  cat("Assumed hedge ratio is", beta, "\n")

  # Build spread
  sprd <- buildSpread(t.xts, beta)

  # Test cointegration
  ht <- testCoint(sprd)
  cat("PP p-value is", as.double(ht$p.value), "\n")

  if (as.double(ht$p.value) < 0.05)
  {
    cat("###############################################################\n", sym1 ,":", sym2 ," is likely mean-reverting.\n", "###########################################################\n" )
  }
  else
  {
    #cat(sym1 ,":", sym2 ," is not mean-reverting.\n")
  }
}

getCombined <- function(sym1, sym2, dateFilter='::')
{
  # Grab historical data for both symbols
  one <- getSymbols(sym1, auto.assign=FALSE)
  two <- getSymbols(sym2, auto.assign=FALSE)

  # Give columns more usable names
  colnames(one) <- c('Open', 'High', 'Low', 'Close', 'Volume', 'Adjusted')
  colnames(two) <- c('Open', 'High', 'Low', 'Close', 'Volume', 'Adjusted')

  # Build combined object
  return(merge(one$Close, two$Close, all=FALSE)[dateFilter])
}

buildLM <- function(combined)
{
  return(lm(Close ~ Close.1 + 0, combined))
}

getBeta <- function(m)
{
  return(as.double(coef(m)[1]))
}

buildSpread <- function(combined, beta)
{
  return(combined$Close - beta*combined$Close.1)
}

testCoint <- function(sprd)
{
  return(PP.test(sprd, lshort = FALSE))
}

I run it on batches of stock-pairs and then have a look at those which are cointegrated.  Assuming my code is right (and anyone who thinks there is something wrong with it please let me know ;-)

Just wondered if anyone simply goes with the results, or if a test of logic is required.  I found, for example, that AGL ( a big gas company) was cointegrated with Bunnings Wharehouses (a hardware superstore chain).  Can't see the reason for that.  AMP (major insurer) cointegrates with AXA (another major insurer).  That makes sense and it cointegrates with  Westpac (major bank) still some logic but a bit thinner.  It also cointegrates with Fortescue Metals (big iron ore operation).  Not much logic there.  Anyway question is: do you get better results by using informed judgement on these things or just trust the figures?

Any comments most welcome.



Stephen Choularton Ph.D., FIoD

9999 2226
0413 545 182


for insurance go to www.netinsure.com.au
for markets go to www.organicfoodmarkets.com.au


On 19/10/2010 12:35 PM, Yihao Lu aeolus_lu wrote: 

I am doing rolling ADF test on some time series to check mean reversion. When I use short period rolling, I find the residue is not stationary at all. However, when I use horizon longer than 5 years, I find very significant stationary. On the other hand, I find the half life is only around 30 days.

Is there anyone who can give me some possible explanation or guide me to some reference? thanks



Best,

Yihao















________________________________

Date: Tue, 19 Oct 2010 09:03:55 +1100

From: stephen at organicfoodmarkets.com.au

To: r-sig-finance at stat.math.ethz.ch

CC: bjorn.skogtro at gmail.com

Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck



Hi



I am still trying to sort this one out. Any comments from anyone would

be most welcome.



Stephen Choularton Ph.D., FIoD







On 14/10/2010 7:29 AM, Stephen Choularton wrote:

Thanks for this help.



Trying to make sense of it so I have added some notes to the code. I

have marked them #?#



Delighted if you can tell me if I am write or wrong, add any comments,

answers.





#?# This appears to be the function that is doing the 'Ornstein-Uhlenbeck

#?# process work' particularly via dcOU

#?# I have noted in several places that I am after:

#?# 'the half-life of the decay equals ln(2)/?'

#?# 'The half-life is given as log(2)/mean-reversion speed.'

#?# and I see theta appearing at a number of points in the code.

#?# Can you tell me why 3 thetas viz theta1, theta2, theta3 and what they do?

#?# eg is one of these the theta I am after?



# ex3.01.R

OU.lik <- function(theta1, theta2, theta3){

n <- length(X)

dt <- deltat(X)

-sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))

}



require(stats4)

require(sde)



#?# random numer generation seed

set.seed(123)



#?# creation of a data set

X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)

#?# If I Look at X its like this:

#?# Time Series:

#?# Start = 0

#?# End = 1000

#?# Frequency = 1

#?# [1] 1.00000000 etc

#?# What sort of data object is it and how would I coerce an object with one

#?# column from a read.csv into it?





mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),

method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit

summary(fit)



#?# This gives:



#?# Maximum likelihood estimation



#?# Call:

#?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,

#?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))



#?# Coefficients:

#?# Estimate Std. Error

#?# theta1 3.355322 0.28159504

#?# theta2 1.106107 0.09010627

#?# theta3 2.052815 0.07624441



#?# -2 log L: 3366.389



#?# What's this telling me?



# ex3.01.R (cont.)

prof <- profile(fit)

par(mfrow=c(1,3))

plot(prof)

par(mfrow=c(1,1))

vcov(fit)

confint(fit)



#?# This provides me with this output using 'fit' from before:



#?# > vcov(fit)

#?# theta1 theta2 theta3

#?# theta1 0.07929576 0.024620718 0.016634557

#?# theta2 0.02462072 0.008119141 0.005485549

#?# theta3 0.01663456 0.005485549 0.005813209

#?# > confint(fit)

#?# Profiling...

#?# 2.5 % 97.5 %

#?# theta1 2.8448980 3.960982

#?# theta2 0.9433338 1.300629

#?# theta3 1.9147136 2.216113



#?# and 'fit' is:



#?# Call:

#?# mle(minuslogl = OU.lik, start = list(theta1 = 1, theta2 = 0.5,

#?# theta3 = 1), method = "L-BFGS-B", lower = c(-Inf, 0, 0))



#?# Coefficients:

#?# theta1 theta2 theta3

#?# 3.355322 1.106107 2.052815



#?# plus some graphic output



#?# Again, what's this telling me.



#?# This looks like a further example?

# ex3.01.R (cont.)

set.seed(123)

X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)

mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),

method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2

summary(fit2)









Please excuse the length of this email (and my lack of understanding)



Hope you can help and thanks.









Stephen Choularton Ph.D., FIoD





On 13/10/2010 2:41 AM, stefano iacus wrote:



just for completeness: OU process is gaussian and transitiion density is known in exact form. So maximum likelihood estimation works fine and I suggest to avoid GMM.



sde package contains exact transition density for this process (e.g. ?dcOU) which you can use to build the likelihood to pass to mle() function.



This example taken from the "inst" directory of the package sde. For the parametrization of the model see ?dcOU





# ex3.01.R

OU.lik <- function(theta1, theta2, theta3){

n <- length(X)

dt <- deltat(X)

-sum(dcOU(X[2:n], dt, X[1:(n-1)], c(theta1,theta2,theta3), log=TRUE))

}



require(stats4)

require(sde)

set.seed(123)

X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1)

mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),

method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit

summary(fit)



# ex3.01.R (cont.)

prof <- profile(fit)

par(mfrow=c(1,3))

plot(prof)

par(mfrow=c(1,1))

vcov(fit)

confint(fit)



# ex3.01.R (cont.)

set.seed(123)

X <- sde.sim(model="OU", theta=c(3,1,2), N=1000, delta=1e-3)

mle(OU.lik, start=list(theta1=1, theta2=0.5, theta3=1),

method="L-BFGS-B", lower=c(-Inf,0,0)) -> fit2

summary(fit2)





I hope this helps out



stefano



On 12 Oct 2010, at 12:33, Bjorn Skogtro wrote:







Hi Stephen,



You could take a look at



http://sitmo.com/doc/Calibrating_the_Ornstein-Uhlenbeck_model



for the linear regression method, or take a look at the package "sde" which

contains some examples using GMM (not for the Ornstein-Uhlenbeck process,

though, only the CIR).



The half-life is given as log(2)/mean-reversion speed.



Do keep an eye on the partition of the time-axis, e.g. what frequency you

are using (daily, yearly) for interpreting the half-life.



BR,

Bj?rn

















------------------------------



Message: 2

Date: Tue, 12 Oct 2010 05:43:32 -0400

From: Sarbo

To: r-sig-finance at stat.math.ethz.ch

Subject: Re: [R-SIG-Finance] Ornstein-Uhlenbeck

Message-ID:

Content-Type: text/plain; charset="utf-8"



By half-life, do you mean the speed of mean-reversion?



If so, there's a bit of algebraic tomfoolery that's required to

discretise the equation and then fit the data to it. I don't have the

time right now to go into all the details but it's not hard- you can

parameterise the process using simple linear regression. If you need

help with that I'll try and get back to you tonight about it.



On Tue, 2010-10-12 at 13:47 +1100, Stephen Choularton wrote:







Hi



Wonder if anyone could point me how I use this method to discover the

half life of a mean reverting process.



I am looking into pair trading and the time it takes for a

cointegrated pair to revert to the norm.



--

Stephen Choularton Ph.D., FIoD



9999 2226

0413 545 182





for insurance go to www.netinsure.com.au

for markets go to www.organicfoodmarkets.com.au





_______________________________________________

R-SIG-Finance at stat.math.ethz.ch mailing list

https://stat.ethz.ch/mailman/listinfo/r-sig-finance

-- Subscriber-posting only. If you want to post, subscribe first.

-- Also note that this is not the r-help list where general R questions





should go.





-------------- next part --------------

An HTML attachment was scrubbed...

URL: <

https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.html





-------------- next part --------------

A non-text attachment was scrubbed...

Name: CoS2010Winner.JPG

Type: image/jpeg

Size: 16091 bytes

Desc: not available

URL: <

https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101012/26e32fc7/attachment-0001.jpe





------------------------------



_______________________________________________

R-SIG-Finance mailing list

R-SIG-Finance at stat.math.ethz.ch

https://stat.ethz.ch/mailman/listinfo/r-sig-finance





End of R-SIG-Finance Digest, Vol 77, Issue 8

********************************************





[[alternative HTML version deleted]]



_______________________________________________

R-SIG-Finance at stat.math.ethz.ch mailing list

https://stat.ethz.ch/mailman/listinfo/r-sig-finance

-- Subscriber-posting only. If you want to post, subscribe first.

-- Also note that this is not the r-help list where general R questions should go.







-----------------------------------

Stefano M. Iacus

Department of Economics,

Business and Statistics

University of Milan

Via Conservatorio, 7

I-20123 Milan - Italy

Ph.: +39 02 50321 461

Fax: +39 02 50321 505

http://www.economia.unimi.it/iacus

------------------------------------------------------------------------------------

Please don't send me Word or PowerPoint attachments if not

absolutely necessary. See:

http://www.gnu.org/philosophy/no-word-attachments.html



_______________________________________________

R-SIG-Finance at stat.math.ethz.ch mailing list

https://stat.ethz.ch/mailman/listinfo/r-sig-finance

-- Subscriber-posting only. If you want to post, subscribe first.

-- Also note that this is not the r-help list where general R questions should go.











No virus found in this incoming message.

Checked by AVG - www.avg.com















_______________________________________________

R-SIG-Finance at stat.math.ethz.ch mailing list

https://stat.ethz.ch/mailman/listinfo/r-sig-finance

-- Subscriber-posting only. If you want to post, subscribe first.

-- Also note that this is not the r-help list where general R questions should go.











No virus found in this incoming message.

Checked by AVG - www.avg.com









_______________________________________________

R-SIG-Finance at stat.math.ethz.ch mailing list

https://stat.ethz.ch/mailman/listinfo/r-sig-finance --

Subscriber-posting only. If you want to post, subscribe first. -- Also

note that this is not the r-help list where general R questions should

go.

 		 	   		  

_______________________________________________

R-SIG-Finance at stat.math.ethz.ch mailing list

https://stat.ethz.ch/mailman/listinfo/r-sig-finance

-- Subscriber-posting only. If you want to post, subscribe first.

-- Also note that this is not the r-help list where general R questions should go.




No virus found in this incoming message.

Checked by AVG - www.avg.com 





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/08079fb9/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/08079fb9/attachment.jpe>

From aeolus_lu at hotmail.com  Tue Oct 19 16:20:00 2010
From: aeolus_lu at hotmail.com (Yihao Lu aeolus_lu)
Date: Tue, 19 Oct 2010 10:20:00 -0400
Subject: [R-SIG-Finance] Mean reversion
In-Reply-To: <BLU0-SMTP79BDF0C3CE2DC969FD904EE25B0@phx.gbl>
References: <AANLkTinn6_ODTBDWfmiQG7B5ZQKt5N7Ce_DR6_sZwOq8@mail.gmail.com>,
	<0C7BE64B-F2CB-40E4-BEAA-5ED53AA1C27D@unimi.it>, , 
	<4CB61698.6070601@organicfoodmarkets.com.au>,,
	<4CBCC44B.6060003@organicfoodmarkets.com.au>,
	<COL120-W53DD96E290E42F7D4B328C885B0@phx.gbl>,
	<BLU0-SMTP79BDF0C3CE2DC969FD904EE25B0@phx.gbl>
Message-ID: <COL120-W4034DF84EBEF0D5B008C37885B0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101019/99a6474a/attachment.pl>

From milano_amy at yahoo.com  Wed Oct 20 11:41:43 2010
From: milano_amy at yahoo.com (Amy Milano)
Date: Wed, 20 Oct 2010 02:41:43 -0700 (PDT)
Subject: [R-SIG-Finance] Portfolio Value at Risk - A conceptual problem
Message-ID: <204849.19227.qm@web114415.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101020/ba1b6ff7/attachment.pl>

From patrick at burns-stat.com  Wed Oct 20 12:01:07 2010
From: patrick at burns-stat.com (Patrick Burns)
Date: Wed, 20 Oct 2010 11:01:07 +0100
Subject: [R-SIG-Finance] Portfolio Value at Risk - A conceptual problem
In-Reply-To: <204849.19227.qm@web114415.mail.gq1.yahoo.com>
References: <204849.19227.qm@web114415.mail.gq1.yahoo.com>
Message-ID: <4CBEBDE3.6010704@burns-stat.com>

You can use the valuation of the whole
portfolio to calculate the returns.
That is probably the easiest approach.
That should reduce your Problem C -- it
shouldn't matter what your assets are
as long as you have valuations for them
at each timepoint.

I'm guessing that you might have tried
approach B and got a different answer.
If so, then the following should tell
you what went wrong:
http://www.portfolioprobe.com/2010/10/04/a-tale-of-two-returns/
(You can do it that way, but it's a bit
trickier.)

On 20/10/2010 10:41, Amy Milano wrote:
> Dear all,
>
> I am having following conceptual problem when I am trying to find out Value at Risk (VaR) for the portfolio. I am just giving an indicative portfolio.
>
> (a) stocks (equity) of 3 different companies say e.g.
>
> E1   500 equity shares
> E2 1000 equity shares
> E3   100 equity shares
>
> I have closing prices for last 1 year (i.e. say 250 days) and thus I obtain 250 portfolio values by multiplying the respective number of equity shares by respective closing prices and add them.
>
> Thus, I have 250 portfolio values. I obtain 249 portfolio returns using "LN".
>
> Problem (A)
>
> My problem is is my method of calculating returns correct?
> In the sense, should I calculate returns for all these 3 companies separately (unlike calculating the portfolio value by adding the values of these 3 companies together) and then carry out the further analysis like calculating the correlation matrix etc.
>
> Problem (B)
>
> If I were to consider returns separately for the above three companies, what will happen if there are say 5000 companies (equity only) in my portfolio? How do I handle these many companies?
>
> Problem (C)
>
> How do I proceed if besides having equity, I also have debt and forex transactions also. (Please note that I am asking these questions (especially Problem (C) form calculating returns point of view as say for Forex transactions, I consider the spot exchange rates and the LIBOR rates (depending on the currency and the maturity period) as risk factors and calculate the Mark to Market (MTMs) values.
>
> So my problem basically is how do I arrive at returns in a portfolio.
>
> I apologize if I have not put up the problem in correct and short words. Please forgive and guide me,
>
> With regards
>
> Amy
>
>
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog


From brian at braverock.com  Wed Oct 20 12:19:38 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 20 Oct 2010 05:19:38 -0500
Subject: [R-SIG-Finance] Portfolio Value at Risk - A conceptual problem
In-Reply-To: <204849.19227.qm@web114415.mail.gq1.yahoo.com>
References: <204849.19227.qm@web114415.mail.gq1.yahoo.com>
Message-ID: <33f7430d5a74042b78a0095495fc113a@braverock.com>

On Wed, 20 Oct 2010 02:41:43 -0700 (PDT), Amy Milano
<milano_amy at yahoo.com>
wrote:
> Dear all,
> 
> I am having following conceptual problem when I am trying to find out
> Value at Risk (VaR) for the portfolio. I am just giving an indicative
> portfolio.
> 
> (a) stocks (equity) of 3 different companies say e.g.
> 
> E1?? 500 equity shares
> E2 1000 equity shares
> E3?? 100 equity shares
> 
> I have closing prices for last 1 year (i.e. say 250 days) and thus I
> obtain 250 portfolio values by multiplying the respective number of
equity
> shares by respective closing prices and add them.
> 
> Thus, I have 250 portfolio values. I obtain 249 portfolio returns using
> "LN". 
>
> Problem (A) 
> 
> My problem is is my method of calculating returns correct?

No.

Don't worry about weights yet.  Get the returns for each individual series
before sorting out your portfolio weights.  You have all the information,
so you should use it.

The function 'Return.calculate' from 'PerformanceAnalytics' will do what
you want, but the calculation isn't hard.  If 'pr' is your variable of
prices,

pr/Lag(pr, k = 1) - 1

will give you simple returns (which I typically recommend using with daily
series), or 

diff(log(pr))

will give you compound returns.  I typically want a simple return series
for each asset, and will turn it into a compound series later, only if
required, to look at total portfolio return. Sticking with simple returns
avoids adding compounding estimation errors into your calculations later
on.

You want to calculate returns on each price series without worrying about
your invested amount.  It makes everything else simpler.

> In the sense, should I calculate returns for all these 3 companies
> separately (unlike calculating the portfolio value by adding the values
of
> these 3 companies together) and then carry out the further analysis like
> calculating the correlation matrix etc.


There's a function for VaR too that is likely more sophisticated than
anything you would do by hand...

Typically, if you have all the information, why wouldn't you use it?

If you have a simple or compound return series for all the instruments in
your portfolio, then you can readily calculate the portfolio return,
portfolio risk, and contributions to risk.  All you need are weights.  Take
the capital required to establish each of your positions, add it all up. 
this is 100% of your capital.  Now, the capital for opening each position
divided by the total capital is the percent weight you've invested in each
position.

The function 'Return.portfolio' will take your per-instrument returns, and
calculate your portfolio return (assuming no rebalancing, though there's a
function for that too). It can also calulate you 'contribution' to total
return from each of the assets.


> Problem (B)
> 
> If I were to consider returns separately for the above three companies,
> what will happen if there are say 5000 companies (equity only) in my
> portfolio? How do I handle these many companies?


See above.  These functions are routinely used on very large portfolios.

 
> Problem (C) 
> 
> How do I proceed if besides having equity, I also have debt and forex
> transactions also. (Please note that I am asking these questions
> (especially Problem (C) form calculating returns point of view as say
for
> Forex transactions, I consider the spot exchange rates and the LIBOR
rates
> (depending on the currency and the maturity period) as risk factors and
> calculate the Mark to Market (MTMs) values.


If you have a series of MTM 'prices' use these in step A above.


> So my problem basically is how do I arrive at returns in a portfolio.
> 
> I apologize if I have not put up the problem in correct and short words.
> Please forgive and guide me,

Hopefully this helps.

You should find most of the other functions you need for univariate and
portfolio risk (SharpeRation, VaR, ES, etc.) in PerformanceAnalytics as
well.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From arun.kumar.saha at gmail.com  Wed Oct 20 15:24:09 2010
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Wed, 20 Oct 2010 06:24:09 -0700 (PDT)
Subject: [R-SIG-Finance] Portfolio Value at Risk - A conceptual problem
In-Reply-To: <4CBEBDE3.6010704@burns-stat.com>
References: <204849.19227.qm@web114415.mail.gq1.yahoo.com>
	<4CBEBDE3.6010704@burns-stat.com>
Message-ID: <1287581049504-3003837.post@n4.nabble.com>


Dear Amy, assuming you have sufficient amount of historical data, you should
calculate return collectively, because calculating return separately will
destroy the correlation pattern implicit within the historical quotes
therefore you may not address properly the diversification effect in your
VaR figure.

Instead of directly valuing portfolio (and then portfolio return) based on
historical quotes I would prefer to find out the historical realized return
(may be logarithmic or percentage) and construct a hypothetical price
distribution (by taking antilog or something like) for next day (assuming
VaR horizon is 1 day) and then find the possible distribution of portfolio
values for next day. This always makes sense as price series is never
stationary/stable but returns are. Here the fact is to find answer like,
previously on some date I got that return therefore what if same return gets
realized from 1 day holding. This inference you can never make had you taken
raw price because 1 year back price may be 50pt lower than current level,
hence in a single day you can never achieve that level (ofcourse assuming
tomorrow another layman brother would not fall on your head!) of price but
with return you can.

Thanks,
Arun
-- 
View this message in context: http://r.789695.n4.nabble.com/Portfolio-Value-at-Risk-A-conceptual-problem-tp3003552p3003837.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From brian at braverock.com  Wed Oct 20 16:28:18 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 20 Oct 2010 09:28:18 -0500
Subject: [R-SIG-Finance] Portfolio Value at Risk - A conceptual problem
In-Reply-To: <1287581049504-3003837.post@n4.nabble.com>
References: <204849.19227.qm@web114415.mail.gq1.yahoo.com>	<4CBEBDE3.6010704@burns-stat.com>
	<1287581049504-3003837.post@n4.nabble.com>
Message-ID: <4CBEFC82.1000802@braverock.com>

On 10/20/2010 08:24 AM, Arun.stat wrote:
>
> Dear Amy, assuming you have sufficient amount of historical data, you should
> calculate return collectively, because calculating return separately will
> destroy the correlation pattern implicit within the historical quotes
> therefore you may not address properly the diversification effect in your
> VaR figure.
>
> Instead of directly valuing portfolio (and then portfolio return) based on
> historical quotes I would prefer to find out the historical realized return
> (may be logarithmic or percentage) and construct a hypothetical price
> distribution (by taking antilog or something like) for next day (assuming
> VaR horizon is 1 day) and then find the possible distribution of portfolio
> values for next day. This always makes sense as price series is never
> stationary/stable but returns are. Here the fact is to find answer like,
> previously on some date I got that return therefore what if same return gets
> realized from 1 day holding. This inference you can never make had you taken
> raw price because 1 year back price may be 50pt lower than current level,
> hence in a single day you can never achieve that level (ofcourse assuming
> tomorrow another layman brother would not fall on your head!) of price but
> with return you can.

I prefer to have all the individual returns so that I can also do 
component risk contribution.  If you simply use univariate portfolio 
returns, you lose the interdependence between the assets, and can't find 
out the *contribution* to the overall portfolio risk, only the result. 
Component risk measures sum to the univariate portfolio risk, so you get 
that too.

# e.g.
######

require(PerformanceAnalytics)
data(edhec)
VaR(edhec,portfolio_method="component")
ES(edhec,portfolio_method="component")

######

Weights, of course, may also be applied.

Cheers,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From matthieu.stigler at gmail.com  Wed Oct 20 16:57:45 2010
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Wed, 20 Oct 2010 16:57:45 +0200
Subject: [R-SIG-Finance] Coefficients,
 Principal Component Regression. pcr
In-Reply-To: <BLU0-SMTP15857E2684B97BD18B4B7DCE2590@phx.gbl>
References: <COL124-W2563D1DEC714416B27A0B5E5560@phx.gbl>
	<BLU0-SMTP15857E2684B97BD18B4B7DCE2590@phx.gbl>
Message-ID: <4CBF0369.4040602@gmail.com>

Dear Karla

I have really limited knowledge in pls and pcr models, but I believe one 
still can have inference in those models, since you are doing a 
regression among different factors.

I don't know exactly to what you are applying your models, but another 
framework very similar to PLS/PCR is Structural Equation Modelling, 
which allows to make different regressions among latent variables (and 
nest factor models, maybe even pcr).

If this is useful for you, you might have a look at the openMx R 
project, which has just done an important release (see annoucement 
below) and seems to be very impressive.

Hope this helps

Matthieu

Dear R users,

The OpenMx developer team takes great pride in announcing the availability
of OpenMx 1.0. The team would like to express its gratitude to the large
number of beta-testers who have helped us improve the code. Thank you.

OpenMx is a free suite of R functions and a estimation back-end that
supports fitting a wide variety of structural equation models including
multiple groups, full information ML for missing data, ordinal estimation
with thresholds, multilevel, latent class, and mixture distributions to name
a few.

The most current version of OpenMx (for Mac, Windows and most Linux
variants) may be downloaded by issuing the following R command:

source('http://openmx.psyc.virginia.edu/getOpenMx.R')

OpenMx is not currently hosted on CRAN due to a license restriction on the
one portion of our code, an optimizer, that was not written by the project.
We hope to remedy this situation reasonably soon as we are working on an
open source version of the optimizer.  The remainder of the project is
licensed under Apache 2.0 and the source code may be downloaded from the
OpenMx website and used for any purpose you wish.  We do hope that you wish
to contribute improvements or bug fixes back to the project, but we do not
require it.

The OpenMx website ishttp://openmx.psyc.virginia.edu, where we host a set
of manuals and tutorials, a wiki, and a set of user forums where issues to
do with OpenMx and SEM in general can be discussed.  We require free
registration in order to post to the forums or wiki so as to slow down the
spambots, but everything else is available without registration.

OpenMx has been in development for 3 years.  The OpenMx beta test program
began in October 2009. Since then, we have improved the interface and sped
up the optimization times considerably. Many new features are in the works
and we encourage you to post to the Wish List forum so that we know what you
would like to see.

> From this point on, we will maintain two binary releases: a stable release
numbered as 1.x.x, and a development binary with the latest and greatest
features and bug-fixes, numbered with the current revision number (e.g.,
1448). The development of OpenMx is on-going and we expect that new
development binaries will be released often. The stable releases are likely
to be updated every few months or so.

For the OpenMx team.


Le 18. 10. 10 01:13, Sarbo a ?crit :
> Karla,
>
> The mathematics you've outlined are not quite correct. In multiple
> linear regression you are attempting to find the hyperplane that most
> closely approximates the data set that you are dealing with. In PCA, you
> are performing a change of coordinates so that your data are arranged in
> a different Cartesian space. This means that all of your data can now be
> represented as linear combinations of the eigenvectors calculated from
> your correlation (or covariance) matrix. There is no "approximation"
> going on, hence no t-values or F-statistics to calculate goodness of
> fit. You can, however, figure out the explanatory power of each new
> variable pretty easily.
>
> The significance of each of the basis vectors in your eigenspace is
> represented by the absolute magnitude of each eigenvalue. You can figure
> out how much of your data are represented by each eigenvector by
> plotting the cumulative variance explained by the eigenvectors. The
> function "princomp", which is part of the base R distribution these days
> unless I'm very much mistaken, will help you do this using the "plot"
> method.
>
> On Thu, 2010-10-14 at 08:20 -0600, karla hernandez villafuerte wrote:
>
>    
>> Dear Members:
>>
>> I am trying to applied a Principal Component Regression using the pls package and the next formula:
>>
>> PCA<-pcr(Beta~XCT+XCLa+XCLb+XCLc+XCLd+XCLe+XCLf+XCLg+XCLh,
>> data=mydata,ncomp=15,validation="LOO",method="svdpc", model=TRUE, y=TRUE, x=TRUE)
>>
>> where XCT is a matrix of cuantitatives variables and each one of  XCL are cualitatives variables.
>>
>> I can estimate the coefficient matrix using:
>>
>> coef(PCA,comps=5)
>>
>> As far I understand, the PCR perform a multilple regression analysis of the response variable against the reduced set of principal components, using OLS. The results coefficients are transformed into a new set of coefficients (those in coef(PCA,comps=5)) that correspond to a mathematic transformation of the original ones.
>>
>> My question is: Can I see the t values for the final coefficents estimated in coef(PCA,comps=5) or can I have the results of the OLS equation?. In other case which is the best way to analyse the significance of the variables?
>>
>> Thanks!!
>>
>> Karla Hernndez Villafuerte
>>
>>    		 	   		
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>      
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From niheaven at gmail.com  Thu Oct 21 05:22:51 2010
From: niheaven at gmail.com (Hsiaonan Chang)
Date: Thu, 21 Oct 2010 11:22:51 +0800
Subject: [R-SIG-Finance] Leon et al.(2005)'s GARCHSK Model Estimation
Message-ID: <AANLkTikvm3RuEw66Ri_9xzkahW0HaeyUvi+vfwADOKr2@mail.gmail.com>

Hi,

Could anyone tell me how to estimate a Leon et al.(2005)'s GARCHSK
(GARCH with Skewness and Kurtosis) model? And is there any programs?

Thank you very much.

Hsiao-nan Cheung
Penghua Fund
2010/10/21


From milano_amy at yahoo.com  Thu Oct 21 08:21:59 2010
From: milano_amy at yahoo.com (Amy Milano)
Date: Wed, 20 Oct 2010 23:21:59 -0700 (PDT)
Subject: [R-SIG-Finance] Portfolio Value at Risk - A conceptual problem
Message-ID: <180156.99405.qm@web114420.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101020/31f2ec6c/attachment.pl>

From cmdr_rogue at hotmail.com  Thu Oct 21 11:22:57 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Thu, 21 Oct 2010 05:22:57 -0400
Subject: [R-SIG-Finance] Coefficients,
 Principal Component Regression. pcr
In-Reply-To: <4CB96D42.7050402@gmail.com>
References: <COL124-W2563D1DEC714416B27A0B5E5560@phx.gbl>
	<4CB96D42.7050402@gmail.com>
Message-ID: <BLU0-SMTP1326D8B79BD4E04DD62574FE25D0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101021/e900c250/attachment.pl>

From nikos.rachmanis at gmail.com  Thu Oct 21 23:37:52 2010
From: nikos.rachmanis at gmail.com (Nikos Rachmanis)
Date: Thu, 21 Oct 2010 17:37:52 -0400
Subject: [R-SIG-Finance] Bollinger Bands error
Message-ID: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101021/2727f7fe/attachment.pl>

From jeff.a.ryan at gmail.com  Thu Oct 21 23:47:56 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Thu, 21 Oct 2010 16:47:56 -0500
Subject: [R-SIG-Finance] Bollinger Bands error
In-Reply-To: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>
References: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>
Message-ID: <AANLkTi=FChy9gVQgOwxTeO7Xr1BaOmD=C-cee7-jwqSr@mail.gmail.com>

Hi Nikos,

Your object (a data.frame, not a matrix) isn't coercible to a
time-series object (you have no 'time' component).

Try ?xts or the list to get an idea of a better way to manage time
series data, or provide a bit more code for us to look at.

Incidentally, a zoo object, or even a properly formatted
matrix/data.frame that as.xts can handle would be all that is needed.

Jeff

On Thu, Oct 21, 2010 at 4:37 PM, Nikos Rachmanis
<nikos.rachmanis at gmail.com> wrote:
> Hi all,
>
>
>
> I am new to R and I would appreciate if someone can help me out with the
> following problem. I am trying to use the TTR package in order to calculate
> the Bollinger Bands. I have created a matrix with the Open, High, Low and
> Close variables using the following command:
>
>
>
> OHLC<-data.frame(open, high, low, close, check.names=TRUE)
>
>
>
> However every time I am trying to run the command ( BBands(OHLC, n=20,
> maType, sd=2, ...)) this is the error I am getting:
>
>
>
> "Error in inherits(x, "xts") : object 'x' not found"
>
>
>
> Has anyone came across this problem in order to know the solution?
>
>
>
> Thanks a lot in advance,
>
>
>
> Nikos
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeff.a.ryan at gmail.com


From josh.m.ulrich at gmail.com  Fri Oct 22 00:01:49 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 21 Oct 2010 17:01:49 -0500
Subject: [R-SIG-Finance] Bollinger Bands error
In-Reply-To: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>
References: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>
Message-ID: <AANLkTina2WKp-3ZC-fO=2gSfYONnEkTBWsddpgULALsQ@mail.gmail.com>

Hi Nikos,

On Thu, Oct 21, 2010 at 4:37 PM, Nikos Rachmanis
<nikos.rachmanis at gmail.com> wrote:
> Hi all,
>
> I am new to R and I would appreciate if someone can help me out with the
> following problem. I am trying to use the TTR package in order to calculate
> the Bollinger Bands. I have created a matrix with the Open, High, Low and
> Close variables using the following command:
>
You did not create a matrix, you created a data.frame.  They are
different.  Compare ?data.frame and ?matrix.

> OHLC<-data.frame(open, high, low, close, check.names=TRUE)
>
> However every time I am trying to run the command ( BBands(OHLC, n=20,
> maType, sd=2, ...)) this is the error I am getting:
>
> "Error in inherits(x, "xts") : object 'x' not found"
>
A reproducible example would help.  Even if you did not get the above
error, your command should fail because the OHLC object has 4 columns
and BBands only accepts objects with 1 or 3 columns (see ?BBands).

> Has anyone came across this problem in order to know the solution?
>
> Thanks a lot in advance,
> Nikos
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From nikos.rachmanis at gmail.com  Sat Oct 23 23:25:36 2010
From: nikos.rachmanis at gmail.com (Nikos Rachmanis)
Date: Sat, 23 Oct 2010 17:25:36 -0400
Subject: [R-SIG-Finance] Bollinger Bands error
In-Reply-To: <AANLkTina2WKp-3ZC-fO=2gSfYONnEkTBWsddpgULALsQ@mail.gmail.com>
References: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>
	<AANLkTina2WKp-3ZC-fO=2gSfYONnEkTBWsddpgULALsQ@mail.gmail.com>
Message-ID: <AANLkTi=pTOaZsjzjcQ61s=QHv2T=4D0x_5c4-6pEwnB2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101023/f03cee75/attachment.pl>

From prof7bit at googlemail.com  Sun Oct 24 10:02:55 2010
From: prof7bit at googlemail.com (Bernd Kreuss)
Date: Sun, 24 Oct 2010 01:02:55 -0700 (PDT)
Subject: [R-SIG-Finance] R and Metatrader
In-Reply-To: <1269676516179-1693168.post@n4.nabble.com>
References: <1269676516179-1693168.post@n4.nabble.com>
Message-ID: <1287907375418-3009005.post@n4.nabble.com>



yoda55 wrote:
> 
> 
> Has anyone ever tried to connect R to MetaTrader (MT4 or MT5)?
> 

For the sake of completeness I must point you to this:
http://www.forexfactory.com/showthread.php?t=260422

It does not require to run any kind of server in R or needs any packages
installed. It will start Rterm.exe as a background process and communicate
with its command line via stdin/stdout. It defines a bunch of functions that
let you assign strings, numbers, vectors and matrices to R variables, lets
you execute arbitrary R code with a synchronous (blocking) function call and
get the results back into MQL4 variables (vectors into arrays)). It has also
functions to execute code asynchronously without waiting for it (and then
poll for its completion during the following ticks) to make it possible to
write MT4 indicators which do not allow long running or blocking tasks.

The DLL itself (full source code is available) is written in Object Pascal
(FPC) and the TRConsole class which wraps the Rterm process can also
separately be used for your own projects, it does not rely on any windows
specific API so it is easily usable with no or only minimal modifications
for Linux and Mac applications too.

Bernd

-- 
View this message in context: http://r.789695.n4.nabble.com/R-and-Metatrader-tp1693168p3009005.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From jaykwok at gmail.com  Mon Oct 25 12:28:16 2010
From: jaykwok at gmail.com (Jason Kwok)
Date: Mon, 25 Oct 2010 06:28:16 -0400
Subject: [R-SIG-Finance] Database for Historical Security Prices
Message-ID: <AANLkTim35DLyR_y9PFf3-q01mHyL0ons+BQz6GXWN2cN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101025/9481c6f7/attachment.pl>

From cedrick at cedrickjohnson.com  Mon Oct 25 13:01:57 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Mon, 25 Oct 2010 07:01:57 -0400
Subject: [R-SIG-Finance] Database for Historical Security Prices
In-Reply-To: <AANLkTim35DLyR_y9PFf3-q01mHyL0ons+BQz6GXWN2cN@mail.gmail.com>
References: <AANLkTim35DLyR_y9PFf3-q01mHyL0ons+BQz6GXWN2cN@mail.gmail.com>
Message-ID: <4CC563A5.1070405@cedrickjohnson.com>

[moderator: my earlier email was being held b/c of a mistake I made on 
my end with my email address, sorry for the re-post]

I personally use a mysql database here with the 'quantmod' package. See:

?getSymbols.MySQL for the nitty gritty details.

You could also just open a connection to mysql either directly or via 
ODBC and convert your time series into a data.frame and then use 
dbWriteTable(dbcon, "SymbolName", Symbol.df). Conversely, to read back 
into R, just use dbReadTable(dbcon, "SymbolName") and convert it into a 
xts time series.

?dbReadTable and ?dbWriteTable ... If your dataset only adds the new row 
everyday, when writing the table you could specify append=TRUE, 
overwrite=FALSE.

HTH,
C


From breman.mark at gmail.com  Mon Oct 25 13:42:20 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Mon, 25 Oct 2010 13:42:20 +0200
Subject: [R-SIG-Finance] Database for Historical Security Prices
In-Reply-To: <4CC563A5.1070405@cedrickjohnson.com>
References: <AANLkTim35DLyR_y9PFf3-q01mHyL0ons+BQz6GXWN2cN@mail.gmail.com>
	<4CC563A5.1070405@cedrickjohnson.com>
Message-ID: <AANLkTikTfm418khie40kqhBFrz-KNonfm84E9LR+Vi+k@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101025/f767efa0/attachment.pl>

From cedrick at cedrickjohnson.com  Mon Oct 25 13:44:21 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Mon, 25 Oct 2010 07:44:21 -0400
Subject: [R-SIG-Finance] Database for Historical Security Prices
In-Reply-To: <AANLkTikTfm418khie40kqhBFrz-KNonfm84E9LR+Vi+k@mail.gmail.com>
References: <AANLkTim35DLyR_y9PFf3-q01mHyL0ons+BQz6GXWN2cN@mail.gmail.com>	<4CC563A5.1070405@cedrickjohnson.com>
	<AANLkTikTfm418khie40kqhBFrz-KNonfm84E9LR+Vi+k@mail.gmail.com>
Message-ID: <4CC56D95.2050304@cedrickjohnson.com>

That is another way, I [automatically, perhaps incorrectly] assume that 
more than 1 person would be accessing the data. If it's just you, then 
the native/binary way is the way to go :)

-c

On 10/25/2010 7:42 AM, Mark Breman wrote:
> Why not use R's native (binary) storage, i.e. use:
>
> load("vsmirk.Rdata")
> .... update data here...
> save(smirkresult, vsmirkdata, file="vsmirk.Rdata")
>
> Regards,
>
> -Mark-
>
> 2010/10/25 Johnson, Cedrick W. <cedrick at cedrickjohnson.com 
> <mailto:cedrick at cedrickjohnson.com>>
>
>     [moderator: my earlier email was being held b/c of a mistake I
>     made on my end with my email address, sorry for the re-post]
>
>     I personally use a mysql database here with the 'quantmod'
>     package. See:
>
>     ?getSymbols.MySQL for the nitty gritty details.
>
>     You could also just open a connection to mysql either directly or
>     via ODBC and convert your time series into a data.frame and then
>     use dbWriteTable(dbcon, "SymbolName", Symbol.df). Conversely, to
>     read back into R, just use dbReadTable(dbcon, "SymbolName") and
>     convert it into a xts time series.
>
>     ?dbReadTable and ?dbWriteTable ... If your dataset only adds the
>     new row everyday, when writing the table you could specify
>     append=TRUE, overwrite=FALSE.
>
>     HTH,
>
>     C
>
>     _______________________________________________
>     R-SIG-Finance at stat.math.ethz.ch
>     <mailto:R-SIG-Finance at stat.math.ethz.ch> mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>
>


From brian at braverock.com  Mon Oct 25 13:54:40 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 25 Oct 2010 06:54:40 -0500
Subject: [R-SIG-Finance] Database for Historical Security Prices
In-Reply-To: <AANLkTikTfm418khie40kqhBFrz-KNonfm84E9LR+Vi+k@mail.gmail.com>
References: <AANLkTim35DLyR_y9PFf3-q01mHyL0ons+BQz6GXWN2cN@mail.gmail.com>	<4CC563A5.1070405@cedrickjohnson.com>
	<AANLkTikTfm418khie40kqhBFrz-KNonfm84E9LR+Vi+k@mail.gmail.com>
Message-ID: <4CC57000.7040906@braverock.com>

On 10/25/2010 06:42 AM, Mark Breman wrote:
> Why not use R's native (binary) storage, i.e. use:
>
> load("vsmirk.Rdata")
> .... update data here...
> save(smirkresult, vsmirkdata, file="vsmirk.Rdata")

For OHLC bars, even down to 1-minute resolution, the native R binary 
format saving xts (or other) time series is sufficient. File IO and 
locking issues may be handled by the use of read-only files systems and 
file servers.

For tick data, this works, but some column database or something like 
mmap/indexing will work much better.  This allows you to only retrieve 
the data you need, rather than trying to keep it all in memory.

Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From gordon.morrison at hsbcib.com  Mon Oct 25 15:09:07 2010
From: gordon.morrison at hsbcib.com (gordon.morrison at hsbcib.com)
Date: Mon, 25 Oct 2010 14:09:07 +0100
Subject: [R-SIG-Finance] RBloomberg - Trade data with bargain condition codes
Message-ID: <OF8203F816.E3835EE9-ON802577C7.0046CA68-802577C7.00483EFB@hsbcib.com>


Does anyone have experience with getting trade condition codes on tick
data.

So, if I run .....

> conn <- blpConnect()
R version 2.11.1 (2010-05-31)
rJava Version 0.8-6
RBloomberg Version 0.4-144
Java environment initialized successfully.
Looking for most recent blpapi3.jar file...
Bloomberg API Version 3.3.3.3

Followed by ......
> tick(conn, "RYA ID Equity", "TRADE", "2010-09-21 09:00:00.000",
"2010-09-21 09:10:00.000")

I get ......

                     time  type  value  size
1 2010-09-21T09:06:17.000 TRADE 3.9100 35000
2 2010-09-21T09:07:08.000 TRADE 3.9111  2000

which accords with what appears on a BBG terminal

Now, if I do ......

tick(conn, "RYA ID Equity", "TRADE", "2010-09-21 09:00:00.000", "2010-09-21
09:10:00.000",
     option_names = c("includeConditionCodes"),
     option_values = c("TRUE"))

I get the same result, but without bargain condition codes

Finally, if I download the data into Excel using the BBG interface, I get
bargain conditions codes - so they must exist!

Regards


Gordon M Morrison

************************************************************
HSBC Bank plc may be solicited in the course of its placement efforts for a
new issue, by investment clients of the firm for whom the Bank as a firm
already provides other services. It may equally decide to allocate to its
own proprietary book or with an associate of HSBC Group. This represents a
potential conflict of interest. HSBC Bank plc has internal arrangements
designed to ensure that the firm would give unbiased and full advice to the
corporate finance client about the valuation and pricing of the offering as
well as internal systems, controls and procedures to identify and manage
conflicts of interest.

HSBC Bank plc
Registered Office: 8 Canada Square, London E14 5HQ, United Kingdom
Registered in England - Number 14259
Authorised and regulated by the Financial Services Authority.
************************************************************

-----------------------------------------
SAVE PAPER - THINK BEFORE YOU PRINT!

This transmission has been issued by a member of the HSBC Group
"HSBC" for the information of the addressee only and should not be
reproduced and/or distributed to any other person. Each page
attached hereto must be read in conjunction with any disclaimer
which forms part of it. Unless otherwise stated, this transmission
is neither an offer nor the solicitation of an offer to sell or
purchase any investment. Its contents are based on information
obtained from sources believed to be reliable but HSBC makes no
representation and accepts no responsibility or liability as to its
completeness or accuracy.


From mane.desk at googlemail.com  Mon Oct 25 19:56:13 2010
From: mane.desk at googlemail.com (Immanuel)
Date: Mon, 25 Oct 2010 19:56:13 +0200
Subject: [R-SIG-Finance] Quantmod / xts problem " Error in `[.xts`(x,
 xsubset) : subscript out of bounds"
In-Reply-To: <1287907375418-3009005.post@n4.nabble.com>
References: <1269676516179-1693168.post@n4.nabble.com>
	<1287907375418-3009005.post@n4.nabble.com>
Message-ID: <4CC5C4BD.6090204@gmail.com>

Hello all,

I got some problems while plotting OHLC intraday data
using chartSeries(), ploting of chartSeries(Cl(..) ) works through.

Who knows whats going on?
best regards,
Immanuel

-------------------
> class(intradayData)
[1] "xts" "zoo"
> intradayData[1:5]
                      Open  Close   High    Low Volume  X
2010-05-10 10:00:00 5854.5 5911.0 5925.0 5850.0   2066 NA
2010-05-10 10:10:00 5910.5 5895.0 5911.0 5887.5   1055 NA
2010-05-10 10:20:00 5895.0 5892.0 5901.0 5884.0    913 NA
2010-05-10 10:30:00 5890.0 5903.0 5904.5 5888.5    630 NA
2010-05-10 10:40:00 5903.0 5906.5 5925.0 5901.0    418 NA
> chartSeries(intradayData[1:15])
Error in `[.xts`(x, xsubset) : subscript out of bounds


From jeff.a.ryan at gmail.com  Mon Oct 25 20:02:22 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 25 Oct 2010 13:02:22 -0500
Subject: [R-SIG-Finance] Quantmod / xts problem " Error in `[.xts`(x,
 xsubset) : subscript out of bounds"
In-Reply-To: <4CC5C4BD.6090204@gmail.com>
References: <1269676516179-1693168.post@n4.nabble.com>
	<1287907375418-3009005.post@n4.nabble.com>
	<4CC5C4BD.6090204@gmail.com>
Message-ID: <AANLkTi=ih8rRiVWRprV2TghAJHBTKhzaJRyqjeVngOz8@mail.gmail.com>

Immanuel,

Not entirely sure what is wrong, but you need to provide reproducible
code for me to do anything more than hazard a guess.

That said, my guess is that something regarding the # of obs you are
plotting or the column ordering is the issue.  I have tried to
replicate both, and don't seem to see an error on my end, so I'll wait
for your code that can be run by me that replicates your error.

Best,
Jeff

On Mon, Oct 25, 2010 at 12:56 PM, Immanuel <mane.desk at googlemail.com> wrote:
> Hello all,
>
> I got some problems while plotting OHLC intraday data
> using chartSeries(), ploting of chartSeries(Cl(..) ) works through.
>
> Who knows whats going on?
> best regards,
> Immanuel
>
> -------------------
>> class(intradayData)
> [1] "xts" "zoo"
>> intradayData[1:5]
> ? ? ? ? ? ? ? ? ? ? ?Open ?Close ? High ? ?Low Volume ?X
> 2010-05-10 10:00:00 5854.5 5911.0 5925.0 5850.0 ? 2066 NA
> 2010-05-10 10:10:00 5910.5 5895.0 5911.0 5887.5 ? 1055 NA
> 2010-05-10 10:20:00 5895.0 5892.0 5901.0 5884.0 ? ?913 NA
> 2010-05-10 10:30:00 5890.0 5903.0 5904.5 5888.5 ? ?630 NA
> 2010-05-10 10:40:00 5903.0 5906.5 5925.0 5901.0 ? ?418 NA
>> chartSeries(intradayData[1:15])
> Error in `[.xts`(x, xsubset) : subscript out of bounds
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeff.a.ryan at gmail.com


From mane.desk at googlemail.com  Mon Oct 25 20:08:07 2010
From: mane.desk at googlemail.com (Immanuel)
Date: Mon, 25 Oct 2010 20:08:07 +0200
Subject: [R-SIG-Finance] Quantmod / xts problem " Error in `[.xts`(x,
 xsubset) : subscript out of bounds"
In-Reply-To: <AANLkTi=ih8rRiVWRprV2TghAJHBTKhzaJRyqjeVngOz8@mail.gmail.com>
References: <1269676516179-1693168.post@n4.nabble.com>	<1287907375418-3009005.post@n4.nabble.com>	<4CC5C4BD.6090204@gmail.com>
	<AANLkTi=ih8rRiVWRprV2TghAJHBTKhzaJRyqjeVngOz8@mail.gmail.com>
Message-ID: <4CC5C787.90500@gmail.com>

Hey Ryan,

thanks for looking into it.

regards,
Immanuel

------------------
library(quantmod)
library(chron)
library(zoo)


f <- function(x) chron(paste(x[,1]), paste(x[,2], "00", sep = ":"),
            format = c(dates = "d.m.y", times = "h:m:s"))


z <- read.zoo("FDAX_10_min.csv", index = 1:2, header = TRUE, sep =
";",FUN = f)

intradayData <- xts(z, order.by = as.POSIXct(time(z)),unique=FALSE)

chartSeries(intradayData[1:15])
---------------------------------
data file:
------------------------------
Date;Time;Open;Close;High;Low;Volume;
10.05.10;08:00;5854.5;5911;5925;5850;2066;
10.05.10;08:10;5910.5;5895;5911;5887.5;1055;
10.05.10;08:20;5895;5892;5901;5884;913;
10.05.10;08:30;5890;5903;5904.5;5888.5;630;
10.05.10;08:40;5903;5906.5;5925;5901;418;
10.05.10;08:50;5906;5896;5910;5894.5;569;
10.05.10;09:00;5896.5;5892;5901.5;5869.5;786;
10.05.10;09:10;5892.5;5908.5;5909.5;5885;493;
10.05.10;09:20;5908;5915;5916.5;5900;743;
10.05.10;09:30;5914;5936;5937;5904.5;740;
10.05.10;09:40;5937.5;5953.5;5964.5;5933.5;757;
10.05.10;09:50;5953;5942.5;5960;5942;420;
10.05.10;10:00;5942.5;5934.5;5947;5933.5;279;
10.05.10;10:10;5934;5944.5;5949.5;5926.5;366;
10.05.10;10:20;5945;5953.5;5956;5938;261;
10.05.10;10:30;5953;5938.5;5955;5933;96;
10.05.10;10:40;5939;5943;5945.5;5929.5;145;
10.05.10;10:50;5942.5;5972.5;5990;5942.5;248;
10.05.10;11:00;5972.5;5964;5981.5;5963.5;184;
----------------------------------
On 10/25/2010 08:02 PM, Jeff Ryan wrote:
> Immanuel,
>
> Not entirely sure what is wrong, but you need to provide reproducible
> code for me to do anything more than hazard a guess.
>
> That said, my guess is that something regarding the # of obs you are
> plotting or the column ordering is the issue.  I have tried to
> replicate both, and don't seem to see an error on my end, so I'll wait
> for your code that can be run by me that replicates your error.
>
> Best,
> Jeff
>
> On Mon, Oct 25, 2010 at 12:56 PM, Immanuel <mane.desk at googlemail.com> wrote:
>   
>> Hello all,
>>
>> I got some problems while plotting OHLC intraday data
>> using chartSeries(), ploting of chartSeries(Cl(..) ) works through.
>>
>> Who knows whats going on?
>> best regards,
>> Immanuel
>>
>> -------------------
>>     
>>> class(intradayData)
>>>       
>> [1] "xts" "zoo"
>>     
>>> intradayData[1:5]
>>>       
>>                      Open  Close   High    Low Volume  X
>> 2010-05-10 10:00:00 5854.5 5911.0 5925.0 5850.0   2066 NA
>> 2010-05-10 10:10:00 5910.5 5895.0 5911.0 5887.5   1055 NA
>> 2010-05-10 10:20:00 5895.0 5892.0 5901.0 5884.0    913 NA
>> 2010-05-10 10:30:00 5890.0 5903.0 5904.5 5888.5    630 NA
>> 2010-05-10 10:40:00 5903.0 5906.5 5925.0 5901.0    418 NA
>>     
>>> chartSeries(intradayData[1:15])
>>>       
>> Error in `[.xts`(x, xsubset) : subscript out of bounds
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>     
>
>
>


From daniel.cegielka at gmail.com  Mon Oct 25 20:13:48 2010
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Mon, 25 Oct 2010 20:13:48 +0200
Subject: [R-SIG-Finance] Quantmod / xts problem " Error in `[.xts`(x,
 xsubset) : subscript out of bounds"
In-Reply-To: <4CC5C787.90500@gmail.com>
References: <1269676516179-1693168.post@n4.nabble.com>
	<1287907375418-3009005.post@n4.nabble.com>
	<4CC5C4BD.6090204@gmail.com>
	<AANLkTi=ih8rRiVWRprV2TghAJHBTKhzaJRyqjeVngOz8@mail.gmail.com>
	<4CC5C787.90500@gmail.com>
Message-ID: <AANLkTik4QTGTTP8bA79HbYdxRZ_8AMw1OqgjVgpr9sS1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101025/204d6f68/attachment.pl>

From jeff.a.ryan at gmail.com  Mon Oct 25 22:34:48 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 25 Oct 2010 15:34:48 -0500
Subject: [R-SIG-Finance] Quantmod / xts problem " Error in `[.xts`(x,
 xsubset) : subscript out of bounds"
In-Reply-To: <4CC5C787.90500@gmail.com>
References: <1269676516179-1693168.post@n4.nabble.com>
	<1287907375418-3009005.post@n4.nabble.com>
	<4CC5C4BD.6090204@gmail.com>
	<AANLkTi=ih8rRiVWRprV2TghAJHBTKhzaJRyqjeVngOz8@mail.gmail.com>
	<4CC5C787.90500@gmail.com>
Message-ID: <AANLkTi=JOEh4cN3XjrBKX6qCD4HJonximCE3juSf_-eF@mail.gmail.com>

Hi Immanuel,

The extra col/colname is messing something up in chartSeries.  There
is a new version of chartSeries in quantmod (has been for a while)
called chart_Series.  Mostly same behavior, eventually it will be
almost identical to the old version.

The new version is faster, and more extensible.  Also is much nicer to
look at.  And an added bonus is that it also works out of the box on
your example.

Actually both of these do - the former a workaround to get your code
to work with the original chartSeries functionality.

chartSeries(intradayData[1:15,1:5])

chart_Series(intradayData[1:15])

HTH
Jeff


On Mon, Oct 25, 2010 at 1:08 PM, Immanuel <mane.desk at googlemail.com> wrote:
> Hey Ryan,
>
> thanks for looking into it.
>
> regards,
> Immanuel
>
> ------------------
> library(quantmod)
> library(chron)
> library(zoo)
>
>
> f <- function(x) chron(paste(x[,1]), paste(x[,2], "00", sep = ":"),
> ? ? ? ? ? ?format = c(dates = "d.m.y", times = "h:m:s"))
>
>
> z <- read.zoo("FDAX_10_min.csv", index = 1:2, header = TRUE, sep =
> ";",FUN = f)
>
> intradayData <- xts(z, order.by = as.POSIXct(time(z)),unique=FALSE)
>
> chartSeries(intradayData[1:15])
> ---------------------------------
> data file:
> ------------------------------
> Date;Time;Open;Close;High;Low;Volume;
> 10.05.10;08:00;5854.5;5911;5925;5850;2066;
> 10.05.10;08:10;5910.5;5895;5911;5887.5;1055;
> 10.05.10;08:20;5895;5892;5901;5884;913;
> 10.05.10;08:30;5890;5903;5904.5;5888.5;630;
> 10.05.10;08:40;5903;5906.5;5925;5901;418;
> 10.05.10;08:50;5906;5896;5910;5894.5;569;
> 10.05.10;09:00;5896.5;5892;5901.5;5869.5;786;
> 10.05.10;09:10;5892.5;5908.5;5909.5;5885;493;
> 10.05.10;09:20;5908;5915;5916.5;5900;743;
> 10.05.10;09:30;5914;5936;5937;5904.5;740;
> 10.05.10;09:40;5937.5;5953.5;5964.5;5933.5;757;
> 10.05.10;09:50;5953;5942.5;5960;5942;420;
> 10.05.10;10:00;5942.5;5934.5;5947;5933.5;279;
> 10.05.10;10:10;5934;5944.5;5949.5;5926.5;366;
> 10.05.10;10:20;5945;5953.5;5956;5938;261;
> 10.05.10;10:30;5953;5938.5;5955;5933;96;
> 10.05.10;10:40;5939;5943;5945.5;5929.5;145;
> 10.05.10;10:50;5942.5;5972.5;5990;5942.5;248;
> 10.05.10;11:00;5972.5;5964;5981.5;5963.5;184;
> ----------------------------------
> On 10/25/2010 08:02 PM, Jeff Ryan wrote:
>> Immanuel,
>>
>> Not entirely sure what is wrong, but you need to provide reproducible
>> code for me to do anything more than hazard a guess.
>>
>> That said, my guess is that something regarding the # of obs you are
>> plotting or the column ordering is the issue. ?I have tried to
>> replicate both, and don't seem to see an error on my end, so I'll wait
>> for your code that can be run by me that replicates your error.
>>
>> Best,
>> Jeff
>>
>> On Mon, Oct 25, 2010 at 12:56 PM, Immanuel <mane.desk at googlemail.com> wrote:
>>
>>> Hello all,
>>>
>>> I got some problems while plotting OHLC intraday data
>>> using chartSeries(), ploting of chartSeries(Cl(..) ) works through.
>>>
>>> Who knows whats going on?
>>> best regards,
>>> Immanuel
>>>
>>> -------------------
>>>
>>>> class(intradayData)
>>>>
>>> [1] "xts" "zoo"
>>>
>>>> intradayData[1:5]
>>>>
>>> ? ? ? ? ? ? ? ? ? ? ?Open ?Close ? High ? ?Low Volume ?X
>>> 2010-05-10 10:00:00 5854.5 5911.0 5925.0 5850.0 ? 2066 NA
>>> 2010-05-10 10:10:00 5910.5 5895.0 5911.0 5887.5 ? 1055 NA
>>> 2010-05-10 10:20:00 5895.0 5892.0 5901.0 5884.0 ? ?913 NA
>>> 2010-05-10 10:30:00 5890.0 5903.0 5904.5 5888.5 ? ?630 NA
>>> 2010-05-10 10:40:00 5903.0 5906.5 5925.0 5901.0 ? ?418 NA
>>>
>>>> chartSeries(intradayData[1:15])
>>>>
>>> Error in `[.xts`(x, xsubset) : subscript out of bounds
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>>
>>>
>>
>>
>>
>
>



-- 
Jeffrey Ryan
jeff.a.ryan at gmail.com


From nelson.ana at gmail.com  Tue Oct 26 10:53:01 2010
From: nelson.ana at gmail.com (Ana Nelson)
Date: Tue, 26 Oct 2010 09:53:01 +0100
Subject: [R-SIG-Finance] RBloomberg - Trade data with bargain condition
	codes
In-Reply-To: <OF8203F816.E3835EE9-ON802577C7.0046CA68-802577C7.00483EFB@hsbcib.com>
References: <OF8203F816.E3835EE9-ON802577C7.0046CA68-802577C7.00483EFB@hsbcib.com>
Message-ID: <AANLkTi==vW_4nfyxgRP-Y02cU83CfeJtYiY1Nm_=zMkN@mail.gmail.com>

Hi, Gordon,

Looks like I need to modify the source code to fetch these, currently
they aren't being retrieved from the Bloomberg response.

Will advise when I have an update available.

Regards,
Ana



On Mon, Oct 25, 2010 at 2:09 PM,  <gordon.morrison at hsbcib.com> wrote:
>
> Does anyone have experience with getting trade condition codes on tick
> data.
>
> So, if I run .....
>
>> conn <- blpConnect()
> R version 2.11.1 (2010-05-31)
> rJava Version 0.8-6
> RBloomberg Version 0.4-144
> Java environment initialized successfully.
> Looking for most recent blpapi3.jar file...
> Bloomberg API Version 3.3.3.3
>
> Followed by ......
>> tick(conn, "RYA ID Equity", "TRADE", "2010-09-21 09:00:00.000",
> "2010-09-21 09:10:00.000")
>
> I get ......
>
> ? ? ? ? ? ? ? ? ? ? time ?type ?value ?size
> 1 2010-09-21T09:06:17.000 TRADE 3.9100 35000
> 2 2010-09-21T09:07:08.000 TRADE 3.9111 ?2000
>
> which accords with what appears on a BBG terminal
>
> Now, if I do ......
>
> tick(conn, "RYA ID Equity", "TRADE", "2010-09-21 09:00:00.000", "2010-09-21
> 09:10:00.000",
> ? ? option_names = c("includeConditionCodes"),
> ? ? option_values = c("TRUE"))
>
> I get the same result, but without bargain condition codes
>
> Finally, if I download the data into Excel using the BBG interface, I get
> bargain conditions codes - so they must exist!
>
> Regards
>
>
> Gordon M Morrison
>
> ************************************************************
> HSBC Bank plc may be solicited in the course of its placement efforts for a
> new issue, by investment clients of the firm for whom the Bank as a firm
> already provides other services. It may equally decide to allocate to its
> own proprietary book or with an associate of HSBC Group. This represents a
> potential conflict of interest. HSBC Bank plc has internal arrangements
> designed to ensure that the firm would give unbiased and full advice to the
> corporate finance client about the valuation and pricing of the offering as
> well as internal systems, controls and procedures to identify and manage
> conflicts of interest.
>
> HSBC Bank plc
> Registered Office: 8 Canada Square, London E14 5HQ, United Kingdom
> Registered in England - Number 14259
> Authorised and regulated by the Financial Services Authority.
> ************************************************************
>
> -----------------------------------------
> SAVE PAPER - THINK BEFORE YOU PRINT!
>
> This transmission has been issued by a member of the HSBC Group
> "HSBC" for the information of the addressee only and should not be
> reproduced and/or distributed to any other person. Each page
> attached hereto must be read in conjunction with any disclaimer
> which forms part of it. Unless otherwise stated, this transmission
> is neither an offer nor the solicitation of an offer to sell or
> purchase any investment. Its contents are based on information
> obtained from sources believed to be reliable but HSBC makes no
> representation and accepts no responsibility or liability as to its
> completeness or accuracy.
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From johnmu at uj.ac.za  Tue Oct 26 12:24:46 2010
From: johnmu at uj.ac.za (Muteba Mwamba, John)
Date: Tue, 26 Oct 2010 12:24:46 +0200
Subject: [R-SIG-Finance] Copula Package
Message-ID: <720B83D05D2D0241A70EFFC75E9029FF998366DD7E@APK-EXCMS-01.ad.uj.ac.za>


Hi all;
I'm having problem to build a multivariate distribution using copula and generalized Pareto distributions as marginals. When I use the following codes I receive an error message:
> gumbel.cop <- gumbelCopula(3, dim=3)
> myMvd <- mvdc(gumbel.cop, c("gpd","gpd","gpd"), list(list(shape=2,scale=1),list(shape=4,scale=2),list(shape=4,scale=5)))
> n=200
> data<-rmvdc(myMvd,n)
The error message that I receive is:
Error in eval(expr, envir, enclos) : could not find function "qgpd"
Can anyone help me to obtain this "qgpd" function in (copula package) so that this code works.
Thanks in advance
Kind Regards,
John

www.uj.ac.za

Mr John Muteba Mwamba
Lecturer
Department of Economics and Econometrics
Office: D-ring 218
Tel +27 11 559 4371
Fax +27 11 559 3039
Cell +27 82 088 7400
Email: johnmu at uj.ac.za
[cid:image002.gif at 01CB7508.C669C600]


________________________________
This email and all contents are subject to the following disclaimer:

http://disclaimer.uj.ac.za
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/9359032a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.gif
Type: image/gif
Size: 2051 bytes
Desc: image001.gif
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/9359032a/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.gif
Type: image/gif
Size: 21558 bytes
Desc: image002.gif
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/9359032a/attachment-0001.gif>

From risk2009 at ath.forthnet.gr  Tue Oct 26 12:40:33 2010
From: risk2009 at ath.forthnet.gr (Costas)
Date: Tue, 26 Oct 2010 13:40:33 +0300
Subject: [R-SIG-Finance] REUTERS
Message-ID: <4CC6B021.4090803@ath.forthnet.gr>

Hello,

Has anybody used R with Reuters? Can we download data from there?

Best,
Costas


From daniel.cegielka at gmail.com  Tue Oct 26 13:01:49 2010
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Tue, 26 Oct 2010 13:01:49 +0200
Subject: [R-SIG-Finance] REUTERS
In-Reply-To: <4CC6B021.4090803@ath.forthnet.gr>
References: <4CC6B021.4090803@ath.forthnet.gr>
Message-ID: <AANLkTik63f62a1HYoNKV9tZS2arGMEveiEfeiTg1girV@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/8c61e0a7/attachment.pl>

From buddyhi at indiatimes.com  Tue Oct 26 14:06:42 2010
From: buddyhi at indiatimes.com (amit jain)
Date: Tue, 26 Oct 2010 17:36:42 +0530 (IST)
Subject: [R-SIG-Finance] haver
In-Reply-To: <mailman.779.1288094394.4266.r-sig-finance@stat.math.ethz.ch>
Message-ID: <310653263.93721288094802678.JavaMail.root@tilmb12.indiatimes.com>

Hi
 Has anyone downloaded Haver data into R.

I am an R newbie, so please forgive any stupid questions.

This is what i did so far :

I was able to download data from Haver using an existing dll in Visual Basic(Excel).
For e.g. I declared functions such as

Private Declare Function DLXOpenDatabase Lib "DLXAPI32" (ByVal DBName$) As Long

And then used them as 
k = DLXOpenDatabase("W:/DLX/USECON")
MsgBox (k)

Gives me '0' showing connection established



Now I am trying to migrate this code to R and was wondering what is the easiest way to call an external dll in R.

During my research I found this link
http://www.stats.uwo.ca/faculty/murdoch/software/compilingDLLs/existingDLL.html

But it seems to be old with expired links to further help pages.

Can any one guide me on how best to connect to external dll's from R and if there is any easier way than writing a new wrapper dll?


Best,
Amit


From brian at braverock.com  Tue Oct 26 14:54:30 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 26 Oct 2010 07:54:30 -0500
Subject: [R-SIG-Finance] REUTERS
In-Reply-To: <AANLkTik63f62a1HYoNKV9tZS2arGMEveiEfeiTg1girV@mail.gmail.com>
References: <4CC6B021.4090803@ath.forthnet.gr>
	<AANLkTik63f62a1HYoNKV9tZS2arGMEveiEfeiTg1girV@mail.gmail.com>
Message-ID: <4CC6CF86.7080309@braverock.com>

On 10/26/2010 06:01 AM, Daniel Cegie?ka wrote:
> http://www.theresearchkitchen.com/blog/archives/287
>
> <http://www.theresearchkitchen.com/blog/archives/287>
>
> 2010/10/26 Costas<risk2009 at ath.forthnet.gr>
>
>> Hello,
>>
>> Has anybody used R with Reuters? Can we download data from there?

This presumes you have access to the Reuters desktop (like a Bloomberg 
terminal).  If you're using the Reuters TickHistory product, it is an 
FTP+SSL download after you put in requests.

We've found it easiest to use the TickHistory product by manually 
submitting requests, and then using curl to download the files, split 
them up,. and load them into R using standard techniques. We might have 
something a little more industrial-strength to release soon.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From gordon.morrison at hsbcib.com  Tue Oct 26 15:07:00 2010
From: gordon.morrison at hsbcib.com (gordon.morrison at hsbcib.com)
Date: Tue, 26 Oct 2010 14:07:00 +0100
Subject: [R-SIG-Finance] REUTERS
In-Reply-To: <4CC6CF86.7080309@braverock.com>
References: <4CC6B021.4090803@ath.forthnet.gr>	<AANLkTik63f62a1HYoNKV9tZS2arGMEveiEfeiTg1girV@mail.gmail.com>
	<4CC6CF86.7080309@braverock.com>
Message-ID: <OFF990C6D2.BB06A90F-ON802577C8.00478B95-802577C8.00480DA9@hsbcib.com>

As Brian Peterson suggests, I think it depends on what you want - current
data, historic data, static data, tick data etc.

Brian Ripley's RODBC package has worked very well and reliably for me in
the past - open a connection; send a SQL; close connection; data already in
R.




                                                                           
             "Brian G.                                                     
             Peterson"                                                     
             <brian at braverock.                                          To 
             com>                      r-sig-finance at stat.math.ethz.ch     
             Sent by:                                                   cc 
             r-sig-finance-bou                                             
             nces at stat.math.et                                     Subject 
             hz.ch                     Re: [R-SIG-Finance] REUTERS         
                                                                    Entity 
                                       Investment Banking Europe - IBEU    
             26/10/2010 13:54                                              
             Mail Size: 6310                                               
                                                                           
                                                                           
                                                                           
                                                                           




On 10/26/2010 06:01 AM, Daniel Cegie?ka wrote:
> http://www.theresearchkitchen.com/blog/archives/287
>
> <http://www.theresearchkitchen.com/blog/archives/287>
>
> 2010/10/26 Costas<risk2009 at ath.forthnet.gr>
>
>> Hello,
>>
>> Has anybody used R with Reuters? Can we download data from there?

This presumes you have access to the Reuters desktop (like a Bloomberg
terminal).  If you're using the Reuters TickHistory product, it is an
FTP+SSL download after you put in requests.

We've found it easiest to use the TickHistory product by manually
submitting requests, and then using curl to download the files, split
them up,. and load them into R using standard techniques. We might have
something a little more industrial-strength to release soon.

Regards,

   - Brian

--
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


************************************************************
HSBC Bank plc may be solicited in the course of its placement efforts for a
new issue, by investment clients of the firm for whom the Bank as a firm
already provides other services. It may equally decide to allocate to its
own proprietary book or with an associate of HSBC Group. This represents a
potential conflict of interest. HSBC Bank plc has internal arrangements
designed to ensure that the firm would give unbiased and full advice to the
corporate finance client about the valuation and pricing of the offering as
well as internal systems, controls and procedures to identify and manage
conflicts of interest.

HSBC Bank plc
Registered Office: 8 Canada Square, London E14 5HQ, United Kingdom
Registered in England - Number 14259
Authorised and regulated by the Financial Services Authority.
************************************************************


************************************************************
HSBC Bank plc may be solicited in the course of its placement efforts for a
new issue, by investment clients of the firm for whom the Bank as a firm
already provides other services. It may equally decide to allocate to its
own proprietary book or with an associate of HSBC Group. This represents a
potential conflict of interest. HSBC Bank plc has internal arrangements
designed to ensure that the firm would give unbiased and full advice to the
corporate finance client about the valuation and pricing of the offering as
well as internal systems, controls and procedures to identify and manage
conflicts of interest.

HSBC Bank plc
Registered Office: 8 Canada Square, London E14 5HQ, United Kingdom
Registered in England - Number 14259
Authorised and regulated by the Financial Services Authority.
************************************************************

-----------------------------------------
SAVE PAPER - THINK BEFORE YOU PRINT!

This transmission has been issued by a member of the HSBC Group
"HSBC" for the information of the addressee only and should not be
reproduced and/or distributed to any other person. Each page
attached hereto must be read in conjunction with any disclaimer
which forms part of it. Unless otherwise stated, this transmission
is neither an offer nor the solicitation of an offer to sell or
purchase any investment. Its contents are based on information
obtained from sources believed to be reliable but HSBC makes no
representation and accepts no responsibility or liability as to its
completeness or accuracy.


From j_cuisinier at hotmail.com  Tue Oct 26 15:25:06 2010
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Tue, 26 Oct 2010 15:25:06 +0200
Subject: [R-SIG-Finance] R & factset?
Message-ID: <COL102-W17EFA8B2CE753093F949618F420@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/5489e4b7/attachment.pl>

From brian at braverock.com  Tue Oct 26 15:34:14 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 26 Oct 2010 08:34:14 -0500
Subject: [R-SIG-Finance] R & factset?
In-Reply-To: <COL102-W17EFA8B2CE753093F949618F420@phx.gbl>
References: <COL102-W17EFA8B2CE753093F949618F420@phx.gbl>
Message-ID: <4CC6D8D6.2090209@braverock.com>

On 10/26/2010 08:25 AM, julien cuisinier wrote:
> Has anyone ever heard of the possibility to download Factset Data directly into a R object? without using Factset-Excel API in between?
>
> Googling around, I could only find 1 unanswered post from 2003 regarding this topic...
>
> Any help - suggestion - pointer greatly appreciated, hope I am not missing something really obvious...

I haven't looked recently, but when I checked a couple of years ago, 
FactSet didn't release a market data API, only the integration for MS 
Office.

You should probably contact your Factset sales or support representative 
and ask them for API documentation, if such exists.  If you can get at a 
DLL or other library, linking that to R should be possible, and possibly 
even straightforward.

Please keep the list apprised of your findings to help others as they 
look for similar solutions.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From dutangc at gmail.com  Tue Oct 26 15:46:25 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Tue, 26 Oct 2010 15:46:25 +0200
Subject: [R-SIG-Finance] Copula Package
In-Reply-To: <720B83D05D2D0241A70EFFC75E9029FF998366DD7E@APK-EXCMS-01.ad.uj.ac.za>
References: <720B83D05D2D0241A70EFFC75E9029FF998366DD7E@APK-EXCMS-01.ad.uj.ac.za>
Message-ID: <AANLkTikeXfQ=en9RGNU8OsYZTOQF_=pUK=mdSnGNBRcq@mail.gmail.com>

Hi,

The GPD is not part of the copula package. Please look at the task view on
distributions to know which package implements the GPD.

Christophe

2010/10/26 Muteba Mwamba, John <johnmu at uj.ac.za>

>   Hi all;
>
> I?m having problem to build a multivariate distribution using copula and
> generalized Pareto distributions as marginals. When I use the following
> codes I receive an error message:
>
> > gumbel.cop <- gumbelCopula(3, dim=3)
>
> > myMvd <- mvdc(gumbel.cop, c("gpd","gpd","gpd"),
> list(list(shape=2,scale=1),list(shape=4,scale=2),list(shape=4,scale=5)))
>
> > n=200
>
> > data<-rmvdc(myMvd,n)
>
> The error message that I receive is:
>
> *Error in eval(expr, envir, enclos) : could not find function "qgpd" *
>
> Can anyone help me to obtain this ?qgpd? function in (copula package) so
> that this code works.
>
> Thanks in advance
>
> Kind Regards,
>
> John
>
> *www.uj.ac.za*
>
> Mr John Muteba Mwamba
> Lecturer
> Department of Economics and Econometrics
>
> Office: D-ring 218
> Tel +27 11 559 4371
> Fax +27 11 559 3039
> Cell +27 82 088 7400
> Email: johnmu at uj.ac.za
>
> [image: UJ_emailer_01]
>
>
>
> ------------------------------
> This email and all contents are subject to the following disclaimer:
>
> http://disclaimer.uj.ac.za
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Christophe DUTANG
Ph. D. student at ISFA, Lyon, France
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/7c99871b/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 21558 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/7c99871b/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 2051 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101026/7c99871b/attachment-0001.gif>

From stephen at organicfoodmarkets.com.au  Wed Oct 27 01:25:02 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 27 Oct 2010 10:25:02 +1100
Subject: [R-SIG-Finance] cointegration & reversion to mean
Message-ID: <4CC7634E.10004@organicfoodmarkets.com.au>

Hi

I am very interested in learning more about cointegration & reversion to 
mean when used for spread trading.

I have a working handle on cointegration thanks to

http://quanttrader.info/public/testForCoint.html

but I am getting nowhere with the Ornstein-Uhlenbeck approach to letting 
me predict time-to-profit as described in

http://epchan.blogspot.com/2007/01/what-is-your-stop-loss-strategy.html

and it strikes me that there must be some work on how far from the mean 
the spread has drifted before it is sensible to take a position but I 
haven't found it yet.

If anyone can point me to work on all these subjects I would be most 
grateful.
-- 
Stephen Choularton Ph.D., FIoD


From arun.kumar.saha at gmail.com  Wed Oct 27 03:48:38 2010
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Tue, 26 Oct 2010 18:48:38 -0700 (PDT)
Subject: [R-SIG-Finance] surface3d from a three column matrix ??
In-Reply-To: <1287700146451-3006418.post@n4.nabble.com>
References: <1287700146451-3006418.post@n4.nabble.com>
Message-ID: <1288144118675-3014755.post@n4.nabble.com>


Hi Skan, are you looking for persp() function?

Regards,
-- 
View this message in context: http://r.789695.n4.nabble.com/surface3d-from-a-three-column-matrix-tp3006418p3014755.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From krishna at primps.com.sg  Wed Oct 27 09:29:29 2010
From: krishna at primps.com.sg (SNV Krishna)
Date: Wed, 27 Oct 2010 15:29:29 +0800
Subject: [R-SIG-Finance] REUTERS
In-Reply-To: <AANLkTik63f62a1HYoNKV9tZS2arGMEveiEfeiTg1girV@mail.gmail.com>
References: <4CC6B021.4090803@ath.forthnet.gr>
	<AANLkTik63f62a1HYoNKV9tZS2arGMEveiEfeiTg1girV@mail.gmail.com>
Message-ID: <97A469AE0FE64CFBAB5F999B755777D1@primpsg>

 
Hi All

This is something which was on my radar for quite some time. I am a
subscriber to Reuters 3000 xtra and looking for ways importing the data feed
directly to R. 
I have gone through the blog entry
http://www.theresearchkitchen.com/blog/archives/287 and downloaded the zip
files (reuters_ts1.zip, reuters_ts_release1.zip), and tried installing them
from R menu by selecting the option "install package from local zip files",
but failed to do so as it shows an error. The error message is below

Error in gzfile(file, "r") : cannot open the connection
In addition: Warning message:
In gzfile(file, "r") :
  cannot open compressed file 'reuters_ts1/DESCRIPTION', probable reason 'No
such file or directory'

Could some one help me in this regard, Many thanks for the assistance and
guidance. 

Regards,

Krishna

-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Daniel
Cegielka
Sent: Tuesday, October 26, 2010 7:02 PM
To: costas.vorlow at gmail.com
Cc: r-sig-finance at stat.math.ethz.ch
Subject: Re: [R-SIG-Finance] REUTERS

http://www.theresearchkitchen.com/blog/archives/287

<http://www.theresearchkitchen.com/blog/archives/287>

2010/10/26 Costas <risk2009 at ath.forthnet.gr>

> Hello,
>
> Has anybody used R with Reuters? Can we download data from there?
>
> Best,
> Costas
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.
>

	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From rui.antunes at sgcib.com  Wed Oct 27 12:02:52 2010
From: rui.antunes at sgcib.com (Rui ANTUNES)
Date: Wed, 27 Oct 2010 12:02:52 +0200
Subject: [R-SIG-Finance] ANTUNES, Rui
Message-ID: <OFF081E4CE.0B842288-ONC12577C9.003731C7-C12577C9.003731C7@fr.world.socgen>


I will be out of the office starting  27/10/2010 and will not return until
29/10/2010.

I am away at the moment, in case of an urgent request please contact George
Oikonomou.

*************************************************************************
This message and any attachments (the "message") are con...{{dropped:12}}


From paulteetor at yahoo.com  Wed Oct 27 17:08:41 2010
From: paulteetor at yahoo.com (Paul Teetor)
Date: Wed, 27 Oct 2010 10:08:41 -0500
Subject: [R-SIG-Finance] cointegration & reversion to mean
In-Reply-To: <4CC7634E.10004@organicfoodmarkets.com.au>
References: <4CC7634E.10004@organicfoodmarkets.com.au>
Message-ID: <2B8739B678F94D50957076138B2B49BA@XI>

Stephen,

First, did you get my posting regarding the O-U model and its limitations
when modeling time-to-reversion?

Second, I suggest reading Ernie Chan's book ("Quantitative Trading") if you
haven't already.

Third, I haven't found much research regarding the timing of mean-reversion
trades. It's my impression that academics don't think about that sort of
thing, and professional traders don't publish what they know. That leaves
very little to read.

For my own trading, I want two conditions before taking a mean-reversion
trade. (1) The spread must be at an extreme value, either the top 90th
percentile of its historical range or the bottom 10th percentile of its
range. (2) The spread momentum must be towards the mean, not away.

Those two guidelines don't guarantee a profit, and I'm sure you can find
better ones. But, so far, they've worked for me.

HTH

Paul
 

-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Stephen
Choularton
Sent: Tuesday, October 26, 2010 6:25 PM
To: r-sig-finance at stat.math.ethz.ch
Subject: [R-SIG-Finance] cointegration & reversion to mean

Hi

I am very interested in learning more about cointegration & reversion to
mean when used for spread trading.

I have a working handle on cointegration thanks to

http://quanttrader.info/public/testForCoint.html

but I am getting nowhere with the Ornstein-Uhlenbeck approach to letting me
predict time-to-profit as described in

http://epchan.blogspot.com/2007/01/what-is-your-stop-loss-strategy.html

and it strikes me that there must be some work on how far from the mean the
spread has drifted before it is sensible to take a position but I haven't
found it yet.

If anyone can point me to work on all these subjects I would be most
grateful.
--
Stephen Choularton Ph.D., FIoD

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From sunduck at gmail.com  Wed Oct 27 17:40:09 2010
From: sunduck at gmail.com (Alex Bird)
Date: Wed, 27 Oct 2010 19:40:09 +0400
Subject: [R-SIG-Finance] Bloomberg historical data requests via rcom
Message-ID: <AANLkTikuVqYNwJJxdDYm+8i6hNju=0WCMx6+7E+6vm9W@mail.gmail.com>

Hello there,

  I have encountered a problem trying to retrieve some historical
piece of data from bloomberg using rcom. Namely if I am trying to do
any requests without specifying start/end datetimes into the bloomberg
functions like this one

conn<-comCreateObject("Bloomberg.Data.1")
comGetProperty(conn,"BLPSubscribe",Security="SPX Index",Fields=c("TODAY_DT"))

I get "10/27/2010" as a result. But if I want to get a timeseries as
of some date like the following one

comGetProperty(conn,"BLPGetHistoricalData",Security="SPX
Index",Fields=c("TODAY_DT"),StartDate=startdate)

I get NULL as a result. I tried to specify dates and datetimes in
different formats (chron,POSIXct,YYYYMMDD,etc.), including the one
used to convert datetime from chron to COM format in the
RBloomberg_0.1-11 (i.e. the current date 2010-10-27 for example
becomes 40452, function for doing that can be found below). Details of
my R are
> sessionInfo()
R version 2.12.0 (2010-10-15)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] chron_2.3-38   rcom_2.2-3.1   rscproxy_1.3-1
>

and I use the latest statconnDCOM3.1-2B6.


I tried to do the same request via RDCOMClient package. Details of
that request are
> require(RDCOMClient)
> require(chron)
>
> as.COMDate.chron <- function(x, date1904 = FALSE){
+   orig0 <- attr(x, "origin")
+   orig1 <- as.Date(ISOdate(orig0[3], orig0[1], orig0[2]))
+   if (date1904){
+     dif <- orig1 - as.Date("1903-12-31") + 1
+   }else{
+     dif <- orig1 - as.Date("1900-01-01") + 2
+   }
+   y <- as.numeric(x) + as.numeric(dif)
+   class(y) <- "COMDate"
+   y
+ }
>
> conn<-COMCreate("Bloomberg.Data.1")
> startdate=as.COMDate.chron(as.chron('2010-10-27'))
> startdate
[1] 40478
attr(,"class")
[1] "COMDate"
> conn$BLPSubscribe(Security="SPX Index",Fields="TODAY_DT")
[[1]]
[[1]][[1]]
[1] "10/27/2010"


> conn$BLPGetHistoricalData(Security="SPX Index",Fields="PX_OPEN",StartDate=startdate)
[[1]]
[[1]][[1]]
[[1]][[1]][[1]]
An object of class "COMDate"
[1] 40478



[[2]]
[[2]][[1]]
[[2]][[1]][[1]]
[1] 1183.84



>
> sessionInfo()
R version 2.12.0 (2010-10-15)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] chron_2.3-38         RDCOMClient_0.92-0.1
>



And the question is what can be wrong with the datetime format or my R?
Thanks in advance!

Kind regards,
Alex


From cedrick at cedrickjohnson.com  Wed Oct 27 17:54:30 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Wed, 27 Oct 2010 11:54:30 -0400
Subject: [R-SIG-Finance] Calculating returns on negative time series
Message-ID: <4CC84B36.8070102@cedrickjohnson.com>

Howdy-

I *know* I've seen it discussed before on the list, and I've tried to 
search through all my emails and the archives for it so forgive me for 
reposting (perhaps I'm using the improper search terms).

To calculate the simple returns for a time series above 0, no brainer:

I'm using the Return.calculate function to calculate these (method="simple")

Things get a little tricky when I throw in time series that are negative 
(such as spreads):

x = 
c(-117,-122,-129,-129,-134,-136,-136,-140,-143,-143,-143.2,-146.7,-145.8,-143,-141.2,-137.7,-135.5,-133.6)

NaN's are produced when trying to get a "return" time series. I seem to 
recall doing this

xa = abs(x)
Return.calculate(xa)

2   0.041847110
3   0.055791360
4   0.000000000
5   0.038027396
6   0.014815086
7   0.000000000
8   0.028987537
9   0.021202208
10  0.000000000
11  0.001397624
12  0.024147431
13 -0.006153866
14 -0.019391189
15 -0.012667305
16 -0.025099919
17 -0.016105765
18 -0.014121379

I am thinking that I could take the abs value, once I get the return 
series just invert it by multiplying by -1. I'm concerned that something 
could be thrown off by a series that's changing from lets say 1,0,-1 
(puking on the 0).

Can someone point me to anything that addresses this? Not sure the 
"solution" i outlined above is the proper way to handle this.

-c


From Horace.Tso at pgn.com  Wed Oct 27 18:37:40 2010
From: Horace.Tso at pgn.com (Horace Tso)
Date: Wed, 27 Oct 2010 09:37:40 -0700
Subject: [R-SIG-Finance] fancier version of weeklyReturn (quantmod)
Message-ID: <5C3F9922B1D5FB4886B2D2045AB952F3052B003754@IPEXMAIL.corp.dom>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101027/cc67c80b/attachment.pl>

From patrick at burns-stat.com  Wed Oct 27 18:38:42 2010
From: patrick at burns-stat.com (Patrick Burns)
Date: Wed, 27 Oct 2010 17:38:42 +0100
Subject: [R-SIG-Finance] Calculating returns on negative time series
In-Reply-To: <4CC84B36.8070102@cedrickjohnson.com>
References: <4CC84B36.8070102@cedrickjohnson.com>
Message-ID: <4CC85592.5070100@burns-stat.com>

The post:
http://www.portfolioprobe.com/2010/10/04/a-tale-of-two-returns/
may or may not answer your question.

If it does answer your question, then I suspect
you are using negative values to mean "short".
Correct?

If it does not answer your question, then can you
explain the negative part more thoroughly please?

On 27/10/2010 16:54, Johnson, Cedrick W. wrote:
> Howdy-
>
> I *know* I've seen it discussed before on the list, and I've tried to
> search through all my emails and the archives for it so forgive me for
> reposting (perhaps I'm using the improper search terms).
>
> To calculate the simple returns for a time series above 0, no brainer:
>
> I'm using the Return.calculate function to calculate these
> (method="simple")
>
> Things get a little tricky when I throw in time series that are negative
> (such as spreads):
>
> x =
> c(-117,-122,-129,-129,-134,-136,-136,-140,-143,-143,-143.2,-146.7,-145.8,-143,-141.2,-137.7,-135.5,-133.6)
>
>
> NaN's are produced when trying to get a "return" time series. I seem to
> recall doing this
>
> xa = abs(x)
> Return.calculate(xa)
>
> 2 0.041847110
> 3 0.055791360
> 4 0.000000000
> 5 0.038027396
> 6 0.014815086
> 7 0.000000000
> 8 0.028987537
> 9 0.021202208
> 10 0.000000000
> 11 0.001397624
> 12 0.024147431
> 13 -0.006153866
> 14 -0.019391189
> 15 -0.012667305
> 16 -0.025099919
> 17 -0.016105765
> 18 -0.014121379
>
> I am thinking that I could take the abs value, once I get the return
> series just invert it by multiplying by -1. I'm concerned that something
> could be thrown off by a series that's changing from lets say 1,0,-1
> (puking on the 0).
>
> Can someone point me to anything that addresses this? Not sure the
> "solution" i outlined above is the proper way to handle this.
>
> -c
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog


From matthieu.stigler at gmail.com  Wed Oct 27 18:40:35 2010
From: matthieu.stigler at gmail.com (mat)
Date: Wed, 27 Oct 2010 18:40:35 +0200
Subject: [R-SIG-Finance] cointegration & reversion to mean
In-Reply-To: <2B8739B678F94D50957076138B2B49BA@XI>
References: <4CC7634E.10004@organicfoodmarkets.com.au>
	<2B8739B678F94D50957076138B2B49BA@XI>
Message-ID: <4CC85603.1060804@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101027/2ff1bdf8/attachment.pl>

From cedrick at cedrickjohnson.com  Wed Oct 27 18:51:26 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Wed, 27 Oct 2010 12:51:26 -0400
Subject: [R-SIG-Finance] Calculating returns on negative time series
In-Reply-To: <4CC85592.5070100@burns-stat.com>
References: <4CC84B36.8070102@cedrickjohnson.com>
	<4CC85592.5070100@burns-stat.com>
Message-ID: <4CC8588E.80005@cedrickjohnson.com>

I'll look into the materials at the post in more detail shortly, much 
appreciated.

On the series, I could either be long or short. Meaning:

"long" at -117, if it jumps to -122 i've lost -5. Conversely, "short" 
-117 and it jumps to -122 +5.

I hope I explained it well, as I said i'll check the link and do some 
more digging.

regards,
c

On 10/27/2010 12:38 PM, Patrick Burns wrote:
> The post:
> http://www.portfolioprobe.com/2010/10/04/a-tale-of-two-returns/
> may or may not answer your question.
>
> If it does answer your question, then I suspect
> you are using negative values to mean "short".
> Correct?
>
> If it does not answer your question, then can you
> explain the negative part more thoroughly please?
>
> On 27/10/2010 16:54, Johnson, Cedrick W. wrote:
>> Howdy-
>>
>> I *know* I've seen it discussed before on the list, and I've tried to
>> search through all my emails and the archives for it so forgive me for
>> reposting (perhaps I'm using the improper search terms).
>>
>> To calculate the simple returns for a time series above 0, no brainer:
>>
>> I'm using the Return.calculate function to calculate these
>> (method="simple")
>>
>> Things get a little tricky when I throw in time series that are negative
>> (such as spreads):
>>
>> x =
>> c(-117,-122,-129,-129,-134,-136,-136,-140,-143,-143,-143.2,-146.7,-145.8,-143,-141.2,-137.7,-135.5,-133.6) 
>>
>>
>>
>> NaN's are produced when trying to get a "return" time series. I seem to
>> recall doing this
>>
>> xa = abs(x)
>> Return.calculate(xa)
>>
>> 2 0.041847110
>> 3 0.055791360
>> 4 0.000000000
>> 5 0.038027396
>> 6 0.014815086
>> 7 0.000000000
>> 8 0.028987537
>> 9 0.021202208
>> 10 0.000000000
>> 11 0.001397624
>> 12 0.024147431
>> 13 -0.006153866
>> 14 -0.019391189
>> 15 -0.012667305
>> 16 -0.025099919
>> 17 -0.016105765
>> 18 -0.014121379
>>
>> I am thinking that I could take the abs value, once I get the return
>> series just invert it by multiplying by -1. I'm concerned that something
>> could be thrown off by a series that's changing from lets say 1,0,-1
>> (puking on the 0).
>>
>> Can someone point me to anything that addresses this? Not sure the
>> "solution" i outlined above is the proper way to handle this.
>>
>> -c
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>


From patrick at burns-stat.com  Wed Oct 27 19:11:21 2010
From: patrick at burns-stat.com (Patrick Burns)
Date: Wed, 27 Oct 2010 18:11:21 +0100
Subject: [R-SIG-Finance] Calculating returns on negative time series
In-Reply-To: <4CC8588E.80005@cedrickjohnson.com>
References: <4CC84B36.8070102@cedrickjohnson.com>
	<4CC85592.5070100@burns-stat.com>
	<4CC8588E.80005@cedrickjohnson.com>
Message-ID: <4CC85D39.2050904@burns-stat.com>

Okay.  The thing about returns is that
they are about *money*.  The return
over a period of time is a function of
two values:
* the amount of money to buy
* the amount of money to sell

I don't think that is what you have in
your data.

On 27/10/2010 17:51, Johnson, Cedrick W. wrote:
> I'll look into the materials at the post in more detail shortly, much
> appreciated.
>
> On the series, I could either be long or short. Meaning:
>
> "long" at -117, if it jumps to -122 i've lost -5. Conversely, "short"
> -117 and it jumps to -122 +5.
>
> I hope I explained it well, as I said i'll check the link and do some
> more digging.
>
> regards,
> c
>
> On 10/27/2010 12:38 PM, Patrick Burns wrote:
>> The post:
>> http://www.portfolioprobe.com/2010/10/04/a-tale-of-two-returns/
>> may or may not answer your question.
>>
>> If it does answer your question, then I suspect
>> you are using negative values to mean "short".
>> Correct?
>>
>> If it does not answer your question, then can you
>> explain the negative part more thoroughly please?
>>
>> On 27/10/2010 16:54, Johnson, Cedrick W. wrote:
>>> Howdy-
>>>
>>> I *know* I've seen it discussed before on the list, and I've tried to
>>> search through all my emails and the archives for it so forgive me for
>>> reposting (perhaps I'm using the improper search terms).
>>>
>>> To calculate the simple returns for a time series above 0, no brainer:
>>>
>>> I'm using the Return.calculate function to calculate these
>>> (method="simple")
>>>
>>> Things get a little tricky when I throw in time series that are negative
>>> (such as spreads):
>>>
>>> x =
>>> c(-117,-122,-129,-129,-134,-136,-136,-140,-143,-143,-143.2,-146.7,-145.8,-143,-141.2,-137.7,-135.5,-133.6)
>>>
>>>
>>>
>>> NaN's are produced when trying to get a "return" time series. I seem to
>>> recall doing this
>>>
>>> xa = abs(x)
>>> Return.calculate(xa)
>>>
>>> 2 0.041847110
>>> 3 0.055791360
>>> 4 0.000000000
>>> 5 0.038027396
>>> 6 0.014815086
>>> 7 0.000000000
>>> 8 0.028987537
>>> 9 0.021202208
>>> 10 0.000000000
>>> 11 0.001397624
>>> 12 0.024147431
>>> 13 -0.006153866
>>> 14 -0.019391189
>>> 15 -0.012667305
>>> 16 -0.025099919
>>> 17 -0.016105765
>>> 18 -0.014121379
>>>
>>> I am thinking that I could take the abs value, once I get the return
>>> series just invert it by multiplying by -1. I'm concerned that something
>>> could be thrown off by a series that's changing from lets say 1,0,-1
>>> (puking on the 0).
>>>
>>> Can someone point me to anything that addresses this? Not sure the
>>> "solution" i outlined above is the proper way to handle this.
>>>
>>> -c
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog


From cedrick at cedrickjohnson.com  Wed Oct 27 19:17:36 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Wed, 27 Oct 2010 13:17:36 -0400
Subject: [R-SIG-Finance] Calculating returns on negative time series
In-Reply-To: <4CC85D39.2050904@burns-stat.com>
References: <4CC84B36.8070102@cedrickjohnson.com>
	<4CC85592.5070100@burns-stat.com>
	<4CC8588E.80005@cedrickjohnson.com>
	<4CC85D39.2050904@burns-stat.com>
Message-ID: <4CC85EB0.3020106@cedrickjohnson.com>

I concur; I was approaching this particular problem from the wrong way 
and this helps clarify things a great bit.

Thanks for clarity on this on behalf of my foggy brain today

-c

On 10/27/2010 1:11 PM, Patrick Burns wrote:
> Okay.  The thing about returns is that
> they are about *money*.  The return
> over a period of time is a function of
> two values:
> * the amount of money to buy
> * the amount of money to sell
>
> I don't think that is what you have in
> your data.
>
> On 27/10/2010 17:51, Johnson, Cedrick W. wrote:
>> I'll look into the materials at the post in more detail shortly, much
>> appreciated.
>>
>> On the series, I could either be long or short. Meaning:
>>
>> "long" at -117, if it jumps to -122 i've lost -5. Conversely, "short"
>> -117 and it jumps to -122 +5.
>>
>> I hope I explained it well, as I said i'll check the link and do some
>> more digging.
>>
>> regards,
>> c
>>
>> On 10/27/2010 12:38 PM, Patrick Burns wrote:
>>> The post:
>>> http://www.portfolioprobe.com/2010/10/04/a-tale-of-two-returns/
>>> may or may not answer your question.
>>>
>>> If it does answer your question, then I suspect
>>> you are using negative values to mean "short".
>>> Correct?
>>>
>>> If it does not answer your question, then can you
>>> explain the negative part more thoroughly please?
>>>
>>> On 27/10/2010 16:54, Johnson, Cedrick W. wrote:
>>>> Howdy-
>>>>
>>>> I *know* I've seen it discussed before on the list, and I've tried to
>>>> search through all my emails and the archives for it so forgive me for
>>>> reposting (perhaps I'm using the improper search terms).
>>>>
>>>> To calculate the simple returns for a time series above 0, no brainer:
>>>>
>>>> I'm using the Return.calculate function to calculate these
>>>> (method="simple")
>>>>
>>>> Things get a little tricky when I throw in time series that are 
>>>> negative
>>>> (such as spreads):
>>>>
>>>> x =
>>>> c(-117,-122,-129,-129,-134,-136,-136,-140,-143,-143,-143.2,-146.7,-145.8,-143,-141.2,-137.7,-135.5,-133.6) 
>>>>
>>>>
>>>>
>>>>
>>>> NaN's are produced when trying to get a "return" time series. I 
>>>> seem to
>>>> recall doing this
>>>>
>>>> xa = abs(x)
>>>> Return.calculate(xa)
>>>>
>>>> 2 0.041847110
>>>> 3 0.055791360
>>>> 4 0.000000000
>>>> 5 0.038027396
>>>> 6 0.014815086
>>>> 7 0.000000000
>>>> 8 0.028987537
>>>> 9 0.021202208
>>>> 10 0.000000000
>>>> 11 0.001397624
>>>> 12 0.024147431
>>>> 13 -0.006153866
>>>> 14 -0.019391189
>>>> 15 -0.012667305
>>>> 16 -0.025099919
>>>> 17 -0.016105765
>>>> 18 -0.014121379
>>>>
>>>> I am thinking that I could take the abs value, once I get the return
>>>> series just invert it by multiplying by -1. I'm concerned that 
>>>> something
>>>> could be thrown off by a series that's changing from lets say 1,0,-1
>>>> (puking on the 0).
>>>>
>>>> Can someone point me to anything that addresses this? Not sure the
>>>> "solution" i outlined above is the proper way to handle this.
>>>>
>>>> -c
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R 
>>>> questions
>>>> should go.
>>>>
>>>
>>
>>
>


From leijin56 at gmail.com  Thu Oct 28 07:30:25 2010
From: leijin56 at gmail.com (Lei Jin)
Date: Wed, 27 Oct 2010 22:30:25 -0700
Subject: [R-SIG-Finance] help: blotter debugging: How to step into a blotter
	function.
Message-ID: <AANLkTim1VQEEgaTMYajJZWP87nf+Mz12Uh0D1mT0i_Q=@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101027/f92cd7d6/attachment.pl>

From breman.mark at gmail.com  Thu Oct 28 09:58:36 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 28 Oct 2010 09:58:36 +0200
Subject: [R-SIG-Finance] help: blotter debugging: How to step into a
 blotter function.
In-Reply-To: <AANLkTim1VQEEgaTMYajJZWP87nf+Mz12Uh0D1mT0i_Q=@mail.gmail.com>
References: <AANLkTim1VQEEgaTMYajJZWP87nf+Mz12Uh0D1mT0i_Q=@mail.gmail.com>
Message-ID: <AANLkTin8si5_Z5bNMca4fqzbZvt9V6c8vW+WkC2SzF-B@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101028/17f73eb7/attachment.pl>

From brian at braverock.com  Thu Oct 28 12:19:11 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 28 Oct 2010 05:19:11 -0500
Subject: [R-SIG-Finance] help: blotter debugging: How to step into a
 blotter function.
In-Reply-To: <AANLkTim1VQEEgaTMYajJZWP87nf+Mz12Uh0D1mT0i_Q=@mail.gmail.com>
References: <AANLkTim1VQEEgaTMYajJZWP87nf+Mz12Uh0D1mT0i_Q=@mail.gmail.com>
Message-ID: <0b9fbc3db0759e70a548c50e83eba605@braverock.com>

On Wed, 27 Oct 2010 22:30:25 -0700, Lei Jin <leijin56 at gmail.com> wrote:
> Hi,
> 
> I just picked up R and played with few samples.  I need some help on
> debugging.
> 
> How do I debug a function in a package like blotter?  I would like to
step
> into the function.  Right now, I got the following error from my script
> below.  I copied and modified the sample script from somewhere.  I don't
> know where the error message coming from (OK, I guess it is coming from
> getEndEq()), the message does not have a call stack trace.  What's the
> effective way of debugging such message?

You may also want to start with the demo scripts in the package itself,
and make sure you understand those first.

Regards,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From andres.susrud at gmail.com  Thu Oct 28 15:06:04 2010
From: andres.susrud at gmail.com (Andres Susrud)
Date: Thu, 28 Oct 2010 15:06:04 +0200
Subject: [R-SIG-Finance] intraday volatility
Message-ID: <AANLkTin27kBSXuD0ea9sR=5VzCM4PJB7RFdtNCptJARb@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101028/1645db80/attachment.pl>

From brian at braverock.com  Thu Oct 28 15:10:25 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 28 Oct 2010 08:10:25 -0500
Subject: [R-SIG-Finance] intraday volatility
In-Reply-To: <AANLkTin27kBSXuD0ea9sR=5VzCM4PJB7RFdtNCptJARb@mail.gmail.com>
References: <AANLkTin27kBSXuD0ea9sR=5VzCM4PJB7RFdtNCptJARb@mail.gmail.com>
Message-ID: <4CC97641.4070208@braverock.com>

On 10/28/2010 08:06 AM, Andres Susrud wrote:
> I have a question regarding calculating the intraday volatility.
>
> I have a dataset that is sub minute, and about 2-3k long.
>
> The normal calculation would be
> sigma = sd(diff(log(data)))
> but when producing a GBM w.o drift, the process is way out of scale of what
> I would expect.
>
> any comments? or hints for calculating the intraday vol. adjusted for my
> timescale?

What you see is typical for high frequency data.  See the package 
'realized' and the references therein for more information on the 
literature regarding volatility calculations on high frequency data.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From rex at nosyntax.net  Thu Oct 28 16:07:38 2010
From: rex at nosyntax.net (rex)
Date: Thu, 28 Oct 2010 07:07:38 -0700
Subject: [R-SIG-Finance] intraday volatility
In-Reply-To: <AANLkTin27kBSXuD0ea9sR=5VzCM4PJB7RFdtNCptJARb@mail.gmail.com>
References: <AANLkTin27kBSXuD0ea9sR=5VzCM4PJB7RFdtNCptJARb@mail.gmail.com>
Message-ID: <20101028140738.GA4552@nosyntax.net>

Andres Susrud <andres.susrud at gmail.com> [2010-10-28 06:06]:
>I have a question regarding calculating the intraday volatility.
>
>I have a dataset that is sub minute, and about 2-3k long.
>
>The normal calculation would be
>sigma = sd(diff(log(data)))
>but when producing a GBM w.o drift, the process is way out of scale of what
>I would expect.

As Brian noted, noise is predominant in HF data. The URLs below
link to a recent (2010) paper on the problem. Google will turn up
a free draft version of the paper.

http://www.sciencedirect.com/science?_ob=ArticleURL&_udi=B6VC0-4YJ6GKX-G&_user=10&_coverDate=03%2F06%2F2010&_rdoc=1&_fmt=high&_orig=search&_origin=search&_sort=d&_docanchor=&view=c&_searchStrId=1517805192&_rerunOrigin=scholar.google&_acct=C000050221&_version=1&_urlVersion=0&_userid=10&md5=9311c44ddcdeb2111516631a7781fc0b&searchtype=a

http://tinyurl.com/2bsrd9b

-rex
-- 
Impartial, adj.:
        Unable to perceive any promise of personal advantage from
        espousing either side of a controversy or adopting either of two
        conflicting opinions.
                -- Ambrose Bierce, "The Devil's Dictionary"


From josh.m.ulrich at gmail.com  Fri Oct 29 03:27:07 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 28 Oct 2010 20:27:07 -0500
Subject: [R-SIG-Finance] haver
In-Reply-To: <310653263.93721288094802678.JavaMail.root@tilmb12.indiatimes.com>
References: <mailman.779.1288094394.4266.r-sig-finance@stat.math.ethz.ch>
	<310653263.93721288094802678.JavaMail.root@tilmb12.indiatimes.com>
Message-ID: <AANLkTi=8xr55xWBZD2+hFoqD9YE9ghbnzzivPGyXBwLH@mail.gmail.com>

Hi Amit,

While Haver does provide a lot of financial data, this question is
really more suited for R-help.  You will be much more likely to
receive a response in that forum, since many more people follow it.

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Tue, Oct 26, 2010 at 7:06 AM, amit jain <buddyhi at indiatimes.com> wrote:
> Hi
> ?Has anyone downloaded Haver data into R.
>
> I am an R newbie, so please forgive any stupid questions.
>
> This is what i did so far :
>
> I was able to download data from Haver using an existing dll in Visual Basic(Excel).
> For e.g. I declared functions such as
>
> Private Declare Function DLXOpenDatabase Lib "DLXAPI32" (ByVal DBName$) As Long
>
> And then used them as
> k = DLXOpenDatabase("W:/DLX/USECON")
> MsgBox (k)
>
> Gives me '0' showing connection established
>
>
>
> Now I am trying to migrate this code to R and was wondering what is the easiest way to call an external dll in R.
>
> During my research I found this link
> http://www.stats.uwo.ca/faculty/murdoch/software/compilingDLLs/existingDLL.html
>
> But it seems to be old with expired links to further help pages.
>
> Can any one guide me on how best to connect to external dll's from R and if there is any easier way than writing a new wrapper dll?
>
>
> Best,
> Amit
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From omerle at agritel.com  Fri Oct 29 11:33:34 2010
From: omerle at agritel.com (Olivier MERLE)
Date: 29 Oct 2010 09:33:34 -0000
Subject: [R-SIG-Finance] =?utf-8?q?IBrokers_=3A_asssign=2EData_and_others_?=
	=?utf-8?q?questions=2E=2E?=
Message-ID: <1288344814.4cca94ee2e9f1@agritel.extranet-e.net>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101029/7db3d161/attachment.html>

From vedahl at stud.ntnu.no  Sat Oct 30 00:09:27 2010
From: vedahl at stud.ntnu.no (Knut Erik Vedahl)
Date: Sat, 30 Oct 2010 00:09:27 +0200
Subject: [R-SIG-Finance] Seasonal ARIMA simulation using time series history
Message-ID: <20101030000927.utcvjszq2oo44o4o@webmail.ntnu.no>

Hi,

I'm currently working with a seasonal ARIMA model from which I want to make
simulations. As I understand, neither sarima.Sim nor the functions in the
gsarima package use historic realizations of the time series to simulate
future values. However, I want to use historic values as input and simulate
future values based on the history. Anyone who know whether such a function
is available in the libaries or anywhere else?


Thanks for any help!

Knut


From gplaxico at gmail.com  Sat Oct 30 01:29:38 2010
From: gplaxico at gmail.com (Gabe Plaxico)
Date: Fri, 29 Oct 2010 19:29:38 -0400
Subject: [R-SIG-Finance] Mean-Semivariance (downside risk) Portfolio
	Construction
Message-ID: <4CCB58E2.5010301@gmail.com>

Hello Everyone:

Does anyone have experience in constructing a mean-semivariance 
portfolio using the fPortfolio package?  What I am really searching for 
is the ability to use my own arbitrary "mean", essentially constructing 
a downside risk portfolio (Sortino - 
http://sortino.com/htm/New%20Book.htm).  Typically done using the lpm 
solver option.   My attempts at constructing this portfolio with 
anything other than the true mean for each security ends in an error.  
If anyone has done something similar can you provide 
suggestions/examples?  Thanks in advance.


From josh.m.ulrich at gmail.com  Sat Oct 30 18:37:16 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sat, 30 Oct 2010 11:37:16 -0500
Subject: [R-SIG-Finance] Bollinger Bands error
In-Reply-To: <AANLkTi=pTOaZsjzjcQ61s=QHv2T=4D0x_5c4-6pEwnB2@mail.gmail.com>
References: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>
	<AANLkTina2WKp-3ZC-fO=2gSfYONnEkTBWsddpgULALsQ@mail.gmail.com>
	<AANLkTi=pTOaZsjzjcQ61s=QHv2T=4D0x_5c4-6pEwnB2@mail.gmail.com>
Message-ID: <AANLkTinyrvE-a9ejZ=yMzXc8VjQQfCozsB2v3d-MazB_@mail.gmail.com>

Hi Nikos,

On Sat, Oct 23, 2010 at 4:25 PM, Nikos Rachmanis
<nikos.rachmanis at gmail.com> wrote:
> Hi Joshua & Jeff,
> Thank you very much for your answers. As you said I followed you
> recommendation with the following code:
> Close<-as.matrix(close)
> BB<-format(BBands(Close, n=14, sd=2), digits=6)
> Joshua, the only thing that I do not comprehend fully is the maType argument
> you have. How exactly do you use it?

The maType argument isn't particularly interesting in BBands because
BBands only requires one MA.  maType allows you to specify different
MAs (or the same MA with different arguments) for functions that have
more than one MA.  ?RSI has some examples:

# Case of one 'maType' for both MAs
rsiMA1 <- RSI(price, n=14, maType="WMA", wts=ttrc[,"Volume"])

# Case of two different 'maType's for both MAs
rsiMA2 <- RSI(price, n=14, maType=list(maUp=list(EMA,ratio=1/5),
              maDown=list(WMA,wts=1:10)))


> Thank you very much everyone for the very useful feedback,
> Nikos

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


> On Thu, Oct 21, 2010 at 6:01 PM, Joshua Ulrich <josh.m.ulrich at gmail.com>
> wrote:
>>
>> Hi Nikos,
>>
>> On Thu, Oct 21, 2010 at 4:37 PM, Nikos Rachmanis
>> <nikos.rachmanis at gmail.com> wrote:
>> > Hi all,
>> >
>> > I am new to R and I would appreciate if someone can help me out with the
>> > following problem. I am trying to use the TTR package in order to
>> > calculate
>> > the Bollinger Bands. I have created a matrix with the Open, High, Low
>> > and
>> > Close variables using the following command:
>> >
>> You did not create a matrix, you created a data.frame. ?They are
>> different. ?Compare ?data.frame and ?matrix.
>>
>> > OHLC<-data.frame(open, high, low, close, check.names=TRUE)
>> >
>> > However every time I am trying to run the command ( BBands(OHLC, n=20,
>> > maType, sd=2, ...)) this is the error I am getting:
>> >
>> > "Error in inherits(x, "xts") : object 'x' not found"
>> >
>> A reproducible example would help. ?Even if you did not get the above
>> error, your command should fail because the OHLC object has 4 columns
>> and BBands only accepts objects with 1 or 3 columns (see ?BBands).
>>
>> > Has anyone came across this problem in order to know the solution?
>> >
>> > Thanks a lot in advance,
>> > Nikos
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at stat.math.ethz.ch mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>> >
>
>


From nikos.rachmanis at gmail.com  Sun Oct 31 02:41:57 2010
From: nikos.rachmanis at gmail.com (Nikos Rachmanis)
Date: Sat, 30 Oct 2010 20:41:57 -0400
Subject: [R-SIG-Finance] Bollinger Bands error
In-Reply-To: <AANLkTinyrvE-a9ejZ=yMzXc8VjQQfCozsB2v3d-MazB_@mail.gmail.com>
References: <AANLkTi=GaKwwxXGo_Ps1ic-ZAE8oCo1orzMCmvBHf+d+@mail.gmail.com>
	<AANLkTina2WKp-3ZC-fO=2gSfYONnEkTBWsddpgULALsQ@mail.gmail.com>
	<AANLkTi=pTOaZsjzjcQ61s=QHv2T=4D0x_5c4-6pEwnB2@mail.gmail.com>
	<AANLkTinyrvE-a9ejZ=yMzXc8VjQQfCozsB2v3d-MazB_@mail.gmail.com>
Message-ID: <AANLkTim7snzRVF8fr=vnZ=nVc9JOxdsTP=HJAnfqfxrv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101030/092992a5/attachment.pl>

From premhotm at hotmail.com  Sun Oct 31 04:43:59 2010
From: premhotm at hotmail.com (Premkumar Narasimhan)
Date: Sun, 31 Oct 2010 03:43:59 +0000
Subject: [R-SIG-Finance] Using dense constraint matrix in package lpSolve
Message-ID: <SNT126-W32C3F46F061321C27D6B54DB470@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101031/3625c559/attachment.pl>

From rex at nosyntax.net  Sun Oct 31 05:39:22 2010
From: rex at nosyntax.net (rex)
Date: Sat, 30 Oct 2010 21:39:22 -0700
Subject: [R-SIG-Finance] intraday volatility
In-Reply-To: <20101028140738.GA4552@nosyntax.net>
References: <AANLkTin27kBSXuD0ea9sR=5VzCM4PJB7RFdtNCptJARb@mail.gmail.com>
	<20101028140738.GA4552@nosyntax.net>
Message-ID: <20101031043922.GJ5256@nosyntax.net>

rex <rex at nosyntax.net> [2010-10-28 07:09]:
>As Brian noted, noise is predominant in HF data. The URLs below
>link to a recent (2010) paper on the problem. Google will turn up
>a free draft version of the paper.

The URLs fail. :( Here's a reference:

Ultra High Frequency Volatility Estimation with Dependent
Microstructure Noise
Yacine Ait-Sahalia, Per A. Mykland, Lan Zhang
First Draft: November 2004. This Version: October 28, 2008.
                    Abstract
We analyze the impact of time series dependence in market
microstructure noise on the properties of estimators of the
integrated volatility of an asset price based on data sampled at
frequencies high enough for that noise to be a dominant
consideration. We show that combining two time scales for that
purpose will work even when the noise exhibits time series
dependence, analyze in that context a refinement of this approach
based on multiple time scales, and compare empirically our
different estimators to the standard realized volatility.

Google Scholar advanced search ( author:Mykland) will find the
full text.

http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.143.972&rep=rep1&type=pdf

(Tested, it works in FF.)

-rex
-- 
Mathematician: noun, someone who disavows certainty when their
uncertainty set is non-empty, even if that set has measure zero.


From j_cuisinier at hotmail.com  Mon Nov  1 09:46:01 2010
From: j_cuisinier at hotmail.com (julien cuisinier)
Date: Mon, 1 Nov 2010 09:46:01 +0100
Subject: [R-SIG-Finance] R & factset?
In-Reply-To: <4CC6D8D6.2090209@braverock.com>
References: <COL102-W17EFA8B2CE753093F949618F420@phx.gbl>,
	<4CC6D8D6.2090209@braverock.com>
Message-ID: <COL102-W2881C9D423B3EFA582CB638F480@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101101/82f74a7a/attachment.pl>

From megh700004 at yahoo.com  Mon Nov  1 09:47:36 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Mon, 1 Nov 2010 01:47:36 -0700 (PDT)
Subject: [R-SIG-Finance] Barrier options
Message-ID: <672696.78695.qm@web58101.mail.re3.yahoo.com>

Dear friends, is there any implementation in R to price the Barrier options like (up&in, up&out, down&in , down&out). If it is not implemented yet then perhaps I need to write on my own.

Thanks


From matthieu.stigler at gmail.com  Mon Nov  1 10:00:10 2010
From: matthieu.stigler at gmail.com (mat)
Date: Mon, 01 Nov 2010 10:00:10 +0100
Subject: [R-SIG-Finance] Seasonal ARIMA simulation using time series
	history
In-Reply-To: <20101030000927.utcvjszq2oo44o4o@webmail.ntnu.no>
References: <20101030000927.utcvjszq2oo44o4o@webmail.ntnu.no>
Message-ID: <4CCE819A.2060105@gmail.com>

Dear Knut

Why don't you estimate historical values using arima() and then use 
gsarimax package to simulate from those parameters?

Hope this helps

Matthieu

Le 30. 10. 10 00:09, Knut Erik Vedahl a ?crit :
> Hi,
>
> I'm currently working with a seasonal ARIMA model from which I want to 
> make
> simulations. As I understand, neither sarima.Sim nor the functions in the
> gsarima package use historic realizations of the time series to simulate
> future values. However, I want to use historic values as input and 
> simulate
> future values based on the history. Anyone who know whether such a 
> function
> is available in the libaries or anywhere else?
>
>
> Thanks for any help!
>
> Knut
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.


From brian at braverock.com  Mon Nov  1 12:31:55 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 01 Nov 2010 06:31:55 -0500
Subject: [R-SIG-Finance] Barrier options
In-Reply-To: <672696.78695.qm@web58101.mail.re3.yahoo.com>
References: <672696.78695.qm@web58101.mail.re3.yahoo.com>
Message-ID: <4CCEA52B.1070309@braverock.com>

On 11/01/2010 03:47 AM, Megh Dal wrote:
> Dear friends, is there any implementation in R to price the Barrier options like (up&in, up&out, down&in , down&out). If it is not implemented yet then perhaps I need to write on my own.

RQuantLib exposes function BarrierOption from the QuantLib library.

for future reference,

RSiteSearch("barrier option")

from inside R would have told you that.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Mon Nov  1 15:07:31 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 01 Nov 2010 09:07:31 -0500
Subject: [R-SIG-Finance] Mean-Semivariance (downside risk) Portfolio
	Construction
In-Reply-To: <4CCE1591.3090708@gmail.com>
References: <4CCB58E2.5010301@gmail.com>
	<afe25679dd2435ada48597018f1e2530@braverock.com>
	<4CCE1591.3090708@gmail.com>
Message-ID: <4CCEC9A3.7010802@braverock.com>

Gabe,

Since no one has answered your question regarding fPortfolio, and I 
can't really help with that in this context, I've done an example using 
PortfolioAnalytics.

Here's an example that maximizes Sortino Ratio, given some MAR.

It takes about 15 seconds to run the example on my machine, using 
multicore and random portfolios.  DEoptim will also work, but will be 
slower. Larger portfolios will obviously take longer to optimize.

If you're on Windows, you will have to modify (or simply comment out) 
the lines:
require(doMC)
registerDoMC()

If you want some different objective, let me know, and I can work that 
up too.  This only took a few minutes to put together.

I did have to make some small modifications to the SortinoRatio function 
in PerformanceAnalytics to make it 'portfolio-aware'.  I've attached a 
file you can 'source()' here, and this will be on R-Forge later today, 
and in the next version of PerformanceAnalytics.

There was also a small bug in the plot() method.  I will check in the 
fixed version, and it should be available as a binary download from 
R-Forge at the latest tomorrow.

PortfolioAnalytics, by default, assumes a full investment constraint 
(all weights sum to 1), though this may be turned off if your 
constraints differ.

Regards,

   - Brian


On 10/31/2010 08:19 PM, Gabe Plaxico wrote:
> Brian:
>
> Thanks for the reply. I did come across the PortfolioAnalytics
> (fantastic, by the way) package. I'll have to take a look at it again.
> Last time I used it I was under the impression only one return series
> could be used. I used the result as my max/min target along with a
> Differential Evolution algorithm to see if I could get optimal security
> weights to form an optimized (no shorting) MAR-downside risk portfolio.
> The hang-up is trying to come up with a method to optimize each security
> weight to minimize the downside risk. I couldn't get the algorithm to
> work restricting it to a total weight of 1. I would certainly welcome
> your offer to provide an example if you have come across this before.
> Thanks in advance.
>
> - Gabe
>
> On 10/30/10 7:21 AM, Brian G. Peterson wrote:
>> I can't really help you with fPortfolio in this context, but the
>> PortfolioAnalytics package on R-Forge will do what you need.
>>
>> If you're interested, I could work up a self-contained example for you of
>> SortinoRatio maximization portfolios maybe Monday.
>>
>> Regards,
>>
>> - Brian
>>
>> On Fri, 29 Oct 2010 19:29:38 -0400, Gabe Plaxico<gplaxico at gmail.com>
>> wrote:
>>> Hello Everyone:
>>>
>>> Does anyone have experience in constructing a mean-semivariance
>>> portfolio using the fPortfolio package? What I am really searching for
>>> is the ability to use my own arbitrary "mean", essentially constructing
>>> a downside risk portfolio (Sortino -
>>> http://sortino.com/htm/New%20Book.htm). Typically done using the lpm
>>> solver option. My attempts at constructing this portfolio with
>>> anything other than the true mean for each security ends in an error.
>>> If anyone has done something similar can you provide
>>> suggestions/examples? Thanks in advance.
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: SortinoRatio.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101101/17fd5fb0/attachment.pl>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: sortino.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101101/17fd5fb0/attachment-0001.pl>

From megh700004 at yahoo.com  Mon Nov  1 19:08:24 2010
From: megh700004 at yahoo.com (Megh)
Date: Mon, 1 Nov 2010 11:08:24 -0700 (PDT)
Subject: [R-SIG-Finance] Barrier options
In-Reply-To: <4CCEA52B.1070309@braverock.com>
References: <672696.78695.qm@web58101.mail.re3.yahoo.com>
	<4CCEA52B.1070309@braverock.com>
Message-ID: <1288634904294-3022552.post@n4.nabble.com>


Thanks Braverock for you suggestion. However I am struggling to download that
package even from r-forge irself. It is saying "package ?RQuantLib? is not
available". 

Even CRAN seems to having no package in that name atleast in zip format.

Can anyone tell me from where to download that package? I am using R-2.12.0
in Vista

Thanks
-- 
View this message in context: http://r.789695.n4.nabble.com/Barrier-options-tp3021886p3022552.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From rory.winston at gmail.com  Mon Nov  1 23:50:46 2010
From: rory.winston at gmail.com (Rory Winston)
Date: Tue, 2 Nov 2010 09:50:46 +1100
Subject: [R-SIG-Finance] Barrier options
Message-ID: <AANLkTimvk=PaY4VLVrmPsMzc8AdZ7TGxDj2RSxeX2bhS@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/b3096f8f/attachment.pl>

From cmdr_rogue at hotmail.com  Tue Nov  2 10:18:33 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Tue, 2 Nov 2010 05:18:33 -0400
Subject: [R-SIG-Finance] Barrier options
In-Reply-To: <1288634904294-3022552.post@n4.nabble.com>
References: <672696.78695.qm@web58101.mail.re3.yahoo.com>
	<4CCEA52B.1070309@braverock.com>
	<1288634904294-3022552.post@n4.nabble.com>
Message-ID: <BLU0-SMTP2070D176CC1A3CD48CE8820E2490@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/be30f7d3/attachment.pl>

From omerle at agritel.com  Tue Nov  2 14:53:36 2010
From: omerle at agritel.com (Olivier MERLE)
Date: 2 Nov 2010 13:53:36 -0000
Subject: [R-SIG-Finance] =?utf-8?q?Barrier_options?=
Message-ID: <1288706016.4cd017e0affcb@agritel.extranet-e.net>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/bd0836cc/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: LOGO AGRITEL JPEG petit.jpg
Type: image/jpeg
Size: 23320 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/bd0836cc/attachment.jpg>

From cedrick at cedrickjohnson.com  Tue Nov  2 15:02:38 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Tue, 02 Nov 2010 10:02:38 -0400
Subject: [R-SIG-Finance] Barrier options
In-Reply-To: <1288634904294-3022552.post@n4.nabble.com>
References: <672696.78695.qm@web58101.mail.re3.yahoo.com>	<4CCEA52B.1070309@braverock.com>
	<1288634904294-3022552.post@n4.nabble.com>
Message-ID: <4CD019FE.9080309@cedrickjohnson.com>

 From the RQuantLib CRAN page, for Windows (README link):

http://cran.r-project.org/bin/windows/contrib/r-release/ReadMe

I have it running on XP, but I went to QuantLib's site and built the 
packages on Windows manually. As Sarbo and Olivier pointed out, 
fOptions/fExoticOptions may be your best bet if you can't build the QL 
packages on Windows. I'll try to dig thru my notes to reconstruct how I 
got the RQuantLib package working (R 2.11.1, XP).

Regards,
C


From omerle at agritel.com  Tue Nov  2 17:06:08 2010
From: omerle at agritel.com (Olivier MERLE)
Date: 2 Nov 2010 16:06:08 -0000
Subject: [R-SIG-Finance] =?utf-8?q?IBrokers_=3A_asssign=2EData_and_others_?=
	=?utf-8?q?questions=2E=2E_No_ideas_=3F?=
Message-ID: <1288713968.4cd036f05eee1@agritel.extranet-e.net>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/47ed059c/attachment.html>

From breman.mark at gmail.com  Tue Nov  2 17:26:35 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 2 Nov 2010 17:26:35 +0100
Subject: [R-SIG-Finance] Quantmod segmentation fault
Message-ID: <AANLkTindDXuzYcgQvQSF1WNqH1cZpGaSVnrh=9T+8Rea@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/2c07580e/attachment.pl>

From daniel.cegielka at gmail.com  Tue Nov  2 17:52:28 2010
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Tue, 2 Nov 2010 17:52:28 +0100
Subject: [R-SIG-Finance] Quantmod segmentation fault
In-Reply-To: <AANLkTindDXuzYcgQvQSF1WNqH1cZpGaSVnrh=9T+8Rea@mail.gmail.com>
References: <AANLkTindDXuzYcgQvQSF1WNqH1cZpGaSVnrh=9T+8Rea@mail.gmail.com>
Message-ID: <AANLkTikM60Hc-840YOAns5YUzhJ_9_95T2Cyesj4XHxk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/73c1c596/attachment.pl>

From brian at braverock.com  Tue Nov  2 17:54:10 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 02 Nov 2010 11:54:10 -0500
Subject: [R-SIG-Finance] IBrokers : asssign.Data and others questions..
 No ideas ?
In-Reply-To: <1288713968.4cd036f05eee1@agritel.extranet-e.net>
References: <1288713968.4cd036f05eee1@agritel.extranet-e.net>
Message-ID: <4CD04232.9070202@braverock.com>

On 11/02/2010 11:06 AM, Olivier MERLE wrote:
> 1st question :
>
> I am currently working on IBrokers and I don't understant how the data
> are assigned in the eWrapper environment.
>
> For instance, you have eventWrapper$get.Data("bidPrice"). I don't
> understant in which part of the code bidPrice is assigned to the
> environment.
>
> 2 nd question :
>
> I would like to save bid/ask quotes for multiple underlying in a SQL
> Database in real time. What is the best way to implement this thing ?
>
> I know that I have to modify eWrapper to save data in the environment as
> I like and then take these data and save it in my SQL Database (but where).
>
> 3 rd question :
>
> Why I cant see the function `e_open_order`in my R environment even its called inside IBrokers function ?
> This function can be found on http://ibrokers.googlecode.com/svn-history/r91/trunk/R/eventHandlers.R
>
> 4 th question :
>
> I feel that I lack some theoritical background in computer science. Do
> you any advice or book for upgrading my knowledge in this field ?

Olivier,

Please don't repost, it's impolite, especially after only a few days 
including a weekend.  If someone has the answers to your questions, they 
may take the time to answer you and help you out.

You also didn't include a reproducible example demonstrating your 
problem, per the posting guide.

It is not at all clear that you've reviewed the various documentation, 
examples, and presentations by Jeff and others that are posted online 
about using IBrokers, creating custom eWrappers, etc.

Please do your homework and include a reproducible example and more 
details if you post again.

Regards,

    - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From breman.mark at gmail.com  Tue Nov  2 19:04:54 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 2 Nov 2010 19:04:54 +0100
Subject: [R-SIG-Finance] Quantmod segmentation fault
In-Reply-To: <AANLkTikM60Hc-840YOAns5YUzhJ_9_95T2Cyesj4XHxk@mail.gmail.com>
References: <AANLkTindDXuzYcgQvQSF1WNqH1cZpGaSVnrh=9T+8Rea@mail.gmail.com>
	<AANLkTikM60Hc-840YOAns5YUzhJ_9_95T2Cyesj4XHxk@mail.gmail.com>
Message-ID: <AANLkTim9mAvzmS4JBOKRzG6+7Nc8iawD5+zL_U1_JG4h@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/7536e0b6/attachment.pl>

From worik.stanton at gmail.com  Tue Nov  2 20:10:19 2010
From: worik.stanton at gmail.com (Worik)
Date: Wed, 03 Nov 2010 08:10:19 +1300
Subject: [R-SIG-Finance] Barrier options
In-Reply-To: <4CCEA52B.1070309@braverock.com>
References: <672696.78695.qm@web58101.mail.re3.yahoo.com>
	<4CCEA52B.1070309@braverock.com>
Message-ID: <4CD0621B.7030900@gmail.com>

For variety and (err...) options:
>
> RSiteSearch("barrier option")
>
> from inside R would have told you that.
>
I do not use windows, but for me:
 > help.search("barrier option")

Works *much* better than RSiteSearch.  The latter opens  a browser 
window  which is a pain.  For me.  It is a matter of taste.

cheers
Worik

-- 
You do not have to be blind to not see what is going on right in front of you if it is behind your back
Pascall West
--


From jeff.a.ryan at gmail.com  Tue Nov  2 21:24:30 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 2 Nov 2010 15:24:30 -0500
Subject: [R-SIG-Finance] Quantmod segmentation fault
In-Reply-To: <AANLkTindDXuzYcgQvQSF1WNqH1cZpGaSVnrh=9T+8Rea@mail.gmail.com>
References: <AANLkTindDXuzYcgQvQSF1WNqH1cZpGaSVnrh=9T+8Rea@mail.gmail.com>
Message-ID: <AANLkTingtB-27r0givQ6FjjtwCpw5boUb9A6bjGpDgpv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101102/fddef61b/attachment.pl>

From mane.desk at googlemail.com  Tue Nov  2 21:26:51 2010
From: mane.desk at googlemail.com (Immanuel)
Date: Tue, 02 Nov 2010 21:26:51 +0100
Subject: [R-SIG-Finance] getting date of highest value (xts)
Message-ID: <4CD0740B.2010909@gmail.com>

Hello all,

I would like to know when the highest price value
in a given xts time series occurred but I couldn't figure out
how to do this, can anybody help?

thanks


--------------------
# load libraries
library(quantmod)
library(TTR)

getSymbols("^GDAXI")

OHLC.data <- GDAXI["2010-03-01/2010-09-10"]

# I want to know the date where the highest value occurred

max(Hi(GDAXI))
# returns only the highest value, but I would like to know the date...


From josh.m.ulrich at gmail.com  Tue Nov  2 21:30:38 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 2 Nov 2010 15:30:38 -0500
Subject: [R-SIG-Finance] getting date of highest value (xts)
In-Reply-To: <4CD0740B.2010909@gmail.com>
References: <4CD0740B.2010909@gmail.com>
Message-ID: <AANLkTik+M4F=2a3WhHmEu=vTcXJbvgugC1=vt_wJZYES@mail.gmail.com>

Hi Immanuel,

You can use which.max for that.

> Hi(GDAXI)[which.max(Hi(GDAXI))]
           GDAXI.High
2007-07-13    8151.57

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Tue, Nov 2, 2010 at 3:26 PM, Immanuel <mane.desk at googlemail.com> wrote:
> Hello all,
>
> I would like to know when the highest price value
> in a given xts time series occurred but I couldn't figure out
> how to do this, can anybody help?
>
> thanks
>
>
> --------------------
> # load libraries
> library(quantmod)
> library(TTR)
>
> getSymbols("^GDAXI")
>
> OHLC.data <- GDAXI["2010-03-01/2010-09-10"]
>
> # I want to know the date where the highest value occurred
>
> max(Hi(GDAXI))
> # returns only the highest value, but I would like to know the date...
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From mane.desk at googlemail.com  Tue Nov  2 21:57:28 2010
From: mane.desk at googlemail.com (Immanuel)
Date: Tue, 02 Nov 2010 21:57:28 +0100
Subject: [R-SIG-Finance] getting date of highest value (xts)
In-Reply-To: <AANLkTik+M4F=2a3WhHmEu=vTcXJbvgugC1=vt_wJZYES@mail.gmail.com>
References: <4CD0740B.2010909@gmail.com>
	<AANLkTik+M4F=2a3WhHmEu=vTcXJbvgugC1=vt_wJZYES@mail.gmail.com>
Message-ID: <4CD07B38.70905@gmail.com>

great, thanks
On 11/02/2010 09:30 PM, Joshua Ulrich wrote:
> Hi Immanuel,
>
> You can use which.max for that.
>
>   
>> Hi(GDAXI)[which.max(Hi(GDAXI))]
>>     
>            GDAXI.High
> 2007-07-13    8151.57
>
> Best,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
> On Tue, Nov 2, 2010 at 3:26 PM, Immanuel <mane.desk at googlemail.com> wrote:
>   
>> Hello all,
>>
>> I would like to know when the highest price value
>> in a given xts time series occurred but I couldn't figure out
>> how to do this, can anybody help?
>>
>> thanks
>>
>>
>> --------------------
>> # load libraries
>> library(quantmod)
>> library(TTR)
>>
>> getSymbols("^GDAXI")
>>
>> OHLC.data <- GDAXI["2010-03-01/2010-09-10"]
>>
>> # I want to know the date where the highest value occurred
>>
>> max(Hi(GDAXI))
>> # returns only the highest value, but I would like to know the date...
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>     
>


From megh700004 at yahoo.com  Wed Nov  3 13:53:24 2010
From: megh700004 at yahoo.com (Megh)
Date: Wed, 3 Nov 2010 05:53:24 -0700 (PDT)
Subject: [R-SIG-Finance] Barrier options
In-Reply-To: <4CD0621B.7030900@gmail.com>
References: <672696.78695.qm@web58101.mail.re3.yahoo.com>
	<4CCEA52B.1070309@braverock.com> <4CD0621B.7030900@gmail.com>
Message-ID: <1288788804991-3025292.post@n4.nabble.com>


Thanks everyone for showing interest on my problem. On installing QL I feel
some problems are there for vista+2.12.0 combination. I could install
perfectly in xp+2.10.1 machine without any problem. However I used rmetrics
package for valuation of barrier option.

But in fExoticOptions package there seems to be no option to find greeks of
barrier option. BarrierOption() function of RQuantLib() has option for
sensitivity as well, however all the examples I have tried give NaN value
for sensitivity:

> BarrierOption(barrType="downin", type="call", underlying=100,
+              strike=100, dividendYield=0.02, riskFreeRate=0.03,
+              maturity=0.5, volatility=0.4, barrier=90)
Concise summary of valuation for BarrierOption 
 value  delta  gamma   vega  theta    rho divRho 
3.7383    NaN    NaN    NaN    NaN    NaN    NaN 


Can anyone help me to calculate greeks as well for Barrier option?

Thanks,
-- 
View this message in context: http://r.789695.n4.nabble.com/Barrier-options-tp3021886p3025292.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From Samuel.Le at srlglobal.com  Wed Nov  3 14:02:08 2010
From: Samuel.Le at srlglobal.com (Samuel Le)
Date: Wed, 3 Nov 2010 13:02:08 +0000
Subject: [R-SIG-Finance] Barrier options
In-Reply-To: <1288788804991-3025292.post@n4.nabble.com>
References: <672696.78695.qm@web58101.mail.re3.yahoo.com>
	<4CCEA52B.1070309@braverock.com> <4CD0621B.7030900@gmail.com>
	<1288788804991-3025292.post@n4.nabble.com>
Message-ID: <ECBDD2620D45F74C9B4AA3DBA750C5800C76ACE4@Exchange>

My quick and dirty way to compute the Greeks: the finite difference method.
For example to compute the Delta:

epsilon<-0.001
x1<-BarrierOption(barrType="downin", type="call", underlying=100+epsilon,strike=100, dividendYield=0.02, riskFreeRate=0.03,maturity=0.5, volatility=0.4, barrier=90)
x2<-BarrierOption(barrType="downin", type="call", underlying=100-epsilon,strike=100, dividendYield=0.02, riskFreeRate=0.03,maturity=0.5, volatility=0.4, barrier=90)
delta<-(x1-x2)/(2*epsilon)

You might want to create a wrapper function that would call the RQuantLib function BarrierOption, get the price, compute the Greeks by finite difference, and wraps everything into a data.frame / S4 object of the same format as the RQuantLib function.

Samuel


-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch [mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Megh
Sent: 03 November 2010 12:53
To: r-sig-finance at stat.math.ethz.ch
Subject: Re: [R-SIG-Finance] Barrier options


Thanks everyone for showing interest on my problem. On installing QL I feel
some problems are there for vista+2.12.0 combination. I could install
perfectly in xp+2.10.1 machine without any problem. However I used rmetrics
package for valuation of barrier option.

But in fExoticOptions package there seems to be no option to find greeks of
barrier option. BarrierOption() function of RQuantLib() has option for
sensitivity as well, however all the examples I have tried give NaN value
for sensitivity:

> BarrierOption(barrType="downin", type="call", underlying=100,
+              strike=100, dividendYield=0.02, riskFreeRate=0.03,
+              maturity=0.5, volatility=0.4, barrier=90)
Concise summary of valuation for BarrierOption
 value  delta  gamma   vega  theta    rho divRho
3.7383    NaN    NaN    NaN    NaN    NaN    NaN


Can anyone help me to calculate greeks as well for Barrier option?

Thanks,
--
View this message in context: http://r.789695.n4.nabble.com/Barrier-options-tp3021886p3025292.html
Sent from the Rmetrics mailing list archive at Nabble.com.

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


__________ Information from ESET NOD32 Antivirus, version of virus signature database 5587 (20101103) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com



__________ Information from ESET NOD32 Antivirus, version of virus signature database 5587 (20101103) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com


From harunozkan at gmail.com  Thu Nov  4 06:25:40 2010
From: harunozkan at gmail.com (=?windows-1254?Q?Harun_=D6zkan?=)
Date: Thu, 4 Nov 2010 07:25:40 +0200
Subject: [R-SIG-Finance] Granger causality with panel data (econometrics
	related question)
Message-ID: <8C3752B2745D461CB202EFC4FAB179CC@Harun>

Hi folks,

I am trying to perform a Granger causality analysis with panel data. There 
are some packages around for panel data analysis alone and Granger causality 
per se.
However, I have found neither a package subsuming Granger causality with 
panel data nor any R procedures, that could include homogenous/heterogenous 
frameworks, related tests such as Wald, unit root tests etc.

Of course, someone must have encountered this problem before I did. Does 
anyone know a quick solution to this case?

Thanks in advance.


From rohit.taklikar at gmail.com  Thu Nov  4 09:10:16 2010
From: rohit.taklikar at gmail.com (Rohit Taklikar)
Date: Thu, 4 Nov 2010 13:40:16 +0530
Subject: [R-SIG-Finance] Implied Volatility, Column operation
Message-ID: <AANLkTinsJgCxWP6dkEMTfkzj2Ke22-gHyxi2YG0uBwa-@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101104/148086b8/attachment.pl>

From matthieu.stigler at gmail.com  Thu Nov  4 09:37:22 2010
From: matthieu.stigler at gmail.com (mat)
Date: Thu, 04 Nov 2010 09:37:22 +0100
Subject: [R-SIG-Finance] Granger causality with panel data (econometrics
 related question)
In-Reply-To: <8C3752B2745D461CB202EFC4FAB179CC@Harun>
References: <8C3752B2745D461CB202EFC4FAB179CC@Harun>
Message-ID: <4CD270C2.70905@gmail.com>

Hi Harun

For Granger causality test, you might have a look on the section 3.4. 
Inference in the panel model
  from the plm vignette to see how to use coefficient tests on panel data.

Concerning unit roots, is the purtest() function from plm not the one 
you look for?

Hope this helps

Matthieu
Le 04. 11. 10 06:25, Harun ?zkan a ?crit :
> Hi folks,
>
> I am trying to perform a Granger causality analysis with panel data. 
> There are some packages around for panel data analysis alone and 
> Granger causality per se.
> However, I have found neither a package subsuming Granger causality 
> with panel data nor any R procedures, that could include 
> homogenous/heterogenous frameworks, related tests such as Wald, unit 
> root tests etc.
>
> Of course, someone must have encountered this problem before I did. 
> Does anyone know a quick solution to this case?
>
> Thanks in advance.
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.


From David.Reiner at xrtrading.com  Thu Nov  4 14:28:28 2010
From: David.Reiner at xrtrading.com (David Reiner)
Date: Thu, 4 Nov 2010 08:28:28 -0500
Subject: [R-SIG-Finance] [SPAM] -  Implied Volatility,
 Column operation - Email found in subject
In-Reply-To: <AANLkTinsJgCxWP6dkEMTfkzj2Ke22-gHyxi2YG0uBwa-@mail.gmail.com>
References: <AANLkTinsJgCxWP6dkEMTfkzj2Ke22-gHyxi2YG0uBwa-@mail.gmail.com>
Message-ID: <9DE405308A6AA24AA794B76282C6C00F0B3020EB@HQ-POST1>

Right, the function is not vectorized. See ?Vectorize
HTH,
David L. Reiner
XR Trading LLC

-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch [mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Rohit Taklikar
Sent: Thursday, November 04, 2010 3:10 AM
To: r-sig-finance at stat.math.ethz.ch
Subject: [SPAM] - [R-SIG-Finance] Implied Volatility, Column operation - Email found in subject

Hi,

I have raw options data in an array and i am trying to calculate implied
volatility in a new column for all rows at once -

> sres$CALL_IV =
GBSVolatility(sres$CALL_PRICE,"c",sres$UNDERLYING_PRICE,sres$STRIKE,sres$TIME2EXP,0,0)

where, CALL_IV, CALL_PRICE, UNDERLYING_PRICE etc. are columns of "sres"

I am getting an errors and warnings for this:
======
Error in uniroot(.fGBSVolatility, interval = c(-10, 10), price = price,  :
  invalid function value in 'zeroin'
In addition: Warning messages:
1: In if (is.na(f.lower)) stop("f.lower = f(lower) is NA") :
  the condition has length > 1 and only the first element will be used
2: In if (is.na(f.upper)) stop("f.upper = f(upper) is NA") :
  the condition has length > 1 and only the first element will be used
3: In if (f.lower * f.upper > 0) stop("f() values at end points not of
opposite sign") :
  the condition has length > 1 and only the first element will be used
======

However this works when i run a for loop it works. Does it mean column
operation is not supported by fOptions functions?

Any idea how to do this efficiently?

Regards,

        [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


This e-mail and any materials attached hereto, including, without limitation, all content hereof and thereof (collectively, "XR Content") are confidential and proprietary to XR Trading, LLC ("XR") and/or its affiliates, and are protected by intellectual property laws.  Without the prior written consent of XR, the XR Content may not (i) be disclosed to any third party or (ii) be reproduced or otherwise used by anyone other than current employees of XR or its affiliates, on behalf of XR or its affiliates.

THE XR CONTENT IS PROVIDED AS IS, WITHOUT REPRESENTATIONS OR WARRANTIES OF ANY KIND.  TO THE MAXIMUM EXTENT PERMISSIBLE UNDER APPLICABLE LAW, XR HEREBY DISCLAIMS ANY AND ALL WARRANTIES, EXPRESS AND IMPLIED, RELATING TO THE XR CONTENT, AND NEITHER XR NOR ANY OF ITS AFFILIATES SHALL IN ANY EVENT BE LIABLE FOR ANY DAMAGES OF ANY NATURE WHATSOEVER, INCLUDING, BUT NOT LIMITED TO, DIRECT, INDIRECT, CONSEQUENTIAL, SPECIAL AND PUNITIVE DAMAGES, LOSS OF PROFITS AND TRADING LOSSES, RESULTING FROM ANY PERSON'S USE OR RELIANCE UPON, OR INABILITY TO USE, ANY XR CONTENT, EVEN IF XR IS ADVISED OF THE POSSIBILITY OF SUCH DAMAGES OR IF SUCH DAMAGES WERE FORESEEABLE.


From rohit.taklikar at gmail.com  Thu Nov  4 15:34:13 2010
From: rohit.taklikar at gmail.com (Rohit Taklikar)
Date: Thu, 4 Nov 2010 20:04:13 +0530
Subject: [R-SIG-Finance] [SPAM] -  Implied Volatility,
 Column operation - Email found in subject
In-Reply-To: <9DE405308A6AA24AA794B76282C6C00F0B3020EB@HQ-POST1>
References: <AANLkTinsJgCxWP6dkEMTfkzj2Ke22-gHyxi2YG0uBwa-@mail.gmail.com>
	<9DE405308A6AA24AA794B76282C6C00F0B3020EB@HQ-POST1>
Message-ID: <AANLkTi=E32rUKABDY1uic+FHBX=z5R5Q1V=Mio1FNMWk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101104/e9fcafaf/attachment.pl>

From breman.mark at gmail.com  Thu Nov  4 21:44:47 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 4 Nov 2010 21:44:47 +0100
Subject: [R-SIG-Finance] Questions on fitted garch(1,1)
Message-ID: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101104/9fe4c6f1/attachment.pl>

From arun.kumar.saha at gmail.com  Thu Nov  4 22:00:13 2010
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Thu, 4 Nov 2010 14:00:13 -0700 (PDT)
Subject: [R-SIG-Finance] Questions on fitted garch(1,1)
In-Reply-To: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>
References: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>
Message-ID: <1288904413682-3027779.post@n4.nabble.com>


One possible case may be the different way of initializing the volatility
estimates. You can look into the codes of 2 different packages on how they
are estimating the volatility for the 1st day. 

You can also compare the estimated parameters which set is giving max value
of the likelihood function, because may be they are using different
optimizer?

Thanks,
-- 
View this message in context: http://r.789695.n4.nabble.com/Questions-on-fitted-garch-1-1-tp3027748p3027779.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From alexios at 4dscape.com  Thu Nov  4 22:02:26 2010
From: alexios at 4dscape.com (alexios)
Date: Thu, 04 Nov 2010 21:02:26 +0000
Subject: [R-SIG-Finance] Questions on fitted garch(1,1)
In-Reply-To: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>
References: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>
Message-ID: <4CD31F62.7010406@4dscape.com>

The default for fGarch::garchFit is to estimate the mean, assuming a
non-zero mean dataset is passed, as can be seen from the returned "mu"
parameter ( a call to 'args(garchFit)' should highlight the
'include.mean' argument ). The default for tseries garch is to assume
zero mean data.

Demean the data before passing to tseries garch by the estimated 'mu'
value from 'fgarch.fitted' and you should obtain closer results.

-Alexios



On 11/4/2010 8:44 PM, Mark Breman wrote:
> Hi everyone,
> 
> I'm trying to predict volatility using a garch(1,1) model and I'm running
> into some interesting issues I cannot find an answer for.
> 
> Suppose I have the following code:
> 
> library(quantmod)
> library(tseries)
> library(fGarch)
> 
> # get some returns
> r = dailyReturn(Ad(getSymbols("SPY", from="2000-01-01", to="2010-11-04",
> auto.assign=F)))
> 
> # fit models
> garch.fitted = garch(na.omit(r), order = c(1,1))
> fgarch.fitted = fGarch::garchFit(~ garch(1,1), data = as.zoo(na.omit(r)),
> trace = FALSE)
> 
> Now if I look at the values of the coefficients for both fitted models they
> are not the same:
> 
>> coef(garch.fitted)
>           a0           a1           b1
> 1.339912e-06 8.165689e-02 9.101754e-01
>> coef(fgarch.fitted)
>           mu        omega       alpha1        beta1
> 4.990616e-04 1.370880e-06 8.307080e-02 9.086447e-01
> 
> Q1) Why are they different? What do I have to change to make the coefficient
> values of fgarch.fitted the same as garch.fitted?
> 
> If I try to predict the volatility with: predict(garch.fitted) I get the
> "conditional standard deviation predictions" (an interval) for every period
> return in r.
> 
> Q2) Is this a 1 period prediction (i.e. the volatility prediction for the
> next day)? How do I get a prediction for let's say 2 periods in the future?
> 
> 
> If I use predict(fgarch.fitted) I get:
> 
>> predict(fgarch.fitted)
>    meanForecast   meanError standardDeviation
> 1  0.0004990616 0.006677350       0.006677350
> 2  0.0004990616 0.006751925       0.006751925
> 3  0.0004990616 0.006825079       0.006825079
> 4  0.0004990616 0.006896859       0.006896859
> 5  0.0004990616 0.006967315       0.006967315
> 6  0.0004990616 0.007036491       0.007036491
> 7  0.0004990616 0.007104428       0.007104428
> 8  0.0004990616 0.007171167       0.007171167
> 9  0.0004990616 0.007236745       0.007236745
> 10 0.0004990616 0.007301198       0.007301198
> 
> Q3) Why is the meanForecast for all 10 future periods the same?
> 
> Thanks,
> 
> -Mark-
> 
> 
> 
> predict(garch)
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> 
>


From patrick at burns-stat.com  Thu Nov  4 22:12:27 2010
From: patrick at burns-stat.com (Patrick Burns)
Date: Thu, 04 Nov 2010 21:12:27 +0000
Subject: [R-SIG-Finance] Questions on fitted garch(1,1)
In-Reply-To: <4CD31F62.7010406@4dscape.com>
References: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>
	<4CD31F62.7010406@4dscape.com>
Message-ID: <4CD321BB.6050604@burns-stat.com>

Taking Alexios' advice will probably
help, but I wouldn't be surprised if
they are still not the same.  The
garch likelihood is extremely tricky
to optimize -- specialized optimizers
would be the ideal.

Assuming you can give starting values
to the optimizer in both cases, you can
give the other's answer to each and see
what happens.

On 04/11/2010 21:02, alexios wrote:
> The default for fGarch::garchFit is to estimate the mean, assuming a
> non-zero mean dataset is passed, as can be seen from the returned "mu"
> parameter ( a call to 'args(garchFit)' should highlight the
> 'include.mean' argument ). The default for tseries garch is to assume
> zero mean data.
>
> Demean the data before passing to tseries garch by the estimated 'mu'
> value from 'fgarch.fitted' and you should obtain closer results.
>
> -Alexios
>
>
>
> On 11/4/2010 8:44 PM, Mark Breman wrote:
>> Hi everyone,
>>
>> I'm trying to predict volatility using a garch(1,1) model and I'm running
>> into some interesting issues I cannot find an answer for.
>>
>> Suppose I have the following code:
>>
>> library(quantmod)
>> library(tseries)
>> library(fGarch)
>>
>> # get some returns
>> r = dailyReturn(Ad(getSymbols("SPY", from="2000-01-01", to="2010-11-04",
>> auto.assign=F)))
>>
>> # fit models
>> garch.fitted = garch(na.omit(r), order = c(1,1))
>> fgarch.fitted = fGarch::garchFit(~ garch(1,1), data = as.zoo(na.omit(r)),
>> trace = FALSE)
>>
>> Now if I look at the values of the coefficients for both fitted models they
>> are not the same:
>>
>>> coef(garch.fitted)
>>            a0           a1           b1
>> 1.339912e-06 8.165689e-02 9.101754e-01
>>> coef(fgarch.fitted)
>>            mu        omega       alpha1        beta1
>> 4.990616e-04 1.370880e-06 8.307080e-02 9.086447e-01
>>
>> Q1) Why are they different? What do I have to change to make the coefficient
>> values of fgarch.fitted the same as garch.fitted?
>>
>> If I try to predict the volatility with: predict(garch.fitted) I get the
>> "conditional standard deviation predictions" (an interval) for every period
>> return in r.
>>
>> Q2) Is this a 1 period prediction (i.e. the volatility prediction for the
>> next day)? How do I get a prediction for let's say 2 periods in the future?
>>
>>
>> If I use predict(fgarch.fitted) I get:
>>
>>> predict(fgarch.fitted)
>>     meanForecast   meanError standardDeviation
>> 1  0.0004990616 0.006677350       0.006677350
>> 2  0.0004990616 0.006751925       0.006751925
>> 3  0.0004990616 0.006825079       0.006825079
>> 4  0.0004990616 0.006896859       0.006896859
>> 5  0.0004990616 0.006967315       0.006967315
>> 6  0.0004990616 0.007036491       0.007036491
>> 7  0.0004990616 0.007104428       0.007104428
>> 8  0.0004990616 0.007171167       0.007171167
>> 9  0.0004990616 0.007236745       0.007236745
>> 10 0.0004990616 0.007301198       0.007301198
>>
>> Q3) Why is the meanForecast for all 10 future periods the same?
>>
>> Thanks,
>>
>> -Mark-
>>
>>
>>
>> predict(garch)
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog


From nneslihan at gmail.com  Fri Nov  5 16:35:43 2010
From: nneslihan at gmail.com (neshac)
Date: Fri, 5 Nov 2010 08:35:43 -0700 (PDT)
Subject: [R-SIG-Finance] garchFit- initial volatility
Message-ID: <1288971343099-3028796.post@n4.nabble.com>


Hi all,

I am newbie in R, and trying to estimate the volatility using GARCH model. I
have daily return time series of some stocks in DAX30.

My question is, how the initial variance is calculated when I have a return
time series with 20 elements as the input and lets say they are daily
returns in January. Is it the variance of the time series? In this case, I
will only have the variance for the last day of the month and the returns
for the whole month. Since the time points of returns and volatility will
not fit,  how will be the model estimated then? 


I'd like to use  the 20-day variance for the 1st of January as the initial
variance, how should I code it so that it takes whatever I want as the
initial variance? I checked the source code for initializing parameters but
I could not see how it is done.

Could anyone show me a way to do this please?

Thank you in advance for your attention,

Regards,

Neslihan H. 

 
-- 
View this message in context: http://r.789695.n4.nabble.com/garchFit-initial-volatility-tp3028796p3028796.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From arun.kumar.saha at gmail.com  Fri Nov  5 16:58:38 2010
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Fri, 5 Nov 2010 08:58:38 -0700 (PDT)
Subject: [R-SIG-Finance] garchFit- initial volatility
In-Reply-To: <1288971343099-3028796.post@n4.nabble.com>
References: <1288971343099-3028796.post@n4.nabble.com>
Message-ID: <1288972718447-3028850.post@n4.nabble.com>


Why dont you look into the code of the corresponding function and see by
yourself instead expecting someone else would job for you.

Thanks,
-- 
View this message in context: http://r.789695.n4.nabble.com/garchFit-initial-volatility-tp3028796p3028850.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From nneslihan at gmail.com  Sat Nov  6 13:07:02 2010
From: nneslihan at gmail.com (neshac)
Date: Sat, 6 Nov 2010 05:07:02 -0700 (PDT)
Subject: [R-SIG-Finance] garchFit- initial volatility
In-Reply-To: <1288972718447-3028850.post@n4.nabble.com>
References: <1288971343099-3028796.post@n4.nabble.com>
	<1288972718447-3028850.post@n4.nabble.com>
Message-ID: <1289045222919-3029902.post@n4.nabble.com>


Hi, 

thank you for your answer. 

If you read my message again carefully you will see exactly this sentence :
"I checked the source code for initializing parameters but I could not see
how it is done." 


Regards,


Neslihan


-- 
View this message in context: http://r.789695.n4.nabble.com/garchFit-initial-volatility-tp3028796p3029902.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From noah at smartmediacorp.com  Sun Nov  7 02:35:13 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Sat, 06 Nov 2010 18:35:13 -0700
Subject: [R-SIG-Finance] How to calculate Trading Days
Message-ID: <4CD60251.2010507@smartmediacorp.com>

Hi,

I'm working on some option value pricing models. Starting with the 
GBSvolatility for example.  All of the various formulas require a Time 
parameter (fraction of year) until expiration. Ideally, I want to 
compute it as:
"trading days until expiration" / 252

Give two days, I can use the difftimeDate to get the number of days 
between them, However I can't seem to find a way to get Trading Days 
(which excludes weekends and holidays.)  I've looked through rseek.org 
and many library's documentation, but can't find a way to do this.

One thought would be to generate a vector of dates between the start and 
end days.  Then test EACH date to see if it was a holiday or weekend.  
This could work, but seems very inefficient.

Does anyone know of a way to calculate Trading Days between two dates???
(Surely I can't be the only person here who needs this in R.)

Thanks!!!

--
Noah


From cmdr_rogue at hotmail.com  Sun Nov  7 16:54:18 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Sun, 7 Nov 2010 10:54:18 -0500
Subject: [R-SIG-Finance] [SPAM] -  Implied Volatility,
 Column operation - Email found in subject
In-Reply-To: <AANLkTi=E32rUKABDY1uic+FHBX=z5R5Q1V=Mio1FNMWk@mail.gmail.com>
References: <AANLkTinsJgCxWP6dkEMTfkzj2Ke22-gHyxi2YG0uBwa-@mail.gmail.com>
	<9DE405308A6AA24AA794B76282C6C00F0B3020EB@HQ-POST1>
	<AANLkTi=E32rUKABDY1uic+FHBX=z5R5Q1V=Mio1FNMWk@mail.gmail.com>
Message-ID: <BLU0-SMTP1855F3F50BE1A89ECE14A10E24E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101107/1c42ec81/attachment.pl>

From brian at braverock.com  Sun Nov  7 17:50:29 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 07 Nov 2010 10:50:29 -0600
Subject: [R-SIG-Finance] How to calculate Trading Days
In-Reply-To: <4CD60251.2010507@smartmediacorp.com>
References: <4CD60251.2010507@smartmediacorp.com>
Message-ID: <db504cdae087b286ac480b37863788a6@braverock.com>

On Sat, 06 Nov 2010 18:35:13 -0700, Noah Silverman
<noah at smartmediacorp.com> wrote:
> Hi,
> 
> I'm working on some option value pricing models. Starting with the 
> GBSvolatility for example.  All of the various formulas require a Time 
> parameter (fraction of year) until expiration. Ideally, I want to 
> compute it as:
> "trading days until expiration" / 252
> 
> Give two days, I can use the difftimeDate to get the number of days 
> between them, However I can't seem to find a way to get Trading Days 
> (which excludes weekends and holidays.)  I've looked through rseek.org 
> and many library's documentation, but can't find a way to do this.
> 
> One thought would be to generate a vector of dates between the start and

> end days.  Then test EACH date to see if it was a holiday or weekend.  
> This could work, but seems very inefficient.
> 
> Does anyone know of a way to calculate Trading Days between two dates???
> (Surely I can't be the only person here who needs this in R.)

Each exchange has a different calendar.  Most people keep a calendar in a
database for each exchange they trade on.  This can then be matched to the
exchange meta-data for each instrument you trade.

Since you seem to be using timeDate, you could take a close look at
fCalendar and see if the holiday functions included there will solve your
problem.

A more efficient method of extracting holidays would be to generate
vectors of weekends and holidays and the remove the weekends and holidays
vectors from your vector of all days.

Regards,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From noah at smartmediacorp.com  Sun Nov  7 19:02:29 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Sun, 07 Nov 2010 10:02:29 -0800
Subject: [R-SIG-Finance] How to calculate Trading Days
In-Reply-To: <db504cdae087b286ac480b37863788a6@braverock.com>
References: <4CD60251.2010507@smartmediacorp.com>
	<db504cdae087b286ac480b37863788a6@braverock.com>
Message-ID: <4CD6E9B5.5020203@smartmediacorp.com>

That makes perfect sense. 

However, using the difftimeDate function from fCalendar just gives me a
count.  Is there another function that will return a vector of days
between two dates? 

Thanks!

-N


On 11/7/10 8:50 AM, Brian G. Peterson wrote:
> On Sat, 06 Nov 2010 18:35:13 -0700, Noah Silverman
> <noah at smartmediacorp.com> wrote:
>> Hi,
>>
>> I'm working on some option value pricing models. Starting with the 
>> GBSvolatility for example.  All of the various formulas require a Time 
>> parameter (fraction of year) until expiration. Ideally, I want to 
>> compute it as:
>> "trading days until expiration" / 252
>>
>> Give two days, I can use the difftimeDate to get the number of days 
>> between them, However I can't seem to find a way to get Trading Days 
>> (which excludes weekends and holidays.)  I've looked through rseek.org 
>> and many library's documentation, but can't find a way to do this.
>>
>> One thought would be to generate a vector of dates between the start and
>> end days.  Then test EACH date to see if it was a holiday or weekend.  
>> This could work, but seems very inefficient.
>>
>> Does anyone know of a way to calculate Trading Days between two dates???
>> (Surely I can't be the only person here who needs this in R.)
> Each exchange has a different calendar.  Most people keep a calendar in a
> database for each exchange they trade on.  This can then be matched to the
> exchange meta-data for each instrument you trade.
>
> Since you seem to be using timeDate, you could take a close look at
> fCalendar and see if the holiday functions included there will solve your
> problem.
>
> A more efficient method of extracting holidays would be to generate
> vectors of weekends and holidays and the remove the weekends and holidays
> vectors from your vector of all days.
>
> Regards,
>
>   - Brian
>


From dupuy.dangeac at free.fr  Sun Nov  7 19:13:16 2010
From: dupuy.dangeac at free.fr (R Dupuy d'Angeac)
Date: Sun, 7 Nov 2010 19:13:16 +0100
Subject: [R-SIG-Finance] blotter package
Message-ID: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101107/03739fda/attachment.pl>

From public_browe at muxspace.com  Sun Nov  7 19:20:57 2010
From: public_browe at muxspace.com (Brian Rowe)
Date: Sun, 7 Nov 2010 13:20:57 -0500
Subject: [R-SIG-Finance] How to calculate trading days
Message-ID: <AANLkTikijJgFOt6bzU-FEO=CdiHoAnaSRPMDgLsa7z2D@mail.gmail.com>

Noah,

My package fractalrock has a function to calculate trading days:
?getTradingDates.

Here are some examples:

> getTradingDates('2010-11-07', obs=20)
 [1] "2010-10-11" "2010-10-12" "2010-10-13" "2010-10-14" "2010-10-15"
 [6] "2010-10-18" "2010-10-19" "2010-10-20" "2010-10-21" "2010-10-22"
[11] "2010-10-25" "2010-10-26" "2010-10-27" "2010-10-28" "2010-10-29"
[16] "2010-11-01" "2010-11-02" "2010-11-03" "2010-11-04" "2010-11-05"

> getTradingDates('2010-11-07', start='2010-10-07')
 [1] "2010-10-07" "2010-10-08" "2010-10-11" "2010-10-12" "2010-10-13"
 [6] "2010-10-14" "2010-10-15" "2010-10-18" "2010-10-19" "2010-10-20"
[11] "2010-10-21" "2010-10-22" "2010-10-25" "2010-10-26" "2010-10-27"
[16] "2010-10-28" "2010-10-29" "2010-11-01" "2010-11-02" "2010-11-03"
[21] "2010-11-04" "2010-11-05"

You can set the calendar to whatever you want. The default is the NYSE.

HTH,
Brian

> Date: Sat, 06 Nov 2010 18:35:13 -0700
> From: Noah Silverman <noah at smartmediacorp.com>
> To: r-sig-finance at stat.math.ethz.ch
> Subject: [R-SIG-Finance] How to calculate Trading Days
> Message-ID: <4CD60251.2010507 at smartmediacorp.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> Hi,
>
> I'm working on some option value pricing models. Starting with the
> GBSvolatility for example. ?All of the various formulas require a Time
> parameter (fraction of year) until expiration. Ideally, I want to
> compute it as:
> "trading days until expiration" / 252
>
> Give two days, I can use the difftimeDate to get the number of days
> between them, However I can't seem to find a way to get Trading Days
> (which excludes weekends and holidays.) ?I've looked through rseek.org
> and many library's documentation, but can't find a way to do this.
>
> One thought would be to generate a vector of dates between the start and
> end days. ?Then test EACH date to see if it was a holiday or weekend.
> This could work, but seems very inefficient.
>
> Does anyone know of a way to calculate Trading Days between two dates???
> (Surely I can't be the only person here who needs this in R.)
>
> Thanks!!!
>
> --
> Noah


From brian at braverock.com  Sun Nov  7 19:22:34 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 07 Nov 2010 12:22:34 -0600
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
Message-ID: <dc88ab901b1e095bbcb6213286c1c340@braverock.com>

On Sun, 7 Nov 2010 19:13:16 +0100, "R Dupuy d'Angeac"
<dupuy.dangeac at free.fr> wrote:
> ???Dear friends
>   I try to make some simulations using last version of blotter(0.7.2)
;at
>   the end of the test I have this message:
>   ???error:  object ???getEndEq??? nowhere to be found ???
> packages loaded: blotter,quanmod,xts,quantstrat,financialinstruments,
.....
> R VERSION 2.12.0 with Windows 7
> 
> What is wrong??

Please provide sessionInfo() so that i can help debug.

Also, try calling:

blotter::getEndEq()

and

blotter:::getEndEq()

it is an exported function, so it should be available.  I'm not having any
issues calling it here.

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Sun Nov  7 19:40:46 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 07 Nov 2010 12:40:46 -0600
Subject: [R-SIG-Finance] How to calculate Trading Days
In-Reply-To: <4CD6E9B5.5020203@smartmediacorp.com>
References: <4CD60251.2010507@smartmediacorp.com>
	<db504cdae087b286ac480b37863788a6@braverock.com>
	<4CD6E9B5.5020203@smartmediacorp.com>
Message-ID: <25160593eb1ea0145a6da2544ad8b98a@braverock.com>

On Sun, 07 Nov 2010 10:02:29 -0800, Noah Silverman
<noah at smartmediacorp.com> wrote:
> That makes perfect sense. 
> 
> However, using the difftimeDate function from fCalendar just gives me a
> count.  Is there another function that will return a vector of days
> between two dates? 

seq.Date()

and then use the fCalendar functions to sort out your holidays by
financial center.

  - Brian
 
> On 11/7/10 8:50 AM, Brian G. Peterson wrote:
>> On Sat, 06 Nov 2010 18:35:13 -0700, Noah Silverman
>> <noah at smartmediacorp.com> wrote:
>>> Hi,
>>>
>>> I'm working on some option value pricing models. Starting with the 
>>> GBSvolatility for example.  All of the various formulas require a Time

>>> parameter (fraction of year) until expiration. Ideally, I want to 
>>> compute it as:
>>> "trading days until expiration" / 252
>>>
>>> Give two days, I can use the difftimeDate to get the number of days 
>>> between them, However I can't seem to find a way to get Trading Days 
>>> (which excludes weekends and holidays.)  I've looked through rseek.org

>>> and many library's documentation, but can't find a way to do this.
>>>
>>> One thought would be to generate a vector of dates between the start
and
>>> end days.  Then test EACH date to see if it was a holiday or weekend. 

>>> This could work, but seems very inefficient.
>>>
>>> Does anyone know of a way to calculate Trading Days between two
dates???
>>> (Surely I can't be the only person here who needs this in R.)
>> Each exchange has a different calendar.  Most people keep a calendar in
a
>> database for each exchange they trade on.  This can then be matched to
>> the
>> exchange meta-data for each instrument you trade.
>>
>> Since you seem to be using timeDate, you could take a close look at
>> fCalendar and see if the holiday functions included there will solve
your
>> problem.
>>
>> A more efficient method of extracting holidays would be to generate
>> vectors of weekends and holidays and the remove the weekends and
holidays
>> vectors from your vector of all days.
>>
>> Regards,
>>
>>   - Brian
>>
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From dupuy.dangeac at free.fr  Sun Nov  7 20:37:42 2010
From: dupuy.dangeac at free.fr (burcy)
Date: Sun, 7 Nov 2010 11:37:42 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
Message-ID: <1289158662040-3031102.post@n4.nabble.com>



please find hereunder sessionInfo()
R version 2.12.0 (2010-10-15)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252   
[3] LC_MONETARY=French_France.1252 LC_NUMERIC=C                  
[5] LC_TIME=French_France.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] urca_1.2-4                   tseries_0.10-22             
 [3] quadprog_1.5-3               quantmod_0.3-14             
 [5] TTR_0.20-2                   Defaults_1.1-1              
 [7] PerformanceAnalytics_1.0.3.2 fImport_2110.79             
 [9] timeSeries_2120.89           timeDate_2120.90            
[11] FinancialInstrument_0.0.2    xts_0.7-5                   
[13] zoo_1.6-4                   

loaded via a namespace (and not attached):
[1] grid_2.12.0     lattice_0.19-13 nlme_3.1-97    

>  getEndEq()
Erreur : impossible de trouver la fonction "getEndEq"
> blotter::getEndEq()
Erreur dans blotter::getEndEq() : 
  l'argument "Account" est manquant, avec aucune valeur par d?faut
> blotter:::getEndEq()
Erreur dans blotter:::getEndEq() : 
  l'argument "Account" est manquant, avec aucune valeur par d?faut
sorry it is french but does that means the problem comes fom the package or
my test?

regards 
burcy
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3031102.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From brian at braverock.com  Mon Nov  8 00:19:28 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 07 Nov 2010 17:19:28 -0600
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1289158662040-3031102.post@n4.nabble.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289158662040-3031102.post@n4.nabble.com>
Message-ID: <6d17853833fdc06daa15664265aa181f@braverock.com>

Note that package 'blotter' is not loaded.

require(blotter) at the beginning of your test, and the error should go
away.

It looks as though you've only loaded FinancialInstrument, and not
blotter.

It seems likely that you will also need to upgrade xts.  The current xts
requirement in blotter is set to:

xts (>= 0.7-6.1)

because of bugs and performance improvements that have been resolved in
recent R-Forge xts versions which impacted blotter.

Regards,
 
   - Brian

On Sun, 7 Nov 2010 11:37:42 -0800 (PST), burcy <dupuy.dangeac at free.fr>
wrote:
> please find hereunder sessionInfo()
> R version 2.12.0 (2010-10-15)
> Platform: i386-pc-mingw32/i386 (32-bit)
> 
> locale:
> [1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252   
> [3] LC_MONETARY=French_France.1252 LC_NUMERIC=C                  
> [5] LC_TIME=French_France.1252    
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base    

> 
> other attached packages:
>  [1] urca_1.2-4                   tseries_0.10-22             
>  [3] quadprog_1.5-3               quantmod_0.3-14             
>  [5] TTR_0.20-2                   Defaults_1.1-1              
>  [7] PerformanceAnalytics_1.0.3.2 fImport_2110.79             
>  [9] timeSeries_2120.89           timeDate_2120.90            
> [11] FinancialInstrument_0.0.2    xts_0.7-5                   
> [13] zoo_1.6-4                   
> 
> loaded via a namespace (and not attached):
> [1] grid_2.12.0     lattice_0.19-13 nlme_3.1-97    
> 
>>  getEndEq()
> Erreur : impossible de trouver la fonction "getEndEq"
>> blotter::getEndEq()
> Erreur dans blotter::getEndEq() : 
>   l'argument "Account" est manquant, avec aucune valeur par d?faut
>> blotter:::getEndEq()
> Erreur dans blotter:::getEndEq() : 
>   l'argument "Account" est manquant, avec aucune valeur par d?faut
> sorry it is french but does that means the problem comes fom the package
or
> my test?
> 
> regards 
> burcy
> -- 
> View this message in context:
> http://r.789695.n4.nabble.com/blotter-package-tp3031027p3031102.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From dupuy.dangeac at free.fr  Mon Nov  8 10:31:28 2010
From: dupuy.dangeac at free.fr (burcy)
Date: Mon, 8 Nov 2010 01:31:28 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
Message-ID: <1289208688226-3031671.post@n4.nabble.com>


Thanks Brian for your help 

It is right ,I cannot load Blotter ,because I cannot load xts (0.7-6.4);it
seems there is no file available for windows on R forge right now .
regards
burcy
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3031671.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From jeff.a.ryan at gmail.com  Mon Nov  8 16:09:00 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 8 Nov 2010 09:09:00 -0600
Subject: [R-SIG-Finance] How to calculate Trading Days
In-Reply-To: <25160593eb1ea0145a6da2544ad8b98a@braverock.com>
References: <4CD60251.2010507@smartmediacorp.com>
	<db504cdae087b286ac480b37863788a6@braverock.com>
	<4CD6E9B5.5020203@smartmediacorp.com>
	<25160593eb1ea0145a6da2544ad8b98a@braverock.com>
Message-ID: <AANLkTinb4iWNYEMPoRQYtMGEGurWPFevXqwP4SoY=Py=@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101108/6bee1869/attachment.pl>

From breman.mark at gmail.com  Tue Nov  9 12:51:17 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 9 Nov 2010 12:51:17 +0100
Subject: [R-SIG-Finance] Questions on fitted garch(1,1)
In-Reply-To: <4CD321BB.6050604@burns-stat.com>
References: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>
	<4CD31F62.7010406@4dscape.com> <4CD321BB.6050604@burns-stat.com>
Message-ID: <AANLkTik2C8BH_RQmgm-T2_pc6p+khrXk1YE4b8pfz31o@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101109/776c2c1a/attachment.pl>

From Zeno.Adams at ebs.edu  Tue Nov  9 14:22:54 2010
From: Zeno.Adams at ebs.edu (Adams, Zeno)
Date: Tue, 9 Nov 2010 14:22:54 +0100
Subject: [R-SIG-Finance] Questions on fitted garch(1,1)
In-Reply-To: <AANLkTik2C8BH_RQmgm-T2_pc6p+khrXk1YE4b8pfz31o@mail.gmail.com>
References: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com><4CD31F62.7010406@4dscape.com>
	<4CD321BB.6050604@burns-stat.com>
	<AANLkTik2C8BH_RQmgm-T2_pc6p+khrXk1YE4b8pfz31o@mail.gmail.com>
Message-ID: <9064522880125945B98983BBAECBA1CC98583A@exchsrv001.ebs.local>

Mark,

>>> If I try to predict the volatility with: predict(garch.fitted) I get
the
>>> "conditional standard deviation predictions" (an interval) for every
>>> period
>>> return in r.
>>>
>>> Q2) Is this a 1 period prediction (i.e. the volatility prediction
for the
>>> next day)? How do I get a prediction for let's say 2 periods in the
>>> future?

No these are not predictions for the next day. The term "predict" is
maybe somewhat misleading. "Fitted Values" is more appropriate, and in
fact both functions give the same results, e.g.

all.equal(predict(garch.fitted)[,1],fitted.values(garch.fitted)[,1])
[1] TRUE

For a two-step-ahead forecast I would use the predict function on the
fGARCH Object and would set the n.ahead argument to 2:

predict(fgarch.fitted, n.ahead = 2)
  meanForecast   meanError standardDeviation
1 0.0005044188 0.008436248       0.008436248
2 0.0005044188 0.008482511       0.008482511


>>> Q3) Why is the meanForecast for all 10 future periods the same?

Because you have just modeled the variance equation and the mean
equation has only a constant. Garch will help you forecasting the
variance of the returns but not the returns themselves. If you want
return forecasts you should model the mean equation, e.g. 

fgarch.fitted <- fGarch::garchFit(~ arma(2,1)+garch(1,1), data =
as.zoo(na.omit(r)), trace =  FALSE)

> predict(fgarch.fitted, n.ahead = 5)
   meanForecast   meanError standardDeviation
1 -0.0009371963 0.008495794       0.008495794
2 -0.0003940789 0.008556624       0.008539586
3  0.0004374707 0.008608828       0.008582793
4  0.0005284133 0.008651758       0.008625429
5  0.0005093462 0.008693970       0.008667503

Hope this helps

Zeno


-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Mark
Breman
Sent: Dienstag, 9. November 2010 12:51
To: Patrick Burns
Cc: r-sig-finance at stat.math.ethz.ch
Subject: Re: [R-SIG-Finance] Questions on fitted garch(1,1)

Hi everyone,

As a followup on my three fitted garch questions;

Yes indeed, if I give the estimated coefficients of fgarch.fitted as
initial
values to garch() the results are much more inline with each other:

> coef(garch(na.omit(r), order = c(1,1),
control=garch.control(start=c(1.3705e-06,8.1789e-02,9.0995e-01))))

 ***** ESTIMATION WITH ANALYTICAL GRADIENT *****


     I     INITIAL X(I)        D(I)

     1     1.370500e-06     1.000e+00
     2     8.178900e-02     1.000e+00
     3     9.099500e-01     1.000e+00

    IT   NF      F         RELDF    PRELDF    RELDX   STPPAR   D*STEP
NPRELDF
     0    1 -1.093e+04
     1   13 -1.093e+04  4.54e-09  1.67e-08  1.1e-09  4.3e+13  2.1e-09
 3.63e+05
     2   24 -1.093e+04 -1.30e-14  2.64e-14  8.1e-15  1.6e+00  1.5e-14
-1.22e-03

 ***** FALSE CONVERGENCE *****

 FUNCTION    -1.093479e+04   RELDX        8.076e-15
 FUNC. EVALS      24         GRAD. EVALS       2
 PRELDF       2.641e-14      NPRELDF     -1.222e-03

     I      FINAL X(I)        D(I)          G(I)

     1    1.372553e-06     1.000e+00    -1.965e+04
     2    8.178900e-02     1.000e+00     2.046e+00
     3    9.099500e-01     1.000e+00    -1.478e+01

          a0           a1           b1
1.372553e-06 8.178900e-02 9.099500e-01

Very nice, thank you!

Now only question 2 and 3 remain a mystery to me.

Kind regards,

-Mark-

2010/11/4 Patrick Burns <patrick at burns-stat.com>

> Taking Alexios' advice will probably
> help, but I wouldn't be surprised if
> they are still not the same.  The
> garch likelihood is extremely tricky
> to optimize -- specialized optimizers
> would be the ideal.
>
> Assuming you can give starting values
> to the optimizer in both cases, you can
> give the other's answer to each and see
> what happens.
>
>
> On 04/11/2010 21:02, alexios wrote:
>
>> The default for fGarch::garchFit is to estimate the mean, assuming a
>> non-zero mean dataset is passed, as can be seen from the returned
"mu"
>> parameter ( a call to 'args(garchFit)' should highlight the
>> 'include.mean' argument ). The default for tseries garch is to assume
>> zero mean data.
>>
>> Demean the data before passing to tseries garch by the estimated 'mu'
>> value from 'fgarch.fitted' and you should obtain closer results.
>>
>> -Alexios
>>
>>
>>
>> On 11/4/2010 8:44 PM, Mark Breman wrote:
>>
>>> Hi everyone,
>>>
>>> I'm trying to predict volatility using a garch(1,1) model and I'm
running
>>> into some interesting issues I cannot find an answer for.
>>>
>>> Suppose I have the following code:
>>>
>>> library(quantmod)
>>> library(tseries)
>>> library(fGarch)
>>>
>>> # get some returns
>>> r = dailyReturn(Ad(getSymbols("SPY", from="2000-01-01",
to="2010-11-04",
>>> auto.assign=F)))
>>>
>>> # fit models
>>> garch.fitted = garch(na.omit(r), order = c(1,1))
>>> fgarch.fitted = fGarch::garchFit(~ garch(1,1), data =
as.zoo(na.omit(r)),
>>> trace = FALSE)
>>>
>>> Now if I look at the values of the coefficients for both fitted
models
>>> they
>>> are not the same:
>>>
>>>  coef(garch.fitted)
>>>>
>>>           a0           a1           b1
>>> 1.339912e-06 8.165689e-02 9.101754e-01
>>>
>>>> coef(fgarch.fitted)
>>>>
>>>           mu        omega       alpha1        beta1
>>> 4.990616e-04 1.370880e-06 8.307080e-02 9.086447e-01
>>>
>>> Q1) Why are they different? What do I have to change to make the
>>> coefficient
>>> values of fgarch.fitted the same as garch.fitted?
>>>
>>> If I try to predict the volatility with: predict(garch.fitted) I get
the
>>> "conditional standard deviation predictions" (an interval) for every
>>> period
>>> return in r.
>>>
>>> Q2) Is this a 1 period prediction (i.e. the volatility prediction
for the
>>> next day)? How do I get a prediction for let's say 2 periods in the
>>> future?
>>>
>>>
>>> If I use predict(fgarch.fitted) I get:
>>>
>>>  predict(fgarch.fitted)
>>>>
>>>    meanForecast   meanError standardDeviation
>>> 1  0.0004990616 0.006677350       0.006677350
>>> 2  0.0004990616 0.006751925       0.006751925
>>> 3  0.0004990616 0.006825079       0.006825079
>>> 4  0.0004990616 0.006896859       0.006896859
>>> 5  0.0004990616 0.006967315       0.006967315
>>> 6  0.0004990616 0.007036491       0.007036491
>>> 7  0.0004990616 0.007104428       0.007104428
>>> 8  0.0004990616 0.007171167       0.007171167
>>> 9  0.0004990616 0.007236745       0.007236745
>>> 10 0.0004990616 0.007301198       0.007301198
>>>
>>> Q3) Why is the meanForecast for all 10 future periods the same?
>>>
>>> Thanks,
>>>
>>> -Mark-
>>>
>>>
>>>
>>> predict(garch)
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R
questions
>>> should go.
>>>
>>>
>>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R
questions
>> should go.
>>
>>
> --
> Patrick Burns
> patrick at burns-stat.com
> http://www.burns-stat.com
> http://www.portfolioprobe.com/blog
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R
questions
> should go.
>

	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.

EBS European Business School gemeinnuetzige GmbH, Universitaet fuer Wirtschaft und Recht i.Gr. - Amtsgericht Wiesbaden HRB 19951 - Umsatzsteuer-ID DE 113891213 Geschaeftsfuehrung: Prof. Dr. Christopher Jahns,  President; Prof. Dr. Rolf Tilmes, Dean Business School; Sabine Fuchs, CMO; Prof. Dr. Dr. Gerrick Frhr. v. Hoyningen-Huene, Dean Law School; Verwaltungsrat: Dr. Hellmut K. Albrecht, Vorsitzender

From gero.schwenk at web.de  Tue Nov  9 14:47:04 2010
From: gero.schwenk at web.de (Gero Schwenk)
Date: Tue, 09 Nov 2010 14:47:04 +0100
Subject: [R-SIG-Finance] Differencing / Detrending in "vars"-Package
Message-ID: <4CD950D8.8090406@web.de>

Hello together!
I've got a question regarding the use of the "vars"-package. As far as I 
know, VAR-models require stationary time series as input, which can 
generally be reached by repeatedly differencing the series and tested 
using unit-root tests.

Now the VAR-function in the "vars"-package allows to include a trend 
coefficient to the model, as seen in the example taken from Cowpertwait, 
Metcalfe, "Introductory Time Series with R", Springer:

library(vars)
US.var <- VAR(cbind(GNP, M1), p = 3, type = "trend")
summary(US.var)

The output, which is shown below, reports all roots of the 
characteristic polynomial being smaller than one, indicating an 
integrative, nonstationary process. Now the question: Does inclusion of 
the trend coefficient free me from worrying about nonstationarity? 
(Obviously, a stationary series should contain no deterministic trend.)
I Would be very happy for hints...
Cheers and thanks,
Gero

####

 > summary(US.var)

VAR Estimation Results:
=========================
Endogenous variables: GNP, M1
Deterministic variables: trend
Sample size: 133
Log Likelihood: -1003.311
Roots of the characteristic polynomial:
0.999 0.9109 0.6363 0.5036 0.3491 0.03296
Call:
VAR(y = cbind(GNP, M1), p = 3, type = "trend")


Estimation results for equation GNP:
====================================
GNP = GNP.l1 + M1.l1 + GNP.l2 + M1.l2 + GNP.l3 + M1.l3 + trend

Estimate Std. Error t value Pr(>|t|)
GNP.l1 1.075374 0.088430 12.161 <2e-16 ***
M1.l1 1.036148 0.410287 2.525 0.0128 *
GNP.l2 -0.006781 0.132817 -0.051 0.9594
M1.l2 -0.300379 0.754331 -0.398 0.6912
GNP.l3 -0.127237 0.085086 -1.495 0.1373
M1.l3 -0.563697 0.445689 -1.265 0.2083
trend 1.035030 0.435195 2.378 0.0189 *
---
Signif. codes: 0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1


Residual standard error: 23.31 on 126 degrees of freedom
Multiple R-Squared: 0.9999, Adjusted R-squared: 0.9999
F-statistic: 2.398e+05 on 7 and 126 DF, p-value: < 2.2e-16


Estimation results for equation M1:
===================================
M1 = GNP.l1 + M1.l1 + GNP.l2 + M1.l2 + GNP.l3 + M1.l3 + trend

Estimate Std. Error t value Pr(>|t|)
GNP.l1 -0.04391 0.01911 -2.298 0.02319 *
M1.l1 1.59231 0.08865 17.961 < 2e-16 ***
GNP.l2 0.06165 0.02870 2.148 0.03362 *
M1.l2 -0.48914 0.16299 -3.001 0.00325 **
GNP.l3 -0.01755 0.01839 -0.954 0.34170
M1.l3 -0.10411 0.09630 -1.081 0.28174
trend 0.01160 0.09404 0.123 0.90204
---
Signif. codes: 0 ?***? 0.001 ?**? 0.01 ?*? 0.05 ?.? 0.1 ? ? 1


Residual standard error: 5.036 on 126 degrees of freedom
Multiple R-Squared: 0.9999, Adjusted R-squared: 0.9999
F-statistic: 1.899e+05 on 7 and 126 DF, p-value: < 2.2e-16



Covariance matrix of residuals:
GNP M1
GNP 543.11 12.21
M1 12.21 25.36

Correlation matrix of residuals:
GNP M1
GNP 1.0000 0.1041
M1 0.1041 1.0000


From Zeno.Adams at ebs.edu  Tue Nov  9 15:48:55 2010
From: Zeno.Adams at ebs.edu (Adams, Zeno)
Date: Tue, 9 Nov 2010 15:48:55 +0100
Subject: [R-SIG-Finance] Differencing / Detrending in "vars"-Package
In-Reply-To: <4CD950D8.8090406@web.de>
References: <4CD950D8.8090406@web.de>
Message-ID: <9064522880125945B98983BBAECBA1CC98583B@exchsrv001.ebs.local>

Gero,

>> Now the question: Does inclusion of the trend coefficient free me
from worrying about nonstationarity?

No, if the data has a stochastic trend then the inclusion of a
deterministic trend does not make the series stationary. This is exactly
the mistake that many researchers made prior to the influential
Nelson/Plosser paper from 1982 (Nelson, C.R., and Plosser C.R. (1982),
Trends and random walks in macroeconmic time series : Some evidence and
implications, Journal of Monetary Economics,139-162). From my experience
the case that economic or financial data becomes stationary after
removing a deterministic trend (i.e. the series are "trend-stationary")
is rare. In most cases, level data is made stationary by taking first
(log-) differences.

Zeno

-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Gero
Schwenk
Sent: Dienstag, 9. November 2010 14:47
To: r-sig-finance at stat.math.ethz.ch
Subject: [R-SIG-Finance] Differencing / Detrending in "vars"-Package

Hello together!
I've got a question regarding the use of the "vars"-package. As far as I

know, VAR-models require stationary time series as input, which can 
generally be reached by repeatedly differencing the series and tested 
using unit-root tests.

Now the VAR-function in the "vars"-package allows to include a trend 
coefficient to the model, as seen in the example taken from Cowpertwait,

Metcalfe, "Introductory Time Series with R", Springer:

library(vars)
US.var <- VAR(cbind(GNP, M1), p = 3, type = "trend")
summary(US.var)

The output, which is shown below, reports all roots of the 
characteristic polynomial being smaller than one, indicating an 
integrative, nonstationary process. Now the question: Does inclusion of 
the trend coefficient free me from worrying about nonstationarity? 
(Obviously, a stationary series should contain no deterministic trend.)
I Would be very happy for hints...
Cheers and thanks,
Gero

####

 > summary(US.var)

VAR Estimation Results:
=========================
Endogenous variables: GNP, M1
Deterministic variables: trend
Sample size: 133
Log Likelihood: -1003.311
Roots of the characteristic polynomial:
0.999 0.9109 0.6363 0.5036 0.3491 0.03296
Call:
VAR(y = cbind(GNP, M1), p = 3, type = "trend")


Estimation results for equation GNP:
====================================
GNP = GNP.l1 + M1.l1 + GNP.l2 + M1.l2 + GNP.l3 + M1.l3 + trend

Estimate Std. Error t value Pr(>|t|)
GNP.l1 1.075374 0.088430 12.161 <2e-16 ***
M1.l1 1.036148 0.410287 2.525 0.0128 *
GNP.l2 -0.006781 0.132817 -0.051 0.9594
M1.l2 -0.300379 0.754331 -0.398 0.6912
GNP.l3 -0.127237 0.085086 -1.495 0.1373
M1.l3 -0.563697 0.445689 -1.265 0.2083
trend 1.035030 0.435195 2.378 0.0189 *
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 23.31 on 126 degrees of freedom
Multiple R-Squared: 0.9999, Adjusted R-squared: 0.9999
F-statistic: 2.398e+05 on 7 and 126 DF, p-value: < 2.2e-16


Estimation results for equation M1:
===================================
M1 = GNP.l1 + M1.l1 + GNP.l2 + M1.l2 + GNP.l3 + M1.l3 + trend

Estimate Std. Error t value Pr(>|t|)
GNP.l1 -0.04391 0.01911 -2.298 0.02319 *
M1.l1 1.59231 0.08865 17.961 < 2e-16 ***
GNP.l2 0.06165 0.02870 2.148 0.03362 *
M1.l2 -0.48914 0.16299 -3.001 0.00325 **
GNP.l3 -0.01755 0.01839 -0.954 0.34170
M1.l3 -0.10411 0.09630 -1.081 0.28174
trend 0.01160 0.09404 0.123 0.90204
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Residual standard error: 5.036 on 126 degrees of freedom
Multiple R-Squared: 0.9999, Adjusted R-squared: 0.9999
F-statistic: 1.899e+05 on 7 and 126 DF, p-value: < 2.2e-16



Covariance matrix of residuals:
GNP M1
GNP 543.11 12.21
M1 12.21 25.36

Correlation matrix of residuals:
GNP M1
GNP 1.0000 0.1041
M1 0.1041 1.0000

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.

EBS European Business School gemeinnuetzige GmbH, Universitaet fuer Wirtschaft und Recht i.Gr. - Amtsgericht Wiesbaden HRB 19951 - Umsatzsteuer-ID DE 113891213 Geschaeftsfuehrung: Prof. Dr. Christopher Jahns,  President; Prof. Dr. Rolf Tilmes, Dean Business School; Sabine Fuchs, CMO; Prof. Dr. Dr. Gerrick Frhr. v. Hoyningen-Huene, Dean Law School; Verwaltungsrat: Dr. Hellmut K. Albrecht, Vorsitzender

From breman.mark at gmail.com  Tue Nov  9 16:14:00 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 9 Nov 2010 16:14:00 +0100
Subject: [R-SIG-Finance] Questions on fitted garch(1,1)
In-Reply-To: <9064522880125945B98983BBAECBA1CC98583A@exchsrv001.ebs.local>
References: <AANLkTikyJxo0C7RZY_ndv7MT9_QJ4DFfUOqwH35ONaCJ@mail.gmail.com>
	<4CD31F62.7010406@4dscape.com> <4CD321BB.6050604@burns-stat.com>
	<AANLkTik2C8BH_RQmgm-T2_pc6p+khrXk1YE4b8pfz31o@mail.gmail.com>
	<9064522880125945B98983BBAECBA1CC98583A@exchsrv001.ebs.local>
Message-ID: <AANLkTi=wE2YjLgO70-NP4+jnhkvmOG38Y2CmR6A4c5vD@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101109/f9c049b1/attachment.pl>

From salmajj at softhome.net  Tue Nov  9 22:20:44 2010
From: salmajj at softhome.net (salmajj at softhome.net)
Date: Tue, 09 Nov 2010 14:20:44 -0700
Subject: [R-SIG-Finance] Copula Package
Message-ID: <courier.4CD9BB2C.000008A2@softhome.net>

Hi I tried a lot of time to send this message hope it works this time!
Hi everybody,
my objective is to find the corresponding parameter of the gumbel copula 
that best fit my empirical dependancy structure. i.e I already know that the 
gumbel copula is the best family but i want to decide on the best parameter 
? 

in other words
let
x <- rcopula(gumbelCopula(3), 100) 

suppose we do not know that alpha=3 is the right value and we are wondering 
if the gumbel copula with alpha equal to 2 is a good fit
let test :
gofEVCopula(gumbelCopula(2), x)
this returns
Parameter estimate(s): 3.044912
Cramer-von Mises statistic: 0.0004143588 with p-value 0.8616384 

let test :
gofEVCopula(gumbelCopula(3), x)
this returns:
arameter estimate(s): 3.044912
Cramer-von Mises statistic: 0.0004143588 with p-value 0.8556444 

So if I well understand this function gofCopula only indicate that the 
gumbel family is a good fit and we can not decide on the best parameter of 
the gumbel copula as the results were the same!
So which test we could use to know that actually the gumbal copula with 
parameter 3 and not 2 fit best the dependancy?
Thanks a lot!


From dutangc at gmail.com  Wed Nov 10 00:06:11 2010
From: dutangc at gmail.com (Christophe Dutang)
Date: Wed, 10 Nov 2010 00:06:11 +0100
Subject: [R-SIG-Finance] Copula Package
In-Reply-To: <courier.4CD9BB2C.000008A2@softhome.net>
References: <courier.4CD9BB2C.000008A2@softhome.net>
Message-ID: <6A27F013-64EE-46A5-B7FB-50735639E053@gmail.com>

Hello,

I think what you need to look at is the log-likelihood. Something like sum(log(dcopula(gumbelCopula(3), x)). 

By the way, there is also the gumbel package available on CRAN where some classic fitting methods are available.

Regards

Christophe

Le 9 nov. 2010 ? 22:20, salmajj at softhome.net a ?crit :

> Hi I tried a lot of time to send this message hope it works this time!
> Hi everybody,
> my objective is to find the corresponding parameter of the gumbel copula that best fit my empirical dependancy structure. i.e I already know that the gumbel copula is the best family but i want to decide on the best parameter ? 
> in other words
> let
> x <- rcopula(gumbelCopula(3), 100) 
> suppose we do not know that alpha=3 is the right value and we are wondering if the gumbel copula with alpha equal to 2 is a good fit
> let test :
> gofEVCopula(gumbelCopula(2), x)
> this returns
> Parameter estimate(s): 3.044912
> Cramer-von Mises statistic: 0.0004143588 with p-value 0.8616384 
> let test :
> gofEVCopula(gumbelCopula(3), x)
> this returns:
> arameter estimate(s): 3.044912
> Cramer-von Mises statistic: 0.0004143588 with p-value 0.8556444 
> So if I well understand this function gofCopula only indicate that the gumbel family is a good fit and we can not decide on the best parameter of the gumbel copula as the results were the same!
> So which test we could use to know that actually the gumbal copula with parameter 3 and not 2 fit best the dependancy?
> Thanks a lot!
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.

--
Christophe Dutang
Ph.D. student at ISFA, Lyon, France
website: http://dutangc.free.fr


From azege at yahoo.com  Wed Nov 10 01:18:12 2010
From: azege at yahoo.com (Andre Zege)
Date: Tue, 9 Nov 2010 16:18:12 -0800 (PST)
Subject: [R-SIG-Finance] possible bug in IBrokers, or my confusion?
Message-ID: <1289348292532-3035331.post@n4.nabble.com>


 I am not sure if this is a bug -- tried to reach Jeff Ryan through Nabble
message a while back, but it doesn't look like he got my message. So here
goes my question

In reqMktData in a couple of places expression
as.numeric(tickerId):length(Contract)) is used. In particular, it is used in 

    on.exit(cancelMktData(con,
as.character(as.numeric(tickerId):length(Contract))))

It seems to me this works fine when you call reqMktData once with default
tickerId="1". It then cancels all tickerIds in the range 1:length(Contract).
So far, so good. However, as tickerIds are not reusable in IB until you log
out from TWS, if you need to call reqMktData more than once, this code is
not going to cancel tickerId, as you will need to start with some other
tickerId, say tickerId=100. If i understand it correctly, there should be
something like
    tid<-as.numeric(tickerId)
    on.exit(cancelMktData(con, as.character(tid:(tid+length(Contract)))))

Maybe i am confused though, so any clarification would be appreciated
-- 
View this message in context: http://r.789695.n4.nabble.com/possible-bug-in-IBrokers-or-my-confusion-tp3035331p3035331.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From jeff.a.ryan at gmail.com  Wed Nov 10 02:47:37 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 9 Nov 2010 19:47:37 -0600
Subject: [R-SIG-Finance] possible bug in IBrokers, or my confusion?
In-Reply-To: <1289348292532-3035331.post@n4.nabble.com>
References: <1289348292532-3035331.post@n4.nabble.com>
Message-ID: <AANLkTimD6sXMN9esciPJi_zU_TyQWvYKXzMDTs2QhS84@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101109/7419085d/attachment.pl>

From noah at smartmediacorp.com  Wed Nov 10 03:43:00 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Tue, 09 Nov 2010 18:43:00 -0800
Subject: [R-SIG-Finance] Bug in quantmod library?
Message-ID: <4CDA06B4.7070507@smartmediacorp.com>

Hi,

Just starting to play around with some derivative pricing models and I 
need an easy way to download option chain data.  The quantmod package 
has a function for this, but it appears to be broken.

I just calling it as:   x <- getOptionChain("AAPL", Exp = NULL, src="yahoo")

Alternately, can anyone suggest an easy way to get option chain data 
directly into R?


Thanks!

-N


From josh.m.ulrich at gmail.com  Wed Nov 10 03:53:17 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 9 Nov 2010 20:53:17 -0600
Subject: [R-SIG-Finance] Bug in quantmod library?
In-Reply-To: <4CDA06B4.7070507@smartmediacorp.com>
References: <4CDA06B4.7070507@smartmediacorp.com>
Message-ID: <AANLkTimqTpv0Q2Axb-UfFeV=o9Cbx2DcV6=YmdqrZz--@mail.gmail.com>

Noah,

On Tue, Nov 9, 2010 at 8:43 PM, Noah Silverman <noah at smartmediacorp.com> wrote:
> Hi,
>
> Just starting to play around with some derivative pricing models and I need
> an easy way to download option chain data. ?The quantmod package has a
> function for this, but it appears to be broken.
>
*Please* elaborate.  What about it appears broken?  What error do you
receive?  What version of R and quantmod are you using?

> I just calling it as: ? x <- getOptionChain("AAPL", Exp = NULL, src="yahoo")
>
This works with the most recent r-forge revision.  It returns
list(calls=NULL, puts=NULL, symbol="AAPL") with the most recent CRAN
version.  It appears there were some changes to the Yahoo site and/or
the web-scraping code.

> Alternately, can anyone suggest an easy way to get option chain data
> directly into R?
>
Yes, use a patched version of quantmod from r-forge.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


>
> Thanks!
>
> -N
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From noah at smartmediacorp.com  Wed Nov 10 05:41:26 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Tue, 09 Nov 2010 20:41:26 -0800
Subject: [R-SIG-Finance] Bug in quantmod library?
In-Reply-To: <AANLkTimqTpv0Q2Axb-UfFeV=o9Cbx2DcV6=YmdqrZz--@mail.gmail.com>
References: <4CDA06B4.7070507@smartmediacorp.com>
	<AANLkTimqTpv0Q2Axb-UfFeV=o9Cbx2DcV6=YmdqrZz--@mail.gmail.com>
Message-ID: <4CDA2276.9000407@smartmediacorp.com>

Josh,

Thanks for the quick answer.  Cedrick also e-mailed me directly.  (The R 
community rocks!)

Installing from the source on r-forge worked!!!

Thanks,

-N

On 11/9/10 6:53 PM, Joshua Ulrich wrote:
> Noah,
>
> On Tue, Nov 9, 2010 at 8:43 PM, Noah Silverman<noah at smartmediacorp.com>  wrote:
>> Hi,
>>
>> Just starting to play around with some derivative pricing models and I need
>> an easy way to download option chain data.  The quantmod package has a
>> function for this, but it appears to be broken.
>>
> *Please* elaborate.  What about it appears broken?  What error do you
> receive?  What version of R and quantmod are you using?
>
>> I just calling it as:   x<- getOptionChain("AAPL", Exp = NULL, src="yahoo")
>>
> This works with the most recent r-forge revision.  It returns
> list(calls=NULL, puts=NULL, symbol="AAPL") with the most recent CRAN
> version.  It appears there were some changes to the Yahoo site and/or
> the web-scraping code.
>
>> Alternately, can anyone suggest an easy way to get option chain data
>> directly into R?
>>
> Yes, use a patched version of quantmod from r-forge.
>
> Best,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>> Thanks!
>>
>> -N
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>


From jeff.a.ryan at gmail.com  Wed Nov 10 09:52:26 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 10 Nov 2010 02:52:26 -0600
Subject: [R-SIG-Finance] Bug in quantmod library?
In-Reply-To: <4CDA2276.9000407@smartmediacorp.com>
References: <4CDA06B4.7070507@smartmediacorp.com>
	<AANLkTimqTpv0Q2Axb-UfFeV=o9Cbx2DcV6=YmdqrZz--@mail.gmail.com>
	<4CDA2276.9000407@smartmediacorp.com>
Message-ID: <AANLkTikiCD4_fMpZ2YeDLg6OQwezRme199d8QDX6+=gv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101110/54dd0287/attachment.pl>

From jeff.a.ryan at gmail.com  Wed Nov 10 19:07:51 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 10 Nov 2010 12:07:51 -0600
Subject: [R-SIG-Finance] IBrokers : asssign.Data and others questions..
 No ideas ?
In-Reply-To: <1288713968.4cd036f05eee1@agritel.extranet-e.net>
References: <1288713968.4cd036f05eee1@agritel.extranet-e.net>
Message-ID: <AANLkTinYS9Lrw4=zsaf9yd2W1+euM6RGpcp+Eg6fVYZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101110/491670f9/attachment.pl>

From Daniel.Probst at web.de  Wed Nov 10 21:17:48 2010
From: Daniel.Probst at web.de (Daniel Probst)
Date: Wed, 10 Nov 2010 21:17:48 +0100
Subject: [R-SIG-Finance] How to calculate Trading Days
In-Reply-To: <4CD6E9B5.5020203@smartmediacorp.com>
References: <4CD60251.2010507@smartmediacorp.com>	<db504cdae087b286ac480b37863788a6@braverock.com>
	<4CD6E9B5.5020203@smartmediacorp.com>
Message-ID: <4CDAFDEC.2000707@web.de>


Hi Noah,

checkout library (timeDate), especially the fns timeSequence, 
isBizday,holidayNYSE.
- Define a calendar for your exchange (use an available one as a 
template, e.g. holidayNYSE)
- define a sequence of days with  timeSequence
- subindex the sequence with isBizday using your calendar as an argument
- count the length of this result

Best
Dan




Am 07.11.2010 19:02, schrieb Noah Silverman:
> That makes perfect sense.
>
> However, using the difftimeDate function from fCalendar just gives me a
> count.  Is there another function that will return a vector of days
> between two dates?
>
> Thanks!
>
> -N
>
>
> On 11/7/10 8:50 AM, Brian G. Peterson wrote:
>> On Sat, 06 Nov 2010 18:35:13 -0700, Noah Silverman
>> <noah at smartmediacorp.com>  wrote:
>>> Hi,
>>>
>>> I'm working on some option value pricing models. Starting with the
>>> GBSvolatility for example.  All of the various formulas require a Time
>>> parameter (fraction of year) until expiration. Ideally, I want to
>>> compute it as:
>>> "trading days until expiration" / 252
>>>
>>> Give two days, I can use the difftimeDate to get the number of days
>>> between them, However I can't seem to find a way to get Trading Days
>>> (which excludes weekends and holidays.)  I've looked through rseek.org
>>> and many library's documentation, but can't find a way to do this.
>>>
>>> One thought would be to generate a vector of dates between the start and
>>> end days.  Then test EACH date to see if it was a holiday or weekend.
>>> This could work, but seems very inefficient.
>>>
>>> Does anyone know of a way to calculate Trading Days between two dates???
>>> (Surely I can't be the only person here who needs this in R.)
>> Each exchange has a different calendar.  Most people keep a calendar in a
>> database for each exchange they trade on.  This can then be matched to the
>> exchange meta-data for each instrument you trade.
>>
>> Since you seem to be using timeDate, you could take a close look at
>> fCalendar and see if the holiday functions included there will solve your
>> problem.
>>
>> A more efficient method of extracting holidays would be to generate
>> vectors of weekends and holidays and the remove the weekends and holidays
>> vectors from your vector of all days.
>>
>> Regards,
>>
>>    - Brian
>>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From stephen at organicfoodmarkets.com.au  Thu Nov 11 04:28:02 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Thu, 11 Nov 2010 14:28:02 +1100
Subject: [R-SIG-Finance] picking up the current index plus n -1, n-2, ...,
	n-20
Message-ID: <4CDB62C2.7070503@organicfoodmarkets.com.au>

Hi

I am trying to use

apply(X=x,MARGIN=1,FUN=myFunction)

to pick up and calculate moving averages and the like.

I can get this type of thing to work:

myFunction <- function (x){return( 2 * x)}

but of course that only work on one index at a time when I want to do 
something like this:

myFunction <- function (x){return( sum(x[n,]:x[n-20]))}

but of course it doesn't work.

I am still looking in R in a Nutshell but I just wondered if someone 
could put me out of my misery.

-- 
Stephen Choularton Ph.D., FIoD


From santosh.srinivas at gmail.com  Thu Nov 11 04:52:56 2010
From: santosh.srinivas at gmail.com (Santosh Srinivas)
Date: Thu, 11 Nov 2010 09:22:56 +0530
Subject: [R-SIG-Finance] picking up the current index plus n -1, n-2, ...,
	n-20
In-Reply-To: <4CDB62C2.7070503@organicfoodmarkets.com.au>
References: <4CDB62C2.7070503@organicfoodmarkets.com.au>
Message-ID: <4cdb689f.2a978e0a.387d.61ae@mx.google.com>

Hi Stephen,

Can't understand your question without a dataset (see dput) and reproducible
sample 
But not sure why sum(x[n:(n-20),]) would not work (see ?unlist too for
possible solutions... from experience)

HTH

-----Original Message-----
From: r-sig-finance-bounces at stat.math.ethz.ch
[mailto:r-sig-finance-bounces at stat.math.ethz.ch] On Behalf Of Stephen
Choularton
Sent: 11 November 2010 08:58
To: r-sig-finance at stat.math.ethz.ch
Subject: [R-SIG-Finance] picking up the current index plus n -1, n-2, ...,
n-20

Hi

I am trying to use

apply(X=x,MARGIN=1,FUN=myFunction)

to pick up and calculate moving averages and the like.

I can get this type of thing to work:

myFunction <- function (x){return( 2 * x)}

but of course that only work on one index at a time when I want to do 
something like this:

myFunction <- function (x){return( sum(x[n,]:x[n-20]))}

but of course it doesn't work.

I am still looking in R in a Nutshell but I just wondered if someone 
could put me out of my misery.

-- 
Stephen Choularton Ph.D., FIoD

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From josh.m.ulrich at gmail.com  Thu Nov 11 05:47:04 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 10 Nov 2010 22:47:04 -0600
Subject: [R-SIG-Finance] picking up the current index plus n -1, n-2, ...,
	n-20
In-Reply-To: <4CDB62C2.7070503@organicfoodmarkets.com.au>
References: <4CDB62C2.7070503@organicfoodmarkets.com.au>
Message-ID: <AANLkTik5ZnRNKJb-F8sN_x1V9+3_CKZCSP0r_=VMTD90@mail.gmail.com>

Hi Stephen,

If you want to calculate moving averages, take a look at the TTR
package.  For applying any function over a rolling time window, see
rollapply in the zoo package.

R-help is a better venue if you simply want to understand how to do it
will apply, since it's not strictly finance-related.

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Wed, Nov 10, 2010 at 9:28 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Hi
>
> I am trying to use
>
> apply(X=x,MARGIN=1,FUN=myFunction)
>
> to pick up and calculate moving averages and the like.
>
> I can get this type of thing to work:
>
> myFunction <- function (x){return( 2 * x)}
>
> but of course that only work on one index at a time when I want to do
> something like this:
>
> myFunction <- function (x){return( sum(x[n,]:x[n-20]))}
>
> but of course it doesn't work.
>
> I am still looking in R in a Nutshell but I just wondered if someone could
> put me out of my misery.
>
> --
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From mdelvaux at gmail.com  Thu Nov 11 05:53:36 2010
From: mdelvaux at gmail.com (Marc Delvaux)
Date: Wed, 10 Nov 2010 20:53:36 -0800
Subject: [R-SIG-Finance] picking up the current index plus n -1, n-2, ...,
	n-20
In-Reply-To: <4cdb689f.2a978e0a.387d.61ae@mx.google.com>
References: <4CDB62C2.7070503@organicfoodmarkets.com.au>
	<4cdb689f.2a978e0a.387d.61ae@mx.google.com>
Message-ID: <AANLkTim_WS2qc2WBz+2BJWspk_iNL26xGzBN8FdY0FH8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101110/965f9884/attachment.pl>

From stephen at organicfoodmarkets.com.au  Fri Nov 12 21:23:55 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Sat, 13 Nov 2010 07:23:55 +1100
Subject: [R-SIG-Finance] loops or other ooerations
Message-ID: <4CDDA25B.5080404@organicfoodmarkets.com.au>


Hi

  I am trying to write some code to backtest some spread trading ideas. 
I have got this far:

library(xts)
library(quantmod)
library(foreach)



getCombined <- function(sym1, sym2, dateFilter='::')
{
   # Grab historical data for both symbols
   one <- getSymbols(sym1, auto.assign=FALSE)
   two <- getSymbols(sym2, auto.assign=FALSE)

   # Give columns more usable names
   colnames(one) <- c('Open', 'High', 'Low', 'Close', 'Volume', 'Adjusted')
   colnames(two) <- c('Open', 'High', 'Low', 'Close', 'Volume', 'Adjusted')

   # Build combined object
   return(merge(one$Close, two$Close, all=FALSE)[dateFilter])
}


sym1 <- 'CBA.AX'
sym2 <- 'NAB.AX'



spread <- getCombined(sym1, sym2)

chartSeries(spread, type='line',theme=chartTheme('white'),TA=NULL)

price <- spread$Close - spread$Close.1

m <- rollapply(price, 20, mean)
sd.2 <- rollapply(price, 20, sd)
upper.boundary <- m + sd.2
lower.boundary <- m - sd.2
spread.data <- merge(price$Close, m$Close, upper.boundary$Close, 
lower.boundary$Close, all=FALSE)
# Give columns more usable names
colnames(spread.data) <- c('Close', 'Mean', 'Upper.Boundary', 
'Lower.Boundary')

so now I have my time series and I want to iterate over it with rules like:

1. If the price exceeds 2 x standard deviation  and then returns below 
sell the spread
2. If I'm short and the price becomes smaller than the average buy the 
spread
3. and so on

In other programming languages (except prolog which favors recursion) I 
guess I would write some type of loop and iterate over the data but some 
of these R functions seem to achieve wonderful results so I thought I 
would post this to see if a loop was the way to go or if there was 
something more elegant.

Any help most welcome.
-- 
Stephen Choularton Ph.D., FIoD


From satimis at yahoo.com  Sat Nov 13 16:16:50 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Sat, 13 Nov 2010 07:16:50 -0800 (PST)
Subject: [R-SIG-Finance] About RBloomberg
Message-ID: <179927.99140.qm@web113208.mail.gq1.yahoo.com>

Hi folks,

RBloomberg is completely new to me.  Can it be installed and run on Linux?


On
http://r-forge.r-project.org/projects/rbloomberg

Operating System: Windows

But the package :RBloomberg_0.1-11.tar.gz

it is Linux/Unix format.

For Windows OS please advise whether it runs on Win7 64bit?

Is there a package for Linux?  TIA

B.R.
Stephen L




From brian at braverock.com  Sat Nov 13 17:08:10 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 13 Nov 2010 10:08:10 -0600
Subject: [R-SIG-Finance] About RBloomberg
In-Reply-To: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
References: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
Message-ID: <4CDEB7EA.5050208@braverock.com>

On 11/13/2010 09:16 AM, Stephen Liu wrote:
> Hi folks,
>
> RBloomberg is completely new to me.  Can it be installed and run on Linux?
> On
> http://r-forge.r-project.org/projects/rbloomberg
>
> Operating System: Windows
>
> But the package :RBloomberg_0.1-11.tar.gz
>
> it is Linux/Unix format.
>
> For Windows OS please advise whether it runs on Win7 64bit?
>
> Is there a package for Linux?  TIA

Bloomberg is a windows-only application.

Thus RBloomberg is also Windows-only, since it uses the Bloomberg Java 
API on the local machine on which the Bloomberg client is installed.

Many people have had luck running Bloomberg under a Windows virtual 
machine on Mac or Linux, and running RBloomberg and R on that virtual 
machine as well.

With sockets, shared files, web services, or other methods, you can 
control the R instance (and thus RBloomberg) that is running on your 
Windows virtual machine if necessary.  You may need a more expensive 
Bloomberg license for this 'remote' access to be allowed under your 
contract with Bloomberg.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From tb_math03 at yahoo.com  Sat Nov 13 18:17:54 2010
From: tb_math03 at yahoo.com (TeBe)
Date: Sat, 13 Nov 2010 09:17:54 -0800 (PST)
Subject: [R-SIG-Finance] GARCH-BEKK
Message-ID: <531288.87097.qm@web52607.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101113/7127ecf3/attachment.pl>

From cmdr_rogue at hotmail.com  Sat Nov 13 18:28:29 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Sat, 13 Nov 2010 12:28:29 -0500
Subject: [R-SIG-Finance] loops or other ooerations
In-Reply-To: <4CDDA25B.5080404@organicfoodmarkets.com.au>
References: <4CDDA25B.5080404@organicfoodmarkets.com.au>
Message-ID: <BLU0-SMTP7F43F265E11CF3F52E831E2340@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101113/4bc195dc/attachment.pl>

From matmsh at yahoo.com  Sat Nov 13 19:02:46 2010
From: matmsh at yahoo.com (Shing Hing Man)
Date: Sat, 13 Nov 2010 10:02:46 -0800 (PST)
Subject: [R-SIG-Finance] PTSingleAssetBarrierOption gives different value
	from example in book by Haug
Message-ID: <200844.40540.qm@web52403.mail.re2.yahoo.com>

I am using version  2110.77 of package fExoticOptions.

I am trying to validate an  example on page 79 in the book

    The complete guide to option pricing formulas, Haug,  1997

using PTSingleAssetBarrierOption.


> PTSingleAssetBarrierOption(TypeFlag = "coB1", S = 95, X = 110,
+ H = 100, time1 = 0.5, Time2 = 1, r = 0.20, b = 0.20,
+ sigma = 0.25)

Title:
 Partial Time Single Asset Barrier Option 

Call:
 PTSingleAssetBarrierOption(TypeFlag = "coB1", S = 95, X = 110, 
     H = 100, time1 = 0.5, Time2 = 1, r = 0.2, b = 0.2, sigma = 0.25)

Parameters:
          Value:
 TypeFlag coB1  
 S        95    
 X        110   
 H        100   
 time1    0.5   
 Time2    1     
 r        0.2   
 b        0.2   
 sigma    0.25  

Option Price:
 9.69503 

Description:
 Sat Nov 13 17:34:52 2010 

> 

In the book by Haug (plese see row 2 in the table 2-11 on  page 79), the pv is 5.8712.

Is this a bug or is there something wrong with my parameters ?

Thanks in advance for any assistance !

Shing





From richard.c.herron at gmail.com  Sat Nov 13 21:49:04 2010
From: richard.c.herron at gmail.com (richard.c.herron at gmail.com)
Date: Sat, 13 Nov 2010 15:49:04 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with lagged
	self using ticker
Message-ID: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101113/88a1805e/attachment.pl>

From ggrothendieck at gmail.com  Sat Nov 13 22:38:02 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 13 Nov 2010 16:38:02 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
Message-ID: <AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>

On Sat, Nov 13, 2010 at 3:49 PM, richard.c.herron at gmail.com
<richard.c.herron at gmail.com> wrote:
> I have a zoo with monthly entries. For each month there are many entries,
> but only one entry per ticker. To to track the performance of decile
> portfolios I want to merge each entry with future dates of itself (i.e.,
> lag). For example, here's AAPL
>
>> head(temp[which(temp$symbol=="AAPL1C"),])
> ? ? ? symbol oi ? ? ? ? ?ret ? ? ? ? ? decile
> 200806 AAPL1C ?8710943.20 -1.129018e-01 10
> 200807 AAPL1C ?7540246.46 -2.437297e-03 10
> 200808 AAPL1C 11366863.59 ?1.703864e-01 10
> 200809 AAPL1C ?9500119.05 -3.689558e-01 10
> 200810 AAPL1C ? 114082.48 -4.406700e-02 ?1
> 200811 AAPL1C ? 723159.24 -1.437163e-01 ?6
>
> and it's future self
>
>> head(temp.lag[which(temp.lag$symbol=="AAPL1C"),])
> ? ? ? symbol oi ? ? ? ? ?ret ? ? ? ? ? decile
> 200806 AAPL1C ?7540246.46 -2.437297e-03 10
> 200807 AAPL1C 11366863.59 ?1.703864e-01 10
> 200808 AAPL1C ?9500119.05 -3.689558e-01 10
> 200809 AAPL1C ? 114082.48 -4.406700e-02 ?1
> 200810 AAPL1C ? 723159.24 -1.437163e-01 ?6
> 200811 AAPL1C ?1006345.25 -1.005402e-01 ?8
>
> When I try to merge these two, I get the warning (of course) that I can't
> merge zoos with duplicate dates.
>
> Is there a way to merge on the "symbol" column, too?
>
> I could lag, convert both back to dataframe, join, then go back to zoo. Is
> there a better way?
>

Some clarification would be useful.  What is the output that is desired?

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From cmdr_rogue at hotmail.com  Sat Nov 13 22:57:23 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Sat, 13 Nov 2010 16:57:23 -0500
Subject: [R-SIG-Finance] PTSingleAssetBarrierOption gives different
 value from example in book by Haug
In-Reply-To: <200844.40540.qm@web52403.mail.re2.yahoo.com>
References: <200844.40540.qm@web52403.mail.re2.yahoo.com>
Message-ID: <BLU0-SMTP103FF744ED9CFCA5BBE9248E2340@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101113/8558769c/attachment.pl>

From nelson.ana at gmail.com  Sat Nov 13 23:54:10 2010
From: nelson.ana at gmail.com (Ana Nelson)
Date: Sat, 13 Nov 2010 22:54:10 +0000
Subject: [R-SIG-Finance] About RBloomberg
In-Reply-To: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
References: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
Message-ID: <AANLkTim2+g84VLSOX4Z=DtVfuubAJ+piQUeUB517+whG@mail.gmail.com>

Stephen,

There is a newer version of RBloomberg using the Java API available at
findata.org

Also, I have just received a patch to allow this to be run on Linux
for the Bloomberg server. I will be incorporating this into the
findata.org version of RBloomberg shortly.




On Sat, Nov 13, 2010 at 3:16 PM, Stephen Liu <satimis at yahoo.com> wrote:
> Hi folks,
>
> RBloomberg is completely new to me. ?Can it be installed and run on Linux?
>
>
> On
> http://r-forge.r-project.org/projects/rbloomberg
>
> Operating System: Windows
>
> But the package :RBloomberg_0.1-11.tar.gz
>
> it is Linux/Unix format.
>
> For Windows OS please advise whether it runs on Win7 64bit?
>
> Is there a package for Linux? ?TIA
>
> B.R.
> Stephen L
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From shane.butler at gmail.com  Sun Nov 14 02:57:41 2010
From: shane.butler at gmail.com (Shane Butler)
Date: Sun, 14 Nov 2010 12:57:41 +1100
Subject: [R-SIG-Finance] loops or other ooerations
In-Reply-To: <4CDDA25B.5080404@organicfoodmarkets.com.au>
References: <4CDDA25B.5080404@organicfoodmarkets.com.au>
Message-ID: <AANLkTind4s5W9h-tOcORjmY4pOcEZhsGVhh3=Npn7BTZ@mail.gmail.com>

You could use logic like this:
<http://blog.fosstrading.com/2009/07/david-varadis-rsi2-alternative.html?showComment=1248458995203#c7802594037487260774>

Shane


On Sat, Nov 13, 2010 at 7:23 AM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
>
> Hi
>
> ?I am trying to write some code to backtest some spread trading ideas. I
> have got this far:
>
> library(xts)
> library(quantmod)
> library(foreach)
>
>
>
> getCombined <- function(sym1, sym2, dateFilter='::')
> {
> ?# Grab historical data for both symbols
> ?one <- getSymbols(sym1, auto.assign=FALSE)
> ?two <- getSymbols(sym2, auto.assign=FALSE)
>
> ?# Give columns more usable names
> ?colnames(one) <- c('Open', 'High', 'Low', 'Close', 'Volume', 'Adjusted')
> ?colnames(two) <- c('Open', 'High', 'Low', 'Close', 'Volume', 'Adjusted')
>
> ?# Build combined object
> ?return(merge(one$Close, two$Close, all=FALSE)[dateFilter])
> }
>
>
> sym1 <- 'CBA.AX'
> sym2 <- 'NAB.AX'
>
>
>
> spread <- getCombined(sym1, sym2)
>
> chartSeries(spread, type='line',theme=chartTheme('white'),TA=NULL)
>
> price <- spread$Close - spread$Close.1
>
> m <- rollapply(price, 20, mean)
> sd.2 <- rollapply(price, 20, sd)
> upper.boundary <- m + sd.2
> lower.boundary <- m - sd.2
> spread.data <- merge(price$Close, m$Close, upper.boundary$Close,
> lower.boundary$Close, all=FALSE)
> # Give columns more usable names
> colnames(spread.data) <- c('Close', 'Mean', 'Upper.Boundary',
> 'Lower.Boundary')
>
> so now I have my time series and I want to iterate over it with rules like:
>
> 1. If the price exceeds 2 x standard deviation ?and then returns below sell
> the spread
> 2. If I'm short and the price becomes smaller than the average buy the
> spread
> 3. and so on
>
> In other programming languages (except prolog which favors recursion) I
> guess I would write some type of loop and iterate over the data but some of
> these R functions seem to achieve wonderful results so I thought I would
> post this to see if a loop was the way to go or if there was something more
> elegant.
>
> Any help most welcome.
> --
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From satimis at yahoo.com  Sun Nov 14 03:28:54 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Sat, 13 Nov 2010 18:28:54 -0800 (PST)
Subject: [R-SIG-Finance] About RBloomberg
In-Reply-To: <AANLkTim2+g84VLSOX4Z=DtVfuubAJ+piQUeUB517+whG@mail.gmail.com>
References: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
	<AANLkTim2+g84VLSOX4Z=DtVfuubAJ+piQUeUB517+whG@mail.gmail.com>
Message-ID: <573305.59044.qm@web113210.mail.gq1.yahoo.com>

Hi Ana,

Thanks for your advice.

Just visited;

http://gorgyrella.rubyforge.org/
http://rubyforge.org/projects/gorgyrella

I'll keep my eyes on them.


I tested many R financial software, Open Source, in the past, R and RExcel, R, R 
and Calc etc.  I wonder how can I test/learn RBloomberg without Bloomberg 
server?  It there a solution or alternative?

B.R.
Stephen L





----- Original Message ----
From: Ana Nelson <nelson.ana at gmail.com>
To: r-sig-finance at stat.math.ethz.ch
Cc: Stephen Liu <satimis at yahoo.com>
Sent: Sun, November 14, 2010 6:54:10 AM
Subject: Re: [R-SIG-Finance] About RBloomberg

Stephen,

There is a newer version of RBloomberg using the Java API available at
findata.org

Also, I have just received a patch to allow this to be run on Linux
for the Bloomberg server. I will be incorporating this into the
findata.org version of RBloomberg shortly.




On Sat, Nov 13, 2010 at 3:16 PM, Stephen Liu <satimis at yahoo.com> wrote:
> Hi folks,
>
> RBloomberg is completely new to me.  Can it be installed and run on Linux?
>
>
> On
> http://r-forge.r-project.org/projects/rbloomberg
>
> Operating System: Windows
>
> But the package :RBloomberg_0.1-11.tar.gz
>
> it is Linux/Unix format.
>
> For Windows OS please advise whether it runs on Win7 64bit?
>
> Is there a package for Linux?  TIA
>
> B.R.
> Stephen L
>
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should 
>go.
>





From satimis at yahoo.com  Sun Nov 14 03:35:01 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Sat, 13 Nov 2010 18:35:01 -0800 (PST)
Subject: [R-SIG-Finance] About RBloomberg
In-Reply-To: <4CDEB7EA.5050208@braverock.com>
References: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
	<4CDEB7EA.5050208@braverock.com>
Message-ID: <787420.7256.qm@web113215.mail.gq1.yahoo.com>

Hi Brian,

Thanks for your advice.

> Many people have had luck running Bloomberg under a Windows virtual machine on
> Mac or Linux, and running RBloomberg and R on that virtual machine as well.

In this setup Bloomberg is still running on Windows OS which runs as VM/client 
on a virtual machine with Mac/Linux as host.  I have done many tests on this 
similar arrangement with Windows application running on a Windows VM/client.  It 
works seamlessly.  The latest test I did was running RExcel and R on a 64 bit 
Win7 VM/client.  RExcel is an Open Source application/package.


> You may need a more expensive Bloomberg license for this 'remote' access to be 

> allowed under your contract with Bloomberg.

That is my barrier on testing RBloomberg.  Is there a free Bloomberg server for 
testing purpose?

B.R.
Stephen L





----- Original Message ----
From: Brian G. Peterson <brian at braverock.com>
To: r-sig-finance at stat.math.ethz.ch
Sent: Sun, November 14, 2010 12:08:10 AM
Subject: Re: [R-SIG-Finance] About RBloomberg

On 11/13/2010 09:16 AM, Stephen Liu wrote:
> Hi folks,
> 
> RBloomberg is completely new to me.  Can it be installed and run on Linux?
> On
> http://r-forge.r-project.org/projects/rbloomberg
> 
> Operating System: Windows
> 
> But the package :RBloomberg_0.1-11.tar.gz
> 
> it is Linux/Unix format.
> 
> For Windows OS please advise whether it runs on Win7 64bit?
> 
> Is there a package for Linux?  TIA

Bloomberg is a windows-only application.

Thus RBloomberg is also Windows-only, since it uses the Bloomberg Java API on 
the local machine on which the Bloomberg client is installed.

Many people have had luck running Bloomberg under a Windows virtual machine on 
Mac or Linux, and running RBloomberg and R on that virtual machine as well.

With sockets, shared files, web services, or other methods, you can control the 
R instance (and thus RBloomberg) that is running on your Windows virtual machine 
if necessary.  You may need a more expensive Bloomberg license for this 'remote' 
access to be allowed under your contract with Bloomberg.

Regards,

  - Brian

-- Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

_______________________________________________
R-SIG-Finance at stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should 
go.





From cmdr_rogue at hotmail.com  Sun Nov 14 03:41:29 2010
From: cmdr_rogue at hotmail.com (Sarbo)
Date: Sat, 13 Nov 2010 21:41:29 -0500
Subject: [R-SIG-Finance] About RBloomberg
In-Reply-To: <787420.7256.qm@web113215.mail.gq1.yahoo.com>
References: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
	<4CDEB7EA.5050208@braverock.com>
	<787420.7256.qm@web113215.mail.gq1.yahoo.com>
Message-ID: <BLU0-SMTP211154FA499EDC390CD7750E2350@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101113/8dba3c89/attachment.pl>

From richard.c.herron at gmail.com  Sun Nov 14 04:03:33 2010
From: richard.c.herron at gmail.com (richard.c.herron at gmail.com)
Date: Sat, 13 Nov 2010 22:03:33 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
	<AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
Message-ID: <AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101113/783afc70/attachment.pl>

From ggrothendieck at gmail.com  Sun Nov 14 04:20:44 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sat, 13 Nov 2010 22:20:44 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
	<AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
	<AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>
Message-ID: <AANLkTimKfTEB=u0=fHDAqja0PH3E5x1=K3=gyfzOuebt@mail.gmail.com>

On Sat, Nov 13, 2010 at 10:03 PM, richard.c.herron at gmail.com
<richard.c.herron at gmail.com> wrote:
> On Sat, Nov 13, 2010 at 16:38, Gabor Grothendieck <ggrothendieck at gmail.com>
> wrote:
>>
>> On Sat, Nov 13, 2010 at 3:49 PM, richard.c.herron at gmail.com
>> <richard.c.herron at gmail.com> wrote:
>> > I have a zoo with monthly entries. For each month there are many
>> > entries,
>> > but only one entry per ticker. To to track the performance of decile
>> > portfolios I want to merge each entry with future dates of itself (i.e.,
>> > lag). For example, here's AAPL
>> >
>> >> head(temp[which(temp$symbol=="AAPL1C"),])
>> > ? ? ? symbol oi ? ? ? ? ?ret ? ? ? ? ? decile
>> > 200806 AAPL1C ?8710943.20 -1.129018e-01 10
>> > 200807 AAPL1C ?7540246.46 -2.437297e-03 10
>> > 200808 AAPL1C 11366863.59 ?1.703864e-01 10
>> > 200809 AAPL1C ?9500119.05 -3.689558e-01 10
>> > 200810 AAPL1C ? 114082.48 -4.406700e-02 ?1
>> > 200811 AAPL1C ? 723159.24 -1.437163e-01 ?6
>> >
>> > and it's future self
>> >
>> >> head(temp.lag[which(temp.lag$symbol=="AAPL1C"),])
>> > ? ? ? symbol oi ? ? ? ? ?ret ? ? ? ? ? decile
>> > 200806 AAPL1C ?7540246.46 -2.437297e-03 10
>> > 200807 AAPL1C 11366863.59 ?1.703864e-01 10
>> > 200808 AAPL1C ?9500119.05 -3.689558e-01 10
>> > 200809 AAPL1C ? 114082.48 -4.406700e-02 ?1
>> > 200810 AAPL1C ? 723159.24 -1.437163e-01 ?6
>> > 200811 AAPL1C ?1006345.25 -1.005402e-01 ?8
>> >
>> > When I try to merge these two, I get the warning (of course) that I
>> > can't
>> > merge zoos with duplicate dates.
>> >
>> > Is there a way to merge on the "symbol" column, too?
>> >
>> > I could lag, convert both back to dataframe, join, then go back to zoo.
>> > Is
>> > there a better way?
>> >
>>
>> Some clarification would be useful. ?What is the output that is desired?
>>
>> --
>> Statistics & Software Consulting
>> GKX Group, GKX Associates Inc.
>> tel: 1-877-GKX-GROUP
>> email: ggrothendieck at gmail.com
>
> Good point. Here's what the desired output looks like. Here .x are the
> current values and .y are the next period values. Here .y are one month
> ahead, but I'm interested in everything from -12 to +12 (thus my interest in
> the slick way to do it). This produces the desired output, but is tedious:
>> temp.df <- cbind(index(temp), as.data.frame(temp))
>> temp.lag.df <- cbind(index(temp.lag), as.data.frame(temp.lag))
>> temp.join.df <- merge(temp.df, temp.lag.df, by=c("date", "symbol"))
>> temp.join.zoo <- zoo(temp.join.df[, -1], index=temp.join.df[, 1])
>> head(temp.join.zoo[which(temp.join.zoo$symbol=="AAPL1C"), ])
> ?? ? ? symbol oi.x ? ? ? ?ret.x ? ? ? ? decile.x oi.y ? ? ? ?ret.y
> 200806 AAPL1C ?8710943.20 -1.129018e-01 10 ? ? ? ?7540246.46 -2.437297e-03
> 200807 AAPL1C ?7540246.46 -2.437297e-03 10 ? ? ? 11366863.59 ?1.703864e-01
> 200808 AAPL1C 11366863.59 ?1.703864e-01 10 ? ? ? ?9500119.05 -3.689558e-01
> 200809 AAPL1C ?9500119.05 -3.689558e-01 10 ? ? ? ? 114082.48 -4.406700e-02
> 200810 AAPL1C ? 114082.48 -4.406700e-02 ?1 ? ? ? ? 723159.24 -1.437163e-01
> 200811 AAPL1C ? 723159.24 -1.437163e-01 ?6 ? ? ? ?1006345.25 -1.005402e-01
> ?? ? ? decile.y
> 200806 10
> 200807 10
> 200808 10
> 200809 ?1
> 200810 ?6
> 200811 ?8
> When I sort on time zero to create a portfolio, I'd like to know the future
> performance of this portfolio on any given dimension. Thanks!
>

Could you supply the inputs using dput.  That is:

dput(myvariable)
dput(myvariable2)
etc.

and following that your code and following that the result so that
someone else can just copy whatever is in your message and paste it
into their session and see the same result.


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From matmsh at yahoo.com  Sun Nov 14 13:47:29 2010
From: matmsh at yahoo.com (matmsh)
Date: Sun, 14 Nov 2010 04:47:29 -0800 (PST)
Subject: [R-SIG-Finance] PTSingleAssetBarrierOption gives different
 value from example in book by Haug
In-Reply-To: <BLU0-SMTP103FF744ED9CFCA5BBE9248E2340@phx.gbl>
References: <200844.40540.qm@web52403.mail.re2.yahoo.com>
	<BLU0-SMTP103FF744ED9CFCA5BBE9248E2340@phx.gbl>
Message-ID: <1289738849266-3041691.post@n4.nabble.com>


My PC does not have a floppy driver. So I can not copy the VBA code from the
disk thatcome with Haug's book.

Shing
-- 
View this message in context: http://r.789695.n4.nabble.com/PTSingleAssetBarrierOption-gives-different-value-from-example-in-book-by-Haug-tp3041114p3041691.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From leijin56 at gmail.com  Sun Nov 14 18:13:33 2010
From: leijin56 at gmail.com (Lei Jin)
Date: Sun, 14 Nov 2010 09:13:33 -0800
Subject: [R-SIG-Finance] Question on blotter: AddTxn() and Txn.Fee
Message-ID: <AANLkTimJeWC3pMyFPQeuHnTGhnj+TRrVQLJxO4UoUFHX@mail.gmail.com>

Hi,

I am trying running the longtrend.r demo from blotter installed
directory.  And I noticed something I don't understand.  After run the
demo, I did
print(getAccount("longtrend"))

Txn.Fees is not 0 (note that the Txn.Fee is set to 0 in the addTxn()
call in the demo script).

                     Unrealized.PL Gross.Trading.PL      Txn.Fees Net.Trading.PL
1997-12-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1998-10-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1998-11-30  0.000000e+00     5.911360e+03  5.911360e+03   5.911360e+03
1998-12-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-01-29  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-02-26  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-03-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-04-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-05-28  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-06-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-07-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-08-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
1999-09-30  1.674764e+04     9.997897e+04  1.167266e+05   1.167266e+05
1999-10-29  0.000000e+00     1.497264e+08  1.497264e+08   1.497264e+08
1999-11-30  0.000000e+00     4.234740e+03  4.234740e+03   4.234740e+03

Am I missing something?

lji


From richard.c.herron at gmail.com  Sun Nov 14 18:52:02 2010
From: richard.c.herron at gmail.com (richard.c.herron at gmail.com)
Date: Sun, 14 Nov 2010 12:52:02 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTimKfTEB=u0=fHDAqja0PH3E5x1=K3=gyfzOuebt@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
	<AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
	<AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>
	<AANLkTimKfTEB=u0=fHDAqja0PH3E5x1=K3=gyfzOuebt@mail.gmail.com>
Message-ID: <AANLkTikSdSQq+PJPPfHhwENVh9BP3LWDw6x+aqtu2qM2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101114/332c542c/attachment.pl>

From ggrothendieck at gmail.com  Sun Nov 14 19:09:43 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 14 Nov 2010 13:09:43 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTikSdSQq+PJPPfHhwENVh9BP3LWDw6x+aqtu2qM2@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
	<AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
	<AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>
	<AANLkTimKfTEB=u0=fHDAqja0PH3E5x1=K3=gyfzOuebt@mail.gmail.com>
	<AANLkTikSdSQq+PJPPfHhwENVh9BP3LWDw6x+aqtu2qM2@mail.gmail.com>
Message-ID: <AANLkTi=F5HTXvv-o10HGp+9sCtXqq1QzsWBr9ECTTV+U@mail.gmail.com>

On Sun, Nov 14, 2010 at 12:52 PM, richard.c.herron at gmail.com
<richard.c.herron at gmail.com> wrote:
> OK, I'm learning :). With more tinkering I found that the zoo lag operator
> lags by rows, not by time stamps, so it fails if there are multiple entries
> per time stamp. I may be forced to switch to data frame, perform the
> following operation, then switch back to zoo.
> Here is the manual coding of the operation I'd like (with a small data
> frame) to do all in the zoo class (or some other time series):
>> # create a zoo multiple symbols per month
>> temp <- data.frame(date=rep(200808:200811, each=3),
>> symbol=rep(letters[1:3], times=4), ret=1:12)
>> # find unique date entries
>> unique.date <- unique(temp$date)
>> # shift the date num.lags to match future performance with current
>> stock/date
>> num.lags <- 1
>> temp.lag <- temp[which(temp$date > unique.date[num.lags]), ]
>> for (i in seq(num.lags+1, length(unique.date), 1)) {
> + ? ? temp.lag$date[which(temp.lag$date==unique.date[i])] <-
> unique.date[i-num.lags]
> + }
>> # merge
>> temp.merged <- merge(temp, temp.lag, by=c("date", "symbol"),
>> suffixes=c(".now", ".next"))
>> temp.merged
> ?? ?date symbol ret.now ret.next
> 1 200808 ? ? ?a ? ? ? 1 ? ? ? ?4
> 2 200808 ? ? ?b ? ? ? 2 ? ? ? ?5
> 3 200808 ? ? ?c ? ? ? 3 ? ? ? ?6
> 4 200809 ? ? ?a ? ? ? 4 ? ? ? ?7
> 5 200809 ? ? ?b ? ? ? 5 ? ? ? ?8
> 6 200809 ? ? ?c ? ? ? 6 ? ? ? ?9
> 7 200810 ? ? ?a ? ? ? 7 ? ? ? 10
> 8 200810 ? ? ?b ? ? ? 8 ? ? ? 11
> 9 200810 ? ? ?c ? ? ? 9 ? ? ? 12
>

zoo series are time series and time series are functions of time so
you can't have multiple times that are the same (or else it would not
be a function). See zoo FAQ #1
vignette("zoo-faq")

Normally in zoo you would represent your data in wide form rather than
long form in which case there is no problem:

> library(zoo)
> f <- function(x) as.yearmon(as.character(x), "%Y%m")
> z <- read.zoo(temp, split = "symbol", FUN = f)
> lag(z, 0:1)
         a.lag0 b.lag0 c.lag0 a.lag1 b.lag1 c.lag1
Aug 2008      1      2      3      4      5      6
Sep 2008      4      5      6      7      8      9
Oct 2008      7      8      9     10     11     12
Nov 2008     10     11     12     NA     NA     NA

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From richard.c.herron at gmail.com  Sun Nov 14 21:18:15 2010
From: richard.c.herron at gmail.com (richard.c.herron at gmail.com)
Date: Sun, 14 Nov 2010 15:18:15 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTi=F5HTXvv-o10HGp+9sCtXqq1QzsWBr9ECTTV+U@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
	<AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
	<AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>
	<AANLkTimKfTEB=u0=fHDAqja0PH3E5x1=K3=gyfzOuebt@mail.gmail.com>
	<AANLkTikSdSQq+PJPPfHhwENVh9BP3LWDw6x+aqtu2qM2@mail.gmail.com>
	<AANLkTi=F5HTXvv-o10HGp+9sCtXqq1QzsWBr9ECTTV+U@mail.gmail.com>
Message-ID: <AANLkTimjxN3zHzTTN8uBkPYsKNnY+nUCjwo1FU3J30K1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101114/19442793/attachment.pl>

From ggrothendieck at gmail.com  Sun Nov 14 22:04:59 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 14 Nov 2010 16:04:59 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTimjxN3zHzTTN8uBkPYsKNnY+nUCjwo1FU3J30K1@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
	<AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
	<AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>
	<AANLkTimKfTEB=u0=fHDAqja0PH3E5x1=K3=gyfzOuebt@mail.gmail.com>
	<AANLkTikSdSQq+PJPPfHhwENVh9BP3LWDw6x+aqtu2qM2@mail.gmail.com>
	<AANLkTi=F5HTXvv-o10HGp+9sCtXqq1QzsWBr9ECTTV+U@mail.gmail.com>
	<AANLkTimjxN3zHzTTN8uBkPYsKNnY+nUCjwo1FU3J30K1@mail.gmail.com>
Message-ID: <AANLkTi=Gr9Pjw94fmQTxdkchgSBZC141hFCkKnjO2a7S@mail.gmail.com>

On Sun, Nov 14, 2010 at 3:18 PM, richard.c.herron at gmail.com
<richard.c.herron at gmail.com> wrote:
> On Sun, Nov 14, 2010 at 13:09, Gabor Grothendieck <ggrothendieck at gmail.com>
>>
>> Normally in zoo you would represent your data in wide form rather than
>> long form in which case there is no problem:
>>
>> > library(zoo)
>> > f <- function(x) as.yearmon(as.character(x), "%Y%m")
>> > z <- read.zoo(temp, split = "symbol", FUN = f)
>> > lag(z, 0:1)
>> ? ? ? ? a.lag0 b.lag0 c.lag0 a.lag1 b.lag1 c.lag1
>> Aug 2008 ? ? ?1 ? ? ?2 ? ? ?3 ? ? ?4 ? ? ?5 ? ? ?6
>> Sep 2008 ? ? ?4 ? ? ?5 ? ? ?6 ? ? ?7 ? ? ?8 ? ? ?9
>> Oct 2008 ? ? ?7 ? ? ?8 ? ? ?9 ? ? 10 ? ? 11 ? ? 12
>> Nov 2008 ? ? 10 ? ? 11 ? ? 12 ? ? NA ? ? NA ? ? NA
>>
>> --
>> Statistics & Software Consulting
>> GKX Group, GKX Associates Inc.
>> tel: 1-877-GKX-GROUP
>> email: ggrothendieck at gmail.com
>
> Thanks, Gabor!
> I knew about zoo's preference for single row per date, but I didn't know
> read.zoo() converted to wide or the lag(x, 0:1) trick.
> Seeing this has me questioning my ideas on portfolio sorting. Is there a
> good reference on forming portfolios along a given parameter (kind of like
> Jegadeesh-Titman momentum portfolios, but sorted along a parameter other
> than return)? The search terms I'm using in rseek.org aren't yielding much.
> Thanks!

This is not R specific and am not sure if its what you are after but
here is one paper:
http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1108361
Also you might look at the PerformanceAnalytics package.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From richard.c.herron at gmail.com  Sun Nov 14 23:29:55 2010
From: richard.c.herron at gmail.com (richard.c.herron at gmail.com)
Date: Sun, 14 Nov 2010 17:29:55 -0500
Subject: [R-SIG-Finance] merge zoo with many entries per date with
 lagged self using ticker
In-Reply-To: <AANLkTi=Gr9Pjw94fmQTxdkchgSBZC141hFCkKnjO2a7S@mail.gmail.com>
References: <AANLkTikjrKFdsisJABCJ76NGrhWpjF-O+e4iwGVjJ2EG@mail.gmail.com>
	<AANLkTinugZCpVpQZSR1XPJDWqaVuTWXzsHpcpC_Rqp1A@mail.gmail.com>
	<AANLkTi=bCVvPz3Qs=icxaCJstTrE9GsRxGS-LKrAvy20@mail.gmail.com>
	<AANLkTimKfTEB=u0=fHDAqja0PH3E5x1=K3=gyfzOuebt@mail.gmail.com>
	<AANLkTikSdSQq+PJPPfHhwENVh9BP3LWDw6x+aqtu2qM2@mail.gmail.com>
	<AANLkTi=F5HTXvv-o10HGp+9sCtXqq1QzsWBr9ECTTV+U@mail.gmail.com>
	<AANLkTimjxN3zHzTTN8uBkPYsKNnY+nUCjwo1FU3J30K1@mail.gmail.com>
	<AANLkTi=Gr9Pjw94fmQTxdkchgSBZC141hFCkKnjO2a7S@mail.gmail.com>
Message-ID: <AANLkTikB9uc4OL=ARohE6jMW27xcKMSVF4AwVJ4AkECP@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101114/68e83457/attachment.pl>

From ustaudinger at gmail.com  Mon Nov 15 06:48:23 2010
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Mon, 15 Nov 2010 06:48:23 +0100
Subject: [R-SIG-Finance] About RBloomberg
In-Reply-To: <BLU0-SMTP211154FA499EDC390CD7750E2350@phx.gbl>
References: <179927.99140.qm@web113208.mail.gq1.yahoo.com>
	<4CDEB7EA.5050208@braverock.com>
	<787420.7256.qm@web113215.mail.gq1.yahoo.com>
	<BLU0-SMTP211154FA499EDC390CD7750E2350@phx.gbl>
Message-ID: <AANLkTikE-_t2wH_10ugiNJ2kRsQJ6e39s6PKP9wnXWDV@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101115/a0fdde7c/attachment.pl>

From tb_math03 at yahoo.com  Mon Nov 15 08:34:52 2010
From: tb_math03 at yahoo.com (TeBe)
Date: Sun, 14 Nov 2010 23:34:52 -0800 (PST)
Subject: [R-SIG-Finance] goodness of fit garch bekk
Message-ID: <602222.7672.qm@web52607.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101114/b795c4d6/attachment.pl>

From brian at braverock.com  Mon Nov 15 16:14:15 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 15 Nov 2010 09:14:15 -0600
Subject: [R-SIG-Finance] Question on blotter: AddTxn() and Txn.Fee
In-Reply-To: <AANLkTindcxj0CLGs++OMttd5AFVG7O8wXQ8mqL-JTnuG@mail.gmail.com>
References: <AANLkTimJeWC3pMyFPQeuHnTGhnj+TRrVQLJxO4UoUFHX@mail.gmail.com>	<4CE02A45.4090805@braverock.com>	<AANLkTinh+8UzFPsR1wFz2ZhtkAiA7wLBjH7oOqW2s1ja@mail.gmail.com>	<7bdd36096c20532234fbfeb03ef414d3@braverock.com>
	<AANLkTindcxj0CLGs++OMttd5AFVG7O8wXQ8mqL-JTnuG@mail.gmail.com>
Message-ID: <4CE14E47.3060108@braverock.com>

xts version 0.7-6.8 (svn r547) fixes the issue


Thanks due to Josh Ulrich chasing it down on the weekend.

Regards,

    - Brian

On 11/14/2010 04:08 PM, Lei Jin wrote:
> Thank you, I will wait for the resolution.
>
> Lei
>
> On Sun, Nov 14, 2010 at 1:19 PM, Brian G. Peterson<brian at braverock.com>  wrote:
>> On Sun, 14 Nov 2010 12:56:44 -0800, Lei Jin<leijin56 at gmail.com>  wrote:
>>> Thank you for the quick response.  I will give it a try.
>>
>>
>> We have discovered that a bug was introduced into xts.  SVN r532
>> works, and it breaks sometime after that.  The simplest thing, for now,
>> would be to either load an older version of xts, or to wait for us to sort
>> it out.
>>
>>
>>> BTW, where do I suppose to use round()?  I am still new to R.
>>
>> for example:
>>
>> round(getAccount("longtrend"),2)
>>
>>
>> We'll let you know once we chase down the bug.
>>
>>    - Brian
>>
>>> Lei
>>>
>>> On Sun, Nov 14, 2010 at 10:28 AM, Brian G. Peterson
>> <brian at braverock.com>
>>> wrote:
>>>> It would have been easier to read if you had used 'round()', but I get
>>>> zeros in the fees for the longtrend demo.
>>>>
>>>> Transaction P&L is reported by 'getTxns', not 'getAccount'
>>>>
>>>> It does appear that there may be a bug in the latest xts that may be
>>>> affecting blotter, though.  Jeff and Josh have been making subsetting
>>>> faster, and blotter relies heavily on xts subsetting.
>>>>
>>>> I'll investigate and let you know.
>>>>
>>>> Regards,
>>>>
>>>>   - Brian
>>>>
>>>> On 11/14/2010 11:13 AM, Lei Jin wrote:
>>>>>
>>>>> Hi,
>>>>>
>>>>> I am trying running the longtrend.r demo from blotter installed
>>>>> directory.  And I noticed something I don't understand.  After run the
>>>>> demo, I did
>>>>> print(getAccount("longtrend"))
>>>>>
>>>>> Txn.Fees is not 0 (note that the Txn.Fee is set to 0 in the addTxn()
>>>>> call in the demo script).
>>>>>
>>>>>                       Unrealized.PL Gross.Trading.PL      Txn.Fees
>>>>> Net.Trading.PL
>>>>> 1997-12-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1998-10-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1998-11-30  0.000000e+00     5.911360e+03  5.911360e+03   5.911360e+03
>>>>> 1998-12-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-01-29  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-02-26  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-03-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-04-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-05-28  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-06-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-07-30  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-08-31  0.000000e+00     0.000000e+00  0.000000e+00   0.000000e+00
>>>>> 1999-09-30  1.674764e+04     9.997897e+04  1.167266e+05   1.167266e+05
>>>>> 1999-10-29  0.000000e+00     1.497264e+08  1.497264e+08   1.497264e+08
>>>>> 1999-11-30  0.000000e+00     4.234740e+03  4.234740e+03   4.234740e+03
>>>>>
>>>>> Am I missing something?
>>>>>
>>>>> lji
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>> -- Also note that this is not the r-help list where general R
>> questions
>>>>> should go.
>>>>
>>>>
>>>> --
>>>> Brian G. Peterson
>>>> http://braverock.com/brian/
>>>> Ph: 773-459-4973
>>>> IM: bgpbraverock
>>>>
>>
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>>
>
>
>


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From noah at smartmediacorp.com  Tue Nov 16 02:06:22 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 15 Nov 2010 17:06:22 -0800
Subject: [R-SIG-Finance] But in quantmod function
Message-ID: <4CE1D90E.5010506@smartmediacorp.com>

Hi,

I think I've found a bug in the quantmod library.

The function "getOptionChain" fails when fetching the chain of an index 
(S&P, DJIA, etc.)
(Note:  It works beautifully for options on stocks.)

chain <- getOptionChain("^GSPC", Exp=NULL)
Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds

chain <- getOptionChain("^RUT", Exp=NULL)
Error in from:to : NA/NaN argument


Any ideas?

-N


From ron_michael70 at yahoo.com  Tue Nov 16 03:27:56 2010
From: ron_michael70 at yahoo.com (Ron Michael)
Date: Mon, 15 Nov 2010 18:27:56 -0800 (PST)
Subject: [R-SIG-Finance] How to install mgarchBEKK package
Message-ID: <565784.65409.qm@web63805.mail.re1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101115/888c1f7a/attachment.pl>

From mdelvaux at gmail.com  Tue Nov 16 03:49:35 2010
From: mdelvaux at gmail.com (Marc Delvaux)
Date: Mon, 15 Nov 2010 18:49:35 -0800
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <4CE1D90E.5010506@smartmediacorp.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
Message-ID: <AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101115/b052ec87/attachment.pl>

From noah at smartmediacorp.com  Tue Nov 16 04:38:31 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 15 Nov 2010 19:38:31 -0800
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
References: <4CE1D90E.5010506@smartmediacorp.com><AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
Message-ID: <4CE1FCB7.1070103@smartmediacorp.com>

OK,

Bad example.  But try it for the ticker "^RUT"  (Russel index)

There ARE options:  http://finance.yahoo.com/q/op?s=^RUT+Options

Also options for the S&P mini "^XAP"
http://finance.yahoo.com/q/op?s=^XSP+Options

getOptionChain("^XSP", NULL)
Error in from:to : NA/NaN argument

I'VE FOUND THE BUG.  But don't know how/where to submit it.

Look carefully at the URLs used by yahoo.

For a stock

For an index

Notice that with an index, the "+options" part is there.  Try calling 
the page without it and it fails.  The current code in quantmod doesn't 
add this.

I think we just need add one line:      Symbols <- paste(Symbols, 
"+options", sep="")

-N





On 11/15/10 7:03 PM, Cedrick Johnson wrote:
> There are technically SPX cash optns. I am not in front of my comp to look them up but they do exist indeed. SPY and DIA options do exist for the ETF's....
>
> -c
> Sent from my BlackBerry?
>
> -----Original Message-----
> From: Marc Delvaux<mdelvaux at gmail.com>
> Sender: r-sig-finance-bounces at stat.math.ethz.ch
> Date: Mon, 15 Nov 2010 18:49:35
> To: Noah Silverman<noah at smartmediacorp.com>
> Reply-To: mdelvaux at gmail.com
> Cc:<r-sig-finance at stat.math.ethz.ch>
> Subject: Re: [R-SIG-Finance] But in quantmod function
>
> That is because there are no options on these specific tickers, as you can
> see by the grayed out "options" link on the corresponding yahoo page.
>
> For options on the S&P, you need to use "SPY", and "^DJX" for the DJIA.
>
> On Mon, Nov 15, 2010 at 5:06 PM, Noah Silverman<noah at smartmediacorp.com>wrote:
>
>> Hi,
>>
>> I think I've found a bug in the quantmod library.
>>
>> The function "getOptionChain" fails when fetching the chain of an index
>> (S&P, DJIA, etc.)
>> (Note:  It works beautifully for options on stocks.)
>>
>> chain<- getOptionChain("^GSPC", Exp=NULL)
>> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>>
>> chain<- getOptionChain("^RUT", Exp=NULL)
>> Error in from:to : NA/NaN argument
>>
>>
>> Any ideas?
>>
>> -N
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From mdelvaux at gmail.com  Tue Nov 16 04:59:46 2010
From: mdelvaux at gmail.com (Marc Delvaux)
Date: Mon, 15 Nov 2010 19:59:46 -0800
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <4CE1FCB7.1070103@smartmediacorp.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
	<AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
	<4CE1FCB7.1070103@smartmediacorp.com>
Message-ID: <AANLkTi=dOG=bK-Rjdeew0GNOYaReHwb=xGbP8YMqZVLS@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101115/ff24e687/attachment.pl>

From josh.m.ulrich at gmail.com  Tue Nov 16 05:05:21 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 15 Nov 2010 22:05:21 -0600
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <4CE1FCB7.1070103@smartmediacorp.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
	<AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
	<4CE1FCB7.1070103@smartmediacorp.com>
Message-ID: <AANLkTikghPDCL=k3DTZrJjoZSpMfezdYzp9Hy1=uiaS9@mail.gmail.com>

Noah,

On Mon, Nov 15, 2010 at 9:38 PM, Noah Silverman <noah at smartmediacorp.com> wrote:
> OK,
>
> Bad example. ?But try it for the ticker "^RUT" ?(Russel index)
>
> There ARE options: ?http://finance.yahoo.com/q/op?s=^RUT+Options
>
> Also options for the S&P mini "^XAP"
> http://finance.yahoo.com/q/op?s=^XSP+Options
>
Which is it "^XAP" or "^XSP"?

> getOptionChain("^XSP", NULL)
> Error in from:to : NA/NaN argument
>
> I'VE FOUND THE BUG. ?But don't know how/where to submit it.
>
> Look carefully at the URLs used by yahoo.
>
> For a stock
>
> For an index
>
Submit bugs to the package maintainer, preferably with patches.  Using
a rude tone doesn't improve the chances of someone helping you.
Especially when *both* the software and the data are free.

> Notice that with an index, the "+options" part is there. ?Try calling the
> page without it and it fails. ?The current code in quantmod doesn't add
> this.
>
> I think we just need add one line: ? ? ?Symbols <- paste(Symbols,
> "+options", sep="")
>
Why don't you try this, test it, and submit a patch?

> -N
>
>

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


>
>
>
> On 11/15/10 7:03 PM, Cedrick Johnson wrote:
>>
>> There are technically SPX cash optns. I am not in front of my comp to look
>> them up but they do exist indeed. SPY and DIA options do exist for the
>> ETF's....
>>
>> -c
>> Sent from my BlackBerry?
>>
>> -----Original Message-----
>> From: Marc Delvaux<mdelvaux at gmail.com>
>> Sender: r-sig-finance-bounces at stat.math.ethz.ch
>> Date: Mon, 15 Nov 2010 18:49:35
>> To: Noah Silverman<noah at smartmediacorp.com>
>> Reply-To: mdelvaux at gmail.com
>> Cc:<r-sig-finance at stat.math.ethz.ch>
>> Subject: Re: [R-SIG-Finance] But in quantmod function
>>
>> That is because there are no options on these specific tickers, as you can
>> see by the grayed out "options" link on the corresponding yahoo page.
>>
>> For options on the S&P, you need to use "SPY", and "^DJX" for the DJIA.
>>
>> On Mon, Nov 15, 2010 at 5:06 PM, Noah
>> Silverman<noah at smartmediacorp.com>wrote:
>>
>>> Hi,
>>>
>>> I think I've found a bug in the quantmod library.
>>>
>>> The function "getOptionChain" fails when fetching the chain of an index
>>> (S&P, DJIA, etc.)
>>> (Note: ?It works beautifully for options on stocks.)
>>>
>>> chain<- getOptionChain("^GSPC", Exp=NULL)
>>> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>>>
>>> chain<- getOptionChain("^RUT", Exp=NULL)
>>> Error in from:to : NA/NaN argument
>>>
>>>
>>> Any ideas?
>>>
>>> -N
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From josh.m.ulrich at gmail.com  Tue Nov 16 05:13:09 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 15 Nov 2010 22:13:09 -0600
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <AANLkTi=dOG=bK-Rjdeew0GNOYaReHwb=xGbP8YMqZVLS@mail.gmail.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
	<AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
	<4CE1FCB7.1070103@smartmediacorp.com>
	<AANLkTi=dOG=bK-Rjdeew0GNOYaReHwb=xGbP8YMqZVLS@mail.gmail.com>
Message-ID: <AANLkTimgfUcVzsq95bBEOLPOghZQuSjd8wpxnL5JYQ5k@mail.gmail.com>

Marc,

On Mon, Nov 15, 2010 at 9:59 PM, Marc Delvaux <mdelvaux at gmail.com> wrote:
> Jeffrey Ryan is the main author and maintainer of quantmod (even if I think
> Joshua Ulrich is working on the yahoo scraping code). ?Taping help(quantmod)

I haven't done anything with the options web-scraping code.

> will give you that information (same as for any package). ?Quantmod is
> hosted on r-forge where you can find more information if needed
> https://r-forge.r-project.org/projects/quantmod/ And of course Jeffrey is
> active on his mail list.
>
Actually, Jeff already patched the issue with symbols that start with
a carat.  There may be other issues though...

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


> Author(s)
>
> Jeffrey A. Ryan
>
> Maintainer: Jeffrey A. Ryan <jeff.a.ryan at gmail.com>
>
>
> On Mon, Nov 15, 2010 at 7:38 PM, Noah Silverman <noah at smartmediacorp.com>wrote:
>
>> OK,
>>
>> Bad example. ?But try it for the ticker "^RUT" ?(Russel index)
>>
>> There ARE options: ?http://finance.yahoo.com/q/op?s=^RUT+Options
>>
>> Also options for the S&P mini "^XAP"
>> http://finance.yahoo.com/q/op?s=^XSP+Options
>>
>> getOptionChain("^XSP", NULL)
>>
>> Error in from:to : NA/NaN argument
>>
>> I'VE FOUND THE BUG. ?But don't know how/where to submit it.
>>
>> Look carefully at the URLs used by yahoo.
>>
>> For a stock
>>
>> For an index
>>
>> Notice that with an index, the "+options" part is there. ?Try calling the
>> page without it and it fails. ?The current code in quantmod doesn't add
>> this.
>>
>> I think we just need add one line: ? ? ?Symbols <- paste(Symbols,
>> "+options", sep="")
>>
>> -N
>>
>>
>>
>>
>>
>>
>> On 11/15/10 7:03 PM, Cedrick Johnson wrote:
>>
>>> There are technically SPX cash optns. I am not in front of my comp to look
>>> them up but they do exist indeed. SPY and DIA options do exist for the
>>> ETF's....
>>>
>>> -c
>>> Sent from my BlackBerry?
>>>
>>> -----Original Message-----
>>> From: Marc Delvaux<mdelvaux at gmail.com>
>>> Sender: r-sig-finance-bounces at stat.math.ethz.ch
>>> Date: Mon, 15 Nov 2010 18:49:35
>>> To: Noah Silverman<noah at smartmediacorp.com>
>>> Reply-To: mdelvaux at gmail.com
>>> Cc:<r-sig-finance at stat.math.ethz.ch>
>>> Subject: Re: [R-SIG-Finance] But in quantmod function
>>>
>>> That is because there are no options on these specific tickers, as you can
>>> see by the grayed out "options" link on the corresponding yahoo page.
>>>
>>> For options on the S&P, you need to use "SPY", and "^DJX" for the DJIA.
>>>
>>> On Mon, Nov 15, 2010 at 5:06 PM, Noah Silverman<noah at smartmediacorp.com
>>> >wrote:
>>>
>>> ?Hi,
>>>>
>>>> I think I've found a bug in the quantmod library.
>>>>
>>>> The function "getOptionChain" fails when fetching the chain of an index
>>>> (S&P, DJIA, etc.)
>>>> (Note: ?It works beautifully for options on stocks.)
>>>>
>>>> chain<- getOptionChain("^GSPC", Exp=NULL)
>>>> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>>>>
>>>> chain<- getOptionChain("^RUT", Exp=NULL)
>>>> Error in from:to : NA/NaN argument
>>>>
>>>>
>>>> Any ideas?
>>>>
>>>> -N
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>> ? ? ? ? [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From noah at smartmediacorp.com  Tue Nov 16 05:17:54 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 15 Nov 2010 20:17:54 -0800
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <AANLkTikghPDCL=k3DTZrJjoZSpMfezdYzp9Hy1=uiaS9@mail.gmail.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
	<AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
	<4CE1FCB7.1070103@smartmediacorp.com>
	<AANLkTikghPDCL=k3DTZrJjoZSpMfezdYzp9Hy1=uiaS9@mail.gmail.com>
Message-ID: <4CE205F2.8030108@smartmediacorp.com>

Josh,

Responding in order of your comments:

1) Typo.  The symbol is "^XSP".  Regardless, it fails for options on any 
index.

2) I wasn't using a rude tone.  I am extremely appreciative and grateful 
for all the wonderful R people, code, and community.  I read through the 
code, tried a few things, and suggested a fix to the list.  Don't see 
how that's rude in any way.

3) I'm new to R, so don't know the proper protocol (or even how/where) 
to submit a patch.  That's why I asked the list.  Happy to contribute 
where I'm able, but need to know the proper way.

Thanks,

-N

On 11/15/10 8:05 PM, Joshua Ulrich wrote:
> Noah,
>
> On Mon, Nov 15, 2010 at 9:38 PM, Noah Silverman<noah at smartmediacorp.com>  wrote:
>> OK,
>>
>> Bad example.  But try it for the ticker "^RUT"  (Russel index)
>>
>> There ARE options:  http://finance.yahoo.com/q/op?s=^RUT+Options
>>
>> Also options for the S&P mini "^XAP"
>> http://finance.yahoo.com/q/op?s=^XSP+Options
>>
> Which is it "^XAP" or "^XSP"?
>
>> getOptionChain("^XSP", NULL)
>> Error in from:to : NA/NaN argument
>>
>> I'VE FOUND THE BUG.  But don't know how/where to submit it.
>>
>> Look carefully at the URLs used by yahoo.
>>
>> For a stock
>>
>> For an index
>>
> Submit bugs to the package maintainer, preferably with patches.  Using
> a rude tone doesn't improve the chances of someone helping you.
> Especially when *both* the software and the data are free.
>
>> Notice that with an index, the "+options" part is there.  Try calling the
>> page without it and it fails.  The current code in quantmod doesn't add
>> this.
>>
>> I think we just need add one line:      Symbols<- paste(Symbols,
>> "+options", sep="")
>>
> Why don't you try this, test it, and submit a patch?
>
>> -N
>>
>>
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>>
>>
>> On 11/15/10 7:03 PM, Cedrick Johnson wrote:
>>> There are technically SPX cash optns. I am not in front of my comp to look
>>> them up but they do exist indeed. SPY and DIA options do exist for the
>>> ETF's....
>>>
>>> -c
>>> Sent from my BlackBerry?
>>>
>>> -----Original Message-----
>>> From: Marc Delvaux<mdelvaux at gmail.com>
>>> Sender: r-sig-finance-bounces at stat.math.ethz.ch
>>> Date: Mon, 15 Nov 2010 18:49:35
>>> To: Noah Silverman<noah at smartmediacorp.com>
>>> Reply-To: mdelvaux at gmail.com
>>> Cc:<r-sig-finance at stat.math.ethz.ch>
>>> Subject: Re: [R-SIG-Finance] But in quantmod function
>>>
>>> That is because there are no options on these specific tickers, as you can
>>> see by the grayed out "options" link on the corresponding yahoo page.
>>>
>>> For options on the S&P, you need to use "SPY", and "^DJX" for the DJIA.
>>>
>>> On Mon, Nov 15, 2010 at 5:06 PM, Noah
>>> Silverman<noah at smartmediacorp.com>wrote:
>>>
>>>> Hi,
>>>>
>>>> I think I've found a bug in the quantmod library.
>>>>
>>>> The function "getOptionChain" fails when fetching the chain of an index
>>>> (S&P, DJIA, etc.)
>>>> (Note:  It works beautifully for options on stocks.)
>>>>
>>>> chain<- getOptionChain("^GSPC", Exp=NULL)
>>>> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>>>>
>>>> chain<- getOptionChain("^RUT", Exp=NULL)
>>>> Error in from:to : NA/NaN argument
>>>>
>>>>
>>>> Any ideas?
>>>>
>>>> -N
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>


From ustaudinger at gmail.com  Tue Nov 16 06:53:24 2010
From: ustaudinger at gmail.com (Ulrich Staudinger)
Date: Tue, 16 Nov 2010 06:53:24 +0100
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <4CE205F2.8030108@smartmediacorp.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
	<AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
	<4CE1FCB7.1070103@smartmediacorp.com>
	<AANLkTikghPDCL=k3DTZrJjoZSpMfezdYzp9Hy1=uiaS9@mail.gmail.com>
	<4CE205F2.8030108@smartmediacorp.com>
Message-ID: <AANLkTik3fPmaRGVS7Z2V9dQeNBJfJ9JFiV1dzT-OMqtT@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101116/769e8129/attachment.pl>

From breman.mark at gmail.com  Tue Nov 16 08:01:31 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Tue, 16 Nov 2010 08:01:31 +0100
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <AANLkTimgfUcVzsq95bBEOLPOghZQuSjd8wpxnL5JYQ5k@mail.gmail.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
	<AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
	<4CE1FCB7.1070103@smartmediacorp.com>
	<AANLkTi=dOG=bK-Rjdeew0GNOYaReHwb=xGbP8YMqZVLS@mail.gmail.com>
	<AANLkTimgfUcVzsq95bBEOLPOghZQuSjd8wpxnL5JYQ5k@mail.gmail.com>
Message-ID: <AANLkTinKzmv+LPSsmJma1S0MOmkcUBgOq6dw4s=WwVCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101116/1b5bbd9d/attachment.pl>

From jeff.a.ryan at gmail.com  Tue Nov 16 08:55:57 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 16 Nov 2010 01:55:57 -0600
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <4CE1D90E.5010506@smartmediacorp.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
Message-ID: <AANLkTin67dPfd0v=Ps6Y0y5roC-srxCWSzyaWUWHwhNp@mail.gmail.com>

Hi Noah,

An odd combo of bug and no information.  The bug is the translation of
^ to %5E on the HTML parsing.  The no information stems from the lack
of contract information for some symbols (^DJI has no options data
that I see on Yahoo: see http://finance.yahoo.com/q?s=^DJI ).

A patch had been committed on R-forge - which I managed to do about 30
minutes after your original email, just didn't get a chance to ping
back the list.

Revision 553 - (view) (download) (annotate) - [select for diffs]
Modified Tue Nov 16 02:19:36 2010 UTC (5 hours, 26 minutes ago) by jryan
File length: 2702 byte(s)
Diff to previous 548
o  getOptionChain(.yahoo) now handles leading ^ in
   yahoo symbology (e.g. ^RUT).  Thanks to Noah Silverman
   for the report
o  cleaned up missing docs for new bid/ask functionality

As far as reports/patches/ideas go, certainly email me directly or the
list (which is obviously quite happy to reply ;-) ) if/when you catch
something askew.  The power of OSS is the community interaction in my
opinion.

Thanks,
Jeff

-- 
Jeffrey Ryan ? ?| ? ?Founder ? ?| ? ?jeffrey.ryan at lemnica.com

www.lemnica.com


On Mon, Nov 15, 2010 at 7:06 PM, Noah Silverman <noah at smartmediacorp.com> wrote:
> Hi,
>
> I think I've found a bug in the quantmod library.
>
> The function "getOptionChain" fails when fetching the chain of an index
> (S&P, DJIA, etc.)
> (Note: ?It works beautifully for options on stocks.)
>
> chain <- getOptionChain("^GSPC", Exp=NULL)
> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>
> chain <- getOptionChain("^RUT", Exp=NULL)
> Error in from:to : NA/NaN argument
>
>
> Any ideas?
>
> -N
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeff.a.ryan at gmail.com


From jeff.a.ryan at gmail.com  Tue Nov 16 09:08:48 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 16 Nov 2010 02:08:48 -0600
Subject: [R-SIG-Finance] But in quantmod function
In-Reply-To: <AANLkTinKzmv+LPSsmJma1S0MOmkcUBgOq6dw4s=WwVCA@mail.gmail.com>
References: <4CE1D90E.5010506@smartmediacorp.com>
	<AANLkTiktM=AbeZu9t8NOm4zS0=vsbsLSDWcoZCeaZHTr@mail.gmail.com>
	<2041993552-1289876616-cardhu_decombobulator_blackberry.rim.net-896763684-@bda059.bisx.prod.on.blackberry>
	<4CE1FCB7.1070103@smartmediacorp.com>
	<AANLkTi=dOG=bK-Rjdeew0GNOYaReHwb=xGbP8YMqZVLS@mail.gmail.com>
	<AANLkTimgfUcVzsq95bBEOLPOghZQuSjd8wpxnL5JYQ5k@mail.gmail.com>
	<AANLkTinKzmv+LPSsmJma1S0MOmkcUBgOq6dw4s=WwVCA@mail.gmail.com>
Message-ID: <AANLkTi=Ezbi2msxXuNfkAw15DuaNtB7QX5df8r_Hb-kQ@mail.gmail.com>

Hi Mark/everyone,

On Tue, Nov 16, 2010 at 1:01 AM, Mark Breman <breman.mark at gmail.com> wrote:
> Hi everyone,
>
> Just a thought:
>
> Often these issues in quantmod arise when there is a change in the url at
> the yahoo site (or other data-provider) and quantmod is not updated yet,
> right?

Not all that often is the URL the only issue.  It usually is far more
complicated in terms of markup changes/and parsing logic than that.
That said,

>
> Would it be possible to expose the url quantmod is using for the scraping,
> so when someone discovers an url change it can be altered
> without modifications to the quantmod code.
>

Duncan Murdoch ironically also emailed me over the weekend to ask for
the same thing.  I am not entirely sure that it is going to help much,
but I am working on a more robust version of getSymbols that will
involve something like 'known hosts' and a caching mechanism that
would get updated/check on a regular basis.

Like I said, the URL changes that *fix* things are rare, but Yahoo
does seem to run a variety of servers that would make this approach
viable enough to bother coding.

Best,
Jeff

P.S. Another great place to have OSS R discussions aside from the list
is at R/Finance here in Chicago. In case the CFP missed anyone, we've
got a pretty amazing line-up of keynotes scheduled!  Conversations
over drinks (coffee or beer) are always quite powerful...

http://www.rinfinance.com/

Hoping to see you all in Chicago in April!

> Regards,
>
> -Mark-
>
> 2010/11/16 Joshua Ulrich <josh.m.ulrich at gmail.com>
>
>> Marc,
>>
>> On Mon, Nov 15, 2010 at 9:59 PM, Marc Delvaux <mdelvaux at gmail.com> wrote:
>> > Jeffrey Ryan is the main author and maintainer of quantmod (even if I
>> think
>> > Joshua Ulrich is working on the yahoo scraping code). ?Taping
>> help(quantmod)
>>
>> I haven't done anything with the options web-scraping code.
>>
>> > will give you that information (same as for any package). ?Quantmod is
>> > hosted on r-forge where you can find more information if needed
>> > https://r-forge.r-project.org/projects/quantmod/ And of course Jeffrey
>> is
>> > active on his mail list.
>> >
>> Actually, Jeff already patched the issue with symbols that start with
>> a carat. ?There may be other issues though...
>>
>> Best,
>> --
>> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>>
>>
>> > Author(s)
>> >
>> > Jeffrey A. Ryan
>> >
>> > Maintainer: Jeffrey A. Ryan <jeff.a.ryan at gmail.com>
>> >
>> >
>> > On Mon, Nov 15, 2010 at 7:38 PM, Noah Silverman <noah at smartmediacorp.com
>> >wrote:
>> >
>> >> OK,
>> >>
>> >> Bad example. ?But try it for the ticker "^RUT" ?(Russel index)
>> >>
>> >> There ARE options: ?http://finance.yahoo.com/q/op?s=^RUT+Options
>> >>
>> >> Also options for the S&P mini "^XAP"
>> >> http://finance.yahoo.com/q/op?s=^XSP+Options
>> >>
>> >> getOptionChain("^XSP", NULL)
>> >>
>> >> Error in from:to : NA/NaN argument
>> >>
>> >> I'VE FOUND THE BUG. ?But don't know how/where to submit it.
>> >>
>> >> Look carefully at the URLs used by yahoo.
>> >>
>> >> For a stock
>> >>
>> >> For an index
>> >>
>> >> Notice that with an index, the "+options" part is there. ?Try calling
>> the
>> >> page without it and it fails. ?The current code in quantmod doesn't add
>> >> this.
>> >>
>> >> I think we just need add one line: ? ? ?Symbols <- paste(Symbols,
>> >> "+options", sep="")
>> >>
>> >> -N
>> >>
>> >>
>> >>
>> >>
>> >>
>> >>
>> >> On 11/15/10 7:03 PM, Cedrick Johnson wrote:
>> >>
>> >>> There are technically SPX cash optns. I am not in front of my comp to
>> look
>> >>> them up but they do exist indeed. SPY and DIA options do exist for the
>> >>> ETF's....
>> >>>
>> >>> -c
>> >>> Sent from my BlackBerry?
>> >>>
>> >>> -----Original Message-----
>> >>> From: Marc Delvaux<mdelvaux at gmail.com>
>> >>> Sender: r-sig-finance-bounces at stat.math.ethz.ch
>> >>> Date: Mon, 15 Nov 2010 18:49:35
>> >>> To: Noah Silverman<noah at smartmediacorp.com>
>> >>> Reply-To: mdelvaux at gmail.com
>> >>> Cc:<r-sig-finance at stat.math.ethz.ch>
>> >>> Subject: Re: [R-SIG-Finance] But in quantmod function
>> >>>
>> >>> That is because there are no options on these specific tickers, as you
>> can
>> >>> see by the grayed out "options" link on the corresponding yahoo page.
>> >>>
>> >>> For options on the S&P, you need to use "SPY", and "^DJX" for the DJIA.
>> >>>
>> >>> On Mon, Nov 15, 2010 at 5:06 PM, Noah Silverman<
>> noah at smartmediacorp.com
>> >>> >wrote:
>> >>>
>> >>> ?Hi,
>> >>>>
>> >>>> I think I've found a bug in the quantmod library.
>> >>>>
>> >>>> The function "getOptionChain" fails when fetching the chain of an
>> index
>> >>>> (S&P, DJIA, etc.)
>> >>>> (Note: ?It works beautifully for options on stocks.)
>> >>>>
>> >>>> chain<- getOptionChain("^GSPC", Exp=NULL)
>> >>>> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>> >>>>
>> >>>> chain<- getOptionChain("^RUT", Exp=NULL)
>> >>>> Error in from:to : NA/NaN argument
>> >>>>
>> >>>>
>> >>>> Any ideas?
>> >>>>
>> >>>> -N
>> >>>>
>> >>>> _______________________________________________
>> >>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >>>> -- Subscriber-posting only. If you want to post, subscribe first.
>> >>>> -- Also note that this is not the r-help list where general R
>> questions
>> >>>> should go.
>> >>>>
>> >>>> ? ? ? ? [[alternative HTML version deleted]]
>> >>>
>> >>> _______________________________________________
>> >>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> >>> -- Subscriber-posting only. If you want to post, subscribe first.
>> >>> -- Also note that this is not the r-help list where general R questions
>> >>> should go.
>> >>>
>> >>
>> >>
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> >
>> > _______________________________________________
>> > R-SIG-Finance at stat.math.ethz.ch mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>> >
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan ? ?| ? ?Founder ? ?| ? ?jeffrey.ryan at lemnica.com

www.lemnica.com


From jeff.a.ryan at gmail.com  Tue Nov 16 11:22:39 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 16 Nov 2010 04:22:39 -0600
Subject: [R-SIG-Finance] How to install mgarchBEKK package
In-Reply-To: <565784.65409.qm@web63805.mail.re1.yahoo.com>
References: <565784.65409.qm@web63805.mail.re1.yahoo.com>
Message-ID: <AANLkTinzw1Bo5sDyL0p_X3P81+4=RT81OJV3vBfRXxOD@mail.gmail.com>

Hi Ron,

I have listed myself as "Maintainer" on the package, but note that is
only because it is abandoned and I am simply providing the patched to
work source and win binary for the community.

I don't use this package, and can't answer any questions about it.
This is truly AS IS.

New links here:

http://www.quantmod.com/download/mgarchBEKK/

Best,
Jeff

On Mon, Nov 15, 2010 at 8:27 PM, Ron Michael <ron_michael70 at yahoo.com> wrote:
> Hi, I wanted to doenload the mgarchBEKK package, however CRAN seems to not holding that. Only source that I found here "http://www.quantmod.com/download/mgarchBEKK/" with is in .gz format not .zip. As I am using R on my windows vista I need something in .zip format. Can somebody please tell me where to download it?
>
> Thanks,
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan ? ?| ? ?Founder ? ?| ? ?jeffrey.ryan at lemnica.com

www.lemnica.com


From noah at smartmediacorp.com  Tue Nov 16 19:16:29 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Tue, 16 Nov 2010 10:16:29 -0800
Subject: [R-SIG-Finance] Fwd: Re:  But in quantmod function
Message-ID: <4CE2CA7D.8070908@smartmediacorp.com>

Thanks Jeff for the quick patch. That's awesome!!!


How do I now update my R with the patch?  I've looked through r-forge
and CRAN.  They still seem to have the old version.

I downloaded the latest snapshot from SVM, but my R installation doesn't
recognize it as an installable package. (On a Mac)

Suggestions?

-N

On 11/16/10 12:08 AM, Jeff Ryan wrote:
> Hi Mark/everyone,
>
> On Tue, Nov 16, 2010 at 1:01 AM, Mark Breman <breman.mark at gmail.com> wrote:
>> Hi everyone,
>>
>> Just a thought:
>>
>> Often these issues in quantmod arise when there is a change in the url at
>> the yahoo site (or other data-provider) and quantmod is not updated yet,
>> right?
> Not all that often is the URL the only issue.  It usually is far more
> complicated in terms of markup changes/and parsing logic than that.
> That said,
>
>> Would it be possible to expose the url quantmod is using for the scraping,
>> so when someone discovers an url change it can be altered
>> without modifications to the quantmod code.
>>
> Duncan Murdoch ironically also emailed me over the weekend to ask for
> the same thing.  I am not entirely sure that it is going to help much,
> but I am working on a more robust version of getSymbols that will
> involve something like 'known hosts' and a caching mechanism that
> would get updated/check on a regular basis.
>
> Like I said, the URL changes that *fix* things are rare, but Yahoo
> does seem to run a variety of servers that would make this approach
> viable enough to bother coding.
>
> Best,
> Jeff
>
> P.S. Another great place to have OSS R discussions aside from the list
> is at R/Finance here in Chicago. In case the CFP missed anyone, we've
> got a pretty amazing line-up of keynotes scheduled!  Conversations
> over drinks (coffee or beer) are always quite powerful...
>
> http://www.rinfinance.com/
>
> Hoping to see you all in Chicago in April!
>
>> Regards,
>>
>> -Mark-
>>
>> 2010/11/16 Joshua Ulrich <josh.m.ulrich at gmail.com>
>>
>>> Marc,
>>>
>>> On Mon, Nov 15, 2010 at 9:59 PM, Marc Delvaux <mdelvaux at gmail.com> wrote:
>>>> Jeffrey Ryan is the main author and maintainer of quantmod (even if I
>>> think
>>>> Joshua Ulrich is working on the yahoo scraping code).  Taping
>>> help(quantmod)
>>>
>>> I haven't done anything with the options web-scraping code.
>>>
>>>> will give you that information (same as for any package).  Quantmod is
>>>> hosted on r-forge where you can find more information if needed
>>>> https://r-forge.r-project.org/projects/quantmod/ And of course Jeffrey
>>> is
>>>> active on his mail list.
>>>>
>>> Actually, Jeff already patched the issue with symbols that start with
>>> a carat.  There may be other issues though...
>>>
>>> Best,
>>> --
>>> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>>>
>>>
>>>> Author(s)
>>>>
>>>> Jeffrey A. Ryan
>>>>
>>>> Maintainer: Jeffrey A. Ryan <jeff.a.ryan at gmail.com>
>>>>
>>>>
>>>> On Mon, Nov 15, 2010 at 7:38 PM, Noah Silverman <noah at smartmediacorp.com
>>>> wrote:
>>>>
>>>>> OK,
>>>>>
>>>>> Bad example.  But try it for the ticker "^RUT"  (Russel index)
>>>>>
>>>>> There ARE options:  http://finance.yahoo.com/q/op?s=^RUT+Options
>>>>>
>>>>> Also options for the S&P mini "^XAP"
>>>>> http://finance.yahoo.com/q/op?s=^XSP+Options
>>>>>
>>>>> getOptionChain("^XSP", NULL)
>>>>>
>>>>> Error in from:to : NA/NaN argument
>>>>>
>>>>> I'VE FOUND THE BUG.  But don't know how/where to submit it.
>>>>>
>>>>> Look carefully at the URLs used by yahoo.
>>>>>
>>>>> For a stock
>>>>>
>>>>> For an index
>>>>>
>>>>> Notice that with an index, the "+options" part is there.  Try calling
>>> the
>>>>> page without it and it fails.  The current code in quantmod doesn't add
>>>>> this.
>>>>>
>>>>> I think we just need add one line:      Symbols <- paste(Symbols,
>>>>> "+options", sep="")
>>>>>
>>>>> -N
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On 11/15/10 7:03 PM, Cedrick Johnson wrote:
>>>>>
>>>>>> There are technically SPX cash optns. I am not in front of my comp to
>>> look
>>>>>> them up but they do exist indeed. SPY and DIA options do exist for the
>>>>>> ETF's....
>>>>>>
>>>>>> -c
>>>>>> Sent from my BlackBerry?
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: Marc Delvaux<mdelvaux at gmail.com>
>>>>>> Sender: r-sig-finance-bounces at stat.math.ethz.ch
>>>>>> Date: Mon, 15 Nov 2010 18:49:35
>>>>>> To: Noah Silverman<noah at smartmediacorp.com>
>>>>>> Reply-To: mdelvaux at gmail.com
>>>>>> Cc:<r-sig-finance at stat.math.ethz.ch>
>>>>>> Subject: Re: [R-SIG-Finance] But in quantmod function
>>>>>>
>>>>>> That is because there are no options on these specific tickers, as you
>>> can
>>>>>> see by the grayed out "options" link on the corresponding yahoo page.
>>>>>>
>>>>>> For options on the S&P, you need to use "SPY", and "^DJX" for the DJIA.
>>>>>>
>>>>>> On Mon, Nov 15, 2010 at 5:06 PM, Noah Silverman<
>>> noah at smartmediacorp.com
>>>>>>> wrote:
>>>>>>  Hi,
>>>>>>> I think I've found a bug in the quantmod library.
>>>>>>>
>>>>>>> The function "getOptionChain" fails when fetching the chain of an
>>> index
>>>>>>> (S&P, DJIA, etc.)
>>>>>>> (Note:  It works beautifully for options on stocks.)
>>>>>>>
>>>>>>> chain<- getOptionChain("^GSPC", Exp=NULL)
>>>>>>> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>>>>>>>
>>>>>>> chain<- getOptionChain("^RUT", Exp=NULL)
>>>>>>> Error in from:to : NA/NaN argument
>>>>>>>
>>>>>>>
>>>>>>> Any ideas?
>>>>>>>
>>>>>>> -N
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>>> -- Also note that this is not the r-help list where general R
>>> questions
>>>>>>> should go.
>>>>>>>
>>>>>>>         [[alternative HTML version deleted]]
>>>>>> _______________________________________________
>>>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>> -- Also note that this is not the r-help list where general R questions
>>>>>> should go.
>>>>>>
>>>>>
>>>>        [[alternative HTML version deleted]]
>>>>
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>        [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>
>


From jeff.a.ryan at gmail.com  Tue Nov 16 19:22:35 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 16 Nov 2010 12:22:35 -0600
Subject: [R-SIG-Finance] Fwd: Re: But in quantmod function
In-Reply-To: <4CE2CA7D.8070908@smartmediacorp.com>
References: <4CE2CA7D.8070908@smartmediacorp.com>
Message-ID: <AANLkTik6gWCMO32nwjPCPKqQ2EqDRLdWvcRm2iWH9Jh6@mail.gmail.com>

Hi Noah,

You'll either need to have the build tools installed on your mac
(including OSX dev tools and some TeX suite), or wait for the binaries
to be built (once a day for R-forge I think...)

I'll try and send you a Mac binary later today as well.

Best,
Jeff

On Tue, Nov 16, 2010 at 12:16 PM, Noah Silverman
<noah at smartmediacorp.com> wrote:
> Thanks Jeff for the quick patch. That's awesome!!!
>
>
> How do I now update my R with the patch? ?I've looked through r-forge
> and CRAN. ?They still seem to have the old version.
>
> I downloaded the latest snapshot from SVM, but my R installation doesn't
> recognize it as an installable package. (On a Mac)
>
> Suggestions?
>
> -N
>
> On 11/16/10 12:08 AM, Jeff Ryan wrote:
>> Hi Mark/everyone,
>>
>> On Tue, Nov 16, 2010 at 1:01 AM, Mark Breman <breman.mark at gmail.com> wrote:
>>> Hi everyone,
>>>
>>> Just a thought:
>>>
>>> Often these issues in quantmod arise when there is a change in the url at
>>> the yahoo site (or other data-provider) and quantmod is not updated yet,
>>> right?
>> Not all that often is the URL the only issue. ?It usually is far more
>> complicated in terms of markup changes/and parsing logic than that.
>> That said,
>>
>>> Would it be possible to expose the url quantmod is using for the scraping,
>>> so when someone discovers an url change it can be altered
>>> without modifications to the quantmod code.
>>>
>> Duncan Murdoch ironically also emailed me over the weekend to ask for
>> the same thing. ?I am not entirely sure that it is going to help much,
>> but I am working on a more robust version of getSymbols that will
>> involve something like 'known hosts' and a caching mechanism that
>> would get updated/check on a regular basis.
>>
>> Like I said, the URL changes that *fix* things are rare, but Yahoo
>> does seem to run a variety of servers that would make this approach
>> viable enough to bother coding.
>>
>> Best,
>> Jeff
>>
>> P.S. Another great place to have OSS R discussions aside from the list
>> is at R/Finance here in Chicago. In case the CFP missed anyone, we've
>> got a pretty amazing line-up of keynotes scheduled! ?Conversations
>> over drinks (coffee or beer) are always quite powerful...
>>
>> http://www.rinfinance.com/
>>
>> Hoping to see you all in Chicago in April!
>>
>>> Regards,
>>>
>>> -Mark-
>>>
>>> 2010/11/16 Joshua Ulrich <josh.m.ulrich at gmail.com>
>>>
>>>> Marc,
>>>>
>>>> On Mon, Nov 15, 2010 at 9:59 PM, Marc Delvaux <mdelvaux at gmail.com> wrote:
>>>>> Jeffrey Ryan is the main author and maintainer of quantmod (even if I
>>>> think
>>>>> Joshua Ulrich is working on the yahoo scraping code). ?Taping
>>>> help(quantmod)
>>>>
>>>> I haven't done anything with the options web-scraping code.
>>>>
>>>>> will give you that information (same as for any package). ?Quantmod is
>>>>> hosted on r-forge where you can find more information if needed
>>>>> https://r-forge.r-project.org/projects/quantmod/ And of course Jeffrey
>>>> is
>>>>> active on his mail list.
>>>>>
>>>> Actually, Jeff already patched the issue with symbols that start with
>>>> a carat. ?There may be other issues though...
>>>>
>>>> Best,
>>>> --
>>>> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>>>>
>>>>
>>>>> Author(s)
>>>>>
>>>>> Jeffrey A. Ryan
>>>>>
>>>>> Maintainer: Jeffrey A. Ryan <jeff.a.ryan at gmail.com>
>>>>>
>>>>>
>>>>> On Mon, Nov 15, 2010 at 7:38 PM, Noah Silverman <noah at smartmediacorp.com
>>>>> wrote:
>>>>>
>>>>>> OK,
>>>>>>
>>>>>> Bad example. ?But try it for the ticker "^RUT" ?(Russel index)
>>>>>>
>>>>>> There ARE options: ?http://finance.yahoo.com/q/op?s=^RUT+Options
>>>>>>
>>>>>> Also options for the S&P mini "^XAP"
>>>>>> http://finance.yahoo.com/q/op?s=^XSP+Options
>>>>>>
>>>>>> getOptionChain("^XSP", NULL)
>>>>>>
>>>>>> Error in from:to : NA/NaN argument
>>>>>>
>>>>>> I'VE FOUND THE BUG. ?But don't know how/where to submit it.
>>>>>>
>>>>>> Look carefully at the URLs used by yahoo.
>>>>>>
>>>>>> For a stock
>>>>>>
>>>>>> For an index
>>>>>>
>>>>>> Notice that with an index, the "+options" part is there. ?Try calling
>>>> the
>>>>>> page without it and it fails. ?The current code in quantmod doesn't add
>>>>>> this.
>>>>>>
>>>>>> I think we just need add one line: ? ? ?Symbols <- paste(Symbols,
>>>>>> "+options", sep="")
>>>>>>
>>>>>> -N
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> On 11/15/10 7:03 PM, Cedrick Johnson wrote:
>>>>>>
>>>>>>> There are technically SPX cash optns. I am not in front of my comp to
>>>> look
>>>>>>> them up but they do exist indeed. SPY and DIA options do exist for the
>>>>>>> ETF's....
>>>>>>>
>>>>>>> -c
>>>>>>> Sent from my BlackBerry?
>>>>>>>
>>>>>>> -----Original Message-----
>>>>>>> From: Marc Delvaux<mdelvaux at gmail.com>
>>>>>>> Sender: r-sig-finance-bounces at stat.math.ethz.ch
>>>>>>> Date: Mon, 15 Nov 2010 18:49:35
>>>>>>> To: Noah Silverman<noah at smartmediacorp.com>
>>>>>>> Reply-To: mdelvaux at gmail.com
>>>>>>> Cc:<r-sig-finance at stat.math.ethz.ch>
>>>>>>> Subject: Re: [R-SIG-Finance] But in quantmod function
>>>>>>>
>>>>>>> That is because there are no options on these specific tickers, as you
>>>> can
>>>>>>> see by the grayed out "options" link on the corresponding yahoo page.
>>>>>>>
>>>>>>> For options on the S&P, you need to use "SPY", and "^DJX" for the DJIA.
>>>>>>>
>>>>>>> On Mon, Nov 15, 2010 at 5:06 PM, Noah Silverman<
>>>> noah at smartmediacorp.com
>>>>>>>> wrote:
>>>>>>> ?Hi,
>>>>>>>> I think I've found a bug in the quantmod library.
>>>>>>>>
>>>>>>>> The function "getOptionChain" fails when fetching the chain of an
>>>> index
>>>>>>>> (S&P, DJIA, etc.)
>>>>>>>> (Note: ?It works beautifully for options on stocks.)
>>>>>>>>
>>>>>>>> chain<- getOptionChain("^GSPC", Exp=NULL)
>>>>>>>> Error in strsplit(opt, "<tr.*?>")[[1]] : subscript out of bounds
>>>>>>>>
>>>>>>>> chain<- getOptionChain("^RUT", Exp=NULL)
>>>>>>>> Error in from:to : NA/NaN argument
>>>>>>>>
>>>>>>>>
>>>>>>>> Any ideas?
>>>>>>>>
>>>>>>>> -N
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>>>> -- Also note that this is not the r-help list where general R
>>>> questions
>>>>>>>> should go.
>>>>>>>>
>>>>>>>> ? ? ? ? [[alternative HTML version deleted]]
>>>>>>> _______________________________________________
>>>>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>>> -- Also note that this is not the r-help list where general R questions
>>>>>>> should go.
>>>>>>>
>>>>>>
>>>>> ? ? ? ?[[alternative HTML version deleted]]
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>> _______________________________________________
>>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>>
>>
>>
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Jeffrey Ryan ? ?| ? ?Founder ? ?| ? ?jeffrey.ryan at lemnica.com

www.lemnica.com


From Jose at erini.ac.uk  Wed Nov 17 00:00:02 2010
From: Jose at erini.ac.uk (Jose Iparraguirre D'Elia)
Date: Tue, 16 Nov 2010 23:00:02 -0000
Subject: [R-SIG-Finance] VARHAC Covariance Matrix Estimator
Message-ID: <C9328F0EEDC3BC439FDABD12060E91090E2EA9@erini1.ERINI.local>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101116/5f2c986a/attachment.pl>

From matthieu.stigler at gmail.com  Wed Nov 17 09:40:43 2010
From: matthieu.stigler at gmail.com (Matthieu Stigler)
Date: Wed, 17 Nov 2010 09:40:43 +0100
Subject: [R-SIG-Finance] VARHAC Covariance Matrix Estimator
In-Reply-To: <C9328F0EEDC3BC439FDABD12060E91090E2EA9@erini1.ERINI.local>
References: <C9328F0EEDC3BC439FDABD12060E91090E2EA9@erini1.ERINI.local>
Message-ID: <4CE3950B.1030607@gmail.com>

Dear Jose

I am not sure this specific HC has been implemented. On the other side, 
there is a really nice package "sandwich" that offers a high flexibility 
for those HC/HAC covariance estimators, and which is very well 
documented, so it should not be too much an effort to implement it with 
the package:
http://www.jstatsoft.org/v11/i10
http://stat.ethz.ch/CRAN/web/packages/sandwich/index.html

Best

Matthieu


Le 17. 11. 10 00:00, Jose Iparraguirre D'Elia a ?crit :
> Does anyone know if the VARHAC covariance matrix estimator by Den Haan and Levin (1994) has been implemented in R?
> I could only find routines for RATS and GAUSS in Den Haan's website.
> Regards,
>
> Jose
>
> Jose Iparraguirre
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From daniel.probst at web.de  Thu Nov 18 18:54:58 2010
From: daniel.probst at web.de (Daniel Probst)
Date: Thu, 18 Nov 2010 18:54:58 +0100 (CET)
Subject: [R-SIG-Finance] Quantmod problem: calling Charts from function
Message-ID: <508544538.2538120.1290102898247.JavaMail.fmail@mwmweb022>

Hello,

I get different behaviour calling candleChart directly versus calling it in a function: only one of multiple technical analyses is plotted.

Example:
#####################################
library(quantmod)
getSymbols("AAPL",src="yahoo")?
# WORKS
candleChart(AAPL,multi.col=TRUE,theme="white")
addBBands()
addMACD()
addMACD()
# Doesn't work
test<- function(x) {
	candleChart(x,multi.col=TRUE,theme="white")
 	addBBands()
	addMACD()
	addMACD()
}
test(AAPL)
# only shows first MACD not 2nd unlike in direct call
###########################

Any pointers where the different behaviour comes from?
Many thanks
Daniel Probst
___________________________________________________________
Neu: WEB.DE De-Mail - Einfach wie E-Mail, sicher wie ein Brief!  
Jetzt De-Mail-Adresse reservieren: https://produkte.web.de/go/demail02


From breman.mark at gmail.com  Thu Nov 18 19:06:07 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 18 Nov 2010 19:06:07 +0100
Subject: [R-SIG-Finance] Quantmod problem: calling Charts from function
In-Reply-To: <508544538.2538120.1290102898247.JavaMail.fmail@mwmweb022>
References: <508544538.2538120.1290102898247.JavaMail.fmail@mwmweb022>
Message-ID: <AANLkTinq72Xi6U+a+8Q9=Utj5J_SnbVh-d-tVT0pz5pH@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101118/02593e4b/attachment.pl>

From jeff.a.ryan at gmail.com  Thu Nov 18 19:12:27 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Thu, 18 Nov 2010 12:12:27 -0600
Subject: [R-SIG-Finance] Quantmod problem: calling Charts from function
In-Reply-To: <508544538.2538120.1290102898247.JavaMail.fmail@mwmweb022>
References: <508544538.2538120.1290102898247.JavaMail.fmail@mwmweb022>
Message-ID: <432F68EA-4C14-4DDC-80DC-71C5EA073ED3@gmail.com>

This has been addressed quite a few times on the list and in the docs. 

Given the desire for interactive additions of TA etc, the object is plotted automatically via plot via print. 

Simply wrap you TA calls with plot and that should do the trick. 

Alternately you can add the args as a character string to the TA param of chartSeries. 

The newest quantmod on CRAN has a new function for plotting called chart_Series which may be of interest to try out. It will be to chartSeries what ggplot2 is to ggplot. i.e. a new and improved version, albeit sans the addition of the numbering confusion. It will eventually migrate to chartSeries proper. 

Best,
Jeff





On Nov 18, 2010, at 11:54 AM, "Daniel Probst" <daniel.probst at web.de> wrote:

> Hello,
> 
> I get different behaviour calling candleChart directly versus calling it in a function: only one of multiple technical analyses is plotted.
> 
> Example:
> #####################################
> library(quantmod)
> getSymbols("AAPL",src="yahoo") 
> # WORKS
> candleChart(AAPL,multi.col=TRUE,theme="white")
> addBBands()
> addMACD()
> addMACD()
> # Doesn't work
> test<- function(x) {
>    candleChart(x,multi.col=TRUE,theme="white")
>    addBBands()
>    addMACD()
>    addMACD()
> }
> test(AAPL)
> # only shows first MACD not 2nd unlike in direct call
> ###########################
> 
> Any pointers where the different behaviour comes from?
> Many thanks
> Daniel Probst
> ___________________________________________________________
> Neu: WEB.DE De-Mail - Einfach wie E-Mail, sicher wie ein Brief!  
> Jetzt De-Mail-Adresse reservieren: https://produkte.web.de/go/demail02
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jaykwok at gmail.com  Thu Nov 18 22:01:49 2010
From: jaykwok at gmail.com (Jason Kwok)
Date: Thu, 18 Nov 2010 16:01:49 -0500
Subject: [R-SIG-Finance] Export Data from R
Message-ID: <AANLkTimUBMRLUK23RH=pQi-G_QXc68VqF40GersBeNCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101118/a588e887/attachment.pl>

From jaykwok at gmail.com  Fri Nov 19 01:19:54 2010
From: jaykwok at gmail.com (Jason Kwok)
Date: Thu, 18 Nov 2010 19:19:54 -0500
Subject: [R-SIG-Finance] Export Data from R
In-Reply-To: <4CE5AA43.30506@organicfoodmarkets.com.au>
References: <AANLkTimUBMRLUK23RH=pQi-G_QXc68VqF40GersBeNCA@mail.gmail.com>
	<4CE5AA43.30506@organicfoodmarkets.com.au>
Message-ID: <AANLkTik2jCrSCPL=LrOiK1JANKidxUwyOge3qnNGDgur@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101118/c243c488/attachment.pl>

From stephen at organicfoodmarkets.com.au  Mon Nov 22 01:54:13 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Mon, 22 Nov 2010 11:54:13 +1100
Subject: [R-SIG-Finance] problem with ibrokers
Message-ID: <4CE9BF35.4040200@organicfoodmarkets.com.au>

Hi

I am trying to get to grips with iBrokers and my first problem is that 
it isn't flowing.

When I try this:

tws <- twsConnect()
 > reqMktData(tws, twsEquity("CBA", exch='ASX'))

The screen hangs.  When I then hit Esc it produces the following:

TWS Message: 2 -1 2104 Market data farm connection is OK:cashfarm
TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
<20101122 11:47:30.688000> id=1 symbol=CBA Volume: 493943
<20101122 11:47:30.688000> id=1 symbol=CBA highPrice: 49.14
<20101122 11:47:30.688000> id=1 symbol=CBA lowPrice: 48.85
<20101122 11:47:30.688000> id=1 symbol=CBA lastTimestamp: 1290385178
<20101122 11:47:31.188000> id=1 symbol=CBA bidPrice: 48.99  bidSize: 774
<20101122 11:47:31.188000> id=1 symbol=CBA askPrice: 49.0  askSize: 11097
<20101122 11:47:31.188000> id=1 symbol=CBA bidSize: 774
<20101122 11:47:31.188000> id=1 symbol=CBA askSize: 11097
<20101122 11:47:31.204000> id=1 symbol=CBA lastPrice: 49.0
<20101122 11:47:31.204000> id=1 symbol=CBA lastSize: 165
<20101122 11:47:31.204000> id=1 symbol=CBA lastTimestamp: 1290386848
<20101122 11:47:31.204000> id=1 symbol=CBA Volume: 680921
<20101122 11:47:31.204000> id=1 symbol=CBA highPrice: 49.14
<20101122 11:47:31.204000> id=1 symbol=CBA lowPrice: 48.85
<20101122 11:47:31.204000> id=1 symbol=CBA closePrice: 48.81
<20101122 11:47:31.204000> id=1 symbol=CBA openPrice: 49.05
<20101122 11:47:31.922000> id=1 symbol=CBA optionCallVolume: 337
<20101122 11:47:31.922000> id=1 symbol=CBA optionPutVolume: 255
<20101122 11:47:31.922000> id=1 symbol=CBA optionCallOpenInterest: 25123
<20101122 11:47:31.922000> id=1 symbol=CBA optionPutOpenInterest: 43334
<20101122 11:47:31.922000> id=1 symbol=CBA optionHistoricalVol: 
0.18604764474327537 NA
<20101122 11:47:31.922000> id=1 symbol=CBA averageVolume: 5190909
<20101122 11:47:31.922000> id=1 symbol=CBA 13-week High: 54.15000153
<20101122 11:47:31.922000> id=1 symbol=CBA 13-week Low: 47.91999817
<20101122 11:47:31.922000> id=1 symbol=CBA 26-week High: 54.15000153
<20101122 11:47:31.922000> id=1 symbol=CBA 26-week Low: 44.62139893
<20101122 11:47:31.922000> id=1 symbol=CBA 52-week High: 57.57139969
<20101122 11:47:31.922000> id=1 symbol=CBA 52-week Low: 44.62139893
<20101122 11:47:31.922000> id=1 symbol=CBA shortable: 1.0
<20101122 11:47:33.891000> id=1 symbol=CBA bidPrice: 48.99  bidSize: 767
<20101122 11:47:33.891000> id=1 symbol=CBA askPrice: 49.0  askSize: 11090
<20101122 11:47:33.891000> id=1 symbol=CBA bidSize: 767
<20101122 11:47:33.891000> id=1 symbol=CBA askSize: 11090
<20101122 11:47:33.891000> id=1 symbol=CBA lastPrice: 49.0
<20101122 11:47:33.891000> id=1 symbol=CBA lastSize: 7
<20101122 11:47:33.891000> id=1 symbol=CBA lastTimestamp: 1290386852
<20101122 11:47:33.891000> id=1 symbol=CBA Volume: 680928
<20101122 11:47:33.891000> id=1 symbol=CBA highPrice: 49.14
<20101122 11:47:33.891000> id=1 symbol=CBA lowPrice: 48.85
<20101122 11:47:33.891000> id=1 symbol=CBA closePrice: 48.81

 >

The example in Jeff' presentation at Meielisalp seems to imply the data 
should just print to screen.  Can anyone help me with this?



-- 
Stephen Choularton Ph.D., FIoD


From jeff.a.ryan at gmail.com  Mon Nov 22 02:22:47 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sun, 21 Nov 2010 19:22:47 -0600
Subject: [R-SIG-Finance] problem with ibrokers
In-Reply-To: <4CE9BF35.4040200@organicfoodmarkets.com.au>
References: <4CE9BF35.4040200@organicfoodmarkets.com.au>
Message-ID: <5054C8E5-1F50-4358-ACA3-3FF9CD46679E@gmail.com>

Hi Stephen,

Though you didn't give your sessionInfo() output, I can infer you're on Windows. 

You need to change one of the menu options in the GUI to turn off buffering of output.  Nothing to do with IBrokers, just basic R behavior (on Windows). 

Jeff

Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Nov 21, 2010, at 6:54 PM, Stephen Choularton <stephen at organicfoodmarkets.com.au> wrote:

> Hi
> 
> I am trying to get to grips with iBrokers and my first problem is that it isn't flowing.
> 
> When I try this:
> 
> tws <- twsConnect()
> > reqMktData(tws, twsEquity("CBA", exch='ASX'))
> 
> The screen hangs.  When I then hit Esc it produces the following:
> 
> TWS Message: 2 -1 2104 Market data farm connection is OK:cashfarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
> <20101122 11:47:30.688000> id=1 symbol=CBA Volume: 493943
> <20101122 11:47:30.688000> id=1 symbol=CBA highPrice: 49.14
> <20101122 11:47:30.688000> id=1 symbol=CBA lowPrice: 48.85
> <20101122 11:47:30.688000> id=1 symbol=CBA lastTimestamp: 1290385178
> <20101122 11:47:31.188000> id=1 symbol=CBA bidPrice: 48.99  bidSize: 774
> <20101122 11:47:31.188000> id=1 symbol=CBA askPrice: 49.0  askSize: 11097
> <20101122 11:47:31.188000> id=1 symbol=CBA bidSize: 774
> <20101122 11:47:31.188000> id=1 symbol=CBA askSize: 11097
> <20101122 11:47:31.204000> id=1 symbol=CBA lastPrice: 49.0
> <20101122 11:47:31.204000> id=1 symbol=CBA lastSize: 165
> <20101122 11:47:31.204000> id=1 symbol=CBA lastTimestamp: 1290386848
> <20101122 11:47:31.204000> id=1 symbol=CBA Volume: 680921
> <20101122 11:47:31.204000> id=1 symbol=CBA highPrice: 49.14
> <20101122 11:47:31.204000> id=1 symbol=CBA lowPrice: 48.85
> <20101122 11:47:31.204000> id=1 symbol=CBA closePrice: 48.81
> <20101122 11:47:31.204000> id=1 symbol=CBA openPrice: 49.05
> <20101122 11:47:31.922000> id=1 symbol=CBA optionCallVolume: 337
> <20101122 11:47:31.922000> id=1 symbol=CBA optionPutVolume: 255
> <20101122 11:47:31.922000> id=1 symbol=CBA optionCallOpenInterest: 25123
> <20101122 11:47:31.922000> id=1 symbol=CBA optionPutOpenInterest: 43334
> <20101122 11:47:31.922000> id=1 symbol=CBA optionHistoricalVol: 0.18604764474327537 NA
> <20101122 11:47:31.922000> id=1 symbol=CBA averageVolume: 5190909
> <20101122 11:47:31.922000> id=1 symbol=CBA 13-week High: 54.15000153
> <20101122 11:47:31.922000> id=1 symbol=CBA 13-week Low: 47.91999817
> <20101122 11:47:31.922000> id=1 symbol=CBA 26-week High: 54.15000153
> <20101122 11:47:31.922000> id=1 symbol=CBA 26-week Low: 44.62139893
> <20101122 11:47:31.922000> id=1 symbol=CBA 52-week High: 57.57139969
> <20101122 11:47:31.922000> id=1 symbol=CBA 52-week Low: 44.62139893
> <20101122 11:47:31.922000> id=1 symbol=CBA shortable: 1.0
> <20101122 11:47:33.891000> id=1 symbol=CBA bidPrice: 48.99  bidSize: 767
> <20101122 11:47:33.891000> id=1 symbol=CBA askPrice: 49.0  askSize: 11090
> <20101122 11:47:33.891000> id=1 symbol=CBA bidSize: 767
> <20101122 11:47:33.891000> id=1 symbol=CBA askSize: 11090
> <20101122 11:47:33.891000> id=1 symbol=CBA lastPrice: 49.0
> <20101122 11:47:33.891000> id=1 symbol=CBA lastSize: 7
> <20101122 11:47:33.891000> id=1 symbol=CBA lastTimestamp: 1290386852
> <20101122 11:47:33.891000> id=1 symbol=CBA Volume: 680928
> <20101122 11:47:33.891000> id=1 symbol=CBA highPrice: 49.14
> <20101122 11:47:33.891000> id=1 symbol=CBA lowPrice: 48.85
> <20101122 11:47:33.891000> id=1 symbol=CBA closePrice: 48.81
> 
> >
> 
> The example in Jeff' presentation at Meielisalp seems to imply the data should just print to screen.  Can anyone help me with this?
> 
> 
> 
> -- 
> Stephen Choularton Ph.D., FIoD
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jeff.a.ryan at gmail.com  Mon Nov 22 02:28:59 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sun, 21 Nov 2010 19:28:59 -0600
Subject: [R-SIG-Finance] problem with ibrokers
In-Reply-To: <4CE9BF35.4040200@organicfoodmarkets.com.au>
References: <4CE9BF35.4040200@organicfoodmarkets.com.au>
Message-ID: <62D28266-6233-41F5-8A66-8445C892E7DF@gmail.com>

One additional point -- IBrokers captures streaming data and as R is not threaded it will by necessity look like it hangs. 

It is in fact running in an infinite loop - one which you can embed your trade logic. For all streaming data you'll need to ESC (Windows) or C-c (*nix) to break and return to the prompt. 

Best,
Jeff

Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Nov 21, 2010, at 6:54 PM, Stephen Choularton <stephen at organicfoodmarkets.com.au> wrote:

> Hi
> 
> I am trying to get to grips with iBrokers and my first problem is that it isn't flowing.
> 
> When I try this:
> 
> tws <- twsConnect()
> > reqMktData(tws, twsEquity("CBA", exch='ASX'))
> 
> The screen hangs.  When I then hit Esc it produces the following:
> 
> TWS Message: 2 -1 2104 Market data farm connection is OK:cashfarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
> <20101122 11:47:30.688000> id=1 symbol=CBA Volume: 493943
> <20101122 11:47:30.688000> id=1 symbol=CBA highPrice: 49.14
> <20101122 11:47:30.688000> id=1 symbol=CBA lowPrice: 48.85
> <20101122 11:47:30.688000> id=1 symbol=CBA lastTimestamp: 1290385178
> <20101122 11:47:31.188000> id=1 symbol=CBA bidPrice: 48.99  bidSize: 774
> <20101122 11:47:31.188000> id=1 symbol=CBA askPrice: 49.0  askSize: 11097
> <20101122 11:47:31.188000> id=1 symbol=CBA bidSize: 774
> <20101122 11:47:31.188000> id=1 symbol=CBA askSize: 11097
> <20101122 11:47:31.204000> id=1 symbol=CBA lastPrice: 49.0
> <20101122 11:47:31.204000> id=1 symbol=CBA lastSize: 165
> <20101122 11:47:31.204000> id=1 symbol=CBA lastTimestamp: 1290386848
> <20101122 11:47:31.204000> id=1 symbol=CBA Volume: 680921
> <20101122 11:47:31.204000> id=1 symbol=CBA highPrice: 49.14
> <20101122 11:47:31.204000> id=1 symbol=CBA lowPrice: 48.85
> <20101122 11:47:31.204000> id=1 symbol=CBA closePrice: 48.81
> <20101122 11:47:31.204000> id=1 symbol=CBA openPrice: 49.05
> <20101122 11:47:31.922000> id=1 symbol=CBA optionCallVolume: 337
> <20101122 11:47:31.922000> id=1 symbol=CBA optionPutVolume: 255
> <20101122 11:47:31.922000> id=1 symbol=CBA optionCallOpenInterest: 25123
> <20101122 11:47:31.922000> id=1 symbol=CBA optionPutOpenInterest: 43334
> <20101122 11:47:31.922000> id=1 symbol=CBA optionHistoricalVol: 0.18604764474327537 NA
> <20101122 11:47:31.922000> id=1 symbol=CBA averageVolume: 5190909
> <20101122 11:47:31.922000> id=1 symbol=CBA 13-week High: 54.15000153
> <20101122 11:47:31.922000> id=1 symbol=CBA 13-week Low: 47.91999817
> <20101122 11:47:31.922000> id=1 symbol=CBA 26-week High: 54.15000153
> <20101122 11:47:31.922000> id=1 symbol=CBA 26-week Low: 44.62139893
> <20101122 11:47:31.922000> id=1 symbol=CBA 52-week High: 57.57139969
> <20101122 11:47:31.922000> id=1 symbol=CBA 52-week Low: 44.62139893
> <20101122 11:47:31.922000> id=1 symbol=CBA shortable: 1.0
> <20101122 11:47:33.891000> id=1 symbol=CBA bidPrice: 48.99  bidSize: 767
> <20101122 11:47:33.891000> id=1 symbol=CBA askPrice: 49.0  askSize: 11090
> <20101122 11:47:33.891000> id=1 symbol=CBA bidSize: 767
> <20101122 11:47:33.891000> id=1 symbol=CBA askSize: 11090
> <20101122 11:47:33.891000> id=1 symbol=CBA lastPrice: 49.0
> <20101122 11:47:33.891000> id=1 symbol=CBA lastSize: 7
> <20101122 11:47:33.891000> id=1 symbol=CBA lastTimestamp: 1290386852
> <20101122 11:47:33.891000> id=1 symbol=CBA Volume: 680928
> <20101122 11:47:33.891000> id=1 symbol=CBA highPrice: 49.14
> <20101122 11:47:33.891000> id=1 symbol=CBA lowPrice: 48.85
> <20101122 11:47:33.891000> id=1 symbol=CBA closePrice: 48.81
> 
> >
> 
> The example in Jeff' presentation at Meielisalp seems to imply the data should just print to screen.  Can anyone help me with this?
> 
> 
> 
> -- 
> Stephen Choularton Ph.D., FIoD
> 
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From dupuy.dangeac at free.fr  Tue Nov 23 12:31:32 2010
From: dupuy.dangeac at free.fr (burcy)
Date: Tue, 23 Nov 2010 03:31:32 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1289208688226-3031671.post@n4.nabble.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289208688226-3031671.post@n4.nabble.com>
Message-ID: <1290511892635-3055244.post@n4.nabble.com>


Brian

my wish is to use the two packages blotter+xts together (of course) , but as
I understand ,you are working on .
last xts version(0.7-6.11) is not available for Windows ,and I am unable to
do that myself ;I need only an old version of Blotter(7.?) which could be
used with xts( 0.7-5),the last release compatible with windows (7)

Is it possible ?

burcy
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3055244.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From goldsmithrb at googlemail.com  Tue Nov 23 12:35:47 2010
From: goldsmithrb at googlemail.com (Robert Goldsmith)
Date: Tue, 23 Nov 2010 11:35:47 +0000
Subject: [R-SIG-Finance] Hello
Message-ID: <AANLkTimV957bYbn73GTxWZ1T3hekKrCW=fV0XP9vofto@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101123/59ff0f08/attachment.pl>

From brian at braverock.com  Tue Nov 23 14:22:55 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 23 Nov 2010 07:22:55 -0600
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1290511892635-3055244.post@n4.nabble.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289208688226-3031671.post@n4.nabble.com>
	<1290511892635-3055244.post@n4.nabble.com>
Message-ID: <fcf98b86fc258fbe7e2f732a44be5122@braverock.com>

On Tue, 23 Nov 2010 03:31:32 -0800 (PST), burcy <dupuy.dangeac at free.fr>
wrote:
> my wish is to use the two packages blotter+xts together (of course) ,
but
> as I understand ,you are working on .
> last xts version(0.7-6.11) is not available for Windows ,and I am unable
to
> do that myself ;I need only an old version of Blotter(7.?) which could
be
> used with xts( 0.7-5),the last release compatible with windows (7)
> 
> Is it possible ?


You have a few options:

1> download the latest Windows build of xts from R-Forge:
https://r-forge.r-project.org/bin/windows/contrib/latest/xts_0.7-6.11.zip
then you should be able to install blotter. Not clear why/if you didn't
try this already? (reproducible examples and all that...)
This lists "PAGE NOT FOUND", and the build log indicates that the cygwin
environment on the windows build host might be broken.
So this option might be retitled: wait till the Windows build environment
for R-Forge is working again.

2> download Rtools and compile the packages from source yourself 
http://www.murdoch-sutherland.com/Rtools/
This is probably the best option overall, as it makes you independently
capable of building Windows R packages, especially when combined with a
Windows SVN client like TortoiseSVN.

3> reply to this message as to why 1> or 2> won't work, and I or some
other kind soul on this list might build xts, quantmod,
FinancialInstrument, and blotter for you as binary Windows packages.  I
won't have time until next week, at the earliest.  I personally only have
64 bit Windows build environment available.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Tue Nov 23 14:25:38 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 23 Nov 2010 07:25:38 -0600
Subject: [R-SIG-Finance] Hello
In-Reply-To: <AANLkTimV957bYbn73GTxWZ1T3hekKrCW=fV0XP9vofto@mail.gmail.com>
References: <AANLkTimV957bYbn73GTxWZ1T3hekKrCW=fV0XP9vofto@mail.gmail.com>
Message-ID: <eb448be146fcea8fd1f880d9843491b8@braverock.com>

On Tue, 23 Nov 2010 11:35:47 +0000, Robert Goldsmith
<goldsmithrb at googlemail.com> wrote:
> Please can you remove me from your distribution list.

Robert,

R-SIG-Finance is a mailing list that you joined, and only you can
un-subcribe from.

The link at the bottom of every list message:

https://stat.ethz.ch/mailman/listinfo/r-sig-finance

Will provide you with instructions to unsubscribe.

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From lestat.jin at gmail.com  Tue Nov 23 14:50:46 2010
From: lestat.jin at gmail.com (Chenchen Jin)
Date: Tue, 23 Nov 2010 13:50:46 +0000
Subject: [R-SIG-Finance] Calibration of mean reversion models
References: <OF60799AE3.02D7E8B2-ON802577E4.004A6F1F-802577E4.004BAA7B@bnpparibas.com>
Message-ID: <28C7440D-2F78-4DC7-9489-8CDAC81909D6@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101123/a69b3756/attachment.pl>

From cedrick at cedrickjohnson.com  Tue Nov 23 16:54:32 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Tue, 23 Nov 2010 10:54:32 -0500
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>	<1289208688226-3031671.post@n4.nabble.com>	<1290511892635-3055244.post@n4.nabble.com>
	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
Message-ID: <4CEBE3B8.9050806@cedrickjohnson.com>

Burcy, you're in luck.. I had to build xts_0.7-6.11 for Windows 32 bit 
(R-2.11.1) this morning to troubleshoot an error I was getting in 
Windows but not in Linux (process of elimination)...

I built the rest of the packages referenced in Brian's email.. I'll find 
a place to upload them if you haven't managed to get option 2 from 
Brian's earlier email working.

Regards,
Cedrick


From dupuy.dangeac at free.fr  Tue Nov 23 17:29:39 2010
From: dupuy.dangeac at free.fr (burcy)
Date: Tue, 23 Nov 2010 08:29:39 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <4CEBE3B8.9050806@cedrickjohnson.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289208688226-3031671.post@n4.nabble.com>
	<1290511892635-3055244.post@n4.nabble.com>
	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
	<4CEBE3B8.9050806@cedrickjohnson.com>
Message-ID: <1290529779031-3055758.post@n4.nabble.com>


Brian Cedric

Thanks for the answers

Sol 1:I get "PAGE NOT FOUND" from server R-Forge when I want to load xts
windows zip version .(same message for Blotter last release)
Sol 2:I am unable to make windows package with source ,I try this afternoon
without any result.

so I am interested by sol 3 if any...
My system :Windows 7 32 bits, R2.12

Regards 

Burcy
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3055758.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From cedrick at cedrickjohnson.com  Tue Nov 23 17:41:44 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Tue, 23 Nov 2010 11:41:44 -0500
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1290529779031-3055758.post@n4.nabble.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>	<1289208688226-3031671.post@n4.nabble.com>	<1290511892635-3055244.post@n4.nabble.com>	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>	<4CEBE3B8.9050806@cedrickjohnson.com>
	<1290529779031-3055758.post@n4.nabble.com>
Message-ID: <4CEBEEC8.5080309@cedrickjohnson.com>

done.. Burcy, sent you a msg directly...

-c

On 11/23/2010 11:29 AM, burcy wrote:
> Brian Cedric
>
> Thanks for the answers
>
> Sol 1:I get "PAGE NOT FOUND" from server R-Forge when I want to load xts
> windows zip version .(same message for Blotter last release)
> Sol 2:I am unable to make windows package with source ,I try this afternoon
> without any result.
>
> so I am interested by sol 3 if any...
> My system :Windows 7 32 bits, R2.12
>
> Regards
>
> Burcy


From dupuy.dangeac at free.fr  Tue Nov 23 18:34:59 2010
From: dupuy.dangeac at free.fr (burcy)
Date: Tue, 23 Nov 2010 09:34:59 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <4CEBEEC8.5080309@cedrickjohnson.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289208688226-3031671.post@n4.nabble.com>
	<1290511892635-3055244.post@n4.nabble.com>
	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
	<4CEBE3B8.9050806@cedrickjohnson.com>
	<1290529779031-3055758.post@n4.nabble.com>
	<4CEBEEC8.5080309@cedrickjohnson.com>
Message-ID: <1290533699383-3055860.post@n4.nabble.com>


Cedric

thanks for your help ,I appreciate, but now my R console tells me :"xts
package has not been installed for
"arch=i386" when I type  library(xts).

Which is wrong as I could read on your "DESCRIPTION" sheet .
what does that means? The only difference is :you use R2.11.1version  and me
R2.12
regards

Burcy


-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3055860.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From arun.kumar.saha at gmail.com  Wed Nov 24 08:18:19 2010
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Tue, 23 Nov 2010 23:18:19 -0800 (PST)
Subject: [R-SIG-Finance] Calibration of mean reversion models
In-Reply-To: <28C7440D-2F78-4DC7-9489-8CDAC81909D6@gmail.com>
References: <28C7440D-2F78-4DC7-9489-8CDAC81909D6@gmail.com>
Message-ID: <1290583099773-3056729.post@n4.nabble.com>


Hi Chenchen, you said "most of financial time series are nonstationary (with
unit root), how can it be possible to fit a stationary model " -------- I
think it is mostly a matter of taste on what you really believe. Most of the
cases (perhaps all) unit root tests are less powerful near the upper
boundary of stability region. Therefore although you can not reject of the
existence of unit root based on a typical realization, actual DGP may be
stationary. Therefore relying heavily on statistical tests may be
disastrous. Therefore if you really believe there is some mean-reversion in
the actual DGP, you can just go ahead.

Thanks,

_____________________________________________________

Arun Kumar Saha, FRM
QUANTITATIVE RISK AND HEDGE CONSULTING SPECIALIST
Visit me at: http://in.linkedin.com/in/ArunFRM
_____________________________________________________

-- 
View this message in context: http://r.789695.n4.nabble.com/Calibration-of-mean-reversion-models-tp3055452p3056729.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From dupuy.dangeac at free.fr  Wed Nov 24 10:14:57 2010
From: dupuy.dangeac at free.fr (burcy)
Date: Wed, 24 Nov 2010 01:14:57 -0800 (PST)
Subject: [R-SIG-Finance] blotter package
In-Reply-To: <1290533699383-3055860.post@n4.nabble.com>
References: <DF7B09CD9A9B49E0B3326364ABC6E84F@RichardPC>
	<1289208688226-3031671.post@n4.nabble.com>
	<1290511892635-3055244.post@n4.nabble.com>
	<fcf98b86fc258fbe7e2f732a44be5122@braverock.com>
	<4CEBE3B8.9050806@cedrickjohnson.com>
	<1290529779031-3055758.post@n4.nabble.com>
	<4CEBEEC8.5080309@cedrickjohnson.com>
	<1290533699383-3055860.post@n4.nabble.com>
Message-ID: <1290590097787-3056941.post@n4.nabble.com>


Brian Cedric 

Again thanks ,all is ok now .

Regards

burcy
-- 
View this message in context: http://r.789695.n4.nabble.com/blotter-package-tp3031027p3056941.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From jorge.nieves at moorecap.com  Wed Nov 24 18:13:54 2010
From: jorge.nieves at moorecap.com (Jorge Nieves)
Date: Wed, 24 Nov 2010 12:13:54 -0500
Subject: [R-SIG-Finance] Library termstrc
Message-ID: <D595C0E05185614C90515F1E8A2D4CBF02B17739@NYC-XCH3.win.moorecap.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101124/10ff38e4/attachment.pl>

From noah at smartmediacorp.com  Thu Nov 25 06:25:10 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Wed, 24 Nov 2010 21:25:10 -0800
Subject: [R-SIG-Finance] Another new bug with quantmod
Message-ID: <4CEDF336.8000002@smartmediacorp.com>

Hi,

the getOptionChain function has been working perfectly, up until
tonight.  Now the exact same code fails.

AAPL.OPTS <- getOptionChain("AAPL", NULL)
Error in calls[, 2] : incorrect number of dimensions

Any ideas?

Here is my current session info

R version 2.12.0 (2010-10-15)
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base    

other attached packages:
 [1] fOptions_2110.78   fBasics_2110.79    timeSeries_2130.90
timeDate_2130.91   mda_0.4-1        
 [6] class_7.3-2        MASS_7.3-8         nnet_7.3-1        
quantmod_0.3-14.1  TTR_0.20-2       
[11] xts_0.7-5          zoo_1.6-4          Defaults_1.1-1   

loaded via a namespace (and not attached):
[1] grid_2.12.0     lattice_0.19-13 tools_2.12.0


From cedrick at cedrickjohnson.com  Thu Nov 25 06:46:00 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Thu, 25 Nov 2010 00:46:00 -0500
Subject: [R-SIG-Finance] Another new bug with quantmod
In-Reply-To: <4CEDF336.8000002@smartmediacorp.com>
References: <4CEDF336.8000002@smartmediacorp.com>
Message-ID: <4CEDF818.6070102@cedrickjohnson.com>

Seems to be working here

$`Nov 2010`
$`Nov 2010`$calls
                     Strike  Last   Chg   Bid   Ask   Vol    OI
AAPL101126C00230000    230 79.40  0.00 83.95 85.85    32    95
AAPL101126C00240000    240 68.60  0.00 73.50 75.40    17    15
AAPL101126C00250000    250 58.30  0.00 63.95 65.35    25    25
AAPL101126C00260000    260 47.75  0.00 54.00 55.80    47   120
<snip>


.. using xts 0.7.5 as well.. Perhaps was an intermittent Y! outage?

-c


From noah at smartmediacorp.com  Thu Nov 25 10:02:06 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Thu, 25 Nov 2010 01:02:06 -0800
Subject: [R-SIG-Finance] Another new bug with quantmod
In-Reply-To: <4CEDF818.6070102@cedrickjohnson.com>
References: <4CEDF336.8000002@smartmediacorp.com>
	<4CEDF818.6070102@cedrickjohnson.com>
Message-ID: <4CEE260E.5050705@smartmediacorp.com>

The error appears when you call the function with the "Exp = NULL" flag

getOptionChain("APPL")  WORKS
getOptionChain("AAPL", Exp = NULL)  FAILS.



On 11/24/10 9:46 PM, Johnson, Cedrick W. wrote:
> Seems to be working here
>
> $`Nov 2010`
> $`Nov 2010`$calls
>                     Strike  Last   Chg   Bid   Ask   Vol    OI
> AAPL101126C00230000    230 79.40  0.00 83.95 85.85    32    95
> AAPL101126C00240000    240 68.60  0.00 73.50 75.40    17    15
> AAPL101126C00250000    250 58.30  0.00 63.95 65.35    25    25
> AAPL101126C00260000    260 47.75  0.00 54.00 55.80    47   120
> <snip>
>
>
> .. using xts 0.7.5 as well.. Perhaps was an intermittent Y! outage?
>
> -c
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.


From breman.mark at gmail.com  Thu Nov 25 10:23:42 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 25 Nov 2010 10:23:42 +0100
Subject: [R-SIG-Finance] Another new bug with quantmod
In-Reply-To: <4CEE260E.5050705@smartmediacorp.com>
References: <4CEDF336.8000002@smartmediacorp.com>
	<4CEDF818.6070102@cedrickjohnson.com>
	<4CEE260E.5050705@smartmediacorp.com>
Message-ID: <AANLkTin6n4yfu1OjAuqtbQMm5vZAn9b9LB+_8GdxgHFr@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101125/148c82ba/attachment.pl>

From jeff.a.ryan at gmail.com  Thu Nov 25 10:47:43 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Thu, 25 Nov 2010 03:47:43 -0600
Subject: [R-SIG-Finance] Another new bug with quantmod
In-Reply-To: <AANLkTin6n4yfu1OjAuqtbQMm5vZAn9b9LB+_8GdxgHFr@mail.gmail.com>
References: <4CEDF336.8000002@smartmediacorp.com>
	<4CEDF818.6070102@cedrickjohnson.com>
	<4CEE260E.5050705@smartmediacorp.com>
	<AANLkTin6n4yfu1OjAuqtbQMm5vZAn9b9LB+_8GdxgHFr@mail.gmail.com>
Message-ID: <AANLkTim2R1JUqX=+hV45OLy1dCavMni6LrjhepY5z_nd@mail.gmail.com>

Hi Noah,

The formatting for the source from Yahoo has changed - so the quantmod
code needed to remove the workaround introduced back in late August
that handled the lack of front month being explicitly available to
parse;  i.e. the yahoo has added the front month link back in.

More disconcerting is the fact that this worked for Mark.

I fear yahoo does some pretty serious load balancing that may or may
not be 100% consistent across servers.  So some get the benefit of
breaking and some do not.  I think this eventually settles down - but
for now I have patched the sources to work with the 'new' html.

rev 556 on R-forge.

Best,
Jeff

Happy Thanksgiving to those celebrating today!


On Thu, Nov 25, 2010 at 3:23 AM, Mark Breman <breman.mark at gmail.com> wrote:
> Hi Noah,
>
> With these settings both will work:
>
> ##################################################################################
>> sessionInfo()
> R version 2.12.0 (2010-10-15)
> Platform: i486-pc-linux-gnu (32-bit)
>
> locale:
> ?[1] LC_CTYPE=en_US.utf8 ? ? ? LC_NUMERIC=C ? ? ? ? ? ? ?LC_TIME=en_US.utf8
> ? ? ? LC_COLLATE=en_US.utf8 ? ? LC_MONETARY=C
> ?[6] LC_MESSAGES=en_US.utf8 ? ?LC_PAPER=en_US.utf8 ? ? ? LC_NAME=C
> ? ? ?LC_ADDRESS=C ? ? ? ? ? ? ?LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.utf8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>
> other attached packages:
> [1] quantmod_0.3-14 TTR_0.20-2 ? ? ?xts_0.7-6.2 ? ? zoo_1.7-0
> Defaults_1.1-1 ?pomp_0.35-1
>
> loaded via a namespace (and not attached):
> [1] deSolve_1.8.1 ? grid_2.12.0 ? ? lattice_0.19-13 mvtnorm_0.9-95
> ?subplex_1.1-3 ? tools_2.12.0
> ##########################################################################
>
> Try the latest xts and quantmod from R-Forge.
>
> Regards,
>
> -Mark-
>
>
> 2010/11/25 Noah Silverman <noah at smartmediacorp.com>
>
>> The error appears when you call the function with the "Exp = NULL" flag
>>
>> getOptionChain("APPL") ?WORKS
>> getOptionChain("AAPL", Exp = NULL) ?FAILS.
>>
>>
>>
>>
>> On 11/24/10 9:46 PM, Johnson, Cedrick W. wrote:
>>
>>> Seems to be working here
>>>
>>> $`Nov 2010`
>>> $`Nov 2010`$calls
>>> ? ? ? ? ? ? ? ? ? ?Strike ?Last ? Chg ? Bid ? Ask ? Vol ? ?OI
>>> AAPL101126C00230000 ? ?230 79.40 ?0.00 83.95 85.85 ? ?32 ? ?95
>>> AAPL101126C00240000 ? ?240 68.60 ?0.00 73.50 75.40 ? ?17 ? ?15
>>> AAPL101126C00250000 ? ?250 58.30 ?0.00 63.95 65.35 ? ?25 ? ?25
>>> AAPL101126C00260000 ? ?260 47.75 ?0.00 54.00 55.80 ? ?47 ? 120
>>> <snip>
>>>
>>>
>>> .. using xts 0.7.5 as well.. Perhaps was an intermittent Y! outage?
>>>
>>> -c
>>>
>>> _______________________________________________
>>> R-SIG-Finance at stat.math.ethz.ch mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>> _______________________________________________
>> R-SIG-Finance at stat.math.ethz.ch mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at stat.math.ethz.ch mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan ? ?| ? ?Founder ? ?| ? ?jeffrey.ryan at lemnica.com

www.lemnica.com


From jorge.nieves at moorecap.com  Thu Nov 25 12:05:13 2010
From: jorge.nieves at moorecap.com (Jorge Nieves)
Date: Thu, 25 Nov 2010 06:05:13 -0500
Subject: [R-SIG-Finance] RODBC
Message-ID: <D595C0E05185614C90515F1E8A2D4CBF093E58B8@NYC-XCH3.win.moorecap.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101125/4b9e436d/attachment.pl>

From breman.mark at gmail.com  Thu Nov 25 13:11:37 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 25 Nov 2010 13:11:37 +0100
Subject: [R-SIG-Finance] RODBC
In-Reply-To: <D595C0E05185614C90515F1E8A2D4CBF093E58B8@NYC-XCH3.win.moorecap.com>
References: <D595C0E05185614C90515F1E8A2D4CBF093E58B8@NYC-XCH3.win.moorecap.com>
Message-ID: <AANLkTikP+obkFT3gQ8qChEKnLKxuwmx18XQ2vw-cb4sE@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101125/ab10d41f/attachment.pl>

From robert.ferstl at wiwi.uni-regensburg.de  Thu Nov 25 21:16:36 2010
From: robert.ferstl at wiwi.uni-regensburg.de (Robert Ferstl)
Date: Thu, 25 Nov 2010 20:16:36 +0000 (UTC)
Subject: [R-SIG-Finance] Library termstrc
References: <D595C0E05185614C90515F1E8A2D4CBF02B17739@NYC-XCH3.win.moorecap.com>
Message-ID: <loom.20101125T211013-280@post.gmane.org>

Yes, this error usually comes up when something is wrong with
 the data structure. 
Please compare your list with our examples in the paper.
 The first few values from your output in $PRICE look too small for 
me.

Regards,

Robert

Jorge Nieves <jorge.nieves <at> moorecap.com> writes:


From mombach at hotmail.com  Sun Nov 28 04:35:22 2010
From: mombach at hotmail.com (Maciej Ombach)
Date: Sat, 27 Nov 2010 22:35:22 -0500
Subject: [R-SIG-Finance] fPortfolio (portfolioFrontier function)
Message-ID: <BLU156-w436E76FDC361755EB7E07CA8230@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101127/88366047/attachment.pl>

From stephen at organicfoodmarkets.com.au  Sun Nov 28 06:57:25 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Sun, 28 Nov 2010 16:57:25 +1100
Subject: [R-SIG-Finance] ibrokers
Message-ID: <4CF1EF45.7040602@organicfoodmarkets.com.au>

I'm having a lot of trouble geting to grips with this. Nothing unusual 
but ...

I am trying the five main functions from Jeffrey's  paper (IBrokers- 
Interactive Brokers and R)


 > library(IBrokers)
Loading required package: xts
Loading required package: zoo
 > tws <- twsConnect()
 > tws
<twsConnection,1 @ 20101128 16:07:16 Eastern Standard Time (New South 
Wales), nextId=1>
 > reqMktData(tws, twsEquity("CBA", exch='ASX'))
TWS Message: 2 -1 2104 Market data farm connection is OK:cashfarm
TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
<20101128 16:09:56.557000> id=1 symbol=CBA highPrice: 0
<20101128 16:09:56.620000> id=1 symbol=CBA lowPrice: 0
<20101128 16:09:57.073000> id=1 symbol=CBA bidPrice: -1.0  bidSize: 0
<20101128 16:09:57.073000> id=1 symbol=CBA askPrice: -1.0  askSize: 0
<20101128 16:09:57.088000> id=1 symbol=CBA bidSize: 0
<20101128 16:09:57.088000> id=1 symbol=CBA askSize: 0
<20101128 16:09:57.088000> id=1 symbol=CBA lastPrice: 47.58
<20101128 16:09:57.088000> id=1 symbol=CBA lastSize: 1403
<20101128 16:09:57.088000> id=1 symbol=CBA lastTimestamp: 1290748224
<20101128 16:09:57.088000> id=1 symbol=CBA highPrice: 0
<20101128 16:09:57.088000> id=1 symbol=CBA lowPrice: 0
<20101128 16:09:57.088000> id=1 symbol=CBA closePrice: 47.58
<20101128 16:09:57.088000> id=1 symbol=CBA openPrice: 0
<20101128 16:09:57.432000> id=1 symbol=CBA optionCallVolume: 1463
<20101128 16:09:57.432000> id=1 symbol=CBA optionPutVolume: 2118
<20101128 16:09:57.448000> id=1 symbol=CBA optionCallOpenInterest: 18531
<20101128 16:09:57.448000> id=1 symbol=CBA optionPutOpenInterest: 35375
<20101128 16:09:57.448000> id=1 symbol=CBA optionHistoricalVol: 
0.18530948012748838 NA
<20101128 16:09:57.448000> id=1 symbol=CBA averageVolume: 5097538
<20101128 16:09:57.448000> id=1 symbol=CBA 13-week High: 54.15000153
<20101128 16:09:57.448000> id=1 symbol=CBA 13-week Low: 47.75999832
<20101128 16:09:57.448000> id=1 symbol=CBA 26-week High: 54.15000153
<20101128 16:09:57.448000> id=1 symbol=CBA 26-week Low: 44.62139893
<20101128 16:09:57.448000> id=1 symbol=CBA 52-week High: 57.57139969
<20101128 16:09:57.448000> id=1 symbol=CBA 52-week Low: 44.62139893
<20101128 16:10:22.698000> id=1 symbol=CBA openPrice: 0
<20101128 16:10:22.698000> id=1 symbol=CBA highPrice: 0
<20101128 16:10:22.698000> id=1 symbol=CBA lowPrice: 0
<20101128 16:10:22.698000> id=1 symbol=CBA closePrice: 47.58


 > reqHistoricalData(tws, twsEquity("CBA", exch='ASX'))
waiting for TWS reply .....
Error: Unable to complete historical data request
In addition: Warning message:
In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106,  :
   No security definition has been found for the request.
 > reqContractsDetails(tws, twsEquity("CBA", exch='ASX'))
Error: could not find function "reqContractsDetails"
 > reqContractDetails(tws, twsEquity("CBA", exch='ASX'))
list()
Warning message:
In reqContractDetails(tws, twsEquity("CBA", exch = "ASX")) :
   error in contract details
 > reqMktDepth(tws, twsEquity("CBA", exch='ASX'))
TWS Message: 2 1 200 No security definition has been found for the request

 > reqRealTimeBars(tws, twsEquity("CBA", exch='ASX'))
TWS Message: 2 1 310 Can't find the subscribed market depth with tickerId:1
TWS Message: 2 1 200 No security definition has been found for the request

reqMktData worked but none of the others did.  It could be something as 
simple as  the market being closed,  but maybe someone with more 
experience than I can advise me.

Incidentally, can anyone  point me to code examples and/or tutorials.   
I've read Real Time Market Data and Trade Execution with R by Jeffrey 
(and his reference card) but the example 2.5 is missing.  I've read Kyle 
Matoba's work as well but I would love to find more.

Any help/comments most appreciated.


-- 
Stephen Choularton Ph.D., FIoD


From jeff.a.ryan at gmail.com  Sun Nov 28 16:09:12 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sun, 28 Nov 2010 09:09:12 -0600
Subject: [R-SIG-Finance] ibrokers
In-Reply-To: <4CF1EF45.7040602@organicfoodmarkets.com.au>
References: <4CF1EF45.7040602@organicfoodmarkets.com.au>
Message-ID: <AANLkTi=w2TPA3Hs+9xWg62yJ38u-hiPAEQXGAy628SoT@mail.gmail.com>

Hi Stephen,

I'm not subscribed to ASX data, so I can't readily replicate.  That
said, I think you are just missing the currency="AUD" (defaults to USD
... maybe I will make this a global option)

> reqContractDetails(ibg, twsEquity("CBA", exch='ASX', currency="AUD"))
[[1]]
List of 18
 $ version       : chr "6"
 $ contract      :List of 16
  ..$ conId          : chr "4036818"
  ..$ symbol         : chr "CBA"
  ..$ sectype        : chr "STK"
  ..$ exch           : chr "ASX"
  ..$ primary        : chr "ASX"
  ..$ expiry         : chr ""
  ..$ strike         : chr "0.0"
  ..$ currency       : chr "AUD"
  ..$ right          : chr ""
  ..$ local          : chr "CBA"
  ..$ multiplier     : chr ""
  ..$ combo_legs_desc: chr ""
  ..$ comboleg       : chr ""
  ..$ include_expired: chr ""
  ..$ secIdType      : chr ""
  ..$ secId          : chr ""
  ..- attr(*, "class")= chr "twsContract"
 $ marketName    : chr "CBA"
 $ tradingClass  : chr "CBA"
 $ conId         : chr "4036818"
 $ minTick       : chr "0.0010"
 $ orderTypes    : chr [1:34] "ACTIVETIM" "ADJUST" "ALERT" "ALLOC" ...
 $ validExchanges: chr [1:2] "ASX" "MIBSX"
 $ priceMagnifier: chr "1"
 $ underConId    : chr "0"
 $ longName      : chr "COMMONWEALTH BANK OF AUSTRAL"
 $ contractMonth : chr ""
 $ industry      : chr "Financial"
 $ category      : chr "Banks"
 $ subcategory   : chr "Commer Banks Non-US"
 $ timeZoneId    : chr "AET"
 $ tradingHours  : chr "20101129:1000-1611;20101130:1000-1611"
 $ liquidHours   : chr "20101129:1000-1611;20101130:1000-1611"

HTH,
Jeff

On Sat, Nov 27, 2010 at 11:57 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> I'm having a lot of trouble geting to grips with this. Nothing unusual but
> ...
>
> I am trying the five main functions from Jeffrey's ?paper (IBrokers-
> Interactive Brokers and R)
>
>
>> library(IBrokers)
> Loading required package: xts
> Loading required package: zoo
>> tws <- twsConnect()
>> tws
> <twsConnection,1 @ 20101128 16:07:16 Eastern Standard Time (New South
> Wales), nextId=1>
>> reqMktData(tws, twsEquity("CBA", exch='ASX'))
> TWS Message: 2 -1 2104 Market data farm connection is OK:cashfarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
> <20101128 16:09:56.557000> id=1 symbol=CBA highPrice: 0
> <20101128 16:09:56.620000> id=1 symbol=CBA lowPrice: 0
> <20101128 16:09:57.073000> id=1 symbol=CBA bidPrice: -1.0 ?bidSize: 0
> <20101128 16:09:57.073000> id=1 symbol=CBA askPrice: -1.0 ?askSize: 0
> <20101128 16:09:57.088000> id=1 symbol=CBA bidSize: 0
> <20101128 16:09:57.088000> id=1 symbol=CBA askSize: 0
> <20101128 16:09:57.088000> id=1 symbol=CBA lastPrice: 47.58
> <20101128 16:09:57.088000> id=1 symbol=CBA lastSize: 1403
> <20101128 16:09:57.088000> id=1 symbol=CBA lastTimestamp: 1290748224
> <20101128 16:09:57.088000> id=1 symbol=CBA highPrice: 0
> <20101128 16:09:57.088000> id=1 symbol=CBA lowPrice: 0
> <20101128 16:09:57.088000> id=1 symbol=CBA closePrice: 47.58
> <20101128 16:09:57.088000> id=1 symbol=CBA openPrice: 0
> <20101128 16:09:57.432000> id=1 symbol=CBA optionCallVolume: 1463
> <20101128 16:09:57.432000> id=1 symbol=CBA optionPutVolume: 2118
> <20101128 16:09:57.448000> id=1 symbol=CBA optionCallOpenInterest: 18531
> <20101128 16:09:57.448000> id=1 symbol=CBA optionPutOpenInterest: 35375
> <20101128 16:09:57.448000> id=1 symbol=CBA optionHistoricalVol:
> 0.18530948012748838 NA
> <20101128 16:09:57.448000> id=1 symbol=CBA averageVolume: 5097538
> <20101128 16:09:57.448000> id=1 symbol=CBA 13-week High: 54.15000153
> <20101128 16:09:57.448000> id=1 symbol=CBA 13-week Low: 47.75999832
> <20101128 16:09:57.448000> id=1 symbol=CBA 26-week High: 54.15000153
> <20101128 16:09:57.448000> id=1 symbol=CBA 26-week Low: 44.62139893
> <20101128 16:09:57.448000> id=1 symbol=CBA 52-week High: 57.57139969
> <20101128 16:09:57.448000> id=1 symbol=CBA 52-week Low: 44.62139893
> <20101128 16:10:22.698000> id=1 symbol=CBA openPrice: 0
> <20101128 16:10:22.698000> id=1 symbol=CBA highPrice: 0
> <20101128 16:10:22.698000> id=1 symbol=CBA lowPrice: 0
> <20101128 16:10:22.698000> id=1 symbol=CBA closePrice: 47.58
>
>
>> reqHistoricalData(tws, twsEquity("CBA", exch='ASX'))
> waiting for TWS reply .....
> Error: Unable to complete historical data request
> In addition: Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106, ?:
> ?No security definition has been found for the request.
>> reqContractsDetails(tws, twsEquity("CBA", exch='ASX'))
> Error: could not find function "reqContractsDetails"
>> reqContractDetails(tws, twsEquity("CBA", exch='ASX'))
> list()
> Warning message:
> In reqContractDetails(tws, twsEquity("CBA", exch = "ASX")) :
> ?error in contract details
>> reqMktDepth(tws, twsEquity("CBA", exch='ASX'))
> TWS Message: 2 1 200 No security definition has been found for the request
>
>> reqRealTimeBars(tws, twsEquity("CBA", exch='ASX'))
> TWS Message: 2 1 310 Can't find the subscribed market depth with tickerId:1
> TWS Message: 2 1 200 No security definition has been found for the request
>
> reqMktData worked but none of the others did. ?It could be something as
> simple as ?the market being closed, ?but maybe someone with more experience
> than I can advise me.
>
> Incidentally, can anyone ?point me to code examples and/or tutorials. ? I've
> read Real Time Market Data and Trade Execution with R by Jeffrey (and his
> reference card) but the example 2.5 is missing. ?I've read Kyle Matoba's
> work as well but I would love to find more.
>
> Any help/comments most appreciated.
>
>
> --
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan ? ?| ? ?Founder ? ?| ? ?jeffrey.ryan at lemnica.com

www.lemnica.com


From aaditya.nanduri at gmail.com  Tue Nov 30 04:58:38 2010
From: aaditya.nanduri at gmail.com (Aaditya Nanduri)
Date: Mon, 29 Nov 2010 21:58:38 -0600
Subject: [R-SIG-Finance] How to backtest in R
Message-ID: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101129/1c15f2cd/attachment.pl>

From dave at kanecap.com  Tue Nov 30 05:03:55 2010
From: dave at kanecap.com (David Kane)
Date: Mon, 29 Nov 2010 23:03:55 -0500
Subject: [R-SIG-Finance] How to backtest in R
In-Reply-To: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
References: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
Message-ID: <AANLkTim1hpNUwB4OXgd4vMrKNGqt6xpQ6AzsPG+W6+vU@mail.gmail.com>

You could start with the backtest package:

http://cran.r-project.org/web/packages/backtest/index.html

But there are many other possible approaches . . .

Dave Kane

On Mon, Nov 29, 2010 at 10:58 PM, Aaditya Nanduri
<aaditya.nanduri at gmail.com> wrote:
> Hello All,
>
> This is a rather general question about backtesting : How is it done?
> (People of my age would usually write "lol" immediately after that question)
>
> My current situation (Im a beginner at this):
>
> I'm working on a variation of the TAA strategy that was written by Mr. Faber
> and while its simple enough, I have no idea how to backtest.
>
> This is what I think is backtesting:
> ?- Must be a walk-forward (or decisions must only be based on events already
> happened)
> ?- Must return a set of entry points and exit points
> ?- Must take some initial amount of money and provide PL of each open/close
> and a running PL
> ?- Overall percentage increase during holding period (monthly, in my case)
> ?- Volatility (SD of price-movement or SD of percentage change in each
> month?)
> ?- Sharpe
>
>
> Is this usually done in a function? a loop? provided in a package? (I looked
> at backtest but I have no idea what that does. Im still reading up on it)
>
> I know this is a lot to ask but can anyone show me an example?
>
> I sincerely appreciate all the help anyone provides.
>
>
> --
> Aaditya Nanduri
> aaditya.nanduri at gmail.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From josh.m.ulrich at gmail.com  Tue Nov 30 05:37:02 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 29 Nov 2010 22:37:02 -0600
Subject: [R-SIG-Finance] How to backtest in R
In-Reply-To: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
References: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
Message-ID: <AANLkTi=2EnxKaHGrp0yHsZ9pK7=aDxcyxj3WZr0Mxgvi@mail.gmail.com>

Hi Aaditya,

On Mon, Nov 29, 2010 at 9:58 PM, Aaditya Nanduri
<aaditya.nanduri at gmail.com> wrote:
> Hello All,
>
> This is a rather general question about backtesting : How is it done?
> (People of my age would usually write "lol" immediately after that question)
>
> My current situation (Im a beginner at this):
>
> I'm working on a variation of the TAA strategy that was written by Mr. Faber
> and while its simple enough, I have no idea how to backtest.
>
> This is what I think is backtesting:
> ?- Must be a walk-forward (or decisions must only be based on events already
> happened)
> ?- Must return a set of entry points and exit points
> ?- Must take some initial amount of money and provide PL of each open/close
> and a running PL
> ?- Overall percentage increase during holding period (monthly, in my case)
> ?- Volatility (SD of price-movement or SD of percentage change in each
> month?)
> ?- Sharpe
>
>
> Is this usually done in a function? a loop? provided in a package? (I looked
> at backtest but I have no idea what that does. Im still reading up on it)
>
> I know this is a lot to ask but can anyone show me an example?
>
There are several examples in the quantstrat and blotter packages.
There are examples of other strategies as well, but those three
replicate Faber.  I would recommend you stick with quantstrat, since
it will help you test strategies (blotter is more infrastructure).
Try:
library(quantstrat)
demo(faber)  # quantstrat demo
demo(faberMC)   # quantstrat demo
demo(longtrend)  # blotter demo

And there are some other examples that perform simple backtesting
without using any package <shameless plug>on my blog</shameless plug>.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


> I sincerely appreciate all the help anyone provides.
>
>
> --
> Aaditya Nanduri
> aaditya.nanduri at gmail.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From aaditya.nanduri at gmail.com  Tue Nov 30 05:59:11 2010
From: aaditya.nanduri at gmail.com (Aaditya Nanduri)
Date: Mon, 29 Nov 2010 22:59:11 -0600
Subject: [R-SIG-Finance] How to backtest in R
In-Reply-To: <AANLkTi=2EnxKaHGrp0yHsZ9pK7=aDxcyxj3WZr0Mxgvi@mail.gmail.com>
References: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
	<AANLkTi=2EnxKaHGrp0yHsZ9pK7=aDxcyxj3WZr0Mxgvi@mail.gmail.com>
Message-ID: <AANLkTin8gXYbZCt8of6bPSZgOALcR7XfrXbb2g_XjMg2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101129/9b3ff6a9/attachment.pl>

From aaditya.nanduri at gmail.com  Tue Nov 30 06:20:03 2010
From: aaditya.nanduri at gmail.com (Aaditya Nanduri)
Date: Mon, 29 Nov 2010 23:20:03 -0600
Subject: [R-SIG-Finance] How to backtest in R
In-Reply-To: <AANLkTin8gXYbZCt8of6bPSZgOALcR7XfrXbb2g_XjMg2@mail.gmail.com>
References: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
	<AANLkTi=2EnxKaHGrp0yHsZ9pK7=aDxcyxj3WZr0Mxgvi@mail.gmail.com>
	<AANLkTin8gXYbZCt8of6bPSZgOALcR7XfrXbb2g_XjMg2@mail.gmail.com>
Message-ID: <AANLkTina6j=RRt=egrfja_gKz5T0f2EU-FGe23n2YMyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101129/0eb5251b/attachment.pl>

From soumendra at gmail.com  Tue Nov 30 07:09:34 2010
From: soumendra at gmail.com (Soumendra)
Date: Tue, 30 Nov 2010 11:39:34 +0530
Subject: [R-SIG-Finance] pairs trading with IBroker
Message-ID: <AANLkTinu1KuUZ5TUZN9DuWP2QrVKy2MWn2Lc+Mvxvg6b@mail.gmail.com>

Hi all.

if I use reqMktData(), it gives me a continuous feed of market data of
a SINGLE stock/future and then I can write callback functions to
handle the incoming data.

For the task at hand, I need a feed of at least two (preferably 40)
different assets/derivatives. At each iteration, I would like to pick
up the market data for about 40 stocks/futures. Currently, there
doesn't seem to be anything in IBrokers that could help me with this
(please correct me if I am wrong). twsBag seemed it could fit the
bill, but I can't figure out given the extreme lack of documentation.

It would be possible to have two different feeds getting the data
using to different connections (client ids) and use a third routine to
look at them and do some kind of pseudo-synchronisation and take the
trading decisions, but that would be an ugly solution.

Any ideas?

Thanks in advance,

Soumendra


From brian at braverock.com  Tue Nov 30 12:13:20 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 30 Nov 2010 05:13:20 -0600
Subject: [R-SIG-Finance] How to backtest in R
In-Reply-To: <AANLkTina6j=RRt=egrfja_gKz5T0f2EU-FGe23n2YMyA@mail.gmail.com>
References: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
	<AANLkTi=2EnxKaHGrp0yHsZ9pK7=aDxcyxj3WZr0Mxgvi@mail.gmail.com>
	<AANLkTin8gXYbZCt8of6bPSZgOALcR7XfrXbb2g_XjMg2@mail.gmail.com>
	<AANLkTina6j=RRt=egrfja_gKz5T0f2EU-FGe23n2YMyA@mail.gmail.com>
Message-ID: <10a164c778d2a149447470c165b3424d@braverock.com>

On Mon, 29 Nov 2010 23:20:03 -0600, Aaditya Nanduri
<aaditya.nanduri at gmail.com> wrote:
> I've just downloaded quantstrat and try to run demo(faber) and it has
some
> warnings.
> 
> I had 16 warnings that read something like this:
> Warning messages:
> 1: In rm("account.faber", "portfolio.faber", pos = .blotter) :
>   object 'account.faber' not found
<...snip...>
>
> Since you are one of the developers, I assumed you would be appropriate
> person to send this to.

These warnings are harmless,and may be safely ignored.  Some users
complained that they couldn't run the demos multiple times from within the
same R session.  The 'rm()' commands simply clean up the environment to
allow the demo to be re-run.  The warning, if you read it carefully and
compare it with the demo code (this is open source) is only telling you
that none of those objects exist already, so they can't be removed.

I suggest that if you want to understand better how they work, look at the
source code of the demo scripts.  These will be installed somewhere on your
hard drive, though it's less clear on Windows than if installing from a
source tarball.  Otherwise, you can find them in the version control
repository on R-Forge. 

https://r-forge.r-project.org/scm/viewvc.php/pkg/quantstrat/demo/?root=blotter

The source also has more comments that may help you understand the flow of
the activities in the demo code.

Cheers,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From w.erselina at gmail.com  Wed Dec  1 00:26:02 2010
From: w.erselina at gmail.com (Werner Erselina)
Date: Wed, 1 Dec 2010 00:26:02 +0100
Subject: [R-SIG-Finance] FX Forward outrights and FX Swaps
Message-ID: <AANLkTim2aEJG_zoBub8upnAQjoWKSHMCzZ3BQX0y9rJf@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101201/dcbd08a6/attachment.pl>

From kriskumar at earthlink.net  Wed Dec  1 02:56:35 2010
From: kriskumar at earthlink.net (krishna)
Date: Tue, 30 Nov 2010 20:56:35 -0500
Subject: [R-SIG-Finance] FX Forward outrights and FX Swaps
In-Reply-To: <AANLkTim2aEJG_zoBub8upnAQjoWKSHMCzZ3BQX0y9rJf@mail.gmail.com>
References: <AANLkTim2aEJG_zoBub8upnAQjoWKSHMCzZ3BQX0y9rJf@mail.gmail.com>
Message-ID: <C77C19B8-C112-493F-BAD7-628F20178C65@earthlink.net>

Are you looking to compute the outrights given the pts and spot that  
is straightforward  ?

Perhaps you are looking to impute the pts given a set of other market  
instruments (futures , swaps etc?)

Unfortunately this is non trivial and you are unlikely to find the  
exact recipe( it also is institution specific)

You can however get bbg composite points on FRD <go>  there is also a  
ubs page on reuters that has streaming  points.

hth



On Nov 30, 2010, at 6:26 PM, Werner Erselina <w.erselina at gmail.com>  
wrote:

> Dear R-sig-finance list,
>
> I was wondering if there are any packages for calculating FX
> forward outrights and swaps prices?
>
> Kind regards,
>
> Werner Erselina
>
>    [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R  
> questions should go.


From aaditya.nanduri at gmail.com  Wed Dec  1 04:43:50 2010
From: aaditya.nanduri at gmail.com (Aaditya Nanduri)
Date: Tue, 30 Nov 2010 21:43:50 -0600
Subject: [R-SIG-Finance] How to backtest in R
In-Reply-To: <10a164c778d2a149447470c165b3424d@braverock.com>
References: <AANLkTimnDiUueoc-0anJYwj75TXWYiaFwN26r-i-MzBp@mail.gmail.com>
	<AANLkTi=2EnxKaHGrp0yHsZ9pK7=aDxcyxj3WZr0Mxgvi@mail.gmail.com>
	<AANLkTin8gXYbZCt8of6bPSZgOALcR7XfrXbb2g_XjMg2@mail.gmail.com>
	<AANLkTina6j=RRt=egrfja_gKz5T0f2EU-FGe23n2YMyA@mail.gmail.com>
	<10a164c778d2a149447470c165b3424d@braverock.com>
Message-ID: <AANLkTikokDUjG8F6T6eK16=-k817k83aq4Lfyc_rU6-w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101130/632eaf03/attachment.pl>

From jeff.a.ryan at gmail.com  Wed Dec  1 05:39:02 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 30 Nov 2010 22:39:02 -0600
Subject: [R-SIG-Finance] pairs trading with IBroker
In-Reply-To: <AANLkTinu1KuUZ5TUZN9DuWP2QrVKy2MWn2Lc+Mvxvg6b@mail.gmail.com>
References: <AANLkTinu1KuUZ5TUZN9DuWP2QrVKy2MWn2Lc+Mvxvg6b@mail.gmail.com>
Message-ID: <AANLkTimEbcRn6x4ZcOeO5DnbgDDJMseGX46rc5Rdiie+@mail.gmail.com>

Hi Soumendra,

On Tue, Nov 30, 2010 at 12:09 AM, Soumendra <soumendra at gmail.com> wrote:
> Hi all.
>
> if I use reqMktData(), it gives me a continuous feed of market data of
> a SINGLE stock/future and then I can write callback functions to
> handle the incoming data.

You can specify more than one contract by simply creating a list of
twsContracts.  This is mentioned in a few places (slides, videos), but
the ?reqMktData doesn't really give a good example of how.  See below
for an example, but I'll update the docs to be more clear.  This
approach works for RealTimeBars as well.

Note that the API restricts the number of symbols you can display (via
API and TWS) to 100 typically, though that number can increase
depending on your trading/account/fees.

>
> For the task at hand, I need a feed of at least two (preferably 40)
> different assets/derivatives. At each iteration, I would like to pick
> up the market data for about 40 stocks/futures. Currently, there
> doesn't seem to be anything in IBrokers that could help me with this
> (please correct me if I am wrong). twsBag seemed it could fit the
> bill, but I can't figure out given the extreme lack of documentation.
>

No, twsBag is for combo orders.  Not the same.

> It would be possible to have two different feeds getting the data
> using to different connections (client ids) and use a third routine to
> look at them and do some kind of pseudo-synchronisation and take the
> trading decisions, but that would be an ugly solution.

Best,
Jeff

tws <- twsConnect()
cons <- lapply(c("AAPL","MSFT","GOOG"), twsSTK)  # create a list of
twsEquity contracts
reqMktData(tws, cons)
<20101130 22:35:06.049830> id=1 symbol=AAPL Volume: 175973
<20101130 22:35:06.060365> id=1 symbol=AAPL highPrice: 314.36
<20101130 22:35:06.060701> id=1 symbol=AAPL lowPrice: 310.87
<20101130 22:35:06.235706> id=3 symbol=GOOG lastTimestamp: 1291165056
<20101130 22:35:06.239321> id=3 symbol=GOOG lastTimestamp: 1291165125
<20101130 22:35:06.239760> id=3 symbol=GOOG lastPrice: 554.0
<20101130 22:35:06.240131> id=3 symbol=GOOG lastSize: 0
<20101130 22:35:06.240497> id=3 symbol=GOOG Volume: 69711
<20101130 22:35:06.240863> id=3 symbol=GOOG highPrice: 574.32
<20101130 22:35:06.241232> id=3 symbol=GOOG lowPrice: 553.31
<20101130 22:35:06.241588> id=3 symbol=GOOG closePrice: 555.71
<20101130 22:35:06.241930> id=3 symbol=GOOG openPrice: 574.32
<20101130 22:35:06.242317> id=2 symbol=MSFT lastTimestamp: 1291164560
<20101130 22:35:06.242686> id=2 symbol=MSFT lastTimestamp: 1291164601
<20101130 22:35:06.243007> id=2 symbol=MSFT lastPrice: 25.22
<20101130 22:35:06.243322> id=2 symbol=MSFT lastSize: 10
<20101130 22:35:06.243639> id=2 symbol=MSFT Volume: 748140
<20101130 22:35:06.243961> id=2 symbol=MSFT highPrice: 25.47
<20101130 22:35:06.244245> id=2 symbol=MSFT lowPrice: 25.0
<20101130 22:35:06.244538> id=2 symbol=MSFT closePrice: 25.26
<20101130 22:35:06.244831> id=2 symbol=MSFT openPrice: 25.05
<20101130 22:35:06.245177> id=1 symbol=AAPL lastTimestamp: 1291165192
<20101130 22:35:06.245505> id=1 symbol=AAPL lastTimestamp: 1291165193
<20101130 22:35:06.245792> id=1 symbol=AAPL lastPrice: 310.61
<20101130 22:35:06.246074> id=1 symbol=AAPL lastSize: 3
<20101130 22:35:06.246354> id=1 symbol=AAPL highPrice: 314.36
<20101130 22:35:06.246640> id=1 symbol=AAPL lowPrice: 310.87
<20101130 22:35:06.246953> id=1 symbol=AAPL closePrice: 311.15
<20101130 22:35:06.247247> id=1 symbol=AAPL openPrice: 313.54
<20101130 22:35:06.247533> id=3 symbol=GOOG bidPrice: -1.0  bidSize: 0
<20101130 22:35:06.247817> id=3 symbol=GOOG askPrice: -1.0  askSize: 0
<20101130 22:35:06.248106> id=3 symbol=GOOG bidSize: 0
<20101130 22:35:06.248407> id=3 symbol=GOOG askSize: 0
<20101130 22:35:06.248668> id=2 symbol=MSFT bidPrice: -1.0  bidSize: 0
<20101130 22:35:06.248950> id=2 symbol=MSFT askPrice: -1.0  askSize: 0
<20101130 22:35:06.249240> id=2 symbol=MSFT bidSize: 0
<20101130 22:35:06.249495> id=2 symbol=MSFT askSize: 0
<20101130 22:35:06.249760> id=1 symbol=AAPL bidPrice: -1.0  bidSize: 0
<20101130 22:35:06.250384> id=1 symbol=AAPL askPrice: -1.0  askSize: 0
<20101130 22:35:06.250686> id=1 symbol=AAPL bidSize: 0
<20101130 22:35:06.250944> id=1 symbol=AAPL askSize: 0
<20101130 22:35:06.738089> id=3 symbol=GOOG optionCallVolume: 90983
<20101130 22:35:06.739385> id=3 symbol=GOOG optionPutVolume: 57624
<20101130 22:35:06.739859> id=3 symbol=GOOG optionCallOpenInterest: 221292
<20101130 22:35:06.740257> id=3 symbol=GOOG optionPutOpenInterest: 233827
<20101130 22:35:06.740883> id=3 symbol=GOOG optionHistoricalVol:
0.178315171961558 NA
<20101130 22:35:06.741311> id=3 symbol=GOOG optionImpliedVol:
0.3274484519180543
<20101130 22:35:06.759913> id=3 symbol=GOOG averageVolume: 30729
<20101130 22:35:06.762184> id=3 symbol=GOOG 13-week High: 630.84997559
<20101130 22:35:06.762629> id=3 symbol=GOOG 13-week Low: 448.0
<20101130 22:35:06.765432> id=3 symbol=GOOG 26-week High: 630.84997559
<20101130 22:35:06.765952> id=3 symbol=GOOG 26-week Low: 433.63000488
<20101130 22:35:06.766370> id=3 symbol=GOOG 52-week High: 630.84997559
<20101130 22:35:06.766793> id=3 symbol=GOOG 52-week Low: 433.63000488
<20101130 22:35:06.767260> id=3 symbol=GOOG shortable: 3.0
<20101130 22:35:06.767604> id=1 symbol=AAPL optionCallVolume: 144457
<20101130 22:35:06.767959> id=1 symbol=AAPL optionPutVolume: 83082
<20101130 22:35:06.768316> id=1 symbol=AAPL optionCallOpenInterest: 890598
<20101130 22:35:06.768651> id=1 symbol=AAPL optionPutOpenInterest: 756497
<20101130 22:35:06.769025> id=1 symbol=AAPL optionHistoricalVol:
0.2603498662626889 NA
<20101130 22:35:06.769351> id=1 symbol=AAPL optionImpliedVol:
0.3097714963644166
<20101130 22:35:06.769626> id=1 symbol=AAPL averageVolume: 190711
<20101130 22:35:06.769918> id=1 symbol=AAPL 13-week High: 321.29998779
<20101130 22:35:06.770234> id=1 symbol=AAPL 13-week Low: 240.3500061
<20101130 22:35:06.770544> id=1 symbol=AAPL 26-week High: 321.29998779
<20101130 22:35:06.770867> id=1 symbol=AAPL 26-week Low: 235.55999756
<20101130 22:35:06.771188> id=1 symbol=AAPL 52-week High: 321.29998779
<20101130 22:35:06.771533> id=1 symbol=AAPL 52-week Low: 188.67999268
<20101130 22:35:06.771925> id=1 symbol=AAPL shortable: 3.0
<20101130 22:35:06.772224> id=2 symbol=MSFT optionCallVolume: 42292
<20101130 22:35:06.772529> id=2 symbol=MSFT optionPutVolume: 27265
<20101130 22:35:06.772831> id=2 symbol=MSFT optionCallOpenInterest: 2053102
<20101130 22:35:06.773118> id=2 symbol=MSFT optionPutOpenInterest: 1508825
<20101130 22:35:06.773455> id=2 symbol=MSFT optionHistoricalVol:
0.220308007620513 NA
<20101130 22:35:06.773761> id=2 symbol=MSFT optionImpliedVol:
0.23314777896940903
<20101130 22:35:06.774028> id=2 symbol=MSFT averageVolume: 619543
<20101130 22:35:06.774307> id=2 symbol=MSFT 13-week High: 27.32999992
<20101130 22:35:06.774609> id=2 symbol=MSFT 13-week Low: 23.15999985
<20101130 22:35:06.774904> id=2 symbol=MSFT 26-week High: 27.32999992
<20101130 22:35:06.775214> id=2 symbol=MSFT 26-week Low: 22.44000053
<20101130 22:35:06.775515> id=2 symbol=MSFT 52-week High: 31.14999962
<20101130 22:35:06.775829> id=2 symbol=MSFT 52-week Low: 22.44000053
<20101130 22:35:06.776213> id=2 symbol=MSFT shortable: 3.0

>
> Any ideas?
>
> Thanks in advance,
>
> Soumendra
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan ? ?| ? ?Founder ? ?| ? ?jeffrey.ryan at lemnica.com

www.lemnica.com


From stephen at organicfoodmarkets.com.au  Wed Dec  1 09:28:56 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 01 Dec 2010 19:28:56 +1100
Subject: [R-SIG-Finance] ibrokers
In-Reply-To: <AANLkTi=w2TPA3Hs+9xWg62yJ38u-hiPAEQXGAy628SoT@mail.gmail.com>
References: <4CF1EF45.7040602@organicfoodmarkets.com.au>
	<AANLkTi=w2TPA3Hs+9xWg62yJ38u-hiPAEQXGAy628SoT@mail.gmail.com>
Message-ID: <4CF60748.6080702@organicfoodmarkets.com.au>

Hi Jeff

Thanks, they all seem to work now although reqRealTimeBars and 
reqMktDepth only work while the market is trading, which i suppose is 
correct anyway.

I'm mainly looking at spreads and I wrote this charting function that 
seems to work very well:



chartIB <- function(sym1, sym2)  {

     one <- reqHistoricalData(tws, twsEquity(sym1, exch='ASX', 
currency="AUD"),duration = "6 M")
     two <- reqHistoricalData(tws, twsEquity(sym2, exch='ASX', 
currency="AUD"),duration = "6 M")

     chartSeries(one - two, type='line',name=c(' ', sym1, ' - ', 
sym2),theme=chartTheme('white'),TA=NULL)
     addBBands(n = 20, sd = 2, maType = "SMA", draw = 'bands', on = -1)


}

library(IBrokers)
library('quantmod')
tws <- twsConnect()
tws
chartIB('CBA','NAB')
dev.new()
chartIB('CBA','WBC')

I'm using the bollinger function to draw 2 standard deviations which are 
my boundaries and if the spread is outside them I open short or long and 
hold until I get back to the mean.  I test for co-integration first but 
I haven't done any work on time to revert to mean or indeed on if 2 
standard deviations is the optimum boundary..

I wouldn't  mind doing the same sort of thing with reqRealTime Bars, but 
I'm still having a lot of trouble using the callbacks in IBrokers.  Did 
I read you are going to run some sort of courses?  is there a more 
fulsome tutorial (with lots of code examples ;-)

I've read your paper Real Time Market Data and Trade Execution but the 
example 2.5 is missing.   I'd love to see it.

Stephen Choularton Ph.D., FIoD


From rory.winston at gmail.com  Wed Dec  1 12:17:04 2010
From: rory.winston at gmail.com (Rory Winston)
Date: Wed, 1 Dec 2010 22:17:04 +1100
Subject: [R-SIG-Finance] FX Forward outrights and FX Swaps
Message-ID: <AANLkTi=h9LVF8TWUgs8mGw2PTr=xz0TiEh1ybgfVm0qz@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101201/f0120d87/attachment.pl>

From dominik.sochin at gmail.com  Wed Dec  1 13:24:17 2010
From: dominik.sochin at gmail.com (dondom)
Date: Wed, 1 Dec 2010 04:24:17 -0800 (PST)
Subject: [R-SIG-Finance] Volatility subsample analysis
Message-ID: <1291206257463-3067158.post@n4.nabble.com>


My problem is the following.  I have applied some filterrules on the SMI to
define points for investment and desinvestment (as in trend analysis). The
aim was to define when upwardstrends and downwardstrends took place.
Afterwards I calculated the volatility for the same dataset and calculated
the mean volatility for each trend (up and down). As expected I found that
uptrends have a lower volatility than downward trends. 
To get to my problem, I would like to analyse now the subsamples for each
trend to get a better insight of this phenomenon. The thing is that I have
now a vector for all upwardtrends and all downwardtrends (vup; vdown). They
look like this. 


vup <- c(0.1,0.2,0.3,0,0,0,0.01,-0.002,0,0,0,0,0,0,0.005,0.1,0.2,0)

Where zeros are placed a downward trend is observed and has to be left out
of the analysis.

This means that for a first subsample I would like to calculate the mean
only for 0.1,0.2 and 0.3. Then for 0.01, -0.002, then for 0.005,0.1,0.2, and
so on


The solution should apply itself to a changing composition of the vector
(because different filterrules are applied)

What I tried is to construct a vector of length vup, with a value 1 where
vup has a value. Then in a second step I wanted to change this vector so
that the first observations are with a 1 after with 2 and so on,... that
would have allowed me to apply the cut or split function in R. Explained in
numbers:

What I have:
x <- c(1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,1,1,0) 

What I want:

y <- c(1,1,1,0,0,0,2,2,0,0,0,0,0,0,3,3,3,0)


As mentioned with "y" I could apply easily a cut or split function and then
calulate the subsample means.

This might be a very simple thing to do, or maybe a completely better
approach can be used.

Thanks in advance for your help
Dominik
-- 
View this message in context: http://r.789695.n4.nabble.com/Volatility-subsample-analysis-tp3067158p3067158.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From patrick at burns-stat.com  Wed Dec  1 16:55:10 2010
From: patrick at burns-stat.com (Patrick Burns)
Date: Wed, 01 Dec 2010 15:55:10 +0000
Subject: [R-SIG-Finance] Volatility subsample analysis
In-Reply-To: <1291206257463-3067158.post@n4.nabble.com>
References: <1291206257463-3067158.post@n4.nabble.com>
Message-ID: <4CF66FDE.9090806@burns-stat.com>

First a comment:

I think it would be better to put NA
as the "not in this trend" value.

Assuming I understand your question
properly (and you've instituted the
above change), you can get what you
want via:

rle(is.na(vup))

On 01/12/2010 12:24, dondom wrote:
>
> My problem is the following.  I have applied some filterrules on the SMI to
> define points for investment and desinvestment (as in trend analysis). The
> aim was to define when upwardstrends and downwardstrends took place.
> Afterwards I calculated the volatility for the same dataset and calculated
> the mean volatility for each trend (up and down). As expected I found that
> uptrends have a lower volatility than downward trends.
> To get to my problem, I would like to analyse now the subsamples for each
> trend to get a better insight of this phenomenon. The thing is that I have
> now a vector for all upwardtrends and all downwardtrends (vup; vdown). They
> look like this.
>
>
> vup<- c(0.1,0.2,0.3,0,0,0,0.01,-0.002,0,0,0,0,0,0,0.005,0.1,0.2,0)
>
> Where zeros are placed a downward trend is observed and has to be left out
> of the analysis.
>
> This means that for a first subsample I would like to calculate the mean
> only for 0.1,0.2 and 0.3. Then for 0.01, -0.002, then for 0.005,0.1,0.2, and
> so on
>
>
> The solution should apply itself to a changing composition of the vector
> (because different filterrules are applied)
>
> What I tried is to construct a vector of length vup, with a value 1 where
> vup has a value. Then in a second step I wanted to change this vector so
> that the first observations are with a 1 after with 2 and so on,... that
> would have allowed me to apply the cut or split function in R. Explained in
> numbers:
>
> What I have:
> x<- c(1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,1,1,0)
>
> What I want:
>
> y<- c(1,1,1,0,0,0,2,2,0,0,0,0,0,0,3,3,3,0)
>
>
> As mentioned with "y" I could apply easily a cut or split function and then
> calulate the subsample means.
>
> This might be a very simple thing to do, or maybe a completely better
> approach can be used.
>
> Thanks in advance for your help
> Dominik

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog


From ben.schreiber58 at gmail.com  Wed Dec  1 21:42:36 2010
From: ben.schreiber58 at gmail.com (ben schreiber)
Date: Wed, 1 Dec 2010 22:42:36 +0200
Subject: [R-SIG-Finance] Markov Switching Models for growth and stock prices
Message-ID: <AANLkTi=rE0439S0dghGX_ubNO_owE9kwQojUZsGrb2wJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101201/6505a1ea/attachment.pl>

From cedrick at cedrickjohnson.com  Wed Dec  1 21:51:21 2010
From: cedrick at cedrickjohnson.com (Johnson, Cedrick W.)
Date: Wed, 01 Dec 2010 15:51:21 -0500
Subject: [R-SIG-Finance] Markov Switching Models for growth and stock
 prices
In-Reply-To: <AANLkTi=rE0439S0dghGX_ubNO_owE9kwQojUZsGrb2wJ@mail.gmail.com>
References: <AANLkTi=rE0439S0dghGX_ubNO_owE9kwQojUZsGrb2wJ@mail.gmail.com>
Message-ID: <4CF6B549.2020501@cedrickjohnson.com>

fMarkovSwitching may have what you're looking for somewhat... also 
perhaps the 'MCMCpack' pkg as well

hth,
c


From fxongoing at hotmail.com  Wed Dec  1 22:23:36 2010
From: fxongoing at hotmail.com (FX Going)
Date: Wed, 1 Dec 2010 15:23:36 -0600
Subject: [R-SIG-Finance] Models for Day Trading
In-Reply-To: <4CF6B549.2020501@cedrickjohnson.com>
References: <AANLkTi=rE0439S0dghGX_ubNO_owE9kwQojUZsGrb2wJ@mail.gmail.com>,
	<4CF6B549.2020501@cedrickjohnson.com>
Message-ID: <COL105-W5A0834912E4EB24697B1DB8260@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101201/3c5d7f14/attachment.pl>

From lestat.jin at gmail.com  Wed Dec  1 23:45:57 2010
From: lestat.jin at gmail.com (=?GB2312?B?vfCzwuih?=)
Date: Wed, 1 Dec 2010 22:45:57 +0000
Subject: [R-SIG-Finance] unstable cointegration vector estimates in Johansen
	test
Message-ID: <AANLkTikff7umQc5sh+wepQapEk-R4VzJcGLP2Nj=+DxT@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101201/fc1c8718/attachment.pl>

From josh.m.ulrich at gmail.com  Thu Dec  2 03:20:45 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 1 Dec 2010 20:20:45 -0600
Subject: [R-SIG-Finance] Models for Day Trading
In-Reply-To: <COL105-W5A0834912E4EB24697B1DB8260@phx.gbl>
References: <AANLkTi=rE0439S0dghGX_ubNO_owE9kwQojUZsGrb2wJ@mail.gmail.com>
	<4CF6B549.2020501@cedrickjohnson.com>
	<COL105-W5A0834912E4EB24697B1DB8260@phx.gbl>
Message-ID: <AANLkTimJK9tj-gBF0P90+VuPYJjSzx0ac3KoqUWSZPr7@mail.gmail.com>

On Wed, Dec 1, 2010 at 3:23 PM, FX Going <fxongoing at hotmail.com> wrote:
>
> Newbie to R. Is there a model that I can use in R to estimate the best entry and exit point based on Mini ES for example during 3am-3pm for each day for six months to year? I also want to findo out how many days the trend has been up before heading down etc.
>
You will probably not get a satisfactory answer to your first question
because, as Pat Burns wrote to Michael "comtech" regarding a similar
question:

Those who say don't know.
Those who know don't say.

   Lao-tzu, Tao Te Ching


Yes, I just quoted a quote.  Nested quotes are the best.

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From mgordon at mcphedge.com  Thu Dec  2 14:12:09 2010
From: mgordon at mcphedge.com (Mark Gordon)
Date: Thu, 2 Dec 2010 08:12:09 -0500
Subject: [R-SIG-Finance] fPortfolio (portfolioFrontier function)
In-Reply-To: <BLU156-w436E76FDC361755EB7E07CA8230@phx.gbl>
References: <BLU156-w436E76FDC361755EB7E07CA8230@phx.gbl>
Message-ID: <2456265B07D72C4AA1EF6B479F3FAB5F01FEF76D@MCPSERVER3.meridiancapitol.local>

 I ran into the same problem with the function minriskPortfolio when I
started using R in September.  I posted the problem, but didn't get any
response.
 
 Within minriskPortfolio there is this line of code:

	 portfolio <- optimize(targetRiskFun, interval =
range(getMu(Data)), 
      	data = Data, spec = spec, constraints = constraints, 
        	tol = .Machine$double.eps^0.5)
 
 The parameter "interval" specificies the range of returns to search for
determining an optimal portfolio.  The "range" function returns an array
containing the returns for the best and worst assets in the dataset.
These returns are feasible only if there is no constriant on owning 100%
of the best or worst asset, respectively.  

 I worked around this by writing my own range function which returns the
best and worst returns subject to my constraints.  I look to create the
minimum return by first setting weights to their minimum constraints
then by choosing a maximum weight on the lowest returning asset, then
choosing the maximum weight on the second lowest returning asset et
cetera until I have my weights equal to 100%.  The calculation for
maximum return is similar.  I am not an R-maven, so I am sure that it is
possible to write more concise code but here is what I did and it works
for me:

MCPrange<-function(data, constraints)
{
mu=getMu(data)
maxCon<-maxWConstraints(data, constraints=constraints)
minCon<-minWConstraints(data, constraints=constraints)
Excess<-maxCon-minCon
summin=sum(minCon)

temp<-sort(mu, index.return=TRUE)
smu=temp$x
sExcess=Excess[temp$ix]
sminCon=minCon[temp$ix]
i=1
while (summin+sum(sExcess[1:i])<1) i=i+1
sExcess[i]=sExcess[i]+1-sum(sExcess[1:i])-summin
sExcess[(i+1):length(sExcess)]=0
min=sum((sExcess+sminCon)*smu)

temp<-sort(mu, decreasing=TRUE, index.return=TRUE)
smu=temp$x
sExcess=Excess[temp$ix]
sminCon=minCon[temp$ix]
i=1
while (summin+sum(sExcess[1:i])<1) i=i+1
sExcess[i]=sExcess[i]+1-sum(sExcess[1:i])-summin
sExcess[(i+1):length(sExcess)]=0
max=sum((sExcess+sminCon)*smu)

return(c(min, max))
}

  I substituted MCPrange for the range function in my version of
minriskPortfolio and use that version in all of my optimization
functions.

Mark

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Maciej Ombach
Sent: Saturday, November 27, 2010 10:35 PM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] fPortfolio (portfolioFrontier function)


In the code below (fPortfolio Version 2110.79, R 2.11.1), if min weights
(min.weights <- c(rep(0, 5), 0.2)) are 0, portfolioFrontier function
works fine.  But when, for example, min weights increase (min.weights <-
c(rep(0.1, 5), 0.2)), a portfolioFrontier call returns the following
error: 
 
Execution stopped:
  The minimum risk portfolio could not be computed.
Possible Reason:
  Your portfolio constraints may be too restrictive.
 
It seems that the minvariancePortfolio function (inside
portfolioFrontier) attempts to minimize risk subject to a return
constraint that is not feasible.  Or am I missing something?  
Any suggestions will be appreciated. 
 
 
library(fPortfolio)
x <- SMALLCAP.RET[,1:6]
spec <- portfolioSpec()
setNFrontierPoints(spec) <- 50
assets.num <- 1:ncol(x)
min.weights <- c(rep(0.1, 5), 0.2)
constraints.min <- paste("minW[", assets.num, "]=", min.weights, sep =
"") max.weights <- c(rep(1, 5), 0.4) constraints.max <- paste("maxW[",
assets.num, "]=", max.weights, sep = "") constraints <-
c(constraints.min, constraints.max) frontier <- portfolioFrontier(x,
spec = spec, constraints = constraints)
 
Maciek  		 	   		  
	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From jyan at alphabetfunds.com  Thu Dec  2 15:04:53 2010
From: jyan at alphabetfunds.com (Jeff Yan)
Date: Thu, 2 Dec 2010 09:04:53 -0500
Subject: [R-SIG-Finance] Models for Day Trading
In-Reply-To: <AANLkTimJK9tj-gBF0P90+VuPYJjSzx0ac3KoqUWSZPr7@mail.gmail.com>
References: <AANLkTi=rE0439S0dghGX_ubNO_owE9kwQojUZsGrb2wJ@mail.gmail.com>
	<4CF6B549.2020501@cedrickjohnson.com>
	<COL105-W5A0834912E4EB24697B1DB8260@phx.gbl>
	<AANLkTimJK9tj-gBF0P90+VuPYJjSzx0ac3KoqUWSZPr7@mail.gmail.com>
Message-ID: <DA86665BCA2EEB4C9D98F7006B30D6B3012756F044@pit-exmbx-02>

People usually use a signal generation mechanism based on either observable data or state space model.


-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Joshua Ulrich
Sent: Wednesday, December 01, 2010 9:21 PM
To: FX Going
Cc: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Models for Day Trading

On Wed, Dec 1, 2010 at 3:23 PM, FX Going <fxongoing at hotmail.com> wrote:
>
> Newbie to R. Is there a model that I can use in R to estimate the best entry and exit point based on Mini ES for example during 3am-3pm for each day for six months to year? I also want to findo out how many days the trend has been up before heading down etc.
>
You will probably not get a satisfactory answer to your first question
because, as Pat Burns wrote to Michael "comtech" regarding a similar
question:

Those who say don't know.
Those who know don't say.

   Lao-tzu, Tao Te Ching


Yes, I just quoted a quote.  Nested quotes are the best.

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

The information contained in this electronic message is ...{{dropped:21}}


From hfwittmann at googlemail.com  Thu Dec  2 15:29:29 2010
From: hfwittmann at googlemail.com (H. Felix Wittmann)
Date: Thu, 02 Dec 2010 15:29:29 +0100
Subject: [R-SIG-Finance] table.Drawdowns table in PerformanceAnalytics
Message-ID: <4CF7AD49.2040908@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101202/92bbb886/attachment.pl>

From hfwittmann at googlemail.com  Thu Dec  2 16:08:26 2010
From: hfwittmann at googlemail.com (H. Felix Wittmann)
Date: Thu, 02 Dec 2010 16:08:26 +0100
Subject: [R-SIG-Finance] table.Drawdowns table in PerformanceAnalytics
In-Reply-To: <4CF7AE6D.6010005@braverock.com>
References: <4CF7AD49.2040908@gmail.com> <4CF7AE6D.6010005@braverock.com>
Message-ID: <4CF7B66A.6060600@gmail.com>

Brian,

thank you for your answer. I enclose the patch (the relevant lines are 
enclosed by case 0/ end case 0

Felix

PS : in the next few days I will probably have some more suggestions for 
patches, should I post this to r-sig-finance at r-project.org, too, or just 
email you.


On 02/12/10 15:34, Brian G. Peterson wrote:
> Felix,
>
> I'm glad you find the package useful.
>
> I also agree with your logic.  If you have te time to craft a patch, 
> we would be happy to include it (with attribution), otherwise I'll add 
> it to my list of things to do.
>
> Regards,
>
>    - Brian
>
> On 12/02/2010 08:29 AM, H. Felix Wittmann wrote:
>>   Brian,
>>
>> first of all: thanks again for an excellent package. I believe you've
>> done a great job for the community!
>>
>> I have noticed that table.Drawdowns  produces spurious/erroneous results
>> when number of drawdowns is less than 1.
>>
>> In my view it would be desirable in the case of no drawdowns to have an
>> output similar to the cases with one/two drawdowns in the series. ie
>> somthing like this
>>
>>
>> *Desired output when number of drawdowns is less than 1.*
>>
>>      [1] From      Trough    To        Depth     Length    To Trough
>> Recovery
>> <0 rows> (or 0-length row.names)
>>
>>      Warning message:
>>      In table.Drawdowns(z.two.drawdowns) : Only 0 available in the data.
>>
>>
>> I include some code (in blue, output in brown)
>>
>>      require(PerformanceAnalytics)
>>      set.seed(seed = 166, kind = NULL, normal.kind = NULL)
>>
>>
>>      time <- as.Date('01/12/2010', "%d/%m/%Y") + +seq(10)*31
>>
>>      z.two.drawdowns <-
>> zoo(c(-0.1,0.2,-0.05,(rnorm(10)/10+1)/10),order.by = time)
>>      z.one.drawdown <- zoo(c(-0.1,(rnorm(10)/10+1)/10),order.by = time)
>>      z.no.drawdown <- zoo((rnorm(10)/10+1)/10,order.by = time)
>>
>>
>>
>>      table.Drawdowns(z.two.drawdowns)
>>          From     Trough         To Depth Length To Trough Recovery
>> 1 2011-01-01 2011-01-01 2011-02-01 -0.10      2         1        1
>> 2 2011-03-04 2011-03-04 2011-04-04 -0.05      2         1        1
>> Warning message:
>> In table.Drawdowns(z.two.drawdowns) : Only 2 available in the data.
>>          From     Trough         To Depth Length To Trough Recovery
>>
>>      table.Drawdowns(z.one.drawdown)
>>
>> 1 2011-01-01 2011-01-01 2011-03-04  -0.1      3         1        2
>> Warning message:
>> In table.Drawdowns(z.one.drawdown) : Only 1 available in the data.
>>
>>      table.Drawdowns(z.no.drawdown)
>>
>> Error in if (runs$return[j] > runs$return[j + 1]) { :
>>    missing value where TRUE/FALSE needed
>> Calls: table.Drawdowns -> sortDrawdowns
>>
>>
>> As one can see from the above, the output in the case of no drawdowns is
>> markedly different. However, I would prefer it to be similar. Happy to
>> provide patches.
>>
>> Cheers, Felix
>>
>>
>
>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: table.Drawdowns.r
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101202/df04eb57/attachment.pl>

From cevans at chyden.net  Thu Dec  2 16:33:05 2010
From: cevans at chyden.net (Charles Evans)
Date: Thu, 2 Dec 2010 10:33:05 -0500
Subject: [R-SIG-Finance] unstable cointegration vector estimates in
	Johansen test
In-Reply-To: <AANLkTikff7umQc5sh+wepQapEk-R4VzJcGLP2Nj=+DxT@mail.gmail.com>
References: <AANLkTikff7umQc5sh+wepQapEk-R4VzJcGLP2Nj=+DxT@mail.gmail.com>
Message-ID: <76BB4672-D18E-44F9-9DA9-5B50D523DD4A@chyden.net>

Hello Paul (Lestat?!?),

In my work, I have looked at potential cointegration between certain  
categories of ETFs and the most nearly related futures, and I have  
found wide disagreement among different cointegration tests.

Different cointegration tests have different strengths and  
weaknesses.  Because there is rarely a conclusive reason to prefer any  
particular cointegration test over all others.  Optimally, one would  
use a variety (e.g., Engle-Granger/ADF, Engle-Granger/Phillips-Perron,  
ECM, Phillips-Ouliaris [ca.po], Johansen [ca.jo]) and run with the  
consensus.  Although it could be a bit tedious, you could run your  
rolling cointegration tests using each of these and see if you get the  
same odd behavior consistently.  If you do, then that would suggest  
something interesting; if not, then it could just be an artifact of  
the specific test.

If you have access to statistics and econometrics journals, you might  
find these papers helpful:

Gregory, Allan W., Alfred A. Haug, and Nicoletta Lomuto, 2004, Mixed  
signals among tests for cointegration. Journal of Applied Econometrics  
19 (1), 89-98.

Hanck, Christoph, 2007, Mixed signals among panel cointegration tests.  
Working Paper.
https://editorialexpress.com/cgibin/conference/download.cgi?db_name=sce2007&paper_id=115

Haug, Alfred A., 1996, Tests for cointegration: A Monte Carlo  
comparison. Journal of Econometrics 71, 89-115.

?stermark, Ralf and Rune H?glund, 2000. Monte Carlo tests of  
cointegration with structural breaks. Kybernetes 29 (9/10), 1284-1297.

?stermark, Ralf and Rune H?glund, 1999. Simulating competing  
cointegration tests in a bivariate system. Journal of Applied  
Statistics 27 (7), 831-846.

HTH,

Charles Evans
cevans at chyden.net

No one ever says, "First shoot all the plumbers."
Steve Foerster

On 1 Dec 2010, at 5:45 PM, ??? wrote:

> Hi, all,
>
> a question regarding the cointegration relations (vectors) estimate  
> in the
> Johansen test:
>
> I have a data sample which is confirmed by the Johansen test as
> cointegrated, however, if I take a subsample of the whole times  
> series, each
> time add one data point and using the "ca.jo" function in R to  
> estimate the
> cointegrating vector, i.e. to do a forward recursive test, and  
> record the
> estimate beta (the first element of the vector is normalized to one,  
> beta is
> the second element), strangely at some point, beta shows  
> discontinuity-a big
> jump with sign change. This is really confusing to me as it seems  
> that the
> Johansen procedure is not robust in that one additional data could  
> cause
> dramatical change in the estimate of beta. not sure if it is problem  
> of the
> procedure or the ca.jo function, I think my data is fine (excluding  
> errors
> and outliers). has anyone seen similar things as me?
>
> Regards,
> Paul C. Jin
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R  
> questions should go.


From brian at braverock.com  Thu Dec  2 16:53:45 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 02 Dec 2010 09:53:45 -0600
Subject: [R-SIG-Finance] table.Drawdowns table in PerformanceAnalytics
In-Reply-To: <4CF7B66A.6060600@gmail.com>
References: <4CF7AD49.2040908@gmail.com> <4CF7AE6D.6010005@braverock.com>
	<4CF7B66A.6060600@gmail.com>
Message-ID: <4CF7C109.2030905@braverock.com>

Felix,

Since these are specific to PerformanceAnalytics, we probably don't need 
to bother the list with the discussion.

Any patches committed will be made with complete attribution, and our 
gratitude for the feedback and contribution.

Regards,

    - Brian

On 12/02/2010 09:08 AM, H. Felix Wittmann wrote:
> Brian,
>
> thank you for your answer. I enclose the patch (the relevant lines are
> enclosed by case 0/ end case 0
>
> Felix
>
> PS : in the next few days I will probably have some more suggestions for
> patches, should I post this to r-sig-finance at r-project.org, too, or just
> email you.
>
>
> On 02/12/10 15:34, Brian G. Peterson wrote:
>> Felix,
>>
>> I'm glad you find the package useful.
>>
>> I also agree with your logic. If you have te time to craft a patch, we
>> would be happy to include it (with attribution), otherwise I'll add it
>> to my list of things to do.
>>
>> Regards,
>>
>> - Brian
>>
>> On 12/02/2010 08:29 AM, H. Felix Wittmann wrote:
>>> Brian,
>>>
>>> first of all: thanks again for an excellent package. I believe you've
>>> done a great job for the community!
>>>
>>> I have noticed that table.Drawdowns produces spurious/erroneous results
>>> when number of drawdowns is less than 1.
>>>
>>> In my view it would be desirable in the case of no drawdowns to have an
>>> output similar to the cases with one/two drawdowns in the series. ie
>>> somthing like this
>>>
>>>
>>> *Desired output when number of drawdowns is less than 1.*
>>>
>>> [1] From Trough To Depth Length To Trough
>>> Recovery
>>> <0 rows> (or 0-length row.names)
>>>
>>> Warning message:
>>> In table.Drawdowns(z.two.drawdowns) : Only 0 available in the data.
>>>
>>>
>>> I include some code (in blue, output in brown)
>>>
>>> require(PerformanceAnalytics)
>>> set.seed(seed = 166, kind = NULL, normal.kind = NULL)
>>>
>>>
>>> time <- as.Date('01/12/2010', "%d/%m/%Y") + +seq(10)*31
>>>
>>> z.two.drawdowns <-
>>> zoo(c(-0.1,0.2,-0.05,(rnorm(10)/10+1)/10),order.by = time)
>>> z.one.drawdown <- zoo(c(-0.1,(rnorm(10)/10+1)/10),order.by = time)
>>> z.no.drawdown <- zoo((rnorm(10)/10+1)/10,order.by = time)
>>>
>>>
>>>
>>> table.Drawdowns(z.two.drawdowns)
>>> From Trough To Depth Length To Trough Recovery
>>> 1 2011-01-01 2011-01-01 2011-02-01 -0.10 2 1 1
>>> 2 2011-03-04 2011-03-04 2011-04-04 -0.05 2 1 1
>>> Warning message:
>>> In table.Drawdowns(z.two.drawdowns) : Only 2 available in the data.
>>> From Trough To Depth Length To Trough Recovery
>>>
>>> table.Drawdowns(z.one.drawdown)
>>>
>>> 1 2011-01-01 2011-01-01 2011-03-04 -0.1 3 1 2
>>> Warning message:
>>> In table.Drawdowns(z.one.drawdown) : Only 1 available in the data.
>>>
>>> table.Drawdowns(z.no.drawdown)
>>>
>>> Error in if (runs$return[j] > runs$return[j + 1]) { :
>>> missing value where TRUE/FALSE needed
>>> Calls: table.Drawdowns -> sortDrawdowns
>>>
>>>
>>> As one can see from the above, the output in the case of no drawdowns is
>>> markedly different. However, I would prefer it to be similar. Happy to
>>> provide patches.
>>>
>>> Cheers, Felix
>>>
>>>
>>
>>
>


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From stephen at organicfoodmarkets.com.au  Thu Dec  2 20:29:07 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Fri, 03 Dec 2010 06:29:07 +1100
Subject: [R-SIG-Finance] ibrokers - new callback
Message-ID: <4CF7F383.4040604@organicfoodmarkets.com.au>

I'm trying to work through Jeff's example for a new callback from his 
presentation Real Time Trading in R at R/Rmetrics 2009:

twsOC <- twsConnect(2) # our order connection
ocWrapper <- eWrapper(TRUE)
traded <- FALSE
while (TRUE) {
     cons <- socketSelect(list(con, twsOC[[1]]), FALSE, 0.01)
     if(cons[1]) { #data
         curMsg <- readBin(con, character(), 1)
         if (!is.null(timestamp)) {
             processMsg(curMsg, con, eWrapper, format(Sys.time(), 
timestamp), file, ...)
         } else {
             processMsg(curMsg, con, eWrapper, timestamp, file, ...)
         }
     } else if(cons[2]) {
         curMsg <- readBin(twsOC[[1]], character(), 1)
         if (!is.null(timestamp)) {
             processMsg(curMsg, twsOC[[1]], ocWrapper, 
format(Sys.time(), timestamp), file, ...)
         } else {
             processMsg(curMsg, twsOC[[1]], ocWrapper, timestamp, file, ...)
         }
     } #TRADE LOGIC HERE
     curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
     if(!traded && !is.na(curBID) && curBID > 141.00) {
         c("this is the order line")
         # IBrokers:::.placeOrder(twsOC, twsSTK("AAPL"), twsOrder(1053, 
"BUY", "10", "MKT"))
         traded <- TRUE
     }
}

First, I think that there was a missing } at the end of the loop on the 
slide, so I added one.  However, when I run it I get:

Error in socketSelect(list(con, twsOC[[1]]), FALSE, 0.01) :
   object 'con' not found


I know I have a connection:

twsOC
<twsConnection,2 @ 20101203 06:16:05 Eastern Standard Time (New South 
Wales), nextId=-1>
 >


  Can anyone advise me what's wrong?

  Incidentally, I don't see how this code gets info on AAPL.  The first 
time its mentioned is down in the TRADE LOGIC HERE section.  Can anyone 
clarify?



-- 
Stephen Choularton Ph.D., FIoD


From breman.mark at gmail.com  Thu Dec  2 20:42:00 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 2 Dec 2010 20:42:00 +0100
Subject: [R-SIG-Finance] ibrokers - new callback
In-Reply-To: <4CF7F383.4040604@organicfoodmarkets.com.au>
References: <4CF7F383.4040604@organicfoodmarkets.com.au>
Message-ID: <AANLkTin6oenWNGuMu3VvOpgGN2bmfMkvzYhmOyX8aGh8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101202/c4720f16/attachment.pl>

From joshchien at yahoo.com  Fri Dec  3 06:43:26 2010
From: joshchien at yahoo.com (JOSH CHIEN)
Date: Thu, 2 Dec 2010 21:43:26 -0800 (PST)
Subject: [R-SIG-Finance] Exponentially Weighted Moving Average (EWMA) in R
	library
Message-ID: <93696.89475.qm@web113102.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101202/b1216b86/attachment.pl>

From daniel.cegielka at gmail.com  Fri Dec  3 07:13:11 2010
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Fri, 3 Dec 2010 07:13:11 +0100
Subject: [R-SIG-Finance] Exponentially Weighted Moving Average (EWMA) in
	R library
In-Reply-To: <93696.89475.qm@web113102.mail.gq1.yahoo.com>
References: <93696.89475.qm@web113102.mail.gq1.yahoo.com>
Message-ID: <AANLkTimRrcZv23Ve6x_htYOUipaE_ez9e+RVyX0J9YDp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101203/b352fa92/attachment.pl>

From matthieu.stigler at gmail.com  Fri Dec  3 11:53:04 2010
From: matthieu.stigler at gmail.com (mat)
Date: Fri, 03 Dec 2010 11:53:04 +0100
Subject: [R-SIG-Finance] unstable cointegration vector estimates in
 Johansen test
In-Reply-To: <76BB4672-D18E-44F9-9DA9-5B50D523DD4A@chyden.net>
References: <AANLkTikff7umQc5sh+wepQapEk-R4VzJcGLP2Nj=+DxT@mail.gmail.com>
	<76BB4672-D18E-44F9-9DA9-5B50D523DD4A@chyden.net>
Message-ID: <4CF8CC10.20207@gmail.com>

Hi

Besides the problem of different results based on different estimators, 
the fact that when doing a rolling analysis you find very different 
values with the same estimator could be due to a strange finite sample 
property of the ML estimator. Philips (ref below) finds indeed that in 
small samples the ML estimator has no finite moments, what can explain 
that single value have important impacts.

See:

Phillips, Peter C B, 1994.
"Some Exact Distribution Theory for Maximum Likelihood Estimators of Cointegrating Coefficients in Error Correction Models,"
Econometrica, Econometric Society, vol. 62(1), pages 73-93, January.

http://ideas.repec.org/a/ecm/emetrp/v62y1994i1p73-93.html

Best

Matthieu



Le 02. 12. 10 16:33, Charles Evans a ?crit :
> Hello Paul (Lestat?!?),
>
> In my work, I have looked at potential cointegration between certain 
> categories of ETFs and the most nearly related futures, and I have 
> found wide disagreement among different cointegration tests.
>
> Different cointegration tests have different strengths and 
> weaknesses.  Because there is rarely a conclusive reason to prefer any 
> particular cointegration test over all others.  Optimally, one would 
> use a variety (e.g., Engle-Granger/ADF, Engle-Granger/Phillips-Perron, 
> ECM, Phillips-Ouliaris [ca.po], Johansen [ca.jo]) and run with the 
> consensus.  Although it could be a bit tedious, you could run your 
> rolling cointegration tests using each of these and see if you get the 
> same odd behavior consistently.  If you do, then that would suggest 
> something interesting; if not, then it could just be an artifact of 
> the specific test.
>
> If you have access to statistics and econometrics journals, you might 
> find these papers helpful:
>
> Gregory, Allan W., Alfred A. Haug, and Nicoletta Lomuto, 2004, Mixed 
> signals among tests for cointegration. Journal of Applied Econometrics 
> 19 (1), 89-98.
>
> Hanck, Christoph, 2007, Mixed signals among panel cointegration tests. 
> Working Paper.
> https://editorialexpress.com/cgibin/conference/download.cgi?db_name=sce2007&paper_id=115 
>
>
> Haug, Alfred A., 1996, Tests for cointegration: A Monte Carlo 
> comparison. Journal of Econometrics 71, 89-115.
>
> ?stermark, Ralf and Rune H?glund, 2000. Monte Carlo tests of 
> cointegration with structural breaks. Kybernetes 29 (9/10), 1284-1297.
>
> ?stermark, Ralf and Rune H?glund, 1999. Simulating competing 
> cointegration tests in a bivariate system. Journal of Applied 
> Statistics 27 (7), 831-846.
>
> HTH,
>
> Charles Evans
> cevans at chyden.net
>
> No one ever says, "First shoot all the plumbers."
> Steve Foerster
>
> On 1 Dec 2010, at 5:45 PM, ??? wrote:
>
>> Hi, all,
>>
>> a question regarding the cointegration relations (vectors) estimate 
>> in the
>> Johansen test:
>>
>> I have a data sample which is confirmed by the Johansen test as
>> cointegrated, however, if I take a subsample of the whole times 
>> series, each
>> time add one data point and using the "ca.jo" function in R to 
>> estimate the
>> cointegrating vector, i.e. to do a forward recursive test, and record 
>> the
>> estimate beta (the first element of the vector is normalized to one, 
>> beta is
>> the second element), strangely at some point, beta shows 
>> discontinuity-a big
>> jump with sign change. This is really confusing to me as it seems 
>> that the
>> Johansen procedure is not robust in that one additional data could cause
>> dramatical change in the estimate of beta. not sure if it is problem 
>> of the
>> procedure or the ca.jo function, I think my data is fine (excluding 
>> errors
>> and outliers). has anyone seen similar things as me?
>>
>> Regards,
>> Paul C. Jin
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R 
>> questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.


From ezivot at u.washington.edu  Fri Dec  3 18:26:10 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Fri, 3 Dec 2010 09:26:10 -0800
Subject: [R-SIG-Finance] unstable cointegration vector estimates in
	Johansen test
In-Reply-To: <4CF8CC10.20207@gmail.com>
References: <AANLkTikff7umQc5sh+wepQapEk-R4VzJcGLP2Nj=+DxT@mail.gmail.com>	<76BB4672-D18E-44F9-9DA9-5B50D523DD4A@chyden.net>
	<4CF8CC10.20207@gmail.com>
Message-ID: <00df01cb930f$2d19a900$874cfb00$@washington.edu>

The situation is even worse, because rolling estimates are correlated as well. Because the finite sample distn has no moments, you expect to see crazy results from the Johansen MLE from time to time. I have certainly seen estimates that are 10,000 when they should be near 1. This of course, makes it very difficult to judge the stability of recursive or rolling MLEs. Because the Stock-Watson DOLS estimates are regression they will be more stable. Still it would be nice to have some distribution theory for moving estimates of a cointegrating vector. Banerjee, Lumsdain and Stock has a JBES 1992 paper that derived the distn of rolling and recursive unit root tests. It would be nice to know if such an analysis has been done for cointegration.

Eric Zivot                  			               
Robert Richards Chaired Professor of Economics
Adjunct Professor of Finance                            
Adjunct Professor of Statistics
Department of Economics
Box 353330                  email:  ezivot at u.washington.edu 
University of Washington    phone:  206-543-6715            
Seattle, WA 98195-3330                                                                                                   www:  http://faculty.washington.edu/ezivot                  



-----Original Message-----
From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of mat
Sent: Friday, December 03, 2010 2:53 AM
To: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] unstable cointegration vector estimates in Johansen test

Hi

Besides the problem of different results based on different estimators, 
the fact that when doing a rolling analysis you find very different 
values with the same estimator could be due to a strange finite sample 
property of the ML estimator. Philips (ref below) finds indeed that in 
small samples the ML estimator has no finite moments, what can explain 
that single value have important impacts.

See:

Phillips, Peter C B, 1994.
"Some Exact Distribution Theory for Maximum Likelihood Estimators of Cointegrating Coefficients in Error Correction Models,"
Econometrica, Econometric Society, vol. 62(1), pages 73-93, January.

http://ideas.repec.org/a/ecm/emetrp/v62y1994i1p73-93.html

Best

Matthieu



Le 02. 12. 10 16:33, Charles Evans a ?crit :
> Hello Paul (Lestat?!?),
>
> In my work, I have looked at potential cointegration between certain 
> categories of ETFs and the most nearly related futures, and I have 
> found wide disagreement among different cointegration tests.
>
> Different cointegration tests have different strengths and 
> weaknesses.  Because there is rarely a conclusive reason to prefer any 
> particular cointegration test over all others.  Optimally, one would 
> use a variety (e.g., Engle-Granger/ADF, Engle-Granger/Phillips-Perron, 
> ECM, Phillips-Ouliaris [ca.po], Johansen [ca.jo]) and run with the 
> consensus.  Although it could be a bit tedious, you could run your 
> rolling cointegration tests using each of these and see if you get the 
> same odd behavior consistently.  If you do, then that would suggest 
> something interesting; if not, then it could just be an artifact of 
> the specific test.
>
> If you have access to statistics and econometrics journals, you might 
> find these papers helpful:
>
> Gregory, Allan W., Alfred A. Haug, and Nicoletta Lomuto, 2004, Mixed 
> signals among tests for cointegration. Journal of Applied Econometrics 
> 19 (1), 89-98.
>
> Hanck, Christoph, 2007, Mixed signals among panel cointegration tests. 
> Working Paper.
> https://editorialexpress.com/cgibin/conference/download.cgi?db_name=sce2007&paper_id=115 
>
>
> Haug, Alfred A., 1996, Tests for cointegration: A Monte Carlo 
> comparison. Journal of Econometrics 71, 89-115.
>
> ?stermark, Ralf and Rune H?glund, 2000. Monte Carlo tests of 
> cointegration with structural breaks. Kybernetes 29 (9/10), 1284-1297.
>
> ?stermark, Ralf and Rune H?glund, 1999. Simulating competing 
> cointegration tests in a bivariate system. Journal of Applied 
> Statistics 27 (7), 831-846.
>
> HTH,
>
> Charles Evans
> cevans at chyden.net
>
> No one ever says, "First shoot all the plumbers."
> Steve Foerster
>
> On 1 Dec 2010, at 5:45 PM, ??? wrote:
>
>> Hi, all,
>>
>> a question regarding the cointegration relations (vectors) estimate 
>> in the
>> Johansen test:
>>
>> I have a data sample which is confirmed by the Johansen test as
>> cointegrated, however, if I take a subsample of the whole times 
>> series, each
>> time add one data point and using the "ca.jo" function in R to 
>> estimate the
>> cointegrating vector, i.e. to do a forward recursive test, and record 
>> the
>> estimate beta (the first element of the vector is normalized to one, 
>> beta is
>> the second element), strangely at some point, beta shows 
>> discontinuity-a big
>> jump with sign change. This is really confusing to me as it seems 
>> that the
>> Johansen procedure is not robust in that one additional data could cause
>> dramatical change in the estimate of beta. not sure if it is problem 
>> of the
>> procedure or the ca.jo function, I think my data is fine (excluding 
>> errors
>> and outliers). has anyone seen similar things as me?
>>
>> Regards,
>> Paul C. Jin
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R 
>> questions should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


From stephen at organicfoodmarkets.com.au  Sat Dec  4 11:07:23 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Sat, 04 Dec 2010 21:07:23 +1100
Subject: [R-SIG-Finance] ibrokers - callback - example from Jeff Ryan's
	slides
Message-ID: <4CFA12DB.4040100@organicfoodmarkets.com.au>

I'm trying to make this work (its based on an example from Jeff Ryan's 
slides):

library(IBrokers)


myCALLBACK <-
function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
     twsOC <- twsConnect(2) # our order connection
     ocWrapper <- eWrapper(TRUE)
     traded <- FALSE
     while (TRUE) {
         cons <- socketSelect(list(con, twsOC[[1]]), FALSE, 0.01)
         if(cons[1]) { #data
             curMsg <- readBin(con, character(), 1)
             if (!is.null(timestamp)) {
                 processMsg(curMsg, con, eWrapper, format(Sys..time(), 
timestamp), file, ...)
             } else {
                 processMsg(curMsg, con, eWrapper, timestamp, file, ...)
             }
         } else if(cons[2]) {
             curMsg <- readBin(twsOC[[1]], character(), 1)
             if (!is.null(timestamp)) {
                 processMsg(curMsg, twsOC[[1]], ocWrapper, 
format(Sys..time(), timestamp), file, ...)
             } else {
                 processMsg(curMsg, twsOC[[1]], ocWrapper, timestamp, 
file, ...)
             }
         } # TRADE LOGIC HERE
         curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
         if(!traded && !is.na(curBID) && curBID > 141.00) {

             print("this is the order line")
             # IBrokers:::.placeOrder(twsOC, 
twsEquity("CBA","ASX","AUD"), twsOrder(1053, "BUY", "0", "MKT"))
             traded <- TRUE
         }
     }
}

con = twsConnect(1)



reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)

but I get:

Error in socketSelect(list(con, twsOC[[1]]), FALSE, 0.01) :
   invalid connection

Does anyone know what I am doing wrong? Or does anyone have a working 
example?

my  sessionInfo() is
R version 2.11.1 (2010-05-31)
i386-pc-mingw32

locale:
[1] LC_COLLATE=English_United States.1252
[2] LC_CTYPE=English_United States.1252
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] IBrokers_0.2-9 xts_0.7-5      zoo_1.6-4

loaded via a namespace (and not attached):
[1] grid_2.11.1    lattice_0.18-8



-- 
Stephen Choularton Ph.D., FIoD


From jeff.a.ryan at gmail.com  Sat Dec  4 16:43:33 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sat, 4 Dec 2010 09:43:33 -0600
Subject: [R-SIG-Finance] ibrokers - callback - example from Jeff Ryan's
	slides
In-Reply-To: <4CFA12DB.4040100@organicfoodmarkets.com.au>
References: <4CFA12DB.4040100@organicfoodmarkets.com.au>
Message-ID: <1247B61B-0CDA-438B-8D8D-8829B0997610@gmail.com>

Sorry I don't have the time to walk you through this, but for starters you can just remove the second connection from the mix. 

The general placement of the logic should be correct though. 

Jeff

Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Dec 4, 2010, at 4:07 AM, Stephen Choularton <stephen at organicfoodmarkets.com.au> wrote:

> I'm trying to make this work (its based on an example from Jeff Ryan's slides):
> 
> library(IBrokers)
> 
> 
> myCALLBACK <-
> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>    twsOC <- twsConnect(2) # our order connection
>    ocWrapper <- eWrapper(TRUE)
>    traded <- FALSE
>    while (TRUE) {
>        cons <- socketSelect(list(con, twsOC[[1]]), FALSE, 0.01)
>        if(cons[1]) { #data
>            curMsg <- readBin(con, character(), 1)
>            if (!is.null(timestamp)) {
>                processMsg(curMsg, con, eWrapper, format(Sys..time(), timestamp), file, ...)
>            } else {
>                processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>            }
>        } else if(cons[2]) {
>            curMsg <- readBin(twsOC[[1]], character(), 1)
>            if (!is.null(timestamp)) {
>                processMsg(curMsg, twsOC[[1]], ocWrapper, format(Sys..time(), timestamp), file, ...)
>            } else {
>                processMsg(curMsg, twsOC[[1]], ocWrapper, timestamp, file, ...)
>            }
>        } # TRADE LOGIC HERE
>        curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
>        if(!traded && !is.na(curBID) && curBID > 141.00) {
> 
>            print("this is the order line")
>            # IBrokers:::.placeOrder(twsOC, twsEquity("CBA","ASX","AUD"), twsOrder(1053, "BUY", "0", "MKT"))
>            traded <- TRUE
>        }
>    }
> }
> 
> con = twsConnect(1)
> 
> 
> 
> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
> 
> but I get:
> 
> Error in socketSelect(list(con, twsOC[[1]]), FALSE, 0.01) :
>  invalid connection
> 
> Does anyone know what I am doing wrong? Or does anyone have a working example?
> 
> my  sessionInfo() is
> R version 2.11.1 (2010-05-31)
> i386-pc-mingw32
> 
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] IBrokers_0.2-9 xts_0.7-5      zoo_1.6-4
> 
> loaded via a namespace (and not attached):
> [1] grid_2.11.1    lattice_0.18-8
> 
> 
> 
> -- 
> Stephen Choularton Ph.D., FIoD
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From jeff.a.ryan at gmail.com  Sat Dec  4 16:46:46 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sat, 4 Dec 2010 09:46:46 -0600
Subject: [R-SIG-Finance] ibrokers - callback - example from Jeff Ryan's
	slides
In-Reply-To: <4CFA12DB.4040100@organicfoodmarkets.com.au>
References: <4CFA12DB.4040100@organicfoodmarkets.com.au>
Message-ID: <BB247535-023F-40FC-8A48-418F29BD79D5@gmail.com>

Note also that you need to upgrade your IBrokers package to the current CRAN release. 

Best,
Jeff

Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Dec 4, 2010, at 4:07 AM, Stephen Choularton <stephen at organicfoodmarkets.com.au> wrote:

> I'm trying to make this work (its based on an example from Jeff Ryan's slides):
> 
> library(IBrokers)
> 
> 
> myCALLBACK <-
> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>    twsOC <- twsConnect(2) # our order connection
>    ocWrapper <- eWrapper(TRUE)
>    traded <- FALSE
>    while (TRUE) {
>        cons <- socketSelect(list(con, twsOC[[1]]), FALSE, 0.01)
>        if(cons[1]) { #data
>            curMsg <- readBin(con, character(), 1)
>            if (!is.null(timestamp)) {
>                processMsg(curMsg, con, eWrapper, format(Sys..time(), timestamp), file, ...)
>            } else {
>                processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>            }
>        } else if(cons[2]) {
>            curMsg <- readBin(twsOC[[1]], character(), 1)
>            if (!is.null(timestamp)) {
>                processMsg(curMsg, twsOC[[1]], ocWrapper, format(Sys..time(), timestamp), file, ...)
>            } else {
>                processMsg(curMsg, twsOC[[1]], ocWrapper, timestamp, file, ...)
>            }
>        } # TRADE LOGIC HERE
>        curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
>        if(!traded && !is.na(curBID) && curBID > 141.00) {
> 
>            print("this is the order line")
>            # IBrokers:::.placeOrder(twsOC, twsEquity("CBA","ASX","AUD"), twsOrder(1053, "BUY", "0", "MKT"))
>            traded <- TRUE
>        }
>    }
> }
> 
> con = twsConnect(1)
> 
> 
> 
> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
> 
> but I get:
> 
> Error in socketSelect(list(con, twsOC[[1]]), FALSE, 0.01) :
>  invalid connection
> 
> Does anyone know what I am doing wrong? Or does anyone have a working example?
> 
> my  sessionInfo() is
> R version 2.11.1 (2010-05-31)
> i386-pc-mingw32
> 
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] IBrokers_0.2-9 xts_0.7-5      zoo_1.6-4
> 
> loaded via a namespace (and not attached):
> [1] grid_2.11.1    lattice_0.18-8
> 
> 
> 
> -- 
> Stephen Choularton Ph.D., FIoD
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From ronmac17 at yahoo.com  Sat Dec  4 18:28:38 2010
From: ronmac17 at yahoo.com (Ronald McEwan)
Date: Sat, 4 Dec 2010 09:28:38 -0800 (PST)
Subject: [R-SIG-Finance] Quantile Regression-Fit Stock data
Message-ID: <828663.14412.qm@web59412.mail.ac4.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101204/0286848d/attachment.pl>

From edd at debian.org  Sat Dec  4 18:59:56 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Sat, 4 Dec 2010 11:59:56 -0600
Subject: [R-SIG-Finance] Quantile Regression-Fit Stock data
In-Reply-To: <828663.14412.qm@web59412.mail.ac4.yahoo.com>
References: <828663.14412.qm@web59412.mail.ac4.yahoo.com>
Message-ID: <19706.33180.174533.824203@max.nulle.part>


On 4 December 2010 at 09:28, Ronald McEwan wrote:
| I am new to R 

Well, welcome!   But one piece of advice: you cross-posted at StackOverflow
and here. Cross-posting is seen as distasteful. Don't do it.

| and I am trying to reproduce some of my Excel models in R. In this 
| project I am trying to perform a Quantile Regression on two Securities. I am not 
| able to get the rq() function to read the stock data I retrieve. From what I 
| have read so far I think I have to provide a definition for the data to enable 
| rq() to recognize it. I have not had success with this so far. I would 
| appreciate advice on how to define the stock market data in a way that the 
| function will recognize the data as a valid input. This is what I have so far.

As I told you in an answer on SO which you chose to ignore so far, you also
seem to regress _prices_ on _prices_. I gave you the Granger and Newbold
reference on spurious regression that predates unit roots, cointegrations and
all that -- don't work in prices, work in returns.

Cheers, Dirk

| Thanks,
| Regards,
| Ron McEwan
| 
| 
| # Quantile Regression - Fit Stock data
| 
| # Get Library
| 
| library(quantmod)
| library(quantreg)
| 
| # Get Stock Data
| 
| stk1 <- getSymbols("DD",  from="2009-12-31", auto.assign=FALSE)
| stk2 <- getSymbols("GE",  from="2009-12-31", auto.assign=FALSE)
| 
| # perform quantile regression procedures
| 
| #median (l1) regression  fit for the stock data.
| 
| rq(stk1 ~ stk2,.5) 
| 
| #the 1st quartile, 
|   
| rq(stk1 ~ stk2,.25)  
| 
| #note that 8 of the 21 points lie exactly on this plane in 4-space! 
| #this returns the full rq process
| 
| rq(stk1 ~ stk2, tau=-1)   
| 
| #ordinary sample median --no rank inversion ci
| 
| rq(rnorm(50) ~ 1, ci=FALSE)    
| 
| #weighted sample median 
| 
| rq(rnorm(50) ~ 1, weights=runif(50),ci=FALSE)  
| 
| 
| 
|       
| 	[[alternative HTML version deleted]]
| 
| _______________________________________________
| R-SIG-Finance at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| -- Subscriber-posting only. If you want to post, subscribe first.
| -- Also note that this is not the r-help list where general R questions should go.

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From matthieu.stigler at gmail.com  Sun Dec  5 00:09:36 2010
From: matthieu.stigler at gmail.com (mat)
Date: Sun, 05 Dec 2010 00:09:36 +0100
Subject: [R-SIG-Finance] unstable cointegration vector estimates in
 Johansen test
In-Reply-To: <00df01cb930f$2d19a900$874cfb00$@washington.edu>
References: <AANLkTikff7umQc5sh+wepQapEk-R4VzJcGLP2Nj=+DxT@mail.gmail.com>	<76BB4672-D18E-44F9-9DA9-5B50D523DD4A@chyden.net>
	<4CF8CC10.20207@gmail.com>
	<00df01cb930f$2d19a900$874cfb00$@washington.edu>
Message-ID: <4CFACA30.50400@gmail.com>

Depending on what the goal of the analysis is, but if the goal is to 
examine parameter stability, there is a recent nice paper that allows 
"time varying" cointegration (estimated by the Johansen ML):

http://ideas.repec.org/a/cup/etheor/v26y2010i05p1453-1490_99.html

I used this method, and the code will be available (hopefully) soon in 
package tsDyn.

Best

Matthieu

Le 03. 12. 10 18:26, Eric Zivot a ?crit :
> The situation is even worse, because rolling estimates are correlated as well. Because the finite sample distn has no moments, you expect to see crazy results from the Johansen MLE from time to time. I have certainly seen estimates that are 10,000 when they should be near 1. This of course, makes it very difficult to judge the stability of recursive or rolling MLEs. Because the Stock-Watson DOLS estimates are regression they will be more stable. Still it would be nice to have some distribution theory for moving estimates of a cointegrating vector. Banerjee, Lumsdain and Stock has a JBES 1992 paper that derived the distn of rolling and recursive unit root tests. It would be nice to know if such an analysis has been done for cointegration.
>
> Eric Zivot                  			
> Robert Richards Chaired Professor of Economics
> Adjunct Professor of Finance
> Adjunct Professor of Statistics
> Department of Economics
> Box 353330                  email:  ezivot at u.washington.edu
> University of Washington    phone:  206-543-6715
> Seattle, WA 98195-3330                                                                                                   www:  http://faculty.washington.edu/ezivot
>
>
>
> -----Original Message-----
> From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of mat
> Sent: Friday, December 03, 2010 2:53 AM
> To: r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] unstable cointegration vector estimates in Johansen test
>
> Hi
>
> Besides the problem of different results based on different estimators,
> the fact that when doing a rolling analysis you find very different
> values with the same estimator could be due to a strange finite sample
> property of the ML estimator. Philips (ref below) finds indeed that in
> small samples the ML estimator has no finite moments, what can explain
> that single value have important impacts.
>
> See:
>
> Phillips, Peter C B, 1994.
> "Some Exact Distribution Theory for Maximum Likelihood Estimators of Cointegrating Coefficients in Error Correction Models,"
> Econometrica, Econometric Society, vol. 62(1), pages 73-93, January.
>
> http://ideas.repec.org/a/ecm/emetrp/v62y1994i1p73-93.html
>
> Best
>
> Matthieu
>
>
>
> Le 02. 12. 10 16:33, Charles Evans a ?crit :
>    
>> Hello Paul (Lestat?!?),
>>
>> In my work, I have looked at potential cointegration between certain
>> categories of ETFs and the most nearly related futures, and I have
>> found wide disagreement among different cointegration tests.
>>
>> Different cointegration tests have different strengths and
>> weaknesses.  Because there is rarely a conclusive reason to prefer any
>> particular cointegration test over all others.  Optimally, one would
>> use a variety (e.g., Engle-Granger/ADF, Engle-Granger/Phillips-Perron,
>> ECM, Phillips-Ouliaris [ca.po], Johansen [ca.jo]) and run with the
>> consensus.  Although it could be a bit tedious, you could run your
>> rolling cointegration tests using each of these and see if you get the
>> same odd behavior consistently.  If you do, then that would suggest
>> something interesting; if not, then it could just be an artifact of
>> the specific test.
>>
>> If you have access to statistics and econometrics journals, you might
>> find these papers helpful:
>>
>> Gregory, Allan W., Alfred A. Haug, and Nicoletta Lomuto, 2004, Mixed
>> signals among tests for cointegration. Journal of Applied Econometrics
>> 19 (1), 89-98.
>>
>> Hanck, Christoph, 2007, Mixed signals among panel cointegration tests.
>> Working Paper.
>> https://editorialexpress.com/cgibin/conference/download.cgi?db_name=sce2007&paper_id=115
>>
>>
>> Haug, Alfred A., 1996, Tests for cointegration: A Monte Carlo
>> comparison. Journal of Econometrics 71, 89-115.
>>
>> ?stermark, Ralf and Rune H?glund, 2000. Monte Carlo tests of
>> cointegration with structural breaks. Kybernetes 29 (9/10), 1284-1297.
>>
>> ?stermark, Ralf and Rune H?glund, 1999. Simulating competing
>> cointegration tests in a bivariate system. Journal of Applied
>> Statistics 27 (7), 831-846.
>>
>> HTH,
>>
>> Charles Evans
>> cevans at chyden.net
>>
>> No one ever says, "First shoot all the plumbers."
>> Steve Foerster
>>
>> On 1 Dec 2010, at 5:45 PM, ??? wrote:
>>
>>      
>>> Hi, all,
>>>
>>> a question regarding the cointegration relations (vectors) estimate
>>> in the
>>> Johansen test:
>>>
>>> I have a data sample which is confirmed by the Johansen test as
>>> cointegrated, however, if I take a subsample of the whole times
>>> series, each
>>> time add one data point and using the "ca.jo" function in R to
>>> estimate the
>>> cointegrating vector, i.e. to do a forward recursive test, and record
>>> the
>>> estimate beta (the first element of the vector is normalized to one,
>>> beta is
>>> the second element), strangely at some point, beta shows
>>> discontinuity-a big
>>> jump with sign change. This is really confusing to me as it seems
>>> that the
>>> Johansen procedure is not robust in that one additional data could cause
>>> dramatical change in the estimate of beta. not sure if it is problem
>>> of the
>>> procedure or the ca.jo function, I think my data is fine (excluding
>>> errors
>>> and outliers). has anyone seen similar things as me?
>>>
>>> Regards,
>>> Paul C. Jin
>>>
>>>      [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R
>>> questions should go.
>>>        
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R
>> questions should go.
>>      
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>
>


From markleeds2 at gmail.com  Sun Dec  5 03:04:52 2010
From: markleeds2 at gmail.com (Mark Leeds)
Date: Sat, 4 Dec 2010 21:04:52 -0500
Subject: [R-SIG-Finance] question about correlated residuals
Message-ID: <AANLkTik6+eWTHCUV28agZy=q8jWhgZjvmaqpk8NK0X8Y@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101204/3f61ce8b/attachment.pl>

From dlvanbrunt at gmail.com  Sun Dec  5 19:36:23 2010
From: dlvanbrunt at gmail.com (David L. Van Brunt, Ph.D.)
Date: Sun, 5 Dec 2010 13:36:23 -0500
Subject: [R-SIG-Finance] quantmod yearlyReturns differ in 2008 for google,
	yahoo?
Message-ID: <AANLkTimYg-ciCBxG1BtidgF1A_PYoKxio59i2n0EwL8J@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101205/f07715b1/attachment.pl>

From stephen at organicfoodmarkets.com.au  Sun Dec  5 20:23:17 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Mon, 06 Dec 2010 06:23:17 +1100
Subject: [R-SIG-Finance] IBrokers
Message-ID: <4CFBE6A5.6070305@organicfoodmarkets.com.au>

Hi

If you read this list you will have noticed I have been working on 
callbacks and I finally got to some code that appears to work so I 
though I would share it:

library(IBrokers)

myCALLBACK <-
function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
     con <- twsCon[[1]]
     twsOC <- twsConnect(2) # our order connection
     con2 <- twsOC[[1]]
     ocWrapper <- eWrapper(TRUE)
     traded <- FALSE
     while (TRUE) {
         cons <- socketSelect(list(con, con2), FALSE, 0.01)
         if(cons[1]) { #data
             curMsg <- readBin(con, character(), 1)
             if (!is.null(timestamp)) {
                 processMsg(curMsg, con, eWrapper, format(Sys.time(), 
timestamp), file, ...)
             } else {
                 processMsg(curMsg, con, eWrapper, timestamp, file, ...)
             }
         } else if(cons[2]) {
             curMsg <- readBin(con2, character(), 1)
             if (!is.null(timestamp)) {
                 processMsg(curMsg, con2, ocWrapper, format(Sys.time(), 
timestamp), file, ...)
             } else {
                 processMsg(curMsg, con2, ocWrapper, timestamp, file, ...)
             }
         } # TRADE LOGIC HERE
         curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
         if(!traded  ) { # add back on open: && !is.na(curBID) && curBID 
 > 141.00

             print(c("the cur bid is ", curBID))
             # IBrokers:::.placeOrder(twsOC, 
twsEquity("CBA","ASX","AUD"), twsOrder(1053, "BUY", "0", "MKT"))
             traded <- TRUE
         }
     }
     twsDisconnect(twsOC)
}

con = twsConnect(1)

# contracts <-  list(twsSTK("MSFT"),twsSTK("AAPL")))


reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)

twsDisconnect(con)

However, even though I have tried to close down my twsCnnections, if I 
run the code twice I get a warning along the lines:

unable to connect. client id already in use. retry with unique client id

and R freezes.  Does anyone know how to solve the problem?

Incidentally I notice that the code gets  curBID <- 
as.numeric(eWrapper$.Data$data[[1]][3]).  Does anyone know what the 
appropriate indices are for the other data in eWrapper$.Data and what 
that data is?




-- 
Stephen Choularton Ph.D., FIoD


From breman.mark at gmail.com  Sun Dec  5 21:31:21 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Sun, 5 Dec 2010 21:31:21 +0100
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
Message-ID: <AANLkTimaOUyZWe3MCQL882qJDovHSGw-nKM4-o-CzjBk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101205/ea63080f/attachment.pl>

From daniel.cegielka at gmail.com  Sun Dec  5 21:34:44 2010
From: daniel.cegielka at gmail.com (=?ISO-8859-2?Q?Daniel_Cegie=B3ka?=)
Date: Sun, 5 Dec 2010 21:34:44 +0100
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
Message-ID: <AANLkTik5PuTJQJsj6WdkzT3xnGaYRbvo8vPNex7vgC2B@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101205/2ea03b66/attachment.pl>

From mdelvaux at gmail.com  Sun Dec  5 21:47:21 2010
From: mdelvaux at gmail.com (Marc Delvaux)
Date: Sun, 5 Dec 2010 12:47:21 -0800
Subject: [R-SIG-Finance] quantmod yearlyReturns differ in 2008 for
	google, yahoo?
In-Reply-To: <AANLkTimYg-ciCBxG1BtidgF1A_PYoKxio59i2n0EwL8J@mail.gmail.com>
References: <AANLkTimYg-ciCBxG1BtidgF1A_PYoKxio59i2n0EwL8J@mail.gmail.com>
Message-ID: <AANLkTinWeRiDnZ90jmkj3yaFh1gZb9g7ifpFRfhFv_SU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101205/8176ef85/attachment.pl>

From josh.m.ulrich at gmail.com  Sun Dec  5 21:48:55 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Sun, 5 Dec 2010 14:48:55 -0600
Subject: [R-SIG-Finance] quantmod yearlyReturns differ in 2008 for
	google, yahoo?
In-Reply-To: <AANLkTimYg-ciCBxG1BtidgF1A_PYoKxio59i2n0EwL8J@mail.gmail.com>
References: <AANLkTimYg-ciCBxG1BtidgF1A_PYoKxio59i2n0EwL8J@mail.gmail.com>
Message-ID: <AANLkTi=jkfOvXPQrnJtdFhKxEqmcER6eg4A+940yHoq0@mail.gmail.com>

Hi Dave,

On Sun, Dec 5, 2010 at 12:36 PM, David L. Van Brunt, Ph.D.
<dlvanbrunt at gmail.com> wrote:
> Hi.. I was just trying to familiarize myself with the quantmod package, and
> I didn't find any explanation for the following after searching:
>
quantmod provides a means to access the data.  It does not attempt to
understand or explain the differences between data sources.

>> getSymbols("VTI",src="google")
> [1] "VTI"
>> yearlyReturn(VTI)
> ? ? ? ? ? yearly.returns
> 2007-12-31 ? ? 0.02833664
> 2008-12-31 ? ?-0.38357674
> 2009-12-31 ? ? 0.25994636
> 2010-12-03 ? ? 0.12364733
>> getSymbols("VTI",src="yahoo")
> [1] "VTI"
>> yearlyReturn(VTI)
> ? ? ? ? ? yearly.returns
> 2007-12-31 ? ? 0.02833865
> 2008-12-31 ? ?-0.69176714
> 2009-12-31 ? ? 0.25994636
> 2010-12-03 ? ? 0.12364733
>
>
> Any idea why 2008 is so different? ?I saw in the documentation that there
> were issues with Google data for 2003-- but I couldn't find a mention of an
> issue with 2008 there or in searches.
>
>From a cursory look at the data, it seems Google is adjusting the data
(for splits and/or dividends) while Yahoo does not.  Yahoo does
provide an adjusted close column though.

vtig  <- getSymbols("VTI",src="google",auto.assign=FALSE)
vtiy  <- getSymbols("VTI",src="yahoo", auto.assign=FALSE)
vtiya <- adjustOHLC(vtiy, use.Adjusted=TRUE)
head(vtig)
head(vtiy)
head(vtiya)

> Also, the Google Finance web page (http://www.google.com/finance?q=vti)
> shows the 2008 return to be -40.31%.. Closer to the Google data's return, to
> be sure, but still off.
>
> Is there something going on there that didn't make the docs (or at least my
> search of them)?
>
As I mentioned, quantmod doesn't attempt to explain the data.  I would
recommend you search the data provider's websites (Google and Yahoo).

> many thanks,
> -Dave
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From lestat.jin at gmail.com  Sun Dec  5 22:49:16 2010
From: lestat.jin at gmail.com (=?GB2312?B?vfCzwuih?=)
Date: Sun, 5 Dec 2010 21:49:16 +0000
Subject: [R-SIG-Finance] unstable cointegration vector estimates in
 Johansen test
In-Reply-To: <4CFACA30.50400@gmail.com>
References: <AANLkTikff7umQc5sh+wepQapEk-R4VzJcGLP2Nj=+DxT@mail.gmail.com>
	<76BB4672-D18E-44F9-9DA9-5B50D523DD4A@chyden.net>
	<4CF8CC10.20207@gmail.com>
	<00df01cb930f$2d19a900$874cfb00$@washington.edu>
	<4CFACA30.50400@gmail.com>
Message-ID: <AANLkTinriedOgfGyTHX9R7QS4KY-yyP0wBFwG0utzRev@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101205/13587898/attachment.pl>

From jeff.a.ryan at gmail.com  Mon Dec  6 00:17:04 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Sun, 5 Dec 2010 17:17:04 -0600
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
Message-ID: <AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>

Stephen,

Comments inline:

On Sun, Dec 5, 2010 at 1:23 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Hi
>
> If you read this list you will have noticed I have been working on callbacks
> and I finally got to some code that appears to work so I though I would
> share it:
>
> library(IBrokers)
>
> myCALLBACK <-
> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
> ? ?con <- twsCon[[1]]
> ? ?twsOC <- twsConnect(2) # our order connection
> ? ?con2 <- twsOC[[1]]
> ? ?ocWrapper <- eWrapper(TRUE)
> ? ?traded <- FALSE
> ? ?while (TRUE) {
> ? ? ? ?cons <- socketSelect(list(con, con2), FALSE, 0.01)
> ? ? ? ?if(cons[1]) { #data
> ? ? ? ? ? ?curMsg <- readBin(con, character(), 1)
> ? ? ? ? ? ?if (!is.null(timestamp)) {
> ? ? ? ? ? ? ? ?processMsg(curMsg, con, eWrapper, format(Sys.time(),
> timestamp), file, ...)
> ? ? ? ? ? ?} else {
> ? ? ? ? ? ? ? ?processMsg(curMsg, con, eWrapper, timestamp, file, ...)
> ? ? ? ? ? ?}
> ? ? ? ?} else if(cons[2]) {
> ? ? ? ? ? ?curMsg <- readBin(con2, character(), 1)
> ? ? ? ? ? ?if (!is.null(timestamp)) {
> ? ? ? ? ? ? ? ?processMsg(curMsg, con2, ocWrapper, format(Sys.time(),
> timestamp), file, ...)
> ? ? ? ? ? ?} else {
> ? ? ? ? ? ? ? ?processMsg(curMsg, con2, ocWrapper, timestamp, file, ...)
> ? ? ? ? ? ?}
> ? ? ? ?} # TRADE LOGIC HERE
> ? ? ? ?curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
> ? ? ? ?if(!traded ?) { # add back on open: && !is.na(curBID) && curBID >
> 141.00
>
> ? ? ? ? ? ?print(c("the cur bid is ", curBID))
> ? ? ? ? ? ?# IBrokers:::.placeOrder(twsOC, twsEquity("CBA","ASX","AUD"),
> twsOrder(1053, "BUY", "0", "MKT"))
> ? ? ? ? ? ?traded <- TRUE
> ? ? ? ?}
> ? ?}
> ? ?twsDisconnect(twsOC)
> }
>
> con = twsConnect(1)
>
> # contracts <- ?list(twsSTK("MSFT"),twsSTK("AAPL")))
>
>
> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>
> twsDisconnect(con)
>
> However, even though I have tried to close down my twsCnnections, if I run
> the code twice I get a warning along the lines:
>
> unable to connect. client id already in use. retry with unique client id
>
> and R freezes. ?Does anyone know how to solve the problem?

R is likely "freezing" due to buffering on Windows (which you can turn
off in the GUI), but that isn't really the core issue.  You don't need
to have a second connection opened in the CALLBACK.  It is in the
examples of one of my talks to illustrate having an external mkt data
feed and IB execution.  If you are only looking at IB (for data and
execution), DON'T use a second connection.  Seriously it is not needed
at all, and it is just making things more confusing I suspect.

>From there (on connection) close(con) or twsDisconnect(con) should
indeed free up the client id. You can always go the route of
closeAllConnections() route in R to 'start over'.

>
> Incidentally I notice that the code gets ?curBID <-
> as.numeric(eWrapper$.Data$data[[1]][3]). ?Does anyone know what the
> appropriate indices are for the other data in eWrapper$.Data and what that
> data is?
>

As Mark points out in his reply, look at the source for the answers/hints:

In order:  BidSize, BidPrice, AskPrice, AskSize, Last, LastSize and
Volume.  The first four ordering mimic what it looks like when you
stand in the pit on the floor and look at the CRTs (or your own custom
screen...) ;-)


# from the source
> eWrapper.data
function (n)
{
    eW <- eWrapper(NULL)
    eW$assign.Data("data", rep(list(structure(.xts(matrix(rep(NA_real_,
        7), nc = 7), 0), .Dimnames = list(NULL, c("BidSize",
        "BidPrice", "AskPrice", "AskSize", "Last", "LastSize",
        "Volume")))), n))
    eW$tickPrice <- function(curMsg, msg, timestamp, file, ...) {
        tickType = msg[3]
        msg <- as.numeric(msg)
        id <- msg[2]
        data <- eW$get.Data("data")
        attr(data[[id]], "index") <- as.numeric(Sys.time())
        nr.data <- NROW(data[[id]])
        if (tickType == .twsTickType$BID) {
            data[[id]][nr.data, 1:2] <- msg[5:4]
        }
        else if (tickType == .twsTickType$ASK) {
            data[[id]][nr.data, 3:4] <- msg[4:5]
        }
        else if (tickType == .twsTickType$LAST) {
            data[[id]][nr.data, 5] <- msg[4]
        }
        eW$assign.Data("data", data)
        c(curMsg, msg)
    }
    eW$tickSize <- function(curMsg, msg, timestamp, file, ...) {
        data <- eW$get.Data("data")
        tickType = msg[3]
        msg <- as.numeric(msg)
        id <- as.numeric(msg[2])
        attr(data[[id]], "index") <- as.numeric(Sys.time())
        nr.data <- NROW(data[[id]])
        if (tickType == .twsTickType$BID_SIZE) {
            data[[id]][nr.data, 1] <- msg[4]
        }
        else if (tickType == .twsTickType$ASK_SIZE) {
            data[[id]][nr.data, 4] <- msg[4]
        }
        else if (tickType == .twsTickType$LAST_SIZE) {
            data[[id]][nr.data, 6] <- msg[4]
        }
        else if (tickType == .twsTickType$VOLUME) {
            data[[id]][nr.data, 7] <- msg[4]
        }
        eW$assign.Data("data", data)
        c(curMsg, msg)
    }
    return(eW)
}
<environment: namespace:IBrokers>

You can of course do whatever you like to make it more logical to you.
 Reading IBrokers source and the official Java source (yikes) is the
way to get to a different end if you so require.

Best,
Jeff

>
>
>
> --
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From dlvanbrunt at gmail.com  Mon Dec  6 15:51:12 2010
From: dlvanbrunt at gmail.com (David L. Van Brunt, Ph.D.)
Date: Mon, 6 Dec 2010 09:51:12 -0500
Subject: [R-SIG-Finance] quantmod yearlyReturns differ in 2008 for
	google, yahoo?
In-Reply-To: <AANLkTinJ39ZHgDNL+xuGSRgSdvT2L727fWvf=483M8uE@mail.gmail.com>
References: <AANLkTimYg-ciCBxG1BtidgF1A_PYoKxio59i2n0EwL8J@mail.gmail.com>
	<AANLkTinJ39ZHgDNL+xuGSRgSdvT2L727fWvf=483M8uE@mail.gmail.com>
Message-ID: <AANLkTins1WaGq3YX4FPTvh2Mc-J_kewtNEngx-7r500g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101206/5f04d812/attachment.pl>

From eric.thungstrom at gmail.com  Mon Dec  6 18:14:45 2010
From: eric.thungstrom at gmail.com (Eric Thungstom)
Date: Mon, 6 Dec 2010 12:14:45 -0500
Subject: [R-SIG-Finance] quantmod
Message-ID: <AANLkTi=vHD0MFBSenZBCGdbaA=8jwQgRqxc5SSJ-XW0g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101206/84027903/attachment.pl>

From brian at braverock.com  Mon Dec  6 18:20:04 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 06 Dec 2010 11:20:04 -0600
Subject: [R-SIG-Finance] quantmod
In-Reply-To: <AANLkTi=vHD0MFBSenZBCGdbaA=8jwQgRqxc5SSJ-XW0g@mail.gmail.com>
References: <AANLkTi=vHD0MFBSenZBCGdbaA=8jwQgRqxc5SSJ-XW0g@mail.gmail.com>
Message-ID: <4CFD1B44.7060306@braverock.com>

On 12/06/2010 11:14 AM, Eric Thungstom wrote:
> Newbie to R and quantmod. So if this is obvious, please excuse me
>
> With getSymbols() function is there a default number of values or prices
> (days) that it returns. I started playing with this yesterday and it appears
> the look back period for yahoo is pretty short...maybe a year ? I know
> there's an option to include a start date in the function, just wondering
> what the default is. Also, where should I have looked for the default value
> ?

require('quantmod')
?getSymbols.yahoo

'from' and 'to' are listed in the documentation, as is the default.

Cheers,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From stephen at organicfoodmarkets.com.au  Mon Dec  6 20:46:30 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 07 Dec 2010 06:46:30 +1100
Subject: [R-SIG-Finance] IBrokers
Message-ID: <4CFD3D96.5070009@organicfoodmarkets.com.au>

Well I was wrong. I have simplified the code:

myCALLBACK <-
function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {

     con <- twsCon[[1]]
     traded <- FALSE
     while (TRUE) {
         socketSelect(list(con), FALSE, NULL)
         #data
     curMsg <- readBin(con, character(), 1)
     if (!is.null(timestamp)) {
         processMsg(curMsg, con, eWrapper, format(Sys.time(), 
timestamp), file, ...)
     } else {
         processMsg(curMsg, con, eWrapper, timestamp, file, ...)
     }

     # TRADE LOGIC HERE
     curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
     print(c("the cur bid is ", curBID, "end"))
     if(!traded  ) { # add back on open: && !is.na(curBID) && curBID > 
141.00

         print(c("inside the trading logic "))
         # IBrokers:::.placeOrder(twsCon, twsEquity("CBA","ASX","AUD"), 
twsOrder(1053, "BUY", "0", "MKT"))
         # traded <- TRUE
     }
     }
}



con = twsConnect()

# contracts <-  list(twsSTK("MSFT"),twsSTK("AAPL")))


reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)

# reqMktData(con, twsEquity("CBA","ASX","AUD"), CALLBACK=myCALLBACK)

closeAllConnections()

but when I run it 'curBID <- as.numeric(eWrapper$.Data$data[[1]][3])' 
does not get me the current bid even though the callback is seeing it as 
this line from the output shows:

<20101207 06:40:35.844000> id=1 symbol=GOOG bidPrice: 579.31  bidSize: 3

Does any one know how to reference the data?   I have tried all sorts 
of  combinations of indices, etc but I'm not going to find it by chance 
and I cannot find anything in the lit.


-- 
Stephen Choularton Ph.D., FIoD


From josh.m.ulrich at gmail.com  Mon Dec  6 21:04:22 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 6 Dec 2010 14:04:22 -0600
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFD3D96.5070009@organicfoodmarkets.com.au>
References: <4CFD3D96.5070009@organicfoodmarkets.com.au>
Message-ID: <AANLkTikgBHFAG5W6=QH=wZJy3fDrBh01Fk+NDDNrNjxa@mail.gmail.com>

Stephen,

Please reply to your original thread when responding to it.  You've
created 3 threads in 3 days on the same topic...

--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Mon, Dec 6, 2010 at 1:46 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Well I was wrong. I have simplified the code:
>
> myCALLBACK <-
> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>
> ? ?con <- twsCon[[1]]
> ? ?traded <- FALSE
> ? ?while (TRUE) {
> ? ? ? ?socketSelect(list(con), FALSE, NULL)
> ? ? ? ?#data
> ? ?curMsg <- readBin(con, character(), 1)
> ? ?if (!is.null(timestamp)) {
> ? ? ? ?processMsg(curMsg, con, eWrapper, format(Sys.time(), timestamp),
> file, ...)
> ? ?} else {
> ? ? ? ?processMsg(curMsg, con, eWrapper, timestamp, file, ...)
> ? ?}
>
> ? ?# TRADE LOGIC HERE
> ? ?curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
> ? ?print(c("the cur bid is ", curBID, "end"))
> ? ?if(!traded ?) { # add back on open: && !is.na(curBID) && curBID > 141.00
>
> ? ? ? ?print(c("inside the trading logic "))
> ? ? ? ?# IBrokers:::.placeOrder(twsCon, twsEquity("CBA","ASX","AUD"),
> twsOrder(1053, "BUY", "0", "MKT"))
> ? ? ? ?# traded <- TRUE
> ? ?}
> ? ?}
> }
>
>
>
> con = twsConnect()
>
> # contracts <- ?list(twsSTK("MSFT"),twsSTK("AAPL")))
>
>
> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>
> # reqMktData(con, twsEquity("CBA","ASX","AUD"), CALLBACK=myCALLBACK)
>
> closeAllConnections()
>
> but when I run it 'curBID <- as.numeric(eWrapper$.Data$data[[1]][3])' does
> not get me the current bid even though the callback is seeing it as this
> line from the output shows:
>
> <20101207 06:40:35.844000> id=1 symbol=GOOG bidPrice: 579.31 ?bidSize: 3
>
> Does any one know how to reference the data? ? I have tried all sorts of
> ?combinations of indices, etc but I'm not going to find it by chance and I
> cannot find anything in the lit.
>
>
> --
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From jeff.a.ryan at gmail.com  Mon Dec  6 21:35:33 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 6 Dec 2010 14:35:33 -0600
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFD3D96.5070009@organicfoodmarkets.com.au>
References: <4CFD3D96.5070009@organicfoodmarkets.com.au>
Message-ID: <AANLkTi=JfyNt5TMorvG0ttbfiQEJmTs8LzcsB6L4mTur@mail.gmail.com>

The data object is an xts object, but only if you are using the
appropriate eWrapper that contains it.

reqMktData(con, twsEquity("GOOG"), event=eWrapper.data(1), CALLBACK=myCALLBACK)

And you'll need to change the appropriate line to this:

curBID <- as.numeric(eWrapper$.Data$data[[1]][,3])

(Note the [,3] instead of [3] .. we want the 3rd column)

[1] "inside the trading logic "
[1] "the cur bid is " "578.98"          "end"
[1] "inside the trading logic "
[1] "the cur bid is " "578.98"          "end"

HTH
Jeff

On Mon, Dec 6, 2010 at 1:46 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Well I was wrong. I have simplified the code:
>
> myCALLBACK <-
> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>
> ? ?con <- twsCon[[1]]
> ? ?traded <- FALSE
> ? ?while (TRUE) {
> ? ? ? ?socketSelect(list(con), FALSE, NULL)
> ? ? ? ?#data
> ? ?curMsg <- readBin(con, character(), 1)
> ? ?if (!is.null(timestamp)) {
> ? ? ? ?processMsg(curMsg, con, eWrapper, format(Sys.time(), timestamp),
> file, ...)
> ? ?} else {
> ? ? ? ?processMsg(curMsg, con, eWrapper, timestamp, file, ...)
> ? ?}
>
> ? ?# TRADE LOGIC HERE
> ? ?curBID <- as.numeric(eWrapper$.Data$data[[1]][3])
> ? ?print(c("the cur bid is ", curBID, "end"))
> ? ?if(!traded ?) { # add back on open: && !is.na(curBID) && curBID > 141.00
>
> ? ? ? ?print(c("inside the trading logic "))
> ? ? ? ?# IBrokers:::.placeOrder(twsCon, twsEquity("CBA","ASX","AUD"),
> twsOrder(1053, "BUY", "0", "MKT"))
> ? ? ? ?# traded <- TRUE
> ? ?}
> ? ?}
> }
>
>
>
> con = twsConnect()
>
> # contracts <- ?list(twsSTK("MSFT"),twsSTK("AAPL")))
>
>
> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>
> # reqMktData(con, twsEquity("CBA","ASX","AUD"), CALLBACK=myCALLBACK)
>
> closeAllConnections()
>
> but when I run it 'curBID <- as.numeric(eWrapper$.Data$data[[1]][3])' does
> not get me the current bid even though the callback is seeing it as this
> line from the output shows:
>
> <20101207 06:40:35.844000> id=1 symbol=GOOG bidPrice: 579.31 ?bidSize: 3
>
> Does any one know how to reference the data? ? I have tried all sorts of
> ?combinations of indices, etc but I'm not going to find it by chance and I
> cannot find anything in the lit.
>
>
> --
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From stephen at organicfoodmarkets.com.au  Tue Dec  7 07:24:33 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 07 Dec 2010 17:24:33 +1100
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
	<AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>
Message-ID: <4CFDD321.4020408@organicfoodmarkets.com.au>

Just for the record I though I should post this as it did actually place 
the order I was after:

library(IBrokers)

myCALLBACK <-
function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {

     con <- twsCon[[1]]
     traded <- FALSE
     while (TRUE) {
         socketSelect(list(con), FALSE, NULL)
         #data
     curMsg <- readBin(con, character(), 1)
     if (!is.null(timestamp)) {
         processMsg(curMsg, con, eWrapper, format(Sys.time(), 
timestamp), file, ...)
     } else {
         processMsg(curMsg, con, eWrapper, timestamp, file, ...)
     }
     # EXTRACT DATA HERE
     BidSize <- as.numeric(eWrapper$.Data$data[[1]][,1])
     BidPrice <- as.numeric(eWrapper$.Data$data[[1]][,2])
     AskPrice <- as.numeric(eWrapper$.Data$data[[1]][,3])
     AskSize <-  as.numeric(eWrapper$.Data$data[[1]][,4])
     Last <- as.numeric(eWrapper$.Data$data[[1]][,5])
     LastSize <- as.numeric(eWrapper$.Data$data[[1]][,6])
         Volume <- as.numeric(eWrapper$.Data$data[[1]][,7])
     print(c("BidSize: ", BidSize, "BidPrice: ", BidPrice, "AskPrice: ", 
AskPrice, "AskSize: ", AskSize, "Last: ", Last, "LastSize : ", LastSize 
, "Volume: ", Volume ))
     # TRADE LOGIC HERE
     if(!traded && !is.na(Last) && Last >= 49) {

         print(c("inside the trading logic "))
         id <- reqIds(twsCon)
         #placeOrder(tws, twsEquity("CBA","ASX","AUD"), twsOrder(id, 
"BUY", "1", "MKT"))
         traded <- TRUE
     }
     }
}



con = twsConnect()



#reqMktData(con, twsEquity("GOOG"), event=eWrapper.data(1), 
CALLBACK=myCALLBACK)


reqMktData(con, twsEquity("CBA","ASX","AUD"),  event=eWrapper.data(1), 
CALLBACK=myCALLBACK)



closeAllConnections()


I imagine I will be back as I am actually trying to use this for spreads 
- so now I have to move on and try two symbols, etc but for what it is 
worth the code is there for anyone who wants to use it.

Stephen Choularton Ph.D., FIoD


On 06/12/2010 10:17 AM, Jeff Ryan wrote:
> Stephen,
>
> Comments inline:
>
> On Sun, Dec 5, 2010 at 1:23 PM, Stephen Choularton
> <stephen at organicfoodmarkets.com.au>  wrote:
>> Hi
>>
>> If you read this list you will have noticed I have been working on callbacks
>> and I finally got to some code that appears to work so I though I would
>> share it:
>>
>> library(IBrokers)
>>
>> myCALLBACK<-
>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>     con<- twsCon[[1]]
>>     twsOC<- twsConnect(2) # our order connection
>>     con2<- twsOC[[1]]
>>     ocWrapper<- eWrapper(TRUE)
>>     traded<- FALSE
>>     while (TRUE) {
>>         cons<- socketSelect(list(con, con2), FALSE, 0.01)
>>         if(cons[1]) { #data
>>             curMsg<- readBin(con, character(), 1)
>>             if (!is.null(timestamp)) {
>>                 processMsg(curMsg, con, eWrapper, format(Sys.time(),
>> timestamp), file, ...)
>>             } else {
>>                 processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>>             }
>>         } else if(cons[2]) {
>>             curMsg<- readBin(con2, character(), 1)
>>             if (!is.null(timestamp)) {
>>                 processMsg(curMsg, con2, ocWrapper, format(Sys.time(),
>> timestamp), file, ...)
>>             } else {
>>                 processMsg(curMsg, con2, ocWrapper, timestamp, file, ...)
>>             }
>>         } # TRADE LOGIC HERE
>>         curBID<- as.numeric(eWrapper$.Data$data[[1]][3])
>>         if(!traded  ) { # add back on open:&&  !is.na(curBID)&&  curBID>
>> 141.00
>>
>>             print(c("the cur bid is ", curBID))
>>             # IBrokers:::.placeOrder(twsOC, twsEquity("CBA","ASX","AUD"),
>> twsOrder(1053, "BUY", "0", "MKT"))
>>             traded<- TRUE
>>         }
>>     }
>>     twsDisconnect(twsOC)
>> }
>>
>> con = twsConnect(1)
>>
>> # contracts<-  list(twsSTK("MSFT"),twsSTK("AAPL")))
>>
>>
>> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>>
>> twsDisconnect(con)
>>
>> However, even though I have tried to close down my twsCnnections, if I run
>> the code twice I get a warning along the lines:
>>
>> unable to connect. client id already in use. retry with unique client id
>>
>> and R freezes.  Does anyone know how to solve the problem?
> R is likely "freezing" due to buffering on Windows (which you can turn
> off in the GUI), but that isn't really the core issue.  You don't need
> to have a second connection opened in the CALLBACK.  It is in the
> examples of one of my talks to illustrate having an external mkt data
> feed and IB execution.  If you are only looking at IB (for data and
> execution), DON'T use a second connection.  Seriously it is not needed
> at all, and it is just making things more confusing I suspect.
>
> > From there (on connection) close(con) or twsDisconnect(con) should
> indeed free up the client id. You can always go the route of
> closeAllConnections() route in R to 'start over'.
>
>> Incidentally I notice that the code gets  curBID<-
>> as.numeric(eWrapper$.Data$data[[1]][3]).  Does anyone know what the
>> appropriate indices are for the other data in eWrapper$.Data and what that
>> data is?
>>
> As Mark points out in his reply, look at the source for the answers/hints:
>
> In order:  BidSize, BidPrice, AskPrice, AskSize, Last, LastSize and
> Volume.  The first four ordering mimic what it looks like when you
> stand in the pit on the floor and look at the CRTs (or your own custom
> screen...) ;-)
>
>
> # from the source
>> eWrapper.data
> function (n)
> {
>      eW<- eWrapper(NULL)
>      eW$assign.Data("data", rep(list(structure(.xts(matrix(rep(NA_real_,
>          7), nc = 7), 0), .Dimnames = list(NULL, c("BidSize",
>          "BidPrice", "AskPrice", "AskSize", "Last", "LastSize",
>          "Volume")))), n))
>      eW$tickPrice<- function(curMsg, msg, timestamp, file, ...) {
>          tickType = msg[3]
>          msg<- as.numeric(msg)
>          id<- msg[2]
>          data<- eW$get.Data("data")
>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>          nr.data<- NROW(data[[id]])
>          if (tickType == .twsTickType$BID) {
>              data[[id]][nr.data, 1:2]<- msg[5:4]
>          }
>          else if (tickType == .twsTickType$ASK) {
>              data[[id]][nr.data, 3:4]<- msg[4:5]
>          }
>          else if (tickType == .twsTickType$LAST) {
>              data[[id]][nr.data, 5]<- msg[4]
>          }
>          eW$assign.Data("data", data)
>          c(curMsg, msg)
>      }
>      eW$tickSize<- function(curMsg, msg, timestamp, file, ...) {
>          data<- eW$get.Data("data")
>          tickType = msg[3]
>          msg<- as.numeric(msg)
>          id<- as.numeric(msg[2])
>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>          nr.data<- NROW(data[[id]])
>          if (tickType == .twsTickType$BID_SIZE) {
>              data[[id]][nr.data, 1]<- msg[4]
>          }
>          else if (tickType == .twsTickType$ASK_SIZE) {
>              data[[id]][nr.data, 4]<- msg[4]
>          }
>          else if (tickType == .twsTickType$LAST_SIZE) {
>              data[[id]][nr.data, 6]<- msg[4]
>          }
>          else if (tickType == .twsTickType$VOLUME) {
>              data[[id]][nr.data, 7]<- msg[4]
>          }
>          eW$assign.Data("data", data)
>          c(curMsg, msg)
>      }
>      return(eW)
> }
> <environment: namespace:IBrokers>
>
> You can of course do whatever you like to make it more logical to you.
>   Reading IBrokers source and the official Java source (yikes) is the
> way to get to a different end if you so require.
>
> Best,
> Jeff
>
>>
>>
>> --
>> Stephen Choularton Ph.D., FIoD
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>


From stephen at organicfoodmarkets.com.au  Tue Dec  7 20:13:45 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 08 Dec 2010 06:13:45 +1100
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFDD321.4020408@organicfoodmarkets.com.au>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>	<AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>
	<4CFDD321.4020408@organicfoodmarkets.com.au>
Message-ID: <4CFE8769.2050307@organicfoodmarkets.com.au>

So back again!

I have two problem in converting my callback to two handle two symbols 
so I can set up spreads.  (Or at least that's what I can see it at the 
moment):

When I run this using myCALLBACK function below:

con = twsConnect()

reqMktData(con, list(twsSTK("MSFT"),twsSTK("AAPL")),  
event=eWrapper.data(1), CALLBACK=myCALLBACK)

I get this

  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      NA            "LastSize 
: " NA
[13] "Volume: "    NA
2 -1 2104 Market data farm connection is OK:aufarm
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      NA            "LastSize 
: " NA
[13] "Volume: "    NA
2 -1 2104 Market data farm connection is OK:usfarm
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      NA            "LastSize 
: " NA
[13] "Volume: "    NA
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      NA            "LastSize 
: " NA
[13] "Volume: "    NA
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      NA            "LastSize 
: " NA
[13] "Volume: "    NA
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " NA
[13] "Volume: "    NA
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    NA
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  NA
  [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "4"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343529"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.97"
  [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
  [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: 
"  "26.98"
  [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize 
: " "2"
[13] "Volume: "    "343550"
Error in `*tmp*`[[id]] : subscript out of bounds


I think what is happening is that the function fails on its first 
attempt to get data on AAPT and the above data is on MSFT but I am quite 
unsure as to what direction to take to amend the function.  Any pointers 
most welcome.

Secondly I need to be able to know which symbol I am dealing with.  The 
output for:

reqMktData(con, list(twsEquity("MSFT"),twsEquity("AAPL")))

is

TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
<20101208 05:55:28.974000> id=1 symbol=MSFT Volume: 343560
<20101208 05:55:28.978000> id=1 symbol=MSFT highPrice: 27.09
<20101208 05:55:28.983000> id=1 symbol=MSFT lowPrice: 26.88
<20101208 05:55:28.988000> id=2 symbol=AAPL Volume: 79079
<20101208 05:55:28.993000> id=2 symbol=AAPL highPrice: 323.99

and shows the symbol I need but when I try to find something that refers 
to it in myCALLBACK I seem to fail.  Is it somewhere in the data 
object?  Is it somewhere esle someone can point me to?

Stephen Choularton Ph.D., FIoD


On 07/12/2010 5:24 PM, Stephen Choularton wrote:
> Just for the record I though I should post this as it did actually 
> place the order I was after:
>
> library(IBrokers)
>
> myCALLBACK <-
> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>
>     con <- twsCon[[1]]
>     traded <- FALSE
>     while (TRUE) {
>         socketSelect(list(con), FALSE, NULL)
>         #data
>     curMsg <- readBin(con, character(), 1)
>     if (!is.null(timestamp)) {
>         processMsg(curMsg, con, eWrapper, format(Sys.time(), 
> timestamp), file, ...)
>     } else {
>         processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>     }
>     # EXTRACT DATA HERE
>     BidSize <- as.numeric(eWrapper$.Data$data[[1]][,1])
>     BidPrice <- as.numeric(eWrapper$.Data$data[[1]][,2])
>     AskPrice <- as.numeric(eWrapper$.Data$data[[1]][,3])
>     AskSize <-  as.numeric(eWrapper$.Data$data[[1]][,4])
>     Last <- as.numeric(eWrapper$.Data$data[[1]][,5])
>     LastSize <- as.numeric(eWrapper$.Data$data[[1]][,6])
>         Volume <- as.numeric(eWrapper$.Data$data[[1]][,7])
>     print(c("BidSize: ", BidSize, "BidPrice: ", BidPrice, "AskPrice: 
> ", AskPrice, "AskSize: ", AskSize, "Last: ", Last, "LastSize : ", 
> LastSize , "Volume: ", Volume ))
>     # TRADE LOGIC HERE
>     if(!traded && !is.na(Last) && Last >= 49) {
>
>         print(c("inside the trading logic "))
>         id <- reqIds(twsCon)
>         #placeOrder(tws, twsEquity("CBA","ASX","AUD"), twsOrder(id, 
> "BUY", "1", "MKT"))
>         traded <- TRUE
>     }
>     }
> }
>
>
>
> con = twsConnect()
>
>
>
> #reqMktData(con, twsEquity("GOOG"), event=eWrapper.data(1), 
> CALLBACK=myCALLBACK)
>
>
> reqMktData(con, twsEquity("CBA","ASX","AUD"),  event=eWrapper.data(1), 
> CALLBACK=myCALLBACK)
>
>
>
> closeAllConnections()
>
>
> I imagine I will be back as I am actually trying to use this for 
> spreads - so now I have to move on and try two symbols, etc but for 
> what it is worth the code is there for anyone who wants to use it.
>
> Stephen Choularton Ph.D., FIoD
>
>
> On 06/12/2010 10:17 AM, Jeff Ryan wrote:
>> Stephen,
>>
>> Comments inline:
>>
>> On Sun, Dec 5, 2010 at 1:23 PM, Stephen Choularton
>> <stephen at organicfoodmarkets.com.au>  wrote:
>>> Hi
>>>
>>> If you read this list you will have noticed I have been working on 
>>> callbacks
>>> and I finally got to some code that appears to work so I though I would
>>> share it:
>>>
>>> library(IBrokers)
>>>
>>> myCALLBACK<-
>>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>>     con<- twsCon[[1]]
>>>     twsOC<- twsConnect(2) # our order connection
>>>     con2<- twsOC[[1]]
>>>     ocWrapper<- eWrapper(TRUE)
>>>     traded<- FALSE
>>>     while (TRUE) {
>>>         cons<- socketSelect(list(con, con2), FALSE, 0.01)
>>>         if(cons[1]) { #data
>>>             curMsg<- readBin(con, character(), 1)
>>>             if (!is.null(timestamp)) {
>>>                 processMsg(curMsg, con, eWrapper, format(Sys.time(),
>>> timestamp), file, ...)
>>>             } else {
>>>                 processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>>>             }
>>>         } else if(cons[2]) {
>>>             curMsg<- readBin(con2, character(), 1)
>>>             if (!is.null(timestamp)) {
>>>                 processMsg(curMsg, con2, ocWrapper, format(Sys.time(),
>>> timestamp), file, ...)
>>>             } else {
>>>                 processMsg(curMsg, con2, ocWrapper, timestamp, file, 
>>> ...)
>>>             }
>>>         } # TRADE LOGIC HERE
>>>         curBID<- as.numeric(eWrapper$.Data$data[[1]][3])
>>>         if(!traded  ) { # add back on open:&&  !is.na(curBID)&&  
>>> curBID>
>>> 141.00
>>>
>>>             print(c("the cur bid is ", curBID))
>>>             # IBrokers:::.placeOrder(twsOC, 
>>> twsEquity("CBA","ASX","AUD"),
>>> twsOrder(1053, "BUY", "0", "MKT"))
>>>             traded<- TRUE
>>>         }
>>>     }
>>>     twsDisconnect(twsOC)
>>> }
>>>
>>> con = twsConnect(1)
>>>
>>> # contracts<-  list(twsSTK("MSFT"),twsSTK("AAPL")))
>>>
>>>
>>> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>>>
>>> twsDisconnect(con)
>>>
>>> However, even though I have tried to close down my twsCnnections, if 
>>> I run
>>> the code twice I get a warning along the lines:
>>>
>>> unable to connect. client id already in use. retry with unique 
>>> client id
>>>
>>> and R freezes.  Does anyone know how to solve the problem?
>> R is likely "freezing" due to buffering on Windows (which you can turn
>> off in the GUI), but that isn't really the core issue.  You don't need
>> to have a second connection opened in the CALLBACK.  It is in the
>> examples of one of my talks to illustrate having an external mkt data
>> feed and IB execution.  If you are only looking at IB (for data and
>> execution), DON'T use a second connection.  Seriously it is not needed
>> at all, and it is just making things more confusing I suspect.
>>
>> > From there (on connection) close(con) or twsDisconnect(con) should
>> indeed free up the client id. You can always go the route of
>> closeAllConnections() route in R to 'start over'.
>>
>>> Incidentally I notice that the code gets  curBID<-
>>> as.numeric(eWrapper$.Data$data[[1]][3]).  Does anyone know what the
>>> appropriate indices are for the other data in eWrapper$.Data and 
>>> what that
>>> data is?
>>>
>> As Mark points out in his reply, look at the source for the 
>> answers/hints:
>>
>> In order:  BidSize, BidPrice, AskPrice, AskSize, Last, LastSize and
>> Volume.  The first four ordering mimic what it looks like when you
>> stand in the pit on the floor and look at the CRTs (or your own custom
>> screen...) ;-)
>>
>>
>> # from the source
>>> eWrapper.data
>> function (n)
>> {
>>      eW<- eWrapper(NULL)
>>      eW$assign.Data("data", rep(list(structure(.xts(matrix(rep(NA_real_,
>>          7), nc = 7), 0), .Dimnames = list(NULL, c("BidSize",
>>          "BidPrice", "AskPrice", "AskSize", "Last", "LastSize",
>>          "Volume")))), n))
>>      eW$tickPrice<- function(curMsg, msg, timestamp, file, ...) {
>>          tickType = msg[3]
>>          msg<- as.numeric(msg)
>>          id<- msg[2]
>>          data<- eW$get.Data("data")
>>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>>          nr.data<- NROW(data[[id]])
>>          if (tickType == .twsTickType$BID) {
>>              data[[id]][nr.data, 1:2]<- msg[5:4]
>>          }
>>          else if (tickType == .twsTickType$ASK) {
>>              data[[id]][nr.data, 3:4]<- msg[4:5]
>>          }
>>          else if (tickType == .twsTickType$LAST) {
>>              data[[id]][nr.data, 5]<- msg[4]
>>          }
>>          eW$assign.Data("data", data)
>>          c(curMsg, msg)
>>      }
>>      eW$tickSize<- function(curMsg, msg, timestamp, file, ...) {
>>          data<- eW$get.Data("data")
>>          tickType = msg[3]
>>          msg<- as.numeric(msg)
>>          id<- as.numeric(msg[2])
>>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>>          nr.data<- NROW(data[[id]])
>>          if (tickType == .twsTickType$BID_SIZE) {
>>              data[[id]][nr.data, 1]<- msg[4]
>>          }
>>          else if (tickType == .twsTickType$ASK_SIZE) {
>>              data[[id]][nr.data, 4]<- msg[4]
>>          }
>>          else if (tickType == .twsTickType$LAST_SIZE) {
>>              data[[id]][nr.data, 6]<- msg[4]
>>          }
>>          else if (tickType == .twsTickType$VOLUME) {
>>              data[[id]][nr.data, 7]<- msg[4]
>>          }
>>          eW$assign.Data("data", data)
>>          c(curMsg, msg)
>>      }
>>      return(eW)
>> }
>> <environment: namespace:IBrokers>
>>
>> You can of course do whatever you like to make it more logical to you.
>>   Reading IBrokers source and the official Java source (yikes) is the
>> way to get to a different end if you so require.
>>
>> Best,
>> Jeff
>>
>>>
>>>
>>> -- 
>>> Stephen Choularton Ph.D., FIoD
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.
>
>
>
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1170 / Virus Database: 426/3301 - Release Date: 12/06/10
>
>


From andres.susrud at gmail.com  Wed Dec  8 15:02:21 2010
From: andres.susrud at gmail.com (Andres Susrud)
Date: Wed, 8 Dec 2010 15:02:21 +0100
Subject: [R-SIG-Finance] non-standard time-format conversion from data.frame
	to xts
Message-ID: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101208/c1fb7eb9/attachment.pl>

From brian at braverock.com  Wed Dec  8 15:24:15 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 08 Dec 2010 08:24:15 -0600
Subject: [R-SIG-Finance] non-standard time-format conversion from
 data.frame to xts
In-Reply-To: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>
References: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>
Message-ID: <4CFF950F.1060905@braverock.com>

On 12/08/2010 08:02 AM, Andres Susrud wrote:
> Hi,
>
> I have a conversion problem from data.frame to xts.
>
> my dataset looks like this
>> data[1:5,]
>          Time   Bid  Offer
> 1 7:10:03 AM 6118.5 6119.5
> 2 7:10:36 AM 6118.5 6119.5
> 3 7:11:07 AM 6119.5 6119.5
> 4 7:11:48 AM 6119.0 6120.0
> 5 7:12:25 AM 6119.0 6119.5
>
> Because of the lack of date, and the time format of H,M,S and AM/PM, I can't
> convert via as.xts or as.zoo etc.
>
> any suggestions?

I assume that you know the date...

given that, you will change your format string (see ?strftime )
to something like

format='2010-12-08 %I:%M:%S %p'

Next time, please use dput() for your example data, and construct a 
self-contained example.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Wed Dec  8 15:33:58 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 08 Dec 2010 08:33:58 -0600
Subject: [R-SIG-Finance] non-standard time-format conversion from
 data.frame to xts
In-Reply-To: <AANLkTinyZGsWhTOo6_vj-nt6_gPbVd2kQxK75RCnnqFW@mail.gmail.com>
References: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>	<4CFF950F.1060905@braverock.com>
	<AANLkTinyZGsWhTOo6_vj-nt6_gPbVd2kQxK75RCnnqFW@mail.gmail.com>
Message-ID: <4CFF9756.3000707@braverock.com>

Didn't I just get done suggesting that you construct a self-contained 
example?

Having different dates in different files is fine.  You still *know* 
what the date is when you load it in.  There are lots of options here.

One would be to paste() the date (that you know when loading) and the 
Time column together, then usinga full format string, as described in 
?strftime.

You'll have to do some work, but you'll have an answer.
\
    - Brian


On 12/08/2010 08:29 AM, Andres Susrud wrote:
> Hi thanks for answer, I really don't need the date because I have the
> different dates in different files.
>
> the errormessage I get is the following:
> Error in as.POSIXlt.character(x, tz, ...) :
>    character string is not in a standard unambiguous format
>
> BR
>
> Andres
>
> On Wed, Dec 8, 2010 at 3:24 PM, Brian G. Peterson <brian at braverock.com
> <mailto:brian at braverock.com>> wrote:
>
>     On 12/08/2010 08:02 AM, Andres Susrud wrote:
>
>         Hi,
>
>         I have a conversion problem from data.frame to xts.
>
>         my dataset looks like this
>
>             data[1:5,]
>
>                  Time   Bid  Offer
>         1 7:10:03 AM 6118.5 6119.5
>         2 7:10:36 AM 6118.5 6119.5
>         3 7:11:07 AM 6119.5 6119.5
>         4 7:11:48 AM 6119.0 6120.0
>         5 7:12:25 AM 6119.0 6119.5
>
>         Because of the lack of date, and the time format of H,M,S and
>         AM/PM, I can't
>         convert via as.xts or as.zoo etc.
>
>         any suggestions?
>
>
>     I assume that you know the date...
>
>     given that, you will change your format string (see ?strftime )
>     to something like
>
>     format='2010-12-08 %I:%M:%S %p'
>
>     Next time, please use dput() for your example data, and construct a
>     self-contained example.
>
>     Regards,
>
>       - Brian
>
>     --
>     Brian G. Peterson
>     http://braverock.com/brian/
>     Ph: 773-459-4973
>     IM: bgpbraverock
>
>


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From ggrothendieck at gmail.com  Wed Dec  8 15:39:18 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 8 Dec 2010 09:39:18 -0500
Subject: [R-SIG-Finance] non-standard time-format conversion from
 data.frame to xts
In-Reply-To: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>
References: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>
Message-ID: <AANLkTiktDvA-tWyuxWbD-hzHp+Cv6ogLODhEA_9KZM4n@mail.gmail.com>

On Wed, Dec 8, 2010 at 9:02 AM, Andres Susrud <andres.susrud at gmail.com> wrote:
> Hi,
>
> I have a conversion problem from data.frame to xts.
>
> my dataset looks like this
>> data[1:5,]
> ? ? ? ?Time ? Bid ?Offer
> 1 7:10:03 AM 6118.5 6119.5
> 2 7:10:36 AM 6118.5 6119.5
> 3 7:11:07 AM 6119.5 6119.5
> 4 7:11:48 AM 6119.0 6120.0
> 5 7:12:25 AM 6119.0 6119.5
>
> Because of the lack of date, and the time format of H,M,S and AM/PM, I can't
> convert via as.xts or as.zoo etc.
>

Assuming your data frame is this we can use read.zoo to read it into
zoo giving it a chron "times" class:

DF <- structure(list(Time = structure(1:5, .Label = c("7:10:03 AM",
    "7:10:36 AM", "7:11:07 AM", "7:11:48 AM", "7:12:25 AM"), class = "factor"),
    Bid = c(6118.5, 6118.5, 6119.5, 6119, 6119), Offer = c(6119.5,
    6119.5, 6119.5, 6120, 6119.5)), .Names = c("Time", "Bid",
    "Offer"), class = "data.frame", row.names = c(NA, -5L))

library(zoo)
library(chron)
z <- read.zoo(DF, FUN = function(x) times(as.chron(paste("1970-01-01", x),
   format = "%Y-%m-%d %H:%M:%S %p")))
z

If you need it in zoo then you now have it with "times" class which
seems the most appropriate for that data.

xts does not support chron "times" class but if you need it in xts you
could convert it to some date/time class and then use as.xts. e.g.

as.xts(aggregate(z, chron))


-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From jeff.a.ryan at gmail.com  Wed Dec  8 16:01:56 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 8 Dec 2010 09:01:56 -0600
Subject: [R-SIG-Finance] non-standard time-format conversion from
 data.frame to xts
In-Reply-To: <AANLkTiktDvA-tWyuxWbD-hzHp+Cv6ogLODhEA_9KZM4n@mail.gmail.com>
References: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>
	<AANLkTiktDvA-tWyuxWbD-hzHp+Cv6ogLODhEA_9KZM4n@mail.gmail.com>
Message-ID: <AANLkTikNo0N3se86bXJnmKSin1YSZLXR0OfW-UC8MP8D@mail.gmail.com>

I'd personally advise against using anything other than real
POSIX-style time. Time alone can't exist without a date, certainly
with respect to observable data.

Do as Brian says and you'll have the most flexibility, but if you
insist on just time chron can certainly be useful.  Note that chron
uses fractional days to represent time, which is only an approximation
of time - you will run into issues at certain times.

> dput(as.chron(Sys.time()))
structure(14951.6248495370, format = structure(c("m/d/y", "h:m:s"
), .Names = c("dates", "times")), origin = structure(c(1, 1,
1970), .Names = c("month", "day", "year")), class = c("chron",
"dates", "times"))

Best
Jeff

On Wed, Dec 8, 2010 at 8:39 AM, Gabor Grothendieck
<ggrothendieck at gmail.com> wrote:
> On Wed, Dec 8, 2010 at 9:02 AM, Andres Susrud <andres.susrud at gmail.com> wrote:
>> Hi,
>>
>> I have a conversion problem from data.frame to xts.
>>
>> my dataset looks like this
>>> data[1:5,]
>> ? ? ? ?Time ? Bid ?Offer
>> 1 7:10:03 AM 6118.5 6119.5
>> 2 7:10:36 AM 6118.5 6119.5
>> 3 7:11:07 AM 6119.5 6119.5
>> 4 7:11:48 AM 6119.0 6120.0
>> 5 7:12:25 AM 6119.0 6119.5
>>
>> Because of the lack of date, and the time format of H,M,S and AM/PM, I can't
>> convert via as.xts or as.zoo etc.
>>
>
> Assuming your data frame is this we can use read.zoo to read it into
> zoo giving it a chron "times" class:
>
> DF <- structure(list(Time = structure(1:5, .Label = c("7:10:03 AM",
> ? ?"7:10:36 AM", "7:11:07 AM", "7:11:48 AM", "7:12:25 AM"), class = "factor"),
> ? ?Bid = c(6118.5, 6118.5, 6119.5, 6119, 6119), Offer = c(6119.5,
> ? ?6119.5, 6119.5, 6120, 6119.5)), .Names = c("Time", "Bid",
> ? ?"Offer"), class = "data.frame", row.names = c(NA, -5L))
>
> library(zoo)
> library(chron)
> z <- read.zoo(DF, FUN = function(x) times(as.chron(paste("1970-01-01", x),
> ? format = "%Y-%m-%d %H:%M:%S %p")))
> z
>
> If you need it in zoo then you now have it with "times" class which
> seems the most appropriate for that data.
>
> xts does not support chron "times" class but if you need it in xts you
> could convert it to some date/time class and then use as.xts. e.g.
>
> as.xts(aggregate(z, chron))
>
>
> --
> Statistics & Software Consulting
> GKX Group, GKX Associates Inc.
> tel: 1-877-GKX-GROUP
> email: ggrothendieck at gmail.com
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From ggrothendieck at gmail.com  Wed Dec  8 16:33:53 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Wed, 8 Dec 2010 10:33:53 -0500
Subject: [R-SIG-Finance] non-standard time-format conversion from
 data.frame to xts
In-Reply-To: <AANLkTikNo0N3se86bXJnmKSin1YSZLXR0OfW-UC8MP8D@mail.gmail.com>
References: <AANLkTi=9P2JUjhRo4HytpRGr524JLg3H_sOE3aVx8q5w@mail.gmail.com>
	<AANLkTiktDvA-tWyuxWbD-hzHp+Cv6ogLODhEA_9KZM4n@mail.gmail.com>
	<AANLkTikNo0N3se86bXJnmKSin1YSZLXR0OfW-UC8MP8D@mail.gmail.com>
Message-ID: <AANLkTimnpk2xePidQXrhQTR8523gi6kP8ze8RPMuBwSg@mail.gmail.com>

On Wed, Dec 8, 2010 at 10:01 AM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
> I'd personally advise against using anything other than real
> POSIX-style time. Time alone can't exist without a date, certainly
> with respect to observable data.
>
> Do as Brian says and you'll have the most flexibility, but if you
> insist on just time chron can certainly be useful. ?Note that chron
> uses fractional days to represent time, which is only an approximation
> of time - you will run into issues at certain times.
>
>> dput(as.chron(Sys.time()))
> structure(14951.6248495370, format = structure(c("m/d/y", "h:m:s"
> ), .Names = c("dates", "times")), origin = structure(c(1, 1,
> 1970), .Names = c("month", "day", "year")), class = c("chron",
> "dates", "times"))
>

You probably won't have any problems if you use times or POSIXct.

In particular since your resolution is one second that is more than
granular enough to represent it using floating point in chron and
times.  Its possible that errors could accumulate but not too likely.

With POSIXct you likely won't have a problem either but if you do then
the main problem is that you can introduce errors into your code due
to one routine assuming current time zone and another assuming GMT.
(xts itself is consistent but once you start using multiple packages
and even R itself there can be problems.) These errors are not that
frequent but when they occur they are extremely difficult to even know
that you have the error. The other problem is that there can be
unexpected results at day light saving time switch over.  With Date,
chron and times none of these problems occur since there are no time
zones and no day light savings times.  POSIXct is really best for
computer logs and applications like that where concepts like time
zones and day light savings time are important so you can synchronize
your logs with other time zones but is often not the most suitable for
statistical analysis where these only serve to introduce error.

With zoo and xts you do have a range of index classes to choose from,
just about any for zoo since they are defined by an API rather than
hard coded, and the half dozen or so most common for xts.

R News 4/1 discusses this more.

-- 
Statistics & Software Consulting
GKX Group, GKX Associates Inc.
tel: 1-877-GKX-GROUP
email: ggrothendieck at gmail.com


From jeff.a.ryan at gmail.com  Wed Dec  8 18:07:11 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Wed, 8 Dec 2010 11:07:11 -0600
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFE8769.2050307@organicfoodmarkets.com.au>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
	<AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>
	<4CFDD321.4020408@organicfoodmarkets.com.au>
	<4CFE8769.2050307@organicfoodmarkets.com.au>
Message-ID: <AANLkTikOJsP6dzOJ4qKfJVxEH0xgn7-1_BTudCjZtt3v@mail.gmail.com>

Stephen,

You're close.

On Tue, Dec 7, 2010 at 1:13 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> So back again!
>
> I have two problem in converting my callback to two handle two symbols so I
> can set up spreads. ?(Or at least that's what I can see it at the moment):
>
> When I run this using myCALLBACK function below:
>
> con = twsConnect()
>
> reqMktData(con, list(twsSTK("MSFT"),twsSTK("AAPL")),
> ?event=eWrapper.data(1), CALLBACK=myCALLBACK)

The eWrapper needs to be set up to handle the number of contracts you
are watching.  You need: eWrapper.data(2), with 2 being the length of
the contracts you are watching.

The ticker id is by default mapped to the order of the Contracts you
pass in. So MSFT is 1, AAPL is 2 ...

HTH,
Jeff
>
> I get this
>
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?NA ? ? ? ? ? ?"LastSize : "
> NA
> [13] "Volume: " ? ?NA
> 2 -1 2104 Market data farm connection is OK:aufarm
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?NA ? ? ? ? ? ?"LastSize : "
> NA
> [13] "Volume: " ? ?NA
> 2 -1 2104 Market data farm connection is OK:usfarm
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?NA ? ? ? ? ? ?"LastSize : "
> NA
> [13] "Volume: " ? ?NA
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?NA ? ? ? ? ? ?"LastSize : "
> NA
> [13] "Volume: " ? ?NA
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?NA ? ? ? ? ? ?"LastSize : "
> NA
> [13] "Volume: " ? ?NA
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> NA
> [13] "Volume: " ? ?NA
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?NA
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? NA ? ? ? ? ? ?"BidPrice: " ?NA ? ? ? ? ? ?"AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?NA
> ?[7] "AskSize: " ? NA ? ? ? ? ? ?"Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "4"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343529"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "1435" ? ? ? ?"BidPrice: " ?"26.96" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.97"
> ?[7] "AskSize: " ? "828" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> ?[1] "BidSize: " ? "970" ? ? ? ? "BidPrice: " ?"26.97" ? ? ? "AskPrice: "
> ?"26.98"
> ?[7] "AskSize: " ? "847" ? ? ? ? "Last: " ? ? ?"26.97" ? ? ? "LastSize : "
> "2"
> [13] "Volume: " ? ?"343550"
> Error in `*tmp*`[[id]] : subscript out of bounds
>
>
> I think what is happening is that the function fails on its first attempt to
> get data on AAPT and the above data is on MSFT but I am quite unsure as to
> what direction to take to amend the function. ?Any pointers most welcome.
>
> Secondly I need to be able to know which symbol I am dealing with. ?The
> output for:
>
> reqMktData(con, list(twsEquity("MSFT"),twsEquity("AAPL")))
>
> is
>
> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
> <20101208 05:55:28.974000> id=1 symbol=MSFT Volume: 343560
> <20101208 05:55:28.978000> id=1 symbol=MSFT highPrice: 27.09
> <20101208 05:55:28.983000> id=1 symbol=MSFT lowPrice: 26.88
> <20101208 05:55:28.988000> id=2 symbol=AAPL Volume: 79079
> <20101208 05:55:28.993000> id=2 symbol=AAPL highPrice: 323.99
>
> and shows the symbol I need but when I try to find something that refers to
> it in myCALLBACK I seem to fail. ?Is it somewhere in the data object? ?Is it
> somewhere esle someone can point me to?
>
> Stephen Choularton Ph.D., FIoD
>
>
> On 07/12/2010 5:24 PM, Stephen Choularton wrote:
>>
>> Just for the record I though I should post this as it did actually place
>> the order I was after:
>>
>> library(IBrokers)
>>
>> myCALLBACK <-
>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>
>> ? ?con <- twsCon[[1]]
>> ? ?traded <- FALSE
>> ? ?while (TRUE) {
>> ? ? ? ?socketSelect(list(con), FALSE, NULL)
>> ? ? ? ?#data
>> ? ?curMsg <- readBin(con, character(), 1)
>> ? ?if (!is.null(timestamp)) {
>> ? ? ? ?processMsg(curMsg, con, eWrapper, format(Sys.time(), timestamp),
>> file, ...)
>> ? ?} else {
>> ? ? ? ?processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>> ? ?}
>> ? ?# EXTRACT DATA HERE
>> ? ?BidSize <- as.numeric(eWrapper$.Data$data[[1]][,1])
>> ? ?BidPrice <- as.numeric(eWrapper$.Data$data[[1]][,2])
>> ? ?AskPrice <- as.numeric(eWrapper$.Data$data[[1]][,3])
>> ? ?AskSize <- ?as.numeric(eWrapper$.Data$data[[1]][,4])
>> ? ?Last <- as.numeric(eWrapper$.Data$data[[1]][,5])
>> ? ?LastSize <- as.numeric(eWrapper$.Data$data[[1]][,6])
>> ? ? ? ?Volume <- as.numeric(eWrapper$.Data$data[[1]][,7])
>> ? ?print(c("BidSize: ", BidSize, "BidPrice: ", BidPrice, "AskPrice: ",
>> AskPrice, "AskSize: ", AskSize, "Last: ", Last, "LastSize : ", LastSize ,
>> "Volume: ", Volume ))
>> ? ?# TRADE LOGIC HERE
>> ? ?if(!traded && !is.na(Last) && Last >= 49) {
>>
>> ? ? ? ?print(c("inside the trading logic "))
>> ? ? ? ?id <- reqIds(twsCon)
>> ? ? ? ?#placeOrder(tws, twsEquity("CBA","ASX","AUD"), twsOrder(id, "BUY",
>> "1", "MKT"))
>> ? ? ? ?traded <- TRUE
>> ? ?}
>> ? ?}
>> }
>>
>>
>>
>> con = twsConnect()
>>
>>
>>
>> #reqMktData(con, twsEquity("GOOG"), event=eWrapper.data(1),
>> CALLBACK=myCALLBACK)
>>
>>
>> reqMktData(con, twsEquity("CBA","ASX","AUD"), ?event=eWrapper.data(1),
>> CALLBACK=myCALLBACK)
>>
>>
>>
>> closeAllConnections()
>>
>>
>> I imagine I will be back as I am actually trying to use this for spreads -
>> so now I have to move on and try two symbols, etc but for what it is worth
>> the code is there for anyone who wants to use it.
>>
>> Stephen Choularton Ph.D., FIoD
>>
>>
>> On 06/12/2010 10:17 AM, Jeff Ryan wrote:
>>>
>>> Stephen,
>>>
>>> Comments inline:
>>>
>>> On Sun, Dec 5, 2010 at 1:23 PM, Stephen Choularton
>>> <stephen at organicfoodmarkets.com.au> ?wrote:
>>>>
>>>> Hi
>>>>
>>>> If you read this list you will have noticed I have been working on
>>>> callbacks
>>>> and I finally got to some code that appears to work so I though I would
>>>> share it:
>>>>
>>>> library(IBrokers)
>>>>
>>>> myCALLBACK<-
>>>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>>> ? ?con<- twsCon[[1]]
>>>> ? ?twsOC<- twsConnect(2) # our order connection
>>>> ? ?con2<- twsOC[[1]]
>>>> ? ?ocWrapper<- eWrapper(TRUE)
>>>> ? ?traded<- FALSE
>>>> ? ?while (TRUE) {
>>>> ? ? ? ?cons<- socketSelect(list(con, con2), FALSE, 0.01)
>>>> ? ? ? ?if(cons[1]) { #data
>>>> ? ? ? ? ? ?curMsg<- readBin(con, character(), 1)
>>>> ? ? ? ? ? ?if (!is.null(timestamp)) {
>>>> ? ? ? ? ? ? ? ?processMsg(curMsg, con, eWrapper, format(Sys.time(),
>>>> timestamp), file, ...)
>>>> ? ? ? ? ? ?} else {
>>>> ? ? ? ? ? ? ? ?processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>>>> ? ? ? ? ? ?}
>>>> ? ? ? ?} else if(cons[2]) {
>>>> ? ? ? ? ? ?curMsg<- readBin(con2, character(), 1)
>>>> ? ? ? ? ? ?if (!is.null(timestamp)) {
>>>> ? ? ? ? ? ? ? ?processMsg(curMsg, con2, ocWrapper, format(Sys.time(),
>>>> timestamp), file, ...)
>>>> ? ? ? ? ? ?} else {
>>>> ? ? ? ? ? ? ? ?processMsg(curMsg, con2, ocWrapper, timestamp, file, ...)
>>>> ? ? ? ? ? ?}
>>>> ? ? ? ?} # TRADE LOGIC HERE
>>>> ? ? ? ?curBID<- as.numeric(eWrapper$.Data$data[[1]][3])
>>>> ? ? ? ?if(!traded ?) { # add back on open:&& ?!is.na(curBID)&& ?curBID>
>>>> 141.00
>>>>
>>>> ? ? ? ? ? ?print(c("the cur bid is ", curBID))
>>>> ? ? ? ? ? ?# IBrokers:::.placeOrder(twsOC, twsEquity("CBA","ASX","AUD"),
>>>> twsOrder(1053, "BUY", "0", "MKT"))
>>>> ? ? ? ? ? ?traded<- TRUE
>>>> ? ? ? ?}
>>>> ? ?}
>>>> ? ?twsDisconnect(twsOC)
>>>> }
>>>>
>>>> con = twsConnect(1)
>>>>
>>>> # contracts<- ?list(twsSTK("MSFT"),twsSTK("AAPL")))
>>>>
>>>>
>>>> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>>>>
>>>> twsDisconnect(con)
>>>>
>>>> However, even though I have tried to close down my twsCnnections, if I
>>>> run
>>>> the code twice I get a warning along the lines:
>>>>
>>>> unable to connect. client id already in use. retry with unique client id
>>>>
>>>> and R freezes. ?Does anyone know how to solve the problem?
>>>
>>> R is likely "freezing" due to buffering on Windows (which you can turn
>>> off in the GUI), but that isn't really the core issue. ?You don't need
>>> to have a second connection opened in the CALLBACK. ?It is in the
>>> examples of one of my talks to illustrate having an external mkt data
>>> feed and IB execution. ?If you are only looking at IB (for data and
>>> execution), DON'T use a second connection. ?Seriously it is not needed
>>> at all, and it is just making things more confusing I suspect.
>>>
>>> > From there (on connection) close(con) or twsDisconnect(con) should
>>> indeed free up the client id. You can always go the route of
>>> closeAllConnections() route in R to 'start over'.
>>>
>>>> Incidentally I notice that the code gets ?curBID<-
>>>> as.numeric(eWrapper$.Data$data[[1]][3]). ?Does anyone know what the
>>>> appropriate indices are for the other data in eWrapper$.Data and what
>>>> that
>>>> data is?
>>>>
>>> As Mark points out in his reply, look at the source for the
>>> answers/hints:
>>>
>>> In order: ?BidSize, BidPrice, AskPrice, AskSize, Last, LastSize and
>>> Volume. ?The first four ordering mimic what it looks like when you
>>> stand in the pit on the floor and look at the CRTs (or your own custom
>>> screen...) ;-)
>>>
>>>
>>> # from the source
>>>>
>>>> eWrapper.data
>>>
>>> function (n)
>>> {
>>> ? ? eW<- eWrapper(NULL)
>>> ? ? eW$assign.Data("data", rep(list(structure(.xts(matrix(rep(NA_real_,
>>> ? ? ? ? 7), nc = 7), 0), .Dimnames = list(NULL, c("BidSize",
>>> ? ? ? ? "BidPrice", "AskPrice", "AskSize", "Last", "LastSize",
>>> ? ? ? ? "Volume")))), n))
>>> ? ? eW$tickPrice<- function(curMsg, msg, timestamp, file, ...) {
>>> ? ? ? ? tickType = msg[3]
>>> ? ? ? ? msg<- as.numeric(msg)
>>> ? ? ? ? id<- msg[2]
>>> ? ? ? ? data<- eW$get.Data("data")
>>> ? ? ? ? attr(data[[id]], "index")<- as.numeric(Sys.time())
>>> ? ? ? ? nr.data<- NROW(data[[id]])
>>> ? ? ? ? if (tickType == .twsTickType$BID) {
>>> ? ? ? ? ? ? data[[id]][nr.data, 1:2]<- msg[5:4]
>>> ? ? ? ? }
>>> ? ? ? ? else if (tickType == .twsTickType$ASK) {
>>> ? ? ? ? ? ? data[[id]][nr.data, 3:4]<- msg[4:5]
>>> ? ? ? ? }
>>> ? ? ? ? else if (tickType == .twsTickType$LAST) {
>>> ? ? ? ? ? ? data[[id]][nr.data, 5]<- msg[4]
>>> ? ? ? ? }
>>> ? ? ? ? eW$assign.Data("data", data)
>>> ? ? ? ? c(curMsg, msg)
>>> ? ? }
>>> ? ? eW$tickSize<- function(curMsg, msg, timestamp, file, ...) {
>>> ? ? ? ? data<- eW$get.Data("data")
>>> ? ? ? ? tickType = msg[3]
>>> ? ? ? ? msg<- as.numeric(msg)
>>> ? ? ? ? id<- as.numeric(msg[2])
>>> ? ? ? ? attr(data[[id]], "index")<- as.numeric(Sys.time())
>>> ? ? ? ? nr.data<- NROW(data[[id]])
>>> ? ? ? ? if (tickType == .twsTickType$BID_SIZE) {
>>> ? ? ? ? ? ? data[[id]][nr.data, 1]<- msg[4]
>>> ? ? ? ? }
>>> ? ? ? ? else if (tickType == .twsTickType$ASK_SIZE) {
>>> ? ? ? ? ? ? data[[id]][nr.data, 4]<- msg[4]
>>> ? ? ? ? }
>>> ? ? ? ? else if (tickType == .twsTickType$LAST_SIZE) {
>>> ? ? ? ? ? ? data[[id]][nr.data, 6]<- msg[4]
>>> ? ? ? ? }
>>> ? ? ? ? else if (tickType == .twsTickType$VOLUME) {
>>> ? ? ? ? ? ? data[[id]][nr.data, 7]<- msg[4]
>>> ? ? ? ? }
>>> ? ? ? ? eW$assign.Data("data", data)
>>> ? ? ? ? c(curMsg, msg)
>>> ? ? }
>>> ? ? return(eW)
>>> }
>>> <environment: namespace:IBrokers>
>>>
>>> You can of course do whatever you like to make it more logical to you.
>>> ?Reading IBrokers source and the official Java source (yikes) is the
>>> way to get to a different end if you so require.
>>>
>>> Best,
>>> Jeff
>>>
>>>>
>>>>
>>>> --
>>>> Stephen Choularton Ph.D., FIoD
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>
>>>
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>>
>>
>>
>> -----
>> No virus found in this message.
>> Checked by AVG - www.avg.com
>> Version: 10.0.1170 / Virus Database: 426/3301 - Release Date: 12/06/10
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From ezivot at u.washington.edu  Wed Dec  8 21:02:35 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Wed, 8 Dec 2010 12:02:35 -0800
Subject: [R-SIG-Finance] Winter and Spring online R programming courses for
	finance at the University of Washington
Message-ID: <008c01cb9712$db92d630$92b88290$@washington.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101208/84cb29c0/attachment.pl>

From ezivot at u.washington.edu  Wed Dec  8 21:10:25 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Wed, 8 Dec 2010 12:10:25 -0800
Subject: [R-SIG-Finance] Winter and Spring online R programming courses for
	computational finance at the University of Washington
Message-ID: <00c801cb9713$f3ac9de0$db05d9a0$@washington.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101208/037c363e/attachment.pl>

From stephen at organicfoodmarkets.com.au  Wed Dec  8 22:06:18 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Thu, 09 Dec 2010 08:06:18 +1100
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <AANLkTikOJsP6dzOJ4qKfJVxEH0xgn7-1_BTudCjZtt3v@mail.gmail.com>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>	<AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>	<4CFDD321.4020408@organicfoodmarkets.com.au>	<4CFE8769.2050307@organicfoodmarkets.com.au>
	<AANLkTikOJsP6dzOJ4qKfJVxEH0xgn7-1_BTudCjZtt3v@mail.gmail.com>
Message-ID: <4CFFF34A.6060402@organicfoodmarkets.com.au>

Hi Jeff

Thanks, but when I try to reference the second data object using this 
(which is all I can think of):

BidPrice2 <- as.numeric(eWrapper$.Data$data[[2]][,5])

The code runs but I don't get any info. eWrapper$.Data$data[[2]][,5] 
appears to exist but to be empty.  Do I have to do something to place 
the data into it?

Plus does curMsg <- readBin(con, character(), 1) give me the ticker id?



Stephen Choularton Ph.D., FIoD
On 09/12/2010 4:07 AM, Jeff Ryan wrote:
> Stephen,
>
> You're close.
>
> On Tue, Dec 7, 2010 at 1:13 PM, Stephen Choularton
> <stephen at organicfoodmarkets.com.au>  wrote:
>> So back again!
>>
>> I have two problem in converting my callback to two handle two symbols so I
>> can set up spreads.  (Or at least that's what I can see it at the moment):
>>
>> When I run this using myCALLBACK function below:
>>
>> con = twsConnect()
>>
>> reqMktData(con, list(twsSTK("MSFT"),twsSTK("AAPL")),
>>   event=eWrapper.data(1), CALLBACK=myCALLBACK)
> The eWrapper needs to be set up to handle the number of contracts you
> are watching.  You need: eWrapper.data(2), with 2 being the length of
> the contracts you are watching.
>
> The ticker id is by default mapped to the order of the Contracts you
> pass in. So MSFT is 1, AAPL is 2 ...
>
> HTH,
> Jeff
>> I get this
>>
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      NA            "LastSize : "
>> NA
>> [13] "Volume: "    NA
>> 2 -1 2104 Market data farm connection is OK:aufarm
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      NA            "LastSize : "
>> NA
>> [13] "Volume: "    NA
>> 2 -1 2104 Market data farm connection is OK:usfarm
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      NA            "LastSize : "
>> NA
>> [13] "Volume: "    NA
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      NA            "LastSize : "
>> NA
>> [13] "Volume: "    NA
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      NA            "LastSize : "
>> NA
>> [13] "Volume: "    NA
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> NA
>> [13] "Volume: "    NA
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    NA
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   NA            "BidPrice: "  NA            "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   NA
>>   [7] "AskSize: "   NA            "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "4"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343529"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.97"
>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       "AskPrice: "
>>   "26.98"
>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       "LastSize : "
>> "2"
>> [13] "Volume: "    "343550"
>> Error in `*tmp*`[[id]] : subscript out of bounds
>>
>>
>> I think what is happening is that the function fails on its first attempt to
>> get data on AAPT and the above data is on MSFT but I am quite unsure as to
>> what direction to take to amend the function.  Any pointers most welcome.
>>
>> Secondly I need to be able to know which symbol I am dealing with.  The
>> output for:
>>
>> reqMktData(con, list(twsEquity("MSFT"),twsEquity("AAPL")))
>>
>> is
>>
>> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
>> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
>> <20101208 05:55:28.974000>  id=1 symbol=MSFT Volume: 343560
>> <20101208 05:55:28.978000>  id=1 symbol=MSFT highPrice: 27.09
>> <20101208 05:55:28.983000>  id=1 symbol=MSFT lowPrice: 26.88
>> <20101208 05:55:28.988000>  id=2 symbol=AAPL Volume: 79079
>> <20101208 05:55:28.993000>  id=2 symbol=AAPL highPrice: 323.99
>>
>> and shows the symbol I need but when I try to find something that refers to
>> it in myCALLBACK I seem to fail.  Is it somewhere in the data object?  Is it
>> somewhere esle someone can point me to?
>>
>> Stephen Choularton Ph.D., FIoD
>>
>>
>> On 07/12/2010 5:24 PM, Stephen Choularton wrote:
>>> Just for the record I though I should post this as it did actually place
>>> the order I was after:
>>>
>>> library(IBrokers)
>>>
>>> myCALLBACK<-
>>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>>
>>>     con<- twsCon[[1]]
>>>     traded<- FALSE
>>>     while (TRUE) {
>>>         socketSelect(list(con), FALSE, NULL)
>>>         #data
>>>     curMsg<- readBin(con, character(), 1)
>>>     if (!is.null(timestamp)) {
>>>         processMsg(curMsg, con, eWrapper, format(Sys.time(), timestamp),
>>> file, ...)
>>>     } else {
>>>         processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>>>     }
>>>     # EXTRACT DATA HERE
>>>     BidSize<- as.numeric(eWrapper$.Data$data[[1]][,1])
>>>     BidPrice<- as.numeric(eWrapper$.Data$data[[1]][,2])
>>>     AskPrice<- as.numeric(eWrapper$.Data$data[[1]][,3])
>>>     AskSize<-  as.numeric(eWrapper$.Data$data[[1]][,4])
>>>     Last<- as.numeric(eWrapper$.Data$data[[1]][,5])
>>>     LastSize<- as.numeric(eWrapper$.Data$data[[1]][,6])
>>>         Volume<- as.numeric(eWrapper$.Data$data[[1]][,7])
>>>     print(c("BidSize: ", BidSize, "BidPrice: ", BidPrice, "AskPrice: ",
>>> AskPrice, "AskSize: ", AskSize, "Last: ", Last, "LastSize : ", LastSize ,
>>> "Volume: ", Volume ))
>>>     # TRADE LOGIC HERE
>>>     if(!traded&&  !is.na(Last)&&  Last>= 49) {
>>>
>>>         print(c("inside the trading logic "))
>>>         id<- reqIds(twsCon)
>>>         #placeOrder(tws, twsEquity("CBA","ASX","AUD"), twsOrder(id, "BUY",
>>> "1", "MKT"))
>>>         traded<- TRUE
>>>     }
>>>     }
>>> }
>>>
>>>
>>>
>>> con = twsConnect()
>>>
>>>
>>>
>>> #reqMktData(con, twsEquity("GOOG"), event=eWrapper.data(1),
>>> CALLBACK=myCALLBACK)
>>>
>>>
>>> reqMktData(con, twsEquity("CBA","ASX","AUD"),  event=eWrapper.data(1),
>>> CALLBACK=myCALLBACK)
>>>
>>>
>>>
>>> closeAllConnections()
>>>
>>>
>>> I imagine I will be back as I am actually trying to use this for spreads -
>>> so now I have to move on and try two symbols, etc but for what it is worth
>>> the code is there for anyone who wants to use it.
>>>
>>> Stephen Choularton Ph.D., FIoD
>>>
>>>
>>> On 06/12/2010 10:17 AM, Jeff Ryan wrote:
>>>> Stephen,
>>>>
>>>> Comments inline:
>>>>
>>>> On Sun, Dec 5, 2010 at 1:23 PM, Stephen Choularton
>>>> <stephen at organicfoodmarkets.com.au>    wrote:
>>>>> Hi
>>>>>
>>>>> If you read this list you will have noticed I have been working on
>>>>> callbacks
>>>>> and I finally got to some code that appears to work so I though I would
>>>>> share it:
>>>>>
>>>>> library(IBrokers)
>>>>>
>>>>> myCALLBACK<-
>>>>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>>>>     con<- twsCon[[1]]
>>>>>     twsOC<- twsConnect(2) # our order connection
>>>>>     con2<- twsOC[[1]]
>>>>>     ocWrapper<- eWrapper(TRUE)
>>>>>     traded<- FALSE
>>>>>     while (TRUE) {
>>>>>         cons<- socketSelect(list(con, con2), FALSE, 0.01)
>>>>>         if(cons[1]) { #data
>>>>>             curMsg<- readBin(con, character(), 1)
>>>>>             if (!is.null(timestamp)) {
>>>>>                 processMsg(curMsg, con, eWrapper, format(Sys.time(),
>>>>> timestamp), file, ...)
>>>>>             } else {
>>>>>                 processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>>>>>             }
>>>>>         } else if(cons[2]) {
>>>>>             curMsg<- readBin(con2, character(), 1)
>>>>>             if (!is.null(timestamp)) {
>>>>>                 processMsg(curMsg, con2, ocWrapper, format(Sys.time(),
>>>>> timestamp), file, ...)
>>>>>             } else {
>>>>>                 processMsg(curMsg, con2, ocWrapper, timestamp, file, ...)
>>>>>             }
>>>>>         } # TRADE LOGIC HERE
>>>>>         curBID<- as.numeric(eWrapper$.Data$data[[1]][3])
>>>>>         if(!traded  ) { # add back on open:&&    !is.na(curBID)&&    curBID>
>>>>> 141.00
>>>>>
>>>>>             print(c("the cur bid is ", curBID))
>>>>>             # IBrokers:::.placeOrder(twsOC, twsEquity("CBA","ASX","AUD"),
>>>>> twsOrder(1053, "BUY", "0", "MKT"))
>>>>>             traded<- TRUE
>>>>>         }
>>>>>     }
>>>>>     twsDisconnect(twsOC)
>>>>> }
>>>>>
>>>>> con = twsConnect(1)
>>>>>
>>>>> # contracts<-  list(twsSTK("MSFT"),twsSTK("AAPL")))
>>>>>
>>>>>
>>>>> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>>>>>
>>>>> twsDisconnect(con)
>>>>>
>>>>> However, even though I have tried to close down my twsCnnections, if I
>>>>> run
>>>>> the code twice I get a warning along the lines:
>>>>>
>>>>> unable to connect. client id already in use. retry with unique client id
>>>>>
>>>>> and R freezes.  Does anyone know how to solve the problem?
>>>> R is likely "freezing" due to buffering on Windows (which you can turn
>>>> off in the GUI), but that isn't really the core issue.  You don't need
>>>> to have a second connection opened in the CALLBACK.  It is in the
>>>> examples of one of my talks to illustrate having an external mkt data
>>>> feed and IB execution.  If you are only looking at IB (for data and
>>>> execution), DON'T use a second connection.  Seriously it is not needed
>>>> at all, and it is just making things more confusing I suspect.
>>>>
>>>>>  From there (on connection) close(con) or twsDisconnect(con) should
>>>> indeed free up the client id. You can always go the route of
>>>> closeAllConnections() route in R to 'start over'.
>>>>
>>>>> Incidentally I notice that the code gets  curBID<-
>>>>> as.numeric(eWrapper$.Data$data[[1]][3]).  Does anyone know what the
>>>>> appropriate indices are for the other data in eWrapper$.Data and what
>>>>> that
>>>>> data is?
>>>>>
>>>> As Mark points out in his reply, look at the source for the
>>>> answers/hints:
>>>>
>>>> In order:  BidSize, BidPrice, AskPrice, AskSize, Last, LastSize and
>>>> Volume.  The first four ordering mimic what it looks like when you
>>>> stand in the pit on the floor and look at the CRTs (or your own custom
>>>> screen...) ;-)
>>>>
>>>>
>>>> # from the source
>>>>> eWrapper.data
>>>> function (n)
>>>> {
>>>>      eW<- eWrapper(NULL)
>>>>      eW$assign.Data("data", rep(list(structure(.xts(matrix(rep(NA_real_,
>>>>          7), nc = 7), 0), .Dimnames = list(NULL, c("BidSize",
>>>>          "BidPrice", "AskPrice", "AskSize", "Last", "LastSize",
>>>>          "Volume")))), n))
>>>>      eW$tickPrice<- function(curMsg, msg, timestamp, file, ...) {
>>>>          tickType = msg[3]
>>>>          msg<- as.numeric(msg)
>>>>          id<- msg[2]
>>>>          data<- eW$get.Data("data")
>>>>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>>>>          nr.data<- NROW(data[[id]])
>>>>          if (tickType == .twsTickType$BID) {
>>>>              data[[id]][nr.data, 1:2]<- msg[5:4]
>>>>          }
>>>>          else if (tickType == .twsTickType$ASK) {
>>>>              data[[id]][nr.data, 3:4]<- msg[4:5]
>>>>          }
>>>>          else if (tickType == .twsTickType$LAST) {
>>>>              data[[id]][nr.data, 5]<- msg[4]
>>>>          }
>>>>          eW$assign.Data("data", data)
>>>>          c(curMsg, msg)
>>>>      }
>>>>      eW$tickSize<- function(curMsg, msg, timestamp, file, ...) {
>>>>          data<- eW$get.Data("data")
>>>>          tickType = msg[3]
>>>>          msg<- as.numeric(msg)
>>>>          id<- as.numeric(msg[2])
>>>>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>>>>          nr.data<- NROW(data[[id]])
>>>>          if (tickType == .twsTickType$BID_SIZE) {
>>>>              data[[id]][nr.data, 1]<- msg[4]
>>>>          }
>>>>          else if (tickType == .twsTickType$ASK_SIZE) {
>>>>              data[[id]][nr.data, 4]<- msg[4]
>>>>          }
>>>>          else if (tickType == .twsTickType$LAST_SIZE) {
>>>>              data[[id]][nr.data, 6]<- msg[4]
>>>>          }
>>>>          else if (tickType == .twsTickType$VOLUME) {
>>>>              data[[id]][nr.data, 7]<- msg[4]
>>>>          }
>>>>          eW$assign.Data("data", data)
>>>>          c(curMsg, msg)
>>>>      }
>>>>      return(eW)
>>>> }
>>>> <environment: namespace:IBrokers>
>>>>
>>>> You can of course do whatever you like to make it more logical to you.
>>>>   Reading IBrokers source and the official Java source (yikes) is the
>>>> way to get to a different end if you so require.
>>>>
>>>> Best,
>>>> Jeff
>>>>
>>>>>
>>>>> --
>>>>> Stephen Choularton Ph.D., FIoD
>>>>>
>>>>> _______________________________________________
>>>>> R-SIG-Finance at r-project.org mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>> -- Also note that this is not the r-help list where general R questions
>>>>> should go.
>>>>>
>>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>>
>>>
>>>
>>> -----
>>> No virus found in this message.
>>> Checked by AVG - www.avg.com
>>> Version: 10.0.1170 / Virus Database: 426/3301 - Release Date: 12/06/10
>>>
>>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>


From corwin.joy at gmail.com  Thu Dec  9 01:41:44 2010
From: corwin.joy at gmail.com (Corwin Joy)
Date: Wed, 8 Dec 2010 16:41:44 -0800 (PST)
Subject: [R-SIG-Finance] fPortfolio - SOCP not available?
In-Reply-To: <4BCF811C.7010906@itp.phys.ethz.ch>
References: <20100421204855.87740@gmx.net> <4BCF811C.7010906@itp.phys.ethz.ch>
Message-ID: <1291855304248-3079413.post@n4.nabble.com>


The method given by Diethelm Wuertz in the referenced post to obtain a
maximum return portfolio for a given level of risk works pretty well. 
However, I found it useful to tune the optimizer parameter so that the
solver is only solving to the accuracy I need and not running for a long
time.  Here is what this looks like:

require(fPortfolio)
require(fPortfolioSolver)

#
----------------------------------------------------------------------------------------------
# Portfolio solver using RSCOP.  Adapted from solveRsocp to use control
parameters from portfolio spec
#
----------------------------------------------------------------------------------------------
SolveRsocpWithControl<-
function (data, spec, constraints) 
{
    Data = portfolioData(data, spec)
    trace = getTrace(spec)
    if (trace) 
        cat("\nPortfolio Optimiziation:\n Using Rsocp ...\n\n")
    nAssets = getNAssets(Data)
    args <- .rsocpArguments(data, spec, constraints)
    Control <- getControl(spec)
    ans <- .rsocp(f = args$f, A = args$A, b = args$b, C = args$C, 
        d = args$d, N = args$N, targetRisk = args$targetRisk, 
        mu = args$mu, Scale = args$Scale, control = Control)
    class(ans) = c("solveRfoo", "list")
    ans
}

#
----------------------------------------------------------------------------------------------
# Compute weights to give maximum return for desired volatility
# Input
#    rets: log-return history of assets to optimize as a time series object
#    target_vol: target level for desired volatility, expressed as an
annualized volatility
#
# Return
#    vector of weights to give maximum return given desired volatility
#
----------------------------------------------------------------------------------------------
maxReturnGivenVol<-function(rets, target_vol)
{  
  portSpec<-portfolioSpec()
  setTargetRisk(portSpec) <- (target_vol / sqrt(12)) ^ 2
  setSolver(portSpec)="SolveRsocpWithControl"
  
  # Adjust accuracy to appropriate level
  # setContol does not seem to be implemented
  # setControl(portSpec) = .rsocpControl(abs.tol = 1e-5, rel.tol = 1e-4)  
  portSpec at optim$control <- .rsocpControl(abs.tol = 1e-5, rel.tol = 1e-4) 
    
  eff<-efficientPortfolio(data=rets, spec=portSpec, constraints="LongOnly")
  # print(eff)
  # weightsPieCutoff(eff) # Pie chart with min weight cutoff

  w<-getWeights(eff)
  names(w)<-getNames(eff)
  w
}
-- 
View this message in context: http://r.789695.n4.nabble.com/fPortfolio-SOCP-not-available-tp2019667p3079413.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From joshchien at yahoo.com  Thu Dec  9 03:16:54 2010
From: joshchien at yahoo.com (JOSH CHIEN)
Date: Wed, 8 Dec 2010 18:16:54 -0800 (PST)
Subject: [R-SIG-Finance] Do you have any suggestions for spreading R in
	Taiwan where finance is dominated by Matlab?
Message-ID: <393609.56597.qm@web113114.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101208/6333131a/attachment.pl>

From santosh.srinivas at gmail.com  Thu Dec  9 03:31:43 2010
From: santosh.srinivas at gmail.com (Santosh Srinivas)
Date: Thu, 9 Dec 2010 08:01:43 +0530
Subject: [R-SIG-Finance] Do you have any suggestions for spreading R in
 Taiwan where finance is dominated by Matlab?
In-Reply-To: <393609.56597.qm@web113114.mail.gq1.yahoo.com>
References: <393609.56597.qm@web113114.mail.gq1.yahoo.com>
Message-ID: <AANLkTikyhYDCYLuJ1T4Ohf6f4rUvq-n09AjbmvAu9r1c@mail.gmail.com>

Ideally I'd think it is show by example (and then measure with costs
and efficiency). The network R-bloggers, RevoR, learningR .. many
others who are gurus in this group and the r-help group who  do a
great job of *demonstrating* R-usage (and try-it-for-yourself).
(there are lots of these individuals / groups)

I would be watchful on commercial applications (i.e. do proper
cross-testing across platforms and softwares to check). Although, I
like R very much, I spoke to a very established individual in finance
yesterday who mentioned that there are occasional issues that he has
observed in R (he loves R himself). I would be cautious making a
blanket recommendation in commercial applications (since issue is
sortof sensitive)


On Thu, Dec 9, 2010 at 7:46 AM, JOSH CHIEN <joshchien at yahoo.com> wrote:
> Dear all R user,
>
> I'm a risk specialist, quant team, for investment risk department in life
> insurance company in Taiwan.
>
> I need your guys to help me how to spread using R in finance.
>
> Any feedback and opinion is fine to me.
>
> I just want to inspire some idea about using R in finance,especially in modeling
> Credit Risk & Market Risk.
>
> Sincerely,
>
> Josh Chien
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From cevans at chyden.net  Thu Dec  9 03:39:59 2010
From: cevans at chyden.net (Charles Evans)
Date: Wed, 8 Dec 2010 21:39:59 -0500
Subject: [R-SIG-Finance] Multivariate GARCH
Message-ID: <131CF151-E5E2-4A14-8F19-353C6BE7F7E3@chyden.net>

Currently, I am working on an analysis of ETF premiums.  I have  
estimated ECMs for my sample, but the error terms exhibit ARCH behavior.

Is there a more straightforward way to estimate a multivariate GARCH  
model than mgarch or mgarchBEKK?  I have searched for a usable  
tutorial, and I have been unable to find any other than Jeff Ryan's  
post from 2007:

https://stat.ethz.ch/pipermail/r-sig-finance/2007q4/001833.html

and Ruey Tsay's transcript at:

http://faculty.chicagobooth.edu/ruey.tsay/teaching/bs41202/sp2010/fGarch.txt

Can anyone direct me to a tutorial that lays out how one estimates a  
multivariate GARCH model in R?  I'm not asking for a lesson in basic  
econometrics, just an R-related URL that a researcher in a hurry can  
use.

Specifically, I want to fit a model of the following form for a sample  
of ETFs:

p = e + n + [GARCH factors] + v, where

p: price returns
e: lagged error terms from a first-pass regression of p on n
n: net asset value (NAV) returns
v: white noise error term

I have tried:

garchFit(p ~ garch(1,1), data=x.data, trace=F)

but I get exactly the same results as when I run:

garchFit(~ garch(1,1), data=x.data, trace=F)

where

x.data <- cbind(timeSeries(p),timeSeries(e),timeSeries(n))
colnames(x.data) <- c("p","e","n")

Apparently, I am doing something wrong.  Any hints would be greatly  
appreciated.


Sample Data:

p <- c(0.005678744, 0.010188880, 0.004402934, -0.008585791,  
0.002392346, 0.000000000, 0.013999517, 0.006107606, 0.012220111,  
0.003809968, -0.008796353, -0.011222938, 0.003052004, 0.011073019,  
-0.005346363, -0.008778660, 0.009826939, 0.000930882, -0.006300336,  
0.005020149)

n <- c(0.002903111, 0.013199136, 0.002619049, -0.009796972,  
0.006343149, -0.004543832, 0.015105848, 0.007058022, 0.008869238,  
0.011436617, -0.010623656, -0.014617579, 0.004231815, 0.011082062,  
-0.002788106, -0.010055036, 0.008891027, 0.002559034, -0.008985415,  
0.007590391)

e <- c(2.144238e-03, -8.760417e-04, 9.058546e-04, 2.124476e-03,  
-1.831144e-03, 2.716139e-03, 1.598335e-03, 6.425588e-04, 3.986696e-03,  
-3.648639e-03, -1.813267e-03, 1.592476e-03, 4.094507e-04,  
3.919921e-04, -2.164148e-03, -8.801350e-04, 4.902445e-05,  
-1.581071e-03, 1.110833e-03, -1.465173e-03)

Yours,

Charles Evans


From joshchien at yahoo.com  Thu Dec  9 07:21:17 2010
From: joshchien at yahoo.com (JOSH CHIEN)
Date: Wed, 8 Dec 2010 22:21:17 -0800 (PST)
Subject: [R-SIG-Finance] Rmetrics TimeSeries Class
Message-ID: <913474.88751.qm@web113115.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101208/b5fb2fa6/attachment.pl>

From etheber at gmx.de  Thu Dec  9 10:56:39 2010
From: etheber at gmx.de (Thomas Etheber)
Date: Thu, 09 Dec 2010 10:56:39 +0100
Subject: [R-SIG-Finance] Rmetrics TimeSeries Class
In-Reply-To: <913474.88751.qm@web113115.mail.gq1.yahoo.com>
References: <913474.88751.qm@web113115.mail.gq1.yahoo.com>
Message-ID: <4D00A7D7.7010901@gmx.de>

Did you already try something like...

DXY.S <- timeSeries(DXY[,-1], DXY[,1])



On 09.12.2010 07:21, JOSH CHIEN wrote:
> Hi All R user,
> I'm being trouble with converting timeSeries Class on Rmetrics lib.
>
> I use "read.cvs" function to import data.
> data is data.frame class. But, I need to convert into timeSeries class.
>
> Below is my example.
>
> # I can't convert into timeSeries class. I don't why ???
> Anyone can handle that ????
>
> class(data) = data.frame
> class(DXY) = data.frame / class(DXY$Date) = Date
>
>> head(data)
>          Date lastPrice Vol10 Vol30 Vol90 Vol60 Vol180 Vol260 Vol360
> 1 2010/01/04    77.525  4.66  9.18  8.21  8.42   9.62  10.78  12.34
> 2   2010/1/5    77.619  4.38  8.80  8.21  8.37   9.51  10.76  12.34
> 3   2010/1/6    77.493  3.90  8.83  8.10  8.37   9.49  10.72  12.33
> 4   2010/1/7    77.913  4.63  8.12  8.12  8.34   9.47  10.73  12.32
> 5   2010/1/8    77.471  5.49  8.20  8.17  8.44   9.49  10.72  12.33
> 6  2010/1/11    77.005  6.28  8.48  8.20  8.54   9.51  10.70  12.34
>>   DXY<- transform(data,Date = as.Date(Date))
>> head(DXY)
>          Date lastPrice Vol10 Vol30 Vol90 Vol60 Vol180 Vol260 Vol360
> 1 2010-01-04    77.525  4.66  9.18  8.21  8.42   9.62  10.78  12.34
> 2 2010-01-05    77.619  4.38  8.80  8.21  8.37   9.51  10.76  12.34
> 3 2010-01-06    77.493  3.90  8.83  8.10  8.37   9.49  10.72  12.33
> 4 2010-01-07    77.913  4.63  8.12  8.12  8.34   9.47  10.73  12.32
> 5 2010-01-08    77.471  5.49  8.20  8.17  8.44   9.49  10.72  12.33
> 6 2010-01-11    77.005  6.28  8.48  8.20  8.54   9.51  10.70  12.34
>> DXY.S<- as.timeSeries(DXY)
>> head(DXY.S)
> GMT
>                      lastPrice Vol10 Vol30 Vol90 Vol60 Vol180 Vol260 Vol360
> 1970-01-01 04:03:33    77.525  4.66  9.18  8.21  8.42   9.62  10.78  12.34
> 1970-01-01 04:03:34    77.619  4.38  8.80  8.21  8.37   9.51  10.76  12.34
> 1970-01-01 04:03:35    77.493  3.90  8.83  8.10  8.37   9.49  10.72  12.33
> 1970-01-01 04:03:36    77.913  4.63  8.12  8.12  8.34   9.47  10.73  12.32
> 1970-01-01 04:03:37    77.471  5.49  8.20  8.17  8.44   9.49  10.72  12.33
> 1970-01-01 04:03:40    77.005  6.28  8.48  8.20  8.54   9.51  10.70  12.34
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From brian at braverock.com  Thu Dec  9 14:04:11 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 09 Dec 2010 07:04:11 -0600
Subject: [R-SIG-Finance] Do you have any suggestions for spreading R in
 Taiwan where finance is dominated by Matlab?
In-Reply-To: <393609.56597.qm@web113114.mail.gq1.yahoo.com>
References: <393609.56597.qm@web113114.mail.gq1.yahoo.com>
Message-ID: <4D00D3CB.1060309@braverock.com>

On 12/08/2010 08:16 PM, JOSH CHIEN wrote:
> Dear all R user,
>
> I'm a risk specialist, quant team, for investment risk department in life
> insurance company in Taiwan.
>
> I need your guys to help me how to spread using R in finance.
>
> Any feedback and opinion is fine to me.
>
> I just want to inspire some idea about using R in finance,especially in modeling
> Credit Risk&  Market Risk.

1> transparency

As an open system, you can look at, evaluate, and modify the code.
All of it.  There are many well documented failings of Excel, SAS, SPSS, 
and Matlab statistical methods and financial toolkits.  With those 
systems, you are at the mercy of the commercial vendor to fix issues the 
effect your work.  I know from personal experience that even after 
spending tens or hundreds of thousands of dollars (or equivalent) on 
commercial licenses, the answer from your vendor is likely to be "thanks 
for the bug report, we'll look into it and add it to a future release". 
  R is of course not perfect.  Many of the packages developed for R were 
developed for teaching, not production, for example.  *All* code has 
bugs.  However, you will have the code, and could fix any problems you 
locate, with or without help from the package creator/maintainer.

2> community

The mailing lists, forums, etc for R are in many cases more active than 
those for commercial packages.  There are some serious heavy-hitters on 
this list alone.  If you are careful in asking your question (see Eric 
Raymond's excellent advice on asking smart questions) and are working on 
an interesting problem, chances are very good that you'll get a helpful, 
insightful answer.  You'll still need to do some work, of course, but 
all things of value require effort.  Conferences like the RMetrics 
conference and R/Finance in Chicago bring together people exclusively at 
the intersection of finance and R to network and present interesting 
research.

3> collaboration

Related to 2> above, but different.  If you can judge the things that 
you work on that are non-proprietary, of general utility, and contribute 
those things to the community via packages or significant code examples 
on this list or a blog, others will put out real effort to work on them 
with you.  You, in return, enhance your own professional reputation, get 
contributions from gifted individuals, free bug testing, and feedback.

4> research

Many PhD programs, and an increasing number of Masters programs in 
economics or finance are moving to the use of R.  R seems to be the 
dominant language in statistics, and is gaining ground from Matlab in 
Finance.  This increases the chance that what you need (for example in 
Credit and Market Risk) is already written in R, leaving you to spend 
more of your time on your specific problem, and less time replicating 
some analysis published in a journal or book.

5> scalability

I have run analyses on 50 or more physical nodes in parallel.  For the 
cost of commercial software, I could instead get more physical nodes 
(lots more nodes!), and therefore be more productive.


There are more reasons, but these are the most important ones to me.  No 
system is perfect, and no system does everything you want just the way 
you want, but despite (or perhaps because of) its steep learning curve, 
R is capable of getting closer than any other system I'm aware of (and 
I've used all the ones I mention above in large scale analyses).


Regards,

    - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Thu Dec  9 15:57:09 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 09 Dec 2010 08:57:09 -0600
Subject: [R-SIG-Finance] Multivariate GARCH
In-Reply-To: <131CF151-E5E2-4A14-8F19-353C6BE7F7E3@chyden.net>
References: <131CF151-E5E2-4A14-8F19-353C6BE7F7E3@chyden.net>
Message-ID: <4D00EE45.9080703@braverock.com>

On 12/08/2010 08:39 PM, Charles Evans wrote:
> Currently, I am working on an analysis of ETF premiums.  I have
> estimated ECMs for my sample, but the error terms exhibit ARCH behavior.
>
> Is there a more straightforward way to estimate a multivariate GARCH
> model than mgarch or mgarchBEKK? I have searched for a usable tutorial,
> and I have been unable to find any other than Jeff Ryan's post from 2007:
>
> https://stat.ethz.ch/pipermail/r-sig-finance/2007q4/001833.html
>
> and Ruey Tsay's transcript at:
>
> http://faculty.chicagobooth.edu/ruey.tsay/teaching/bs41202/sp2010/fGarch.txt
>
>
> Can anyone direct me to a tutorial that lays out how one estimates a
> multivariate GARCH model in R? I'm not asking for a lesson in basic
> econometrics, just an R-related URL that a researcher in a hurry can use.

packages:

mgarch, mgarchBekk, and ccgarch can all estimate multivariate GARCH 
models.  To the best of my knowledge, fGarch cannot.

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From Bernhard_Pfaff at fra.invesco.com  Thu Dec  9 16:16:47 2010
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Thu, 9 Dec 2010 15:16:47 -0000
Subject: [R-SIG-Finance] Multivariate GARCH
In-Reply-To: <4D00EE45.9080703@braverock.com>
References: <131CF151-E5E2-4A14-8F19-353C6BE7F7E3@chyden.net>
	<4D00EE45.9080703@braverock.com>
Message-ID: <B89F0CE41D45644A97CCC93DF548C1C32857745E@GBHENXMB02.corp.amvescap.net>

 

> -----Urspr?ngliche Nachricht-----
> Von: r-sig-finance-bounces at r-project.org 
> [mailto:r-sig-finance-bounces at r-project.org] Im Auftrag von 
> Brian G. Peterson
> Gesendet: Donnerstag, 9. Dezember 2010 15:57
> An: r-sig-finance at r-project.org
> Betreff: Re: [R-SIG-Finance] Multivariate GARCH
> 
> On 12/08/2010 08:39 PM, Charles Evans wrote:
> > Currently, I am working on an analysis of ETF premiums.  I have 
> > estimated ECMs for my sample, but the error terms exhibit 
> ARCH behavior.
> >
> > Is there a more straightforward way to estimate a 
> multivariate GARCH 
> > model than mgarch or mgarchBEKK? I have searched for a usable 
> > tutorial, and I have been unable to find any other than 
> Jeff Ryan's post from 2007:
> >
> > https://stat.ethz.ch/pipermail/r-sig-finance/2007q4/001833.html
> >
> > and Ruey Tsay's transcript at:
> >
> > 
> http://faculty.chicagobooth.edu/ruey.tsay/teaching/bs41202/sp2010/fGar
> > ch.txt
> >
> >
> > Can anyone direct me to a tutorial that lays out how one 
> estimates a 
> > multivariate GARCH model in R? I'm not asking for a lesson in basic 
> > econometrics, just an R-related URL that a researcher in a 
> hurry can use.
> 
> packages:
> 
> mgarch, mgarchBekk, and ccgarch can all estimate multivariate 
> GARCH models.  To the best of my knowledge, fGarch cannot.
> 
> Regards,
> 
>    - Brian
> 

to toss in one more into the bowl of packages: gogarch

Regards,
Bernhard


> 
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.
> 
*****************************************************************
Confidentiality Note: The information contained in this ...{{dropped:10}}


From alexios at 4dscape.com  Thu Dec  9 17:05:28 2010
From: alexios at 4dscape.com (4dscape.com)
Date: Thu, 9 Dec 2010 16:05:28 +0000
Subject: [R-SIG-Finance] Multivariate GARCH
In-Reply-To: <B89F0CE41D45644A97CCC93DF548C1C32857745E@GBHENXMB02.corp.amvescap.net>
References: <131CF151-E5E2-4A14-8F19-353C6BE7F7E3@chyden.net>
	<4D00EE45.9080703@braverock.com>
	<B89F0CE41D45644A97CCC93DF548C1C32857745E@GBHENXMB02.corp.amvescap.net>
Message-ID: <2B682DBB-86B3-43D8-954F-467FEDE5A0CE@4dscape.com>

rgarch on r-forge also does DCC and GO-GARCH.
Regards,
Alexios Ghalanos

On Dec 9, 2010, at 3:16 PM, "Pfaff, Bernhard Dr." <Bernhard_Pfaff at fra.invesco.com> wrote:

> 
> 
>> -----Urspr?ngliche Nachricht-----
>> Von: r-sig-finance-bounces at r-project.org 
>> [mailto:r-sig-finance-bounces at r-project.org] Im Auftrag von 
>> Brian G. Peterson
>> Gesendet: Donnerstag, 9. Dezember 2010 15:57
>> An: r-sig-finance at r-project.org
>> Betreff: Re: [R-SIG-Finance] Multivariate GARCH
>> 
>> On 12/08/2010 08:39 PM, Charles Evans wrote:
>>> Currently, I am working on an analysis of ETF premiums.  I have 
>>> estimated ECMs for my sample, but the error terms exhibit 
>> ARCH behavior.
>>> 
>>> Is there a more straightforward way to estimate a 
>> multivariate GARCH 
>>> model than mgarch or mgarchBEKK? I have searched for a usable 
>>> tutorial, and I have been unable to find any other than 
>> Jeff Ryan's post from 2007:
>>> 
>>> https://stat.ethz.ch/pipermail/r-sig-finance/2007q4/001833.html
>>> 
>>> and Ruey Tsay's transcript at:
>>> 
>>> 
>> http://faculty.chicagobooth.edu/ruey.tsay/teaching/bs41202/sp2010/fGar
>>> ch.txt
>>> 
>>> 
>>> Can anyone direct me to a tutorial that lays out how one 
>> estimates a 
>>> multivariate GARCH model in R? I'm not asking for a lesson in basic 
>>> econometrics, just an R-related URL that a researcher in a 
>> hurry can use.
>> 
>> packages:
>> 
>> mgarch, mgarchBekk, and ccgarch can all estimate multivariate 
>> GARCH models.  To the best of my knowledge, fGarch cannot.
>> 
>> Regards,
>> 
>>  - Brian
>> 
> 
> to toss in one more into the bowl of packages: gogarch
> 
> Regards,
> Bernhard
> 
> 
>> 
>> --
>> Brian G. Peterson
>> http://braverock.com/brian/
>> Ph: 773-459-4973
>> IM: bgpbraverock
>> 
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list 
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R 
>> questions should go.
>> 
> *****************************************************************
> Confidentiality Note: The information contained in this ...{{dropped:10}}
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> 


From anass.mouhsine at gmail.com  Fri Dec 10 09:12:08 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Fri, 10 Dec 2010 09:12:08 +0100
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
Message-ID: <4D01E0D8.3090402@gmail.com>

Hi all,

I encountered a weird behaviour of merge function while using it with 
xts objects.
I have multiple xts objects (10 timeseries) that I want to merge in 
order to conduct a multivariate analysis.
Here is an example with only two timeseries

#Let us define the time series
 > t1
                                        Close
2007-01-02                  97.87
2007-01-03                  97.32
2007-01-04                  96.04
2007-01-05                  95.97
2007-01-07                  95.69
2007-01-08                  96.23
 > t2
                                        Close
2007-01-02                  94.59
2007-01-03                  94.38
2007-01-04                  92.55
2007-01-05                  92.37
2007-01-07                  92.23
2007-01-08                  92.89
 > c(class(t1),class(t2))
[1] "xts" "zoo" "xts" "zoo"

#I do the merge using merge.xts
 > t<-merge(t1,t2)
 > t
                                        Close                 Close
2007-01-02                  97.87                     NA
2007-01-02                     NA                  94.59
2007-01-03                  97.32                  94.38
2007-01-04                  96.04                  92.55
2007-01-05                  95.97                     NA
2007-01-05                     NA                  92.37
2007-01-07                  95.69                     NA
2007-01-07                     NA                  92.23
2007-01-08                  96.23                  92.89

# I don't see where the problem lays since both xts objects have the 
same index
 > index(t1)
[1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-07" 
"2007-01-08"
 > index(t2)
[1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-07" 
"2007-01-08"

# I tried using join but with no satisfying result
 >t<-merge(head(t1),head(t2),join='inner')
 > t
            CHFJPY..2007.....Close AUDJPY..2007.....Close
2007-01-03                  97.32                  94.38
2007-01-04                  96.04                  92.55
2007-01-08                  96.23                  92.89

I am really out of tricks here :-[ .

So if someone is kind enough as to point me towards the right direction, 
it would make my day.

Thx in advance,

Anass


From breman.mark at gmail.com  Fri Dec 10 10:04:42 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Fri, 10 Dec 2010 10:04:42 +0100
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
In-Reply-To: <4D01E0D8.3090402@gmail.com>
References: <4D01E0D8.3090402@gmail.com>
Message-ID: <AANLkTik64YcnA9_of7qA7K+p21X+mRnCk_jSMdg-PaTu@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101210/572608c8/attachment.pl>

From anass.mouhsine at gmail.com  Fri Dec 10 10:03:41 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Fri, 10 Dec 2010 10:03:41 +0100
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
In-Reply-To: <05C1ABBB41112A4DB61380AD45F18EB619E056230B@SWVLONCUEXDP01.im.root-domain.net>
References: <4D01E0D8.3090402@gmail.com>
	<05C1ABBB41112A4DB61380AD45F18EB619E056230B@SWVLONCUEXDP01.im.root-domain.net>
Message-ID: <4D01ECED.6030603@gmail.com>

Well Murali,
I constructed the xts data series from 1-minute-bar OHLC series using 
the to.daily function from quantmod package.
And I took the close of the daily series.

 > str(t1)
An ?xts? object from 2007-01-02 to 2007-01-08 containing:
Data: num [1:6, 1] 97.9 97.3 96 96 95.7 ...
- attr(*, "dimnames")=List of 2
..$ : NULL
..$ : chr "Close"
Indexed by objects of class: [Date] TZ: America/New_York
Original class: 'xts'
xts Attributes:
NULL
 > str(t2)
An ?xts? object from 2007-01-02 to 2007-01-08 containing:
Data: num [1:6, 1] 94.6 94.4 92.5 92.4 92.2 ...
- attr(*, "dimnames")=List of 2
..$ : NULL
..$ : chr "Close"
Indexed by objects of class: [Date] TZ: America/New_York
Original class: 'xts'
xts Attributes:
NULL

#just to be sure
 > str(index(head(t1)))
Class 'Date' num [1:6] 13515 13516 13517 13518 13520 ...
 > str(index(head(t2)))
Class 'Date' num [1:6] 13515 13516 13517 13518 13520 ...

I will prepare some files to attach for tests in a following mail.

On 10/12/2010 09:30, Murali.Menon at avivainvestors.com wrote:
> It might be that the indices of the two series are not really the same. Try doing str(t1) and str(t2) and see what the index values are. They might appear to be Dates, but are actually internally some other representation.
>
> But really you need to send a reproducible example of the variables. How did you generate t1 and t2? With the text you've sent, it's not possible to reproduce the problem.
>
> Murali
>
> -----Original Message-----
> From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Anass Mouhsine
> Sent: 10 December 2010 08:12
> To: r-sig-finance at r-project.org
> Subject: [R-SIG-Finance] [xts] merge function weird behaviour
>
> Hi all,
>
> I encountered a weird behaviour of merge function while using it with
> xts objects.
> I have multiple xts objects (10 timeseries) that I want to merge in
> order to conduct a multivariate analysis.
> Here is an example with only two timeseries
>
> #Let us define the time series
>   >  t1
>                                          Close
> 2007-01-02                  97.87
> 2007-01-03                  97.32
> 2007-01-04                  96.04
> 2007-01-05                  95.97
> 2007-01-07                  95.69
> 2007-01-08                  96.23
>   >  t2
>                                          Close
> 2007-01-02                  94.59
> 2007-01-03                  94.38
> 2007-01-04                  92.55
> 2007-01-05                  92.37
> 2007-01-07                  92.23
> 2007-01-08                  92.89
>   >  c(class(t1),class(t2))
> [1] "xts" "zoo" "xts" "zoo"
>
> #I do the merge using merge.xts
>   >  t<-merge(t1,t2)
>   >  t
>                                          Close                 Close
> 2007-01-02                  97.87                     NA
> 2007-01-02                     NA                  94.59
> 2007-01-03                  97.32                  94.38
> 2007-01-04                  96.04                  92.55
> 2007-01-05                  95.97                     NA
> 2007-01-05                     NA                  92.37
> 2007-01-07                  95.69                     NA
> 2007-01-07                     NA                  92.23
> 2007-01-08                  96.23                  92.89
>
> # I don't see where the problem lays since both xts objects have the
> same index
>   >  index(t1)
> [1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-07"
> "2007-01-08"
>   >  index(t2)
> [1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-07"
> "2007-01-08"
>
> # I tried using join but with no satisfying result
>   >t<-merge(head(t1),head(t2),join='inner')
>   >  t
>              CHFJPY..2007.....Close AUDJPY..2007.....Close
> 2007-01-03                  97.32                  94.38
> 2007-01-04                  96.04                  92.55
> 2007-01-08                  96.23                  92.89
>
> I am really out of tricks here :-[ .
>
> So if someone is kind enough as to point me towards the right direction,
> it would make my day.
>
> Thx in advance,
>
> Anass
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From anass.mouhsine at gmail.com  Fri Dec 10 10:19:59 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Fri, 10 Dec 2010 10:19:59 +0100
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
In-Reply-To: <AANLkTik64YcnA9_of7qA7K+p21X+mRnCk_jSMdg-PaTu@mail.gmail.com>
References: <4D01E0D8.3090402@gmail.com>
	<AANLkTik64YcnA9_of7qA7K+p21X+mRnCk_jSMdg-PaTu@mail.gmail.com>
Message-ID: <4D01F0BF.9060207@gmail.com>

Here,

you will find attached data used to illustrate the issue.
here is the code used as well

#reading file
t1=read.csv("AUDJPY.csv", sep=";")
rownames(t1)<-t1[,"Index"];t1<-t1[,-1]
#constructing xts object
t1<-as.xts(t1,tzone="America/New_York", src="csv", updated=Sys.time())

t2=read.csv("CHFJPY.csv", sep=";")
rownames(t2)<-t2[,"Index"];t2<-t2[,-1]
t2<-as.xts(t2,tzone="America/New_York", src="csv", updated=Sys.time())

# requires quantmod
library(quantmod)

#constructing daily close series
t1<-Cl(to.daily(t1))
t2<-Cl(to.daily(t2))

#trying to merge
merge(t1,t2)

#......and result....sadly...is
 > merge(t1,t2)
            t1.Close t2.Close
2007-01-02          NA       97.87
2007-01-02       94.59          NA
2007-01-03       94.38       97.32
2007-01-04       92.55       96.04
2007-01-05          NA       95.97
2007-01-05       92.37          NA
2007-01-07          NA       95.69
2007-01-07       92.23          NA
2007-01-08       92.89       96.23



On 10/12/2010 10:04, Mark Breman wrote:
> Hi Anass,
>
> Could it be the series have a (invisible) different time part, or the 
> timezone is different.
>
> Regards,
>
> -Mark-
>
> 2010/12/10 Anass Mouhsine <anass.mouhsine at gmail.com 
> <mailto:anass.mouhsine at gmail.com>>
>
>     Hi all,
>
>     I encountered a weird behaviour of merge function while using it
>     with xts objects.
>     I have multiple xts objects (10 timeseries) that I want to merge
>     in order to conduct a multivariate analysis.
>     Here is an example with only two timeseries
>
>     #Let us define the time series
>     > t1
>                                           Close
>     2007-01-02                  97.87
>     2007-01-03                  97.32
>     2007-01-04                  96.04
>     2007-01-05                  95.97
>     2007-01-07                  95.69
>     2007-01-08                  96.23
>     > t2
>                                           Close
>     2007-01-02                  94.59
>     2007-01-03                  94.38
>     2007-01-04                  92.55
>     2007-01-05                  92.37
>     2007-01-07                  92.23
>     2007-01-08                  92.89
>     > c(class(t1),class(t2))
>     [1] "xts" "zoo" "xts" "zoo"
>
>     #I do the merge using merge.xts
>     > t<-merge(t1,t2)
>     > t
>                                           Close                 Close
>     2007-01-02                  97.87                     NA
>     2007-01-02                     NA                  94.59
>     2007-01-03                  97.32                  94.38
>     2007-01-04                  96.04                  92.55
>     2007-01-05                  95.97                     NA
>     2007-01-05                     NA                  92.37
>     2007-01-07                  95.69                     NA
>     2007-01-07                     NA                  92.23
>     2007-01-08                  96.23                  92.89
>
>     # I don't see where the problem lays since both xts objects have
>     the same index
>     > index(t1)
>     [1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05"
>     "2007-01-07" "2007-01-08"
>     > index(t2)
>     [1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05"
>     "2007-01-07" "2007-01-08"
>
>     # I tried using join but with no satisfying result
>     >t<-merge(head(t1),head(t2),join='inner')
>     > t
>               CHFJPY..2007.....Close AUDJPY..2007.....Close
>     2007-01-03                  97.32                  94.38
>     2007-01-04                  96.04                  92.55
>     2007-01-08                  96.23                  92.89
>
>     I am really out of tricks here :-[ .
>
>     So if someone is kind enough as to point me towards the right
>     direction, it would make my day.
>
>     Thx in advance,
>
>     Anass
>
>     _______________________________________________
>     R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101210/9fd045e6/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: AUDJPY.csv
Type: application/vnd.ms-excel
Size: 149313 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101210/9fd045e6/attachment.xlb>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CHFJPY.csv
Type: application/vnd.ms-excel
Size: 145700 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101210/9fd045e6/attachment-0001.xlb>

From rbali at ufmg.br  Fri Dec 10 11:46:48 2010
From: rbali at ufmg.br (Robert Iquiapaza)
Date: Fri, 10 Dec 2010 08:46:48 -0200
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
In-Reply-To: <4D01F0BF.9060207@gmail.com>
References: <4D01E0D8.3090402@gmail.com><AANLkTik64YcnA9_of7qA7K+p21X+mRnCk_jSMdg-PaTu@mail.gmail.com>
	<4D01F0BF.9060207@gmail.com>
Message-ID: <AA597A6686254B458DFFCBE5BAE2E72B@DellPC>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101210/894b380d/attachment.pl>

From santosh.srinivas at gmail.com  Fri Dec 10 11:51:26 2010
From: santosh.srinivas at gmail.com (Santosh Srinivas)
Date: Fri, 10 Dec 2010 16:21:26 +0530
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
In-Reply-To: <4D01F0BF.9060207@gmail.com>
References: <4D01E0D8.3090402@gmail.com>	<AANLkTik64YcnA9_of7qA7K+p21X+mRnCk_jSMdg-PaTu@mail.gmail.com>
	<4D01F0BF.9060207@gmail.com>
Message-ID: <4d020633.0d768e0a.7f24.ffffcea8@mx.google.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101210/8bf5a07a/attachment.pl>

From anass.mouhsine at gmail.com  Fri Dec 10 12:00:46 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Fri, 10 Dec 2010 12:00:46 +0100
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
In-Reply-To: <4d020633.0d768e0a.7f24.ffffcea8@mx.google.com>
References: <4D01E0D8.3090402@gmail.com>	<AANLkTik64YcnA9_of7qA7K+p21X+mRnCk_jSMdg-PaTu@mail.gmail.com>
	<4D01F0BF.9060207@gmail.com>
	<4d020633.0d768e0a.7f24.ffffcea8@mx.google.com>
Message-ID: <4D02085E.8000600@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101210/68c3e371/attachment.pl>

From akrabolsa at gmail.com  Fri Dec 10 12:23:47 2010
From: akrabolsa at gmail.com (=?iso-8859-1?Q?Saul_Sala_Pe=F1alver?=)
Date: Fri, 10 Dec 2010 12:23:47 +0100
Subject: [R-SIG-Finance] Help with Futures in IBrokers
In-Reply-To: <AANLkTimaOUyZWe3MCQL882qJDovHSGw-nKM4-o-CzjBk@mail.gmail.com>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
	<AANLkTimaOUyZWe3MCQL882qJDovHSGw-nKM4-o-CzjBk@mail.gmail.com>
Message-ID: <38940673-B8AD-4ED9-B53F-58EFB0C9C5D9@gmail.com>

Hi everyone,

I am starting to use Ibrokers with R but I keep receiving an error message when trying to get Futures Data that I have real-timein Ibrokers:

reqMktData(tws,twsFUT("ESTX50","DTB","201103"))
TWS Message: 2 1 200 No secutiry definition has been found for the request

and R keep working and I have to force closing since it doesn't respond

Thank you,

From jeff.a.ryan at gmail.com  Fri Dec 10 14:27:19 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 10 Dec 2010 07:27:19 -0600
Subject: [R-SIG-Finance] [xts] merge function weird behaviour
In-Reply-To: <4D02085E.8000600@gmail.com>
References: <4D01E0D8.3090402@gmail.com>
	<AANLkTik64YcnA9_of7qA7K+p21X+mRnCk_jSMdg-PaTu@mail.gmail.com>
	<4D01F0BF.9060207@gmail.com>
	<4d020633.0d768e0a.7f24.ffffcea8@mx.google.com>
	<4D02085E.8000600@gmail.com>
Message-ID: <AANLkTimg-6SDxqhak9rMiJUimr8B=sBeo6RJa38JQ=va@mail.gmail.com>

Anass,

You're issue is indeed that the times aren't originally aligned, so
to.daily is just aligning to the end of the day as it sees it.

The simple solution is to re-index your data with "Date" times - since
that is really the end result of your to.daily processing expectation
(though not always what one would want, hence the additional step)

index(t1) <- as.Date(index(t1))
index(t2) <- as.Date(index(t2))

merge(t1,t2)
           t1.Close t2.Close
2007-01-03    94.59    97.87
2007-01-04    94.38    97.32
2007-01-05    92.55    96.04
2007-01-05    92.37    95.97
2007-01-08    92.23    95.69
2007-01-09    92.89    96.23

to.period could probably automatically alter your index if days or
lower frequency is selected (e.g. period="days" or to.daily/monthly
etc is called), though I'll have to think about the full implication
of this (i.e. automagically or optionally).

Best,
Jeff


On Fri, Dec 10, 2010 at 5:00 AM, Anass Mouhsine
<anass.mouhsine at gmail.com> wrote:
> Thks all,
>
> Robert,
> My packages are updated. I'll update my R version to be sure.
>
> Santosh,
> I'll try your methodology as well.
>
> On 10/12/2010 11:51, Santosh Srinivas wrote:
>>
>> Hi ?Anass,
>>
>> I like zoo more so here is what you need I think.
>>
>> require(zoo)
>>
>> f2 <- function(d, t, format = "%Y-%m-%d %H:%M:%S") {
>>
>> as.POSIXct(strptime(paste(d, t),format=format))
>>
>> }
>>
>> t1=read.csv("AUDJPY.csv", sep=";")
>>
>> t1.z <- read.zoo(t1, index=list(1,2), FUN =f2)
>>
>> t2=read.csv("CHFJPY.csv", sep=";")
>>
>> t2.z <- read.zoo(t2, index=list(1,2), FUN =f2)
>>
>> head(t1.z)
>>
>> head(t2.z)
>>
>> t1.z.cl <- Cl(x=to.daily(t1.z$Close))
>>
>> t2.z.cl <- Cl(x=to.daily(t2.z$Close))
>>
>> t1.z.cl <- t1.z.cl[,4]
>>
>> t2.z.cl <- t2.z.cl[,4]
>>
>> head(t1.z.cl)
>>
>> head(t2.z.cl)
>>
>> t3 <- merge.zoo(t1.z.cl,t2.z.cl)
>>
>> head(t3)
>>
>> (there should ?be something similar for xts)
>>
>> HTH.
>>
>> *From:*r-sig-finance-bounces at r-project.org
>> [mailto:r-sig-finance-bounces at r-project.org] *On Behalf Of *Anass Mouhsine
>> *Sent:* 10 December 2010 14:50
>> *To:* Mark Breman; r-sig-finance at r-project.org
>> *Subject:* Re: [R-SIG-Finance] [xts] merge function weird behaviour
>>
>> Here,
>>
>> you will find attached data used to illustrate the issue.
>> here is the code used as well
>>
>> #reading file
>> t1=read.csv("AUDJPY.csv", sep=";")
>> rownames(t1)<-t1[,"Index"];t1<-t1[,-1]
>> #constructing xts object
>> t1<-as.xts(t1,tzone="America/New_York", src="csv", updated=Sys.time())
>>
>> t2=read.csv("CHFJPY.csv", sep=";")
>> rownames(t2)<-t2[,"Index"];t2<-t2[,-1]
>> t2<-as.xts(t2,tzone="America/New_York", src="csv", updated=Sys.time())
>>
>> # requires quantmod
>> library(quantmod)
>>
>> #constructing daily close series
>> t1<-Cl(to.daily(t1))
>> t2<-Cl(to.daily(t2))
>>
>> #trying to merge
>> merge(t1,t2)
>>
>> #......and result....sadly...is
>> > merge(t1,t2)
>> ? ? ? ? ? ?t1.Close t2.Close
>> 2007-01-02 ? ? ? ? ?NA ? ? ? 97.87
>> 2007-01-02 ? ? ? 94.59 ? ? ? ? ?NA
>> 2007-01-03 ? ? ? 94.38 ? ? ? 97.32
>> 2007-01-04 ? ? ? 92.55 ? ? ? 96.04
>> 2007-01-05 ? ? ? ? ?NA ? ? ? 95.97
>> 2007-01-05 ? ? ? 92.37 ? ? ? ? ?NA
>> 2007-01-07 ? ? ? ? ?NA ? ? ? 95.69
>> 2007-01-07 ? ? ? 92.23 ? ? ? ? ?NA
>> 2007-01-08 ? ? ? 92.89 ? ? ? 96.23
>>
>>
>>
>> On 10/12/2010 10:04, Mark Breman wrote:
>>
>> Hi Anass,
>>
>> Could it be the series have a (invisible) different time part, or the
>> timezone is different.
>>
>> Regards,
>>
>> -Mark-
>>
>> 2010/12/10 Anass Mouhsine <anass.mouhsine at gmail.com
>> <mailto:anass.mouhsine at gmail.com>>
>>
>> Hi all,
>>
>> I encountered a weird behaviour of merge function while using it with
>> xts objects.
>> I have multiple xts objects (10 timeseries) that I want to merge in
>> order to conduct a multivariate analysis.
>> Here is an example with only two timeseries
>>
>> #Let us define the time series
>> > t1
>> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? Close
>> 2007-01-02 ? ? ? ? ? ? ? ? ?97.87
>> 2007-01-03 ? ? ? ? ? ? ? ? ?97.32
>> 2007-01-04 ? ? ? ? ? ? ? ? ?96.04
>> 2007-01-05 ? ? ? ? ? ? ? ? ?95.97
>> 2007-01-07 ? ? ? ? ? ? ? ? ?95.69
>> 2007-01-08 ? ? ? ? ? ? ? ? ?96.23
>> > t2
>> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? Close
>> 2007-01-02 ? ? ? ? ? ? ? ? ?94.59
>> 2007-01-03 ? ? ? ? ? ? ? ? ?94.38
>> 2007-01-04 ? ? ? ? ? ? ? ? ?92.55
>> 2007-01-05 ? ? ? ? ? ? ? ? ?92.37
>> 2007-01-07 ? ? ? ? ? ? ? ? ?92.23
>> 2007-01-08 ? ? ? ? ? ? ? ? ?92.89
>> > c(class(t1),class(t2))
>> [1] "xts" "zoo" "xts" "zoo"
>>
>> #I do the merge using merge.xts
>> > t<-merge(t1,t2)
>> > t
>> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? Close ? ? ? ? ? ? ? ? Close
>> 2007-01-02 ? ? ? ? ? ? ? ? ?97.87 ? ? ? ? ? ? ? ? ? ? NA
>> 2007-01-02 ? ? ? ? ? ? ? ? ? ? NA ? ? ? ? ? ? ? ? ?94.59
>> 2007-01-03 ? ? ? ? ? ? ? ? ?97.32 ? ? ? ? ? ? ? ? ?94.38
>> 2007-01-04 ? ? ? ? ? ? ? ? ?96.04 ? ? ? ? ? ? ? ? ?92.55
>> 2007-01-05 ? ? ? ? ? ? ? ? ?95.97 ? ? ? ? ? ? ? ? ? ? NA
>> 2007-01-05 ? ? ? ? ? ? ? ? ? ? NA ? ? ? ? ? ? ? ? ?92.37
>> 2007-01-07 ? ? ? ? ? ? ? ? ?95.69 ? ? ? ? ? ? ? ? ? ? NA
>> 2007-01-07 ? ? ? ? ? ? ? ? ? ? NA ? ? ? ? ? ? ? ? ?92.23
>> 2007-01-08 ? ? ? ? ? ? ? ? ?96.23 ? ? ? ? ? ? ? ? ?92.89
>>
>> # I don't see where the problem lays since both xts objects have the
>> same index
>> > index(t1)
>> [1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-07"
>> "2007-01-08"
>> > index(t2)
>> [1] "2007-01-02" "2007-01-03" "2007-01-04" "2007-01-05" "2007-01-07"
>> "2007-01-08"
>>
>> # I tried using join but with no satisfying result
>> >t<-merge(head(t1),head(t2),join='inner')
>> > t
>> ? ? ? ? ? CHFJPY..2007.....Close AUDJPY..2007.....Close
>> 2007-01-03 ? ? ? ? ? ? ? ? ?97.32 ? ? ? ? ? ? ? ? ?94.38
>> 2007-01-04 ? ? ? ? ? ? ? ? ?96.04 ? ? ? ? ? ? ? ? ?92.55
>> 2007-01-08 ? ? ? ? ? ? ? ? ?96.23 ? ? ? ? ? ? ? ? ?92.89
>>
>> I am really out of tricks here :-[ .
>>
>> So if someone is kind enough as to point me towards the right
>> direction, it would make my day.
>>
>> Thx in advance,
>>
>> Anass
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>> mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R
>> questions should go.
>>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From jeff.a.ryan at gmail.com  Fri Dec 10 14:36:25 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 10 Dec 2010 07:36:25 -0600
Subject: [R-SIG-Finance] Help with Futures in IBrokers
In-Reply-To: <38940673-B8AD-4ED9-B53F-58EFB0C9C5D9@gmail.com>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
	<AANLkTimaOUyZWe3MCQL882qJDovHSGw-nKM4-o-CzjBk@mail.gmail.com>
	<38940673-B8AD-4ED9-B53F-58EFB0C9C5D9@gmail.com>
Message-ID: <AANLkTinNhL0Hq32fduo4hd7_8GrpV1C7f0vq04TDwaKX@mail.gmail.com>

Saul,

reqMktData is an infinite loop awaiting incoming data, so forcing it
close is the expected and only result of calling it typically.

You'll need to be able to handle errors/warning in your code generally
-- as there are potentially hundreds of different ones, all warnings
from the TWS that may or may not matter to your system.

In effect, your issue is that the contract you are requesting is
misspecified in some way.  I am not at my desk, but in general you'lll
need to try:

reqContractDetails to understand the correct specification. I suspect
you are missing the correct "currency" arg in the twsFUT call, as it
defaults to USD.  As I alluded to in an earlier reply to another
posted, I'll likely change this to a global option or provide
something like a lookup based on exchange...  of course reading the
docs (IBrokers and IBs) is the first step in figuring out what is
wrong.

Best,
Jeff

On Fri, Dec 10, 2010 at 5:23 AM, Saul Sala Pe?alver <akrabolsa at gmail.com> wrote:
> Hi everyone,
>
> I am starting to use Ibrokers with R but I keep receiving an error message when trying to get Futures Data that I have real-timein Ibrokers:
>
> reqMktData(tws,twsFUT("ESTX50","DTB","201103"))
> TWS Message: 2 1 200 No secutiry definition has been found for the request
>
> and R keep working and I have to force closing since it doesn't respond
>
> Thank you,
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From jeff.a.ryan at gmail.com  Fri Dec 10 14:44:07 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Fri, 10 Dec 2010 07:44:07 -0600
Subject: [R-SIG-Finance] Help with Futures in IBrokers
In-Reply-To: <AANLkTinNhL0Hq32fduo4hd7_8GrpV1C7f0vq04TDwaKX@mail.gmail.com>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>
	<AANLkTimaOUyZWe3MCQL882qJDovHSGw-nKM4-o-CzjBk@mail.gmail.com>
	<38940673-B8AD-4ED9-B53F-58EFB0C9C5D9@gmail.com>
	<AANLkTinNhL0Hq32fduo4hd7_8GrpV1C7f0vq04TDwaKX@mail.gmail.com>
Message-ID: <AANLkTikz8NpQh4Y8hOEkP4ONB2XnZntC-hJyYXpHbAzs@mail.gmail.com>

As expected, trying currency="EUR"

> reqContractDetails(tws, twsFUT("ESTX50","DTB","201103", currency="EUR"))
[[1]]
List of 18
 $ version       : chr "6"
 $ contract      :List of 16
  ..$ conId          : chr "76324422"
  ..$ symbol         : chr "ESTX50"
  ..$ sectype        : chr "FUT"
  ..$ exch           : chr "DTB"
  ..$ primary        : chr ""
  ..$ expiry         : chr "20110318"
  ..$ strike         : chr "0"
  ..$ currency       : chr "EUR"
  ..$ right          : chr ""
  ..$ local          : chr "FESX MAR 11"
  ..$ multiplier     : chr "10"
  ..$ combo_legs_desc: chr ""
  ..$ comboleg       : chr ""
  ..$ include_expired: chr ""
  ..$ secIdType      : chr ""
  ..$ secId          : chr ""
  ..- attr(*, "class")= chr "twsContract"
 $ marketName    : chr "FESX"
 $ tradingClass  : chr "FESX"
 $ conId         : chr "76324422"
 $ minTick       : chr "1.0"
 $ orderTypes    : chr [1:34] "ACTIVETIM" "ADJUST" "ALERT" "ALLOC" ...
 $ validExchanges: chr [1:2] "DTB" "MIBSX"
 $ priceMagnifier: chr "1"
 $ underConId    : chr "4356500"
 $ longName      : chr "Dow Jones Euro STOXX50"
 $ contractMonth : chr "201103"
 $ industry      : chr ""
 $ category      : chr ""
 $ subcategory   : chr ""
 $ timeZoneId    : chr "MET"
 $ tradingHours  : chr "20101210:0750-2203;20101213:0750-2203"
 $ liquidHours   : chr "20101210:0750-2203;20101213:0750-2203"

HTH
Jeff

On Fri, Dec 10, 2010 at 7:36 AM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
> Saul,
>
> reqMktData is an infinite loop awaiting incoming data, so forcing it
> close is the expected and only result of calling it typically.
>
> You'll need to be able to handle errors/warning in your code generally
> -- as there are potentially hundreds of different ones, all warnings
> from the TWS that may or may not matter to your system.
>
> In effect, your issue is that the contract you are requesting is
> misspecified in some way. ?I am not at my desk, but in general you'lll
> need to try:
>
> reqContractDetails to understand the correct specification. I suspect
> you are missing the correct "currency" arg in the twsFUT call, as it
> defaults to USD. ?As I alluded to in an earlier reply to another
> posted, I'll likely change this to a global option or provide
> something like a lookup based on exchange... ?of course reading the
> docs (IBrokers and IBs) is the first step in figuring out what is
> wrong.
>
> Best,
> Jeff
>
> On Fri, Dec 10, 2010 at 5:23 AM, Saul Sala Pe?alver <akrabolsa at gmail.com> wrote:
>> Hi everyone,
>>
>> I am starting to use Ibrokers with R but I keep receiving an error message when trying to get Futures Data that I have real-timein Ibrokers:
>>
>> reqMktData(tws,twsFUT("ESTX50","DTB","201103"))
>> TWS Message: 2 1 200 No secutiry definition has been found for the request
>>
>> and R keep working and I have to force closing since it doesn't respond
>>
>> Thank you,
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From stephen at organicfoodmarkets.com.au  Fri Dec 10 19:18:26 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Sat, 11 Dec 2010 05:18:26 +1100
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFFF34A.6060402@organicfoodmarkets.com.au>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>	<AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>	<4CFDD321.4020408@organicfoodmarkets.com.au>	<4CFE8769.2050307@organicfoodmarkets.com.au>	<AANLkTikOJsP6dzOJ4qKfJVxEH0xgn7-1_BTudCjZtt3v@mail.gmail.com>
	<4CFFF34A.6060402@organicfoodmarkets.com.au>
Message-ID: <4D026EF2.1070103@organicfoodmarkets.com.au>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101211/b17a6976/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 16091 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101211/b17a6976/attachment.jpe>

From stephen at organicfoodmarkets.com.au  Fri Dec 10 20:10:08 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Sat, 11 Dec 2010 06:10:08 +1100
Subject: [R-SIG-Finance] IBrokers
In-Reply-To: <4CFFF34A.6060402@organicfoodmarkets.com.au>
References: <4CFBE6A5.6070305@organicfoodmarkets.com.au>	<AANLkTikuD7YnhXgpiiXkUVy7YiPRiy5a2w81k=uH4MYR@mail.gmail.com>	<4CFDD321.4020408@organicfoodmarkets.com.au>	<4CFE8769.2050307@organicfoodmarkets.com.au>	<AANLkTikOJsP6dzOJ4qKfJVxEH0xgn7-1_BTudCjZtt3v@mail.gmail.com>
	<4CFFF34A.6060402@organicfoodmarkets.com.au>
Message-ID: <4D027B10.8000904@organicfoodmarkets.com.au>

ok, I did get this to work:

AskPriceMSFT <- as.numeric(eWrapper$.Data$data[[1]][,3])
BidPriceAAPL <- as.numeric(eWrapper$.Data$data[[2]][,2])

which produced  "BidPriceAAPL: " "320.84"         "AskPriceMSFT: " "27.34"

I also also do this:

AskPriceMSFT <- as.numeric(eWrapper$.Data$data[['MSFT']][,3])

if I do this earlier in the code

names(eWrapper$.Data$data) <- eWrapper$.Data$symbols

No doubt I'll be back but thanks everyone


Stephen

Hi Jeff

Sorry to put this up again, but I am completely stuck.

How do I reference the second data object

BidPrice2 <- as.numeric(eWrapper$.Data$data[[2]][,5])  doesn't work.

Stephen Choularton Ph.D., FIoD

On 09/12/2010 8:06 AM, Stephen Choularton wrote:
> Hi Jeff
>
> Thanks, but when I try to reference the second data object using this 
> (which is all I can think of):
>
> BidPrice2 <- as.numeric(eWrapper$.Data$data[[2]][,5])
>
> The code runs but I don't get any info. eWrapper$.Data$data[[2]][,5] 
> appears to exist but to be empty.  Do I have to do something to place 
> the data into it?
>
> Plus does curMsg <- readBin(con, character(), 1) give me the ticker id?
>
>
>
> Stephen Choularton Ph.D., FIoD
> On 09/12/2010 4:07 AM, Jeff Ryan wrote:
>> Stephen,
>>
>> You're close.
>>
>> On Tue, Dec 7, 2010 at 1:13 PM, Stephen Choularton
>> <stephen at organicfoodmarkets.com.au>  wrote:
>>> So back again!
>>>
>>> I have two problem in converting my callback to two handle two 
>>> symbols so I
>>> can set up spreads.  (Or at least that's what I can see it at the 
>>> moment):
>>>
>>> When I run this using myCALLBACK function below:
>>>
>>> con = twsConnect()
>>>
>>> reqMktData(con, list(twsSTK("MSFT"),twsSTK("AAPL")),
>>>   event=eWrapper.data(1), CALLBACK=myCALLBACK)
>> The eWrapper needs to be set up to handle the number of contracts you
>> are watching.  You need: eWrapper.data(2), with 2 being the length of
>> the contracts you are watching.
>>
>> The ticker id is by default mapped to the order of the Contracts you
>> pass in. So MSFT is 1, AAPL is 2 ...
>>
>> HTH,
>> Jeff
>>> I get this
>>>
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      NA            
>>> "LastSize : "
>>> NA
>>> [13] "Volume: "    NA
>>> 2 -1 2104 Market data farm connection is OK:aufarm
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      NA            
>>> "LastSize : "
>>> NA
>>> [13] "Volume: "    NA
>>> 2 -1 2104 Market data farm connection is OK:usfarm
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      NA            
>>> "LastSize : "
>>> NA
>>> [13] "Volume: "    NA
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      NA            
>>> "LastSize : "
>>> NA
>>> [13] "Volume: "    NA
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      NA            
>>> "LastSize : "
>>> NA
>>> [13] "Volume: "    NA
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> NA
>>> [13] "Volume: "    NA
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    NA
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   NA            "BidPrice: "  NA            
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   NA
>>>   [7] "AskSize: "   NA            "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "4"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343529"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "1435"        "BidPrice: "  "26.96"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.97"
>>>   [7] "AskSize: "   "828"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>>   [1] "BidSize: "   "970"         "BidPrice: "  "26.97"       
>>> "AskPrice: "
>>>   "26.98"
>>>   [7] "AskSize: "   "847"         "Last: "      "26.97"       
>>> "LastSize : "
>>> "2"
>>> [13] "Volume: "    "343550"
>>> Error in `*tmp*`[[id]] : subscript out of bounds
>>>
>>>
>>> I think what is happening is that the function fails on its first 
>>> attempt to
>>> get data on AAPT and the above data is on MSFT but I am quite unsure 
>>> as to
>>> what direction to take to amend the function.  Any pointers most 
>>> welcome.
>>>
>>> Secondly I need to be able to know which symbol I am dealing with.  The
>>> output for:
>>>
>>> reqMktData(con, list(twsEquity("MSFT"),twsEquity("AAPL")))
>>>
>>> is
>>>
>>> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
>>> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
>>> <20101208 05:55:28.974000>  id=1 symbol=MSFT Volume: 343560
>>> <20101208 05:55:28.978000>  id=1 symbol=MSFT highPrice: 27.09
>>> <20101208 05:55:28.983000>  id=1 symbol=MSFT lowPrice: 26.88
>>> <20101208 05:55:28.988000>  id=2 symbol=AAPL Volume: 79079
>>> <20101208 05:55:28.993000>  id=2 symbol=AAPL highPrice: 323.99
>>>
>>> and shows the symbol I need but when I try to find something that 
>>> refers to
>>> it in myCALLBACK I seem to fail.  Is it somewhere in the data 
>>> object?  Is it
>>> somewhere esle someone can point me to?
>>>
>>> Stephen Choularton Ph.D., FIoD
>>>
>>>
>>> On 07/12/2010 5:24 PM, Stephen Choularton wrote:
>>>> Just for the record I though I should post this as it did actually 
>>>> place
>>>> the order I was after:
>>>>
>>>> library(IBrokers)
>>>>
>>>> myCALLBACK<-
>>>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>>>
>>>>     con<- twsCon[[1]]
>>>>     traded<- FALSE
>>>>     while (TRUE) {
>>>>         socketSelect(list(con), FALSE, NULL)
>>>>         #data
>>>>     curMsg<- readBin(con, character(), 1)
>>>>     if (!is.null(timestamp)) {
>>>>         processMsg(curMsg, con, eWrapper, format(Sys.time(), 
>>>> timestamp),
>>>> file, ...)
>>>>     } else {
>>>>         processMsg(curMsg, con, eWrapper, timestamp, file, ...)
>>>>     }
>>>>     # EXTRACT DATA HERE
>>>>     BidSize<- as.numeric(eWrapper$.Data$data[[1]][,1])
>>>>     BidPrice<- as.numeric(eWrapper$.Data$data[[1]][,2])
>>>>     AskPrice<- as.numeric(eWrapper$.Data$data[[1]][,3])
>>>>     AskSize<-  as.numeric(eWrapper$.Data$data[[1]][,4])
>>>>     Last<- as.numeric(eWrapper$.Data$data[[1]][,5])
>>>>     LastSize<- as.numeric(eWrapper$.Data$data[[1]][,6])
>>>>         Volume<- as.numeric(eWrapper$.Data$data[[1]][,7])
>>>>     print(c("BidSize: ", BidSize, "BidPrice: ", BidPrice, 
>>>> "AskPrice: ",
>>>> AskPrice, "AskSize: ", AskSize, "Last: ", Last, "LastSize : ", 
>>>> LastSize ,
>>>> "Volume: ", Volume ))
>>>>     # TRADE LOGIC HERE
>>>>     if(!traded&&  !is.na(Last)&&  Last>= 49) {
>>>>
>>>>         print(c("inside the trading logic "))
>>>>         id<- reqIds(twsCon)
>>>>         #placeOrder(tws, twsEquity("CBA","ASX","AUD"), twsOrder(id, 
>>>> "BUY",
>>>> "1", "MKT"))
>>>>         traded<- TRUE
>>>>     }
>>>>     }
>>>> }
>>>>
>>>>
>>>>
>>>> con = twsConnect()
>>>>
>>>>
>>>>
>>>> #reqMktData(con, twsEquity("GOOG"), event=eWrapper.data(1),
>>>> CALLBACK=myCALLBACK)
>>>>
>>>>
>>>> reqMktData(con, twsEquity("CBA","ASX","AUD"),  event=eWrapper.data(1),
>>>> CALLBACK=myCALLBACK)
>>>>
>>>>
>>>>
>>>> closeAllConnections()
>>>>
>>>>
>>>> I imagine I will be back as I am actually trying to use this for 
>>>> spreads -
>>>> so now I have to move on and try two symbols, etc but for what it 
>>>> is worth
>>>> the code is there for anyone who wants to use it.
>>>>
>>>> Stephen Choularton Ph.D., FIoD
>>>>
>>>>
>>>> On 06/12/2010 10:17 AM, Jeff Ryan wrote:
>>>>> Stephen,
>>>>>
>>>>> Comments inline:
>>>>>
>>>>> On Sun, Dec 5, 2010 at 1:23 PM, Stephen Choularton
>>>>> <stephen at organicfoodmarkets.com.au>    wrote:
>>>>>> Hi
>>>>>>
>>>>>> If you read this list you will have noticed I have been working on
>>>>>> callbacks
>>>>>> and I finally got to some code that appears to work so I though I 
>>>>>> would
>>>>>> share it:
>>>>>>
>>>>>> library(IBrokers)
>>>>>>
>>>>>> myCALLBACK<-
>>>>>> function(twsCon, eWrapper, timestamp, file, playback = 1, ...) {
>>>>>>     con<- twsCon[[1]]
>>>>>>     twsOC<- twsConnect(2) # our order connection
>>>>>>     con2<- twsOC[[1]]
>>>>>>     ocWrapper<- eWrapper(TRUE)
>>>>>>     traded<- FALSE
>>>>>>     while (TRUE) {
>>>>>>         cons<- socketSelect(list(con, con2), FALSE, 0.01)
>>>>>>         if(cons[1]) { #data
>>>>>>             curMsg<- readBin(con, character(), 1)
>>>>>>             if (!is.null(timestamp)) {
>>>>>>                 processMsg(curMsg, con, eWrapper, format(Sys.time(),
>>>>>> timestamp), file, ...)
>>>>>>             } else {
>>>>>>                 processMsg(curMsg, con, eWrapper, timestamp, 
>>>>>> file, ...)
>>>>>>             }
>>>>>>         } else if(cons[2]) {
>>>>>>             curMsg<- readBin(con2, character(), 1)
>>>>>>             if (!is.null(timestamp)) {
>>>>>>                 processMsg(curMsg, con2, ocWrapper, 
>>>>>> format(Sys.time(),
>>>>>> timestamp), file, ...)
>>>>>>             } else {
>>>>>>                 processMsg(curMsg, con2, ocWrapper, timestamp, 
>>>>>> file, ...)
>>>>>>             }
>>>>>>         } # TRADE LOGIC HERE
>>>>>>         curBID<- as.numeric(eWrapper$.Data$data[[1]][3])
>>>>>>         if(!traded  ) { # add back on open:&&    
>>>>>> !is.na(curBID)&&    curBID>
>>>>>> 141.00
>>>>>>
>>>>>>             print(c("the cur bid is ", curBID))
>>>>>>             # IBrokers:::.placeOrder(twsOC, 
>>>>>> twsEquity("CBA","ASX","AUD"),
>>>>>> twsOrder(1053, "BUY", "0", "MKT"))
>>>>>>             traded<- TRUE
>>>>>>         }
>>>>>>     }
>>>>>>     twsDisconnect(twsOC)
>>>>>> }
>>>>>>
>>>>>> con = twsConnect(1)
>>>>>>
>>>>>> # contracts<-  list(twsSTK("MSFT"),twsSTK("AAPL")))
>>>>>>
>>>>>>
>>>>>> reqMktData(con, twsEquity("GOOG"), CALLBACK=myCALLBACK)
>>>>>>
>>>>>> twsDisconnect(con)
>>>>>>
>>>>>> However, even though I have tried to close down my twsCnnections, 
>>>>>> if I
>>>>>> run
>>>>>> the code twice I get a warning along the lines:
>>>>>>
>>>>>> unable to connect. client id already in use. retry with unique 
>>>>>> client id
>>>>>>
>>>>>> and R freezes.  Does anyone know how to solve the problem?
>>>>> R is likely "freezing" due to buffering on Windows (which you can 
>>>>> turn
>>>>> off in the GUI), but that isn't really the core issue.  You don't 
>>>>> need
>>>>> to have a second connection opened in the CALLBACK.  It is in the
>>>>> examples of one of my talks to illustrate having an external mkt data
>>>>> feed and IB execution.  If you are only looking at IB (for data and
>>>>> execution), DON'T use a second connection.  Seriously it is not 
>>>>> needed
>>>>> at all, and it is just making things more confusing I suspect.
>>>>>
>>>>>>  From there (on connection) close(con) or twsDisconnect(con) should
>>>>> indeed free up the client id. You can always go the route of
>>>>> closeAllConnections() route in R to 'start over'.
>>>>>
>>>>>> Incidentally I notice that the code gets  curBID<-
>>>>>> as.numeric(eWrapper$.Data$data[[1]][3]).  Does anyone know what the
>>>>>> appropriate indices are for the other data in eWrapper$.Data and 
>>>>>> what
>>>>>> that
>>>>>> data is?
>>>>>>
>>>>> As Mark points out in his reply, look at the source for the
>>>>> answers/hints:
>>>>>
>>>>> In order:  BidSize, BidPrice, AskPrice, AskSize, Last, LastSize and
>>>>> Volume.  The first four ordering mimic what it looks like when you
>>>>> stand in the pit on the floor and look at the CRTs (or your own 
>>>>> custom
>>>>> screen...) ;-)
>>>>>
>>>>>
>>>>> # from the source
>>>>>> eWrapper.data
>>>>> function (n)
>>>>> {
>>>>>      eW<- eWrapper(NULL)
>>>>>      eW$assign.Data("data", 
>>>>> rep(list(structure(.xts(matrix(rep(NA_real_,
>>>>>          7), nc = 7), 0), .Dimnames = list(NULL, c("BidSize",
>>>>>          "BidPrice", "AskPrice", "AskSize", "Last", "LastSize",
>>>>>          "Volume")))), n))
>>>>>      eW$tickPrice<- function(curMsg, msg, timestamp, file, ...) {
>>>>>          tickType = msg[3]
>>>>>          msg<- as.numeric(msg)
>>>>>          id<- msg[2]
>>>>>          data<- eW$get.Data("data")
>>>>>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>>>>>          nr.data<- NROW(data[[id]])
>>>>>          if (tickType == .twsTickType$BID) {
>>>>>              data[[id]][nr.data, 1:2]<- msg[5:4]
>>>>>          }
>>>>>          else if (tickType == .twsTickType$ASK) {
>>>>>              data[[id]][nr.data, 3:4]<- msg[4:5]
>>>>>          }
>>>>>          else if (tickType == .twsTickType$LAST) {
>>>>>              data[[id]][nr.data, 5]<- msg[4]
>>>>>          }
>>>>>          eW$assign.Data("data", data)
>>>>>          c(curMsg, msg)
>>>>>      }
>>>>>      eW$tickSize<- function(curMsg, msg, timestamp, file, ...) {
>>>>>          data<- eW$get.Data("data")
>>>>>          tickType = msg[3]
>>>>>          msg<- as.numeric(msg)
>>>>>          id<- as.numeric(msg[2])
>>>>>          attr(data[[id]], "index")<- as.numeric(Sys.time())
>>>>>          nr.data<- NROW(data[[id]])
>>>>>          if (tickType == .twsTickType$BID_SIZE) {
>>>>>              data[[id]][nr.data, 1]<- msg[4]
>>>>>          }
>>>>>          else if (tickType == .twsTickType$ASK_SIZE) {
>>>>>              data[[id]][nr.data, 4]<- msg[4]
>>>>>          }
>>>>>          else if (tickType == .twsTickType$LAST_SIZE) {
>>>>>              data[[id]][nr.data, 6]<- msg[4]
>>>>>          }
>>>>>          else if (tickType == .twsTickType$VOLUME) {
>>>>>              data[[id]][nr.data, 7]<- msg[4]
>>>>>          }
>>>>>          eW$assign.Data("data", data)
>>>>>          c(curMsg, msg)
>>>>>      }
>>>>>      return(eW)
>>>>> }
>>>>> <environment: namespace:IBrokers>
>>>>>
>>>>> You can of course do whatever you like to make it more logical to 
>>>>> you.
>>>>>   Reading IBrokers source and the official Java source (yikes) is the
>>>>> way to get to a different end if you so require.
>>>>>
>>>>> Best,
>>>>> Jeff
>>>>>
>>>>>>
>>>>>> -- 
>>>>>> Stephen Choularton Ph.D., FIoD
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-SIG-Finance at r-project.org mailing list
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>>>> -- Also note that this is not the r-help list where general R 
>>>>>> questions
>>>>>> should go.
>>>>>>
>>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R 
>>>> questions
>>>> should go.
>>>>
>>>>
>>>>
>>>>
>>>> -----
>>>> No virus found in this message.
>>>> Checked by AVG - www.avg.com
>>>> Version: 10.0.1170 / Virus Database: 426/3301 - Release Date: 12/06/10
>>>>
>>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.
>
>
>
>
> -----
> No virus found in this message.
> Checked by AVG - www.avg.com
> Version: 10.0.1170 / Virus Database: 426/3303 - Release Date: 12/07/10
>
>


From klein82517 at yahoo.de  Sat Dec 11 11:33:41 2010
From: klein82517 at yahoo.de (Andreas Klein)
Date: Sat, 11 Dec 2010 10:33:41 +0000 (GMT)
Subject: [R-SIG-Finance] Two-Sample t-Test: paired vs. unpaired
Message-ID: <329479.31828.qm@web29601.mail.ird.yahoo.com>

Hello.

I got stuck with a simple decision problem:

I have two time series of utilities of portfolio returns. The first portfolio consists of 100 stocks and the second portfolio consists of 10 of the 100 stocks.

The correlation coefficient between the portfolio returns is almost zero.

When I produce idependently from each other the utility time series of each of the two portfolios I get a correlation coefficient of around 0.8

=> t.test(utility_series1, utility_series2, paired=???)

The facts: Both are independent at the beginning, but get highly correlated in the end. Therefore the results of t.test() strongly depends on the choice of paired vs. unpaired.

But I cannot decide whether I should treat the series as independent or not.

Any suggestions?


Regards,
Andreas





From arun.kumar.saha at gmail.com  Sat Dec 11 12:52:23 2010
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Sat, 11 Dec 2010 03:52:23 -0800 (PST)
Subject: [R-SIG-Finance] Two-Sample t-Test: paired vs. unpaired
In-Reply-To: <329479.31828.qm@web29601.mail.ird.yahoo.com>
References: <329479.31828.qm@web29601.mail.ird.yahoo.com>
Message-ID: <1292068343150-3083219.post@n4.nabble.com>


Do I really need I assume independent series for doing paired t-test?
Independence among the paired observation should be sufficient for a valid
paired t-test.
-- 
View this message in context: http://r.789695.n4.nabble.com/Two-Sample-t-Test-paired-vs-unpaired-tp3083170p3083219.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From Zeno.Adams at ebs.edu  Sat Dec 11 13:54:19 2010
From: Zeno.Adams at ebs.edu (Adams, Zeno)
Date: Sat, 11 Dec 2010 13:54:19 +0100
Subject: [R-SIG-Finance] Two-Sample t-Test: paired vs. unpaired
References: <329479.31828.qm@web29601.mail.ird.yahoo.com>
Message-ID: <9064522880125945B98983BBAECBA1CC0101BD8B@exchsrv001.ebs.local>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101211/8f6265d7/attachment.pl>

From leijin56 at gmail.com  Sat Dec 11 20:12:07 2010
From: leijin56 at gmail.com (Lei Jin)
Date: Sat, 11 Dec 2010 11:12:07 -0800
Subject: [R-SIG-Finance] adjustedPrice or raw Price in blotter
Message-ID: <AANLkTi=CWtAuM8pGMgBgOjgQJLtwEs9tE7RMocrY76-A@mail.gmail.com>

Hi,

I would like to get some advice on what Price should I use in
backtesting with blotter.  For example, I just ran a script with
adjustedPrice.  In my script, I have

symbol<-adjustOHLC(symbol,use.Adjusted=T)

But I noticed that blotter function updatePosPL() gets its price using
the rawPrice.  Therefore, it seems to me that I can't use adjustOHLC
with blotter.  But then, how do you adjust for event like split,
dividend, in the script.


=================================================================================
.updatePosPL <- function(Portfolio, Symbol, Dates=NULL, Prices=NULL,
ConMult=NULL, ...)
{ # @author Peter Carl, Brian Peterson
	rmfirst=FALSE
    pname<-Portfolio
    Portfolio<-getPortfolio(pname)
	p.ccy.str<-attr(Portfolio,'currency')
	if(is.null(p.ccy.str)) p.ccy.str<-'NA'
    tmp_instr<-try(getInstrument(Symbol))
    if(inherits(tmp_instr,"try-error") | !is.instrument(tmp_instr)){
	    warning(paste("Instrument",Symbol," not found, things may break"))
    }
	
	if(is.null(Prices)){
		prices=getPrice(get(Symbol, envir=as.environment(.GlobalEnv)))
              <======= gets the raw price
	}

=================================================================================

Thanks,
-lji


From brian at braverock.com  Sat Dec 11 20:46:14 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sat, 11 Dec 2010 13:46:14 -0600
Subject: [R-SIG-Finance] adjustedPrice or raw Price in blotter
In-Reply-To: <AANLkTi=CWtAuM8pGMgBgOjgQJLtwEs9tE7RMocrY76-A@mail.gmail.com>
References: <AANLkTi=CWtAuM8pGMgBgOjgQJLtwEs9tE7RMocrY76-A@mail.gmail.com>
Message-ID: <c3ed17849e816cb9f04dca53b0187e99@braverock.com>

blotter calls getPrice.  If you look at the documentation and code for
getPrice, you can pass a 'prefer' argument to use whatever column you want.

The way that you've adjusted it means that it will get the adjusted price,
though.  I don't think you need to do anything else.

If your adjusted series is named for the symbol, then that is the price
that blotter will find.  You can of course verify this by calling that
code:

getPrice(get(symbol, envir=as.environment(.GlobalEnv)))

and I think you will see the adjusted price.  If not, experiment with the
prefer= argument or provide us with a reproducible example we can work from
to help you further.

Regards,

  - Brian

Regards,

  - Brian

On Sat, 11 Dec 2010 11:12:07 -0800, Lei Jin <leijin56 at gmail.com> wrote:
> Hi,
> 
> I would like to get some advice on what Price should I use in
> backtesting with blotter.  For example, I just ran a script with
> adjustedPrice.  In my script, I have
> 
> symbol<-adjustOHLC(symbol,use.Adjusted=T)
> 
> But I noticed that blotter function updatePosPL() gets its price using
> the rawPrice.  Therefore, it seems to me that I can't use adjustOHLC
> with blotter.  But then, how do you adjust for event like split,
> dividend, in the script.
> 
> 
>
=================================================================================
> .updatePosPL <- function(Portfolio, Symbol, Dates=NULL, Prices=NULL,
> ConMult=NULL, ...)
> { # @author Peter Carl, Brian Peterson
> 	rmfirst=FALSE
>     pname<-Portfolio
>     Portfolio<-getPortfolio(pname)
> 	p.ccy.str<-attr(Portfolio,'currency')
> 	if(is.null(p.ccy.str)) p.ccy.str<-'NA'
>     tmp_instr<-try(getInstrument(Symbol))
>     if(inherits(tmp_instr,"try-error") | !is.instrument(tmp_instr)){
> 	    warning(paste("Instrument",Symbol," not found, things may break"))
>     }
> 
> 	if(is.null(Prices)){
> 		prices=getPrice(get(Symbol, envir=as.environment(.GlobalEnv)))
>               <======= gets the raw price
> 	}
> 
>
=================================================================================
> 
> Thanks,
> -lji
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From wjlee2002 at naver.com  Sun Dec 12 09:59:07 2010
From: wjlee2002 at naver.com (=?EUC-KR?B?wMy/+MDn?=)
Date: Sun, 12 Dec 2010 17:59:07 +0900
Subject: [R-SIG-Finance] =?euc-kr?q?RQuantLib_install_error?=
Message-ID: <fed85f6858840c51fc84553a89fb77cb@tweb02-2.nm>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101212/5379810c/attachment.pl>

From J_Cuisinier at hotmail.com  Sun Dec 12 10:18:44 2010
From: J_Cuisinier at hotmail.com (julien cuisinier)
Date: Sun, 12 Dec 2010 09:18:44 +0000
Subject: [R-SIG-Finance] RQuantLib install error
In-Reply-To: <fed85f6858840c51fc84553a89fb77cb@tweb02-2.nm>
References: <fed85f6858840c51fc84553a89fb77cb@tweb02-2.nm>
Message-ID: <BLU0-SMTP435D544EE4FB1130F0EC708F110@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101212/52e6f37b/attachment.pl>

From megh700004 at yahoo.com  Sun Dec 12 14:47:47 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Sun, 12 Dec 2010 05:47:47 -0800 (PST)
Subject: [R-SIG-Finance] Co-integration question
Message-ID: <218731.85645.qm@web58101.mail.re3.yahoo.com>

Hi dears, let say I have few cointegrated variables and those are placed in 2 groups with length n1 & n2. Cointegration may present within and between the groups. As usual information on the cointegration relationship is in beta matrix and the corresponding weights are in alpha matrix.

Now suppose I partition the alpha matrix in 2 part viz alpha1 & alpha2 according to the lengths of the 1st group and 2nd group. Now if I say "alpha2 = 0" then does it signify that: there are no cointgration within the variables of the 2nd group? (however cointegraion may exist within 1st group as well 1st & 2nd group combined).

Thanks for your views.


From megh700004 at yahoo.com  Mon Dec 13 07:56:49 2010
From: megh700004 at yahoo.com (Megh)
Date: Sun, 12 Dec 2010 22:56:49 -0800 (PST)
Subject: [R-SIG-Finance] Forcasting VAR/VEC
Message-ID: <1292223409804-3084994.post@n4.nabble.com>


Hi dears, I am looking for some function to predict through horizon "h", say,
given the corefficients of a VAR/VEC model. I have moderately gone through
packages "urca" & "vars" but did not find any significant:

> ls("package:vars")
 [1] "A"              "Acoef"          "arch"           "arch.test"      "B"             
"Bcoef"          "BQ"             "causality"     
 [9] "fanchart"       "fevd"           "irf"            "normality"     
"normality.test" "Phi"            "Psi"            "restrict"      
[17] "roots"          "serial"         "serial.test"    "stability"     
"SVAR"           "SVEC"           "VAR"            "VARselect"     
[25] "vec2var"       
> ls("package:urca")
 [1] "ablrtest"      "alphaols"      "alrtest"       "bh5lrtest"    
"bh6lrtest"     "blrtest"       "ca.jo"         "ca.po"        
 [9] "cajolst"       "cajools"       "cajorls"       "lttest"        "plot"         
"plotres"       "punitroot"     "qunitroot"    
[17] "summary"       "unitrootTable" "ur.df"         "ur.ers"       
"ur.kpss"       "ur.pp"         "ur.sp"         "ur.za"       

Can somebofy help in finding any relevant function for prediction?

Thanks,
-- 
View this message in context: http://r.789695.n4.nabble.com/Forcasting-VAR-VEC-tp3084994p3084994.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From Bernhard_Pfaff at fra.invesco.com  Mon Dec 13 09:49:14 2010
From: Bernhard_Pfaff at fra.invesco.com (Pfaff, Bernhard Dr.)
Date: Mon, 13 Dec 2010 08:49:14 -0000
Subject: [R-SIG-Finance] Forcasting VAR/VEC
In-Reply-To: <1292223409804-3084994.post@n4.nabble.com>
References: <1292223409804-3084994.post@n4.nabble.com>
Message-ID: <B89F0CE41D45644A97CCC93DF548C1C328577463@GBHENXMB02.corp.amvescap.net>

?vars::predict 

> -----Urspr?ngliche Nachricht-----
> Von: r-sig-finance-bounces at r-project.org 
> [mailto:r-sig-finance-bounces at r-project.org] Im Auftrag von Megh
> Gesendet: Montag, 13. Dezember 2010 07:57
> An: r-sig-finance at stat.math.ethz.ch
> Betreff: [R-SIG-Finance] Forcasting VAR/VEC
> 
> 
> Hi dears, I am looking for some function to predict through 
> horizon "h", say, given the corefficients of a VAR/VEC model. 
> I have moderately gone through packages "urca" & "vars" but 
> did not find any significant:
> 
> > ls("package:vars")
>  [1] "A"              "Acoef"          "arch"           
> "arch.test"      "B"             
> "Bcoef"          "BQ"             "causality"     
>  [9] "fanchart"       "fevd"           "irf"            
> "normality"     
> "normality.test" "Phi"            "Psi"            "restrict"      
> [17] "roots"          "serial"         "serial.test"    
> "stability"     
> "SVAR"           "SVEC"           "VAR"            "VARselect"     
> [25] "vec2var"       
> > ls("package:urca")
>  [1] "ablrtest"      "alphaols"      "alrtest"       "bh5lrtest"    
> "bh6lrtest"     "blrtest"       "ca.jo"         "ca.po"        
>  [9] "cajolst"       "cajools"       "cajorls"       "lttest" 
>        "plot"         
> "plotres"       "punitroot"     "qunitroot"    
> [17] "summary"       "unitrootTable" "ur.df"         "ur.ers"       
> "ur.kpss"       "ur.pp"         "ur.sp"         "ur.za"       
> 
> Can somebofy help in finding any relevant function for prediction?
> 
> Thanks,
> --
> View this message in context: 
> http://r.789695.n4.nabble.com/Forcasting-VAR-VEC-tp3084994p308
4994.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list 
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R 
> questions should go.
> 
*****************************************************************
Confidentiality Note: The information contained in this ...{{dropped:10}}


From stephen at organicfoodmarkets.com.au  Mon Dec 13 20:29:24 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 14 Dec 2010 06:29:24 +1100
Subject: [R-SIG-Finance] reqMktDepth
Message-ID: <4D067414.2050807@organicfoodmarkets.com.au>

I'm trying to use market depth information but falling at the first fence.

This code:

library(IBroker)

tws <- twsConnect(9)
tws

#reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))


#reqMktData(con, list(twsEquity("CBA","ASX","AUD")))


# write to a file
#reqMktDepth(tws, twsEquity("CBA","ASX","AUD"), file='c:/rMktDepth/out.dat')

reqMktDepth(tws, twsEquity("GOOG"))
#reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')

closeAllConnections()

Produces:

 > > tws <- twsConnect(9)
 > tws
<twsConnection,9 @ 20101214 06:18:55 Eastern Standard Time (New South 
Wales), nextId=1>
 >
 > #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
 >
 >
 > #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
 >
 >
 > # write to a file
 > #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"), 
file='c:/rMktDepth/out.dat')
 >
 >reqMktDepth(tws, twsEquity("GOOG"))
 > # reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm

[hanging so hit Esc]


 >
 > closeAllConnections()
 >
 >

Can anyone see what I'm doing wrong?


-- 
Stephen Choularton Ph.D., FIoD


From jeff.a.ryan at gmail.com  Mon Dec 13 21:24:12 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 13 Dec 2010 14:24:12 -0600
Subject: [R-SIG-Finance] reqMktDepth
In-Reply-To: <4D067414.2050807@organicfoodmarkets.com.au>
References: <4D067414.2050807@organicfoodmarkets.com.au>
Message-ID: <AANLkTikRA+HGuawxnExG1U0XuJU0LgrbYTzLU7ugVdNt@mail.gmail.com>

I think the IB API has changed, I will look into it and get a patch out.

Thanks for the report.

Best,
Jeff

On Mon, Dec 13, 2010 at 1:29 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> I'm trying to use market depth information but falling at the first fence.
>
> This code:
>
> library(IBroker)
>
> tws <- twsConnect(9)
> tws
>
> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>
>
> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>
>
> # write to a file
> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"), file='c:/rMktDepth/out.dat')
>
> reqMktDepth(tws, twsEquity("GOOG"))
> #reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
>
> closeAllConnections()
>
> Produces:
>
>> > tws <- twsConnect(9)
>> tws
> <twsConnection,9 @ 20101214 06:18:55 Eastern Standard Time (New South
> Wales), nextId=1>
>>
>> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>>
>>
>> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>>
>>
>> # write to a file
>> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"),
>> file='c:/rMktDepth/out.dat')
>>
>>reqMktDepth(tws, twsEquity("GOOG"))
>> # reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
>
> [hanging so hit Esc]
>
>
>>
>> closeAllConnections()
>>
>>
>
> Can anyone see what I'm doing wrong?
>
>
> --
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From jeff.a.ryan at gmail.com  Mon Dec 13 23:05:48 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 13 Dec 2010 16:05:48 -0600
Subject: [R-SIG-Finance] reqMktDepth
In-Reply-To: <AANLkTikRA+HGuawxnExG1U0XuJU0LgrbYTzLU7ugVdNt@mail.gmail.com>
References: <4D067414.2050807@organicfoodmarkets.com.au>
	<AANLkTikRA+HGuawxnExG1U0XuJU0LgrbYTzLU7ugVdNt@mail.gmail.com>
Message-ID: <AANLkTi=4i4Qia+ewum=STeZ-4PwuxOF31XuJvDBA=s_b@mail.gmail.com>

Stephen,

The issue is actually due to permissions NOT IBrokers.  ARCA and
ISLAND now require data subscriptions.  You don't get an error message
or an explanation unless you try it in the TWS itself.

>From IBrokers, you need to select an exchange, or in the TWS subscribe
to the exchanges that are causing the error for you.

This works for me randomly ...

> reqMktDepth(tws, twsSTK("AAPL",exch="BATS"))
TWS Message: 2 1 310 Can't find the subscribed market depth with tickerId:1
<20101213 15:59:04.646251>,id=1,pos=0,operation=insert,side=bid,price=321.86,size=1
<20101213 15:59:04.647362>,id=1,pos=0,operation=insert,side=ask,price=323.95,size=70
<20101213 15:59:42.995142>,id=1,pos=0,operation=delete,side=bid,price=0,size=0
<20101213 16:00:00.349464>,id=1,pos=0,operation=delete,side=ask,price=0,size=0

HTH,
Jeff

On Mon, Dec 13, 2010 at 2:24 PM, Jeff Ryan <jeff.a.ryan at gmail.com> wrote:
> I think the IB API has changed, I will look into it and get a patch out.
>
> Thanks for the report.
>
> Best,
> Jeff
>
> On Mon, Dec 13, 2010 at 1:29 PM, Stephen Choularton
> <stephen at organicfoodmarkets.com.au> wrote:
>> I'm trying to use market depth information but falling at the first fence.
>>
>> This code:
>>
>> library(IBroker)
>>
>> tws <- twsConnect(9)
>> tws
>>
>> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>>
>>
>> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>>
>>
>> # write to a file
>> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"), file='c:/rMktDepth/out.dat')
>>
>> reqMktDepth(tws, twsEquity("GOOG"))
>> #reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
>>
>> closeAllConnections()
>>
>> Produces:
>>
>>> > tws <- twsConnect(9)
>>> tws
>> <twsConnection,9 @ 20101214 06:18:55 Eastern Standard Time (New South
>> Wales), nextId=1>
>>>
>>> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>>>
>>>
>>> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>>>
>>>
>>> # write to a file
>>> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"),
>>> file='c:/rMktDepth/out.dat')
>>>
>>>reqMktDepth(tws, twsEquity("GOOG"))
>>> # reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
>> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
>> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
>>
>> [hanging so hit Esc]
>>
>>
>>>
>>> closeAllConnections()
>>>
>>>
>>
>> Can anyone see what I'm doing wrong?
>>
>>
>> --
>> Stephen Choularton Ph.D., FIoD
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>>
>
>
>
> --
> Jeffrey Ryan
> jeffrey.ryan at lemnica.com
>
> www.lemnica.com
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From nick.torenvliet at gmail.com  Mon Dec 13 23:20:57 2010
From: nick.torenvliet at gmail.com (Nick Torenvliet)
Date: Mon, 13 Dec 2010 17:20:57 -0500
Subject: [R-SIG-Finance] xts / split time series issue
Message-ID: <AANLkTim0dz4Rr1xF32eGy6_R-tnEpOe60dXL8iFmP_CW@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101213/c8bf822a/attachment.pl>

From brian at braverock.com  Mon Dec 13 23:39:59 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 13 Dec 2010 16:39:59 -0600
Subject: [R-SIG-Finance] xts / split time series issue
In-Reply-To: <AANLkTim0dz4Rr1xF32eGy6_R-tnEpOe60dXL8iFmP_CW@mail.gmail.com>
References: <AANLkTim0dz4Rr1xF32eGy6_R-tnEpOe60dXL8iFmP_CW@mail.gmail.com>
Message-ID: <4D06A0BF.7080400@braverock.com>

We load historical data (as from CSV files), split() and then xts here.

Alternately, you can likely get a list of unique() symbols in your xts, 
and then loop through them and assign to a variable named for 'symbol', 
with something like

assign('ZUT',table[table$symbol=='ZUT',c('open','high','low','close','volume')])

Cheers,

   - Brian


On 12/13/2010 04:20 PM, Nick Torenvliet wrote:
> Hi all,
>
>> splitTable<- split(table, table$symbol)
>> zutTable<- xts(splitTable$ZUT[,-1],order.by
> =as.POSIXct(splitTable$ZUT[,1]))
>> zutTable<- zutTable[,-6]
>> zutTable
>             open    high    low     close   volume
> 2010-12-02 "16.46" "16.48" "16.45" "16.46" " 5567"
> 2010-12-03 "16.48" "16.48" "16.36" "16.39" "12062"
> 2010-12-06 "16.35" "16.40" "16.35" "16.40" " 7197"
> 2010-12-07 "16.41" "16.42" "16.35" "16.40" " 8316"
> 2010-12-08 "16.44" "16.44" "16.33" "16.34" "17637"
> 2010-12-09 "16.34" "16.35" "16.30" "16.35" " 4035"
> 2010-12-10 "16.33" "16.38" "16.33" "16.35" " 5646"
>> candleChart(zutTable)
> Error in na.omit.xts(x) : unsupported type
>
> Which is due to split which as advertised coerces the data to a
> character/string type.
>
> So I've tried a number of data type changes... and can't get the back to a
> numeric data type without frying the xts'ness of the data.
>
> Any suggestions?
>
> Nick
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From stephen at organicfoodmarkets.com.au  Tue Dec 14 00:03:40 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 14 Dec 2010 10:03:40 +1100
Subject: [R-SIG-Finance] reqMktDepth
In-Reply-To: <AANLkTi=4i4Qia+ewum=STeZ-4PwuxOF31XuJvDBA=s_b@mail.gmail.com>
References: <4D067414.2050807@organicfoodmarkets.com.au>	<AANLkTikRA+HGuawxnExG1U0XuJU0LgrbYTzLU7ugVdNt@mail.gmail.com>
	<AANLkTi=4i4Qia+ewum=STeZ-4PwuxOF31XuJvDBA=s_b@mail.gmail.com>
Message-ID: <4D06A64C.3000401@organicfoodmarkets.com.au>

OK, so I have that generic US subscription that costs you nothing if you 
produce more than $30 commissions a month.  Do you think that means I 
have to go for the more specific subscriptions (which I think cost more)?

Second, I am directly subscribed for ASX but didn't get the desired 
results I get this (the market was open at the time):


 > tws <- twsConnect(9)
 > tws
<twsConnection,9 @ 20101214 10:01:45 Eastern Standard Time (New South 
Wales), nextId=>
 >
 > reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
TWS Message: 2 -1 2106 HMDS data farm connection is OK:hkhmds2
TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
TWS Message: 2 1 200 No security definition has been found for the request

 >

PS I can get data with reqMktData(con, list(twsEquity("CBA","ASX","AUD")))


Stephen Choularton Ph.D., FIoD

On 14/12/2010 9:05 AM, Jeff Ryan wrote:
> Stephen,
>
> The issue is actually due to permissions NOT IBrokers.  ARCA and
> ISLAND now require data subscriptions.  You don't get an error message
> or an explanation unless you try it in the TWS itself.
>
> > From IBrokers, you need to select an exchange, or in the TWS subscribe
> to the exchanges that are causing the error for you.
>
> This works for me randomly ...
>
>> reqMktDepth(tws, twsSTK("AAPL",exch="BATS"))
> TWS Message: 2 1 310 Can't find the subscribed market depth with tickerId:1
> <20101213 15:59:04.646251>,id=1,pos=0,operation=insert,side=bid,price=321.86,size=1
> <20101213 15:59:04.647362>,id=1,pos=0,operation=insert,side=ask,price=323.95,size=70
> <20101213 15:59:42.995142>,id=1,pos=0,operation=delete,side=bid,price=0,size=0
> <20101213 16:00:00.349464>,id=1,pos=0,operation=delete,side=ask,price=0,size=0
>
> HTH,
> Jeff
>
> On Mon, Dec 13, 2010 at 2:24 PM, Jeff Ryan<jeff.a.ryan at gmail.com>  wrote:
>> I think the IB API has changed, I will look into it and get a patch out.
>>
>> Thanks for the report.
>>
>> Best,
>> Jeff
>>
>> On Mon, Dec 13, 2010 at 1:29 PM, Stephen Choularton
>> <stephen at organicfoodmarkets.com.au>  wrote:
>>> I'm trying to use market depth information but falling at the first fence.
>>>
>>> This code:
>>>
>>> library(IBroker)
>>>
>>> tws<- twsConnect(9)
>>> tws
>>>
>>> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>>>
>>>
>>> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>>>
>>>
>>> # write to a file
>>> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"), file='c:/rMktDepth/out.dat')
>>>
>>> reqMktDepth(tws, twsEquity("GOOG"))
>>> #reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
>>>
>>> closeAllConnections()
>>>
>>> Produces:
>>>
>>>>> tws<- twsConnect(9)
>>>> tws
>>> <twsConnection,9 @ 20101214 06:18:55 Eastern Standard Time (New South
>>> Wales), nextId=1>
>>>> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>>>>
>>>>
>>>> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>>>>
>>>>
>>>> # write to a file
>>>> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"),
>>>> file='c:/rMktDepth/out.dat')
>>>>
>>>> reqMktDepth(tws, twsEquity("GOOG"))
>>>> # reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
>>> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
>>> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
>>>
>>> [hanging so hit Esc]
>>>
>>>
>>>> closeAllConnections()
>>>>
>>>>
>>> Can anyone see what I'm doing wrong?
>>>
>>>
>>> --
>>> Stephen Choularton Ph.D., FIoD
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions
>>> should go.
>>>
>>
>>
>> --
>> Jeffrey Ryan
>> jeffrey.ryan at lemnica.com
>>
>> www.lemnica.com
>>
>
>


From jeff.a.ryan at gmail.com  Tue Dec 14 00:19:51 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 13 Dec 2010 17:19:51 -0600
Subject: [R-SIG-Finance] reqMktDepth
In-Reply-To: <4D06A64C.3000401@organicfoodmarkets.com.au>
References: <4D067414.2050807@organicfoodmarkets.com.au>
	<AANLkTikRA+HGuawxnExG1U0XuJU0LgrbYTzLU7ugVdNt@mail.gmail.com>
	<AANLkTi=4i4Qia+ewum=STeZ-4PwuxOF31XuJvDBA=s_b@mail.gmail.com>
	<4D06A64C.3000401@organicfoodmarkets.com.au>
Message-ID: <AANLkTi=k3XfbU3enQuDSK_VAXMzx-e74QL7qP7FifF27@mail.gmail.com>

Read:

http://www.interactivebrokers.com/en/p.php?f=marketData

I don't know if depth exists on the ASX, but for the other exchanges
you need for example (per the page above):

NYSE (ex: IBM), full market depth	

- US Securities & Commodities Non-Professional Bundle
- NYSE Open Book Real Time
- NASDAQ Totalview
- Arcabook

Above is ~60 or so for non-pro, and a few hundred for pro...

Due note that this isn't R or IBrokers, this is IB, so questions
aren't on-topic for this forum.

HTH
Jeff

On Mon, Dec 13, 2010 at 5:03 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> OK, so I have that generic US subscription that costs you nothing if you
> produce more than $30 commissions a month. ?Do you think that means I have
> to go for the more specific subscriptions (which I think cost more)?
>
> Second, I am directly subscribed for ASX but didn't get the desired results
> I get this (the market was open at the time):
>
>
>> tws <- twsConnect(9)
>> tws
> <twsConnection,9 @ 20101214 10:01:45 Eastern Standard Time (New South
> Wales), nextId=>
>>
>> reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:hkhmds2
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
> TWS Message: 2 1 200 No security definition has been found for the request
>
>>
>
> PS I can get data with reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>
>
> Stephen Choularton Ph.D., FIoD
>
> On 14/12/2010 9:05 AM, Jeff Ryan wrote:
>>
>> Stephen,
>>
>> The issue is actually due to permissions NOT IBrokers. ?ARCA and
>> ISLAND now require data subscriptions. ?You don't get an error message
>> or an explanation unless you try it in the TWS itself.
>>
>> > From IBrokers, you need to select an exchange, or in the TWS subscribe
>> to the exchanges that are causing the error for you.
>>
>> This works for me randomly ...
>>
>>> reqMktDepth(tws, twsSTK("AAPL",exch="BATS"))
>>
>> TWS Message: 2 1 310 Can't find the subscribed market depth with
>> tickerId:1
>> <20101213
>> 15:59:04.646251>,id=1,pos=0,operation=insert,side=bid,price=321.86,size=1
>> <20101213
>> 15:59:04.647362>,id=1,pos=0,operation=insert,side=ask,price=323.95,size=70
>> <20101213
>> 15:59:42.995142>,id=1,pos=0,operation=delete,side=bid,price=0,size=0
>> <20101213
>> 16:00:00.349464>,id=1,pos=0,operation=delete,side=ask,price=0,size=0
>>
>> HTH,
>> Jeff
>>
>> On Mon, Dec 13, 2010 at 2:24 PM, Jeff Ryan<jeff.a.ryan at gmail.com> ?wrote:
>>>
>>> I think the IB API has changed, I will look into it and get a patch out.
>>>
>>> Thanks for the report.
>>>
>>> Best,
>>> Jeff
>>>
>>> On Mon, Dec 13, 2010 at 1:29 PM, Stephen Choularton
>>> <stephen at organicfoodmarkets.com.au> ?wrote:
>>>>
>>>> I'm trying to use market depth information but falling at the first
>>>> fence.
>>>>
>>>> This code:
>>>>
>>>> library(IBroker)
>>>>
>>>> tws<- twsConnect(9)
>>>> tws
>>>>
>>>> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>>>>
>>>>
>>>> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>>>>
>>>>
>>>> # write to a file
>>>> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"),
>>>> file='c:/rMktDepth/out.dat')
>>>>
>>>> reqMktDepth(tws, twsEquity("GOOG"))
>>>> #reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
>>>>
>>>> closeAllConnections()
>>>>
>>>> Produces:
>>>>
>>>>>> tws<- twsConnect(9)
>>>>>
>>>>> tws
>>>>
>>>> <twsConnection,9 @ 20101214 06:18:55 Eastern Standard Time (New South
>>>> Wales), nextId=1>
>>>>>
>>>>> #reqMktDepth(tws, list(twsEquity("CBA","ASX","AUD")))
>>>>>
>>>>>
>>>>> #reqMktData(con, list(twsEquity("CBA","ASX","AUD")))
>>>>>
>>>>>
>>>>> # write to a file
>>>>> #reqMktDepth(tws, twsEquity("CBA","ASX","AUD"),
>>>>> file='c:/rMktDepth/out.dat')
>>>>>
>>>>> reqMktDepth(tws, twsEquity("GOOG"))
>>>>> # reqMktDepth(tws, twsEquity("GOOG"), file='c:/rMktDepth/out.dat')
>>>>
>>>> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
>>>> TWS Message: 2 -1 2104 Market data farm connection is OK:usfarm
>>>>
>>>> [hanging so hit Esc]
>>>>
>>>>
>>>>> closeAllConnections()
>>>>>
>>>>>
>>>> Can anyone see what I'm doing wrong?
>>>>
>>>>
>>>> --
>>>> Stephen Choularton Ph.D., FIoD
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions
>>>> should go.
>>>>
>>>
>>>
>>> --
>>> Jeffrey Ryan
>>> jeffrey.ryan at lemnica.com
>>>
>>> www.lemnica.com
>>>
>>
>>
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From jeff.a.ryan at gmail.com  Tue Dec 14 00:33:19 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Mon, 13 Dec 2010 17:33:19 -0600
Subject: [R-SIG-Finance] xts / split time series issue
In-Reply-To: <AANLkTim0dz4Rr1xF32eGy6_R-tnEpOe60dXL8iFmP_CW@mail.gmail.com>
References: <AANLkTim0dz4Rr1xF32eGy6_R-tnEpOe60dXL8iFmP_CW@mail.gmail.com>
Message-ID: <AANLkTi=TNQYmLQyC+YN89yaV0BFKU3cELWqG0s2VKxMf@mail.gmail.com>

You can coerce back (assuming the data is coercible) using storage.mode<-

x <- xts(as.character(100), Sys.Date())
x
           [,1]
2010-12-13 "100"

storage.mode(x)
[1] "character"

storage.mode(x) <- "numeric"
storage.mode(x)
[1] "double"

x
           [,1]
2010-12-13  100

HTH
Jeff

On Mon, Dec 13, 2010 at 4:20 PM, Nick Torenvliet
<nick.torenvliet at gmail.com> wrote:
> Hi all,
>
>> splitTable <- split(table, table$symbol)
>> zutTable <- xts(splitTable$ZUT[,-1],order.by
> =as.POSIXct(splitTable$ZUT[,1]))
>> zutTable <- zutTable[,-6]
>> zutTable
> ? ? ? ? ? open ? ?high ? ?low ? ? close ? volume
> 2010-12-02 "16.46" "16.48" "16.45" "16.46" " 5567"
> 2010-12-03 "16.48" "16.48" "16.36" "16.39" "12062"
> 2010-12-06 "16.35" "16.40" "16.35" "16.40" " 7197"
> 2010-12-07 "16.41" "16.42" "16.35" "16.40" " 8316"
> 2010-12-08 "16.44" "16.44" "16.33" "16.34" "17637"
> 2010-12-09 "16.34" "16.35" "16.30" "16.35" " 4035"
> 2010-12-10 "16.33" "16.38" "16.33" "16.35" " 5646"
>> candleChart(zutTable)
> Error in na.omit.xts(x) : unsupported type
>
> Which is due to split which as advertised coerces the data to a
> character/string type.
>
> So I've tried a number of data type changes... and can't get the back to a
> numeric data type without frying the xts'ness of the data.
>
> Any suggestions?
>
> Nick
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From aaditya.nanduri at gmail.com  Tue Dec 14 07:53:33 2010
From: aaditya.nanduri at gmail.com (Aaditya Nanduri)
Date: Tue, 14 Dec 2010 00:53:33 -0600
Subject: [R-SIG-Finance] Problems with quantstrat and my own code
Message-ID: <AANLkTing3U1EAMX0cmrVot3FZ=CHS4QdGEJC27Rp5O6C@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101214/e7d88085/attachment.pl>

From brian at braverock.com  Tue Dec 14 11:57:17 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 14 Dec 2010 04:57:17 -0600
Subject: [R-SIG-Finance] Problems with quantstrat and my own code
In-Reply-To: <AANLkTing3U1EAMX0cmrVot3FZ=CHS4QdGEJC27Rp5O6C@mail.gmail.com>
References: <AANLkTing3U1EAMX0cmrVot3FZ=CHS4QdGEJC27Rp5O6C@mail.gmail.com>
Message-ID: <4bd961381586420b2deb24ced0e57f1b@braverock.com>

OK, first, to your question:

There is no book that will teach you modeling in R.  Strategy modeling is
a very complex and often proprietary task.  There are many books that
purport to teach strategy modeling.  All the ones I own are pretty bad. 
None of them use R.  Some of them are useful as a compilation of common
widely known strategy parameters, indicators, signals, and rules.  

There's a reason that successful quantitative strategists are well
compensated: what we do is hard, and involves art, science, math, and a
little bit of luck.  'quantstrat', and the rest of the toolchain, represent
tools that you can use to make you more productive as you create
strategies.

Second, to your problems.

1> quantstrat

That's a *Warning*, not an *Error*, and is coming out of xts somewhere,
probably in subsetting, since we do so much of that.  Because it is a
Warning, and not an Error, I haven't taken the time to figure out where it
is and either code around it or suppress it.

2> your code

I'm not going to debug your ad-hoc strategy code for you, sorry.  Every
time I set out to write an ad-hoc backtest of a strategy, I screw
*something* up. We wrote a framework to concentrate the bugs in one place,
so that we could eliminate them one at a time, and spend more time actually
modeling strategies. Another way of putting that would be that we we wrote
the framework so that we could have a different kind of discussion with the
user of our open source code.  That discussion would look something like
this:  

"I ran the quantstrat demo('faber') code on instrument 'TYC' and
instrument 'XLY', pdf's of chart.Posn() attached. 
I believe the demo code for market orders is creating incorrect results 
here <insert detailed description> by <insert your hypothesis of what is
wrong>. Could someone please check this and let me know?  I'd be happy to
help patch the code.  Thanks." 

Since I think that's probably more or less what you meant, I'll take a
look at the faber demo on TYC and XLY when I get to the office, and look
for any obvious problems with the trades and P&L.  If you've found
something specific that might raise concerns (all the data is available
either  in the output of applyStrategy or in the portfolio to double-check
the indicators, signals, and rules), please share.

Regards,

  - Brian


On Tue, 14 Dec 2010 00:53:33 -0600, Aaditya Nanduri
<aaditya.nanduri at gmail.com> wrote:
> Hello All,
> 
> I have 2 problems and 1 question today.
> 
> QUESTION : Are there any book that teach modelling in R? Hopefully an
> introductory book. I would like to learn how to build/backtest
strategies,
> so if there are any introductory books, please share.
> 
> PROBLEMS:
> 1) Quantstrat
> 
> I tried to use the Faber demo but changed all the symbols to just "TYC"
> and I get the following errors:
>    .
>    .
>    .
>  # Process the indicators and generate trades
>> start_t<-Sys.time()
>> out<-try(applyStrategy(strategy=stratFaber , portfolios='faber'))
> *Warning message:*
> *In max(i) : no non-missing arguments to max; returning -Inf*
>> end_t<-Sys.time()
>    .
>    .
>    .
> *Warning messages:*
> *1: In max(i) : no non-missing arguments to max; returning -Inf*
> *2: In max(i) : no non-missing arguments to max; returning -Inf*
> 
> I have no idea what they mean...
> 
> 2) My code:
> 
> 
> I know this code is wrong but I dont know where the error is. To me, it
> seems right. But when I ran "XLY" through the faber demo and the code I
> wrote, the end results couldnt be further from each other.
> I also know that my code is highly inefficient so if there are any
helpful
> hints that you would like to throw my way, I am open to everything.
> 
>
------------------------------------------------CODE-----------------------------------
> library(quantmod)
> 
> # Get Data
> getSymbols("TYC", from = "1998-01-01", to = Sys.Date())
> 
> # Convert from daily to monthly
> x <- get(TYC)
> x <- to.monthly(XLY, indexAt = 'lastof', drop.time= TRUE)
> indexFormat(x) <- '%Y-%m-%d'
> colnames(x) <- gsub("x", "XLY", colnames(x))
> assign("XLY", x)
> 
> price <- as.numeric(Cl(XLY))
> # Build indicators
> sma10 <- SMA(price, n=10)
> 
> for(i in 1:length(price)){ buy[i] <- NA; sell[i] <- NA }
> # Buy signal
> buy[which(price > sma10)] <- 1
> buy[which(is.na(buy))] <- 0
> 
> # Sell signal
> sell[which(price < sma10)] <- -1
> sell[which(is.na(sell))] <- 0
> 
> signal <- buy + sell
> signal[which(is.na(signal))] <- 0
> 
> x <- NA
> 
> for(i in 1:length(signal)){
>  # Start with buying not selling
> if(signal[i-1] == 0 && signal[i] == -1) {
> signal[i] = 0
> }
> }
> 
> for(i in 1:length(signal)){
> 
> if(signal[i-1] == 0 && signal[i] == 1) {
> x[i] <- 1
> }
> if(signal[i-1] == -1 && signal[i] == 1) {
> x[i] <- 1
> }
> if(signal[i-1] == 1 && signal[i] == -1) {
> x[i] <- -1
> }
> }
> 
> x[which(is.na(x))] <- 0
> 
> money <- 100000 -> initEq
> stock <- 0
> numinP <- 0
> 
> for(i in 1:length(x)){
>  if(x[i] == 1) {
> p <- price[i]
> b <- floor(money/p)
> numinP <- numinP + b
> money <- money - p*b
> stock <- p*b
>  }
> if(x[i] == -1) {
> p <- price[i]
> money <- money + p*numinP
> stock <- 0
> numinP <- 0
> }
> }
> 
> total <- money + stock
> print(paste("The initial equity:",initEq))
> print(paste("After 10 years of trading using TAA:",total))
> 
> 
> I appreciate all your help
> 
> -- 
> Aaditya Nanduri
> aaditya.nanduri at gmail.com
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From alex.rudnev at gmail.com  Tue Dec 14 14:43:32 2010
From: alex.rudnev at gmail.com (Aleksandr Rudnev)
Date: Tue, 14 Dec 2010 08:43:32 -0500
Subject: [R-SIG-Finance] Problems with quantstrat and my own code
In-Reply-To: <4bd961381586420b2deb24ced0e57f1b@braverock.com>
References: <AANLkTing3U1EAMX0cmrVot3FZ=CHS4QdGEJC27Rp5O6C@mail.gmail.com>
	<4bd961381586420b2deb24ced0e57f1b@braverock.com>
Message-ID: <AANLkTimc2rVT0GG82CtTCpCQ3eMnKva-CLY+VKPE8og3@mail.gmail.com>

Brian,

I've seen those warnings typically in 2 places.
One during applyStrategy, it happens in getOrders(..., "open", ...)
when there are no open orders as part of the following invocation
chain doTryCatch -> applyStrategy -> getOrders -> [ -> [.xts.

applyStrategy
...
rem.orders <- getOrders(portfolio=portfolio, symbol=symbol, status="open")
...

getOrders
...
ordersubset<-orderbook[[portfolio]][[symbol]][indices,]
...
("indices" is empty, as there are no "open" orders where there are no
non-path-dependent rules or they don't produce any orders)

Another one in visualization code, when there were no trades:
...
  2: chart.Posn(Portfolio = my.name, Symbol = my.ticker, theme = my.theme)
  3: Portfolio$symbols[[Symbol]]$txn$Txn.Price[which(Trades > 0)]
  4: `[.xts`(Portfolio$symbols[[Symbol]]$txn$Txn.Price, which(Trades > 0))
  5: .signalSimpleWarning("no non-missing arguments to max; returning
-Inf", quote(max(i)))
...

Neither of those warnings seem to be critical, unless you turn
warnings into errors via option(warn = 2) or something like that :)
Couple of extra checks can eliminate those warnings to reduce
confusion and doubts.

Regards,
Alex

On Tue, Dec 14, 2010 at 5:57 AM, Brian G. Peterson <brian at braverock.com> wrote:
> OK, first, to your question:
>
> There is no book that will teach you modeling in R. ?Strategy modeling is
> a very complex and often proprietary task. ?There are many books that
> purport to teach strategy modeling. ?All the ones I own are pretty bad.
> None of them use R. ?Some of them are useful as a compilation of common
> widely known strategy parameters, indicators, signals, and rules.
>
> There's a reason that successful quantitative strategists are well
> compensated: what we do is hard, and involves art, science, math, and a
> little bit of luck. ?'quantstrat', and the rest of the toolchain, represent
> tools that you can use to make you more productive as you create
> strategies.
>
> Second, to your problems.
>
> 1> quantstrat
>
> That's a *Warning*, not an *Error*, and is coming out of xts somewhere,
> probably in subsetting, since we do so much of that. ?Because it is a
> Warning, and not an Error, I haven't taken the time to figure out where it
> is and either code around it or suppress it.
>
> 2> your code
>
> I'm not going to debug your ad-hoc strategy code for you, sorry. ?Every
> time I set out to write an ad-hoc backtest of a strategy, I screw
> *something* up. We wrote a framework to concentrate the bugs in one place,
> so that we could eliminate them one at a time, and spend more time actually
> modeling strategies. Another way of putting that would be that we we wrote
> the framework so that we could have a different kind of discussion with the
> user of our open source code. ?That discussion would look something like
> this:
>
> "I ran the quantstrat demo('faber') code on instrument 'TYC' and
> instrument 'XLY', pdf's of chart.Posn() attached.
> I believe the demo code for market orders is creating incorrect results
> here <insert detailed description> by <insert your hypothesis of what is
> wrong>. Could someone please check this and let me know? ?I'd be happy to
> help patch the code. ?Thanks."
>
> Since I think that's probably more or less what you meant, I'll take a
> look at the faber demo on TYC and XLY when I get to the office, and look
> for any obvious problems with the trades and P&L. ?If you've found
> something specific that might raise concerns (all the data is available
> either ?in the output of applyStrategy or in the portfolio to double-check
> the indicators, signals, and rules), please share.
>
> Regards,
>
> ?- Brian
>
>
> On Tue, 14 Dec 2010 00:53:33 -0600, Aaditya Nanduri
> <aaditya.nanduri at gmail.com> wrote:
>> Hello All,
>>
>> I have 2 problems and 1 question today.
>>
>> QUESTION : Are there any book that teach modelling in R? Hopefully an
>> introductory book. I would like to learn how to build/backtest
> strategies,
>> so if there are any introductory books, please share.
>>
>> PROBLEMS:
>> 1) Quantstrat
>>
>> I tried to use the Faber demo but changed all the symbols to just "TYC"
>> and I get the following errors:
>> ? ?.
>> ? ?.
>> ? ?.
>> ?# Process the indicators and generate trades
>>> start_t<-Sys.time()
>>> out<-try(applyStrategy(strategy=stratFaber , portfolios='faber'))
>> *Warning message:*
>> *In max(i) : no non-missing arguments to max; returning -Inf*
>>> end_t<-Sys.time()
>> ? ?.
>> ? ?.
>> ? ?.
>> *Warning messages:*
>> *1: In max(i) : no non-missing arguments to max; returning -Inf*
>> *2: In max(i) : no non-missing arguments to max; returning -Inf*
>>
>> I have no idea what they mean...
>>
>> 2) My code:
>>
>>
>> I know this code is wrong but I dont know where the error is. To me, it
>> seems right. But when I ran "XLY" through the faber demo and the code I
>> wrote, the end results couldnt be further from each other.
>> I also know that my code is highly inefficient so if there are any
> helpful
>> hints that you would like to throw my way, I am open to everything.
>>
>>
> ------------------------------------------------CODE-----------------------------------
>> library(quantmod)
>>
>> # Get Data
>> getSymbols("TYC", from = "1998-01-01", to = Sys.Date())
>>
>> # Convert from daily to monthly
>> x <- get(TYC)
>> x <- to.monthly(XLY, indexAt = 'lastof', drop.time= TRUE)
>> indexFormat(x) <- '%Y-%m-%d'
>> colnames(x) <- gsub("x", "XLY", colnames(x))
>> assign("XLY", x)
>>
>> price <- as.numeric(Cl(XLY))
>> # Build indicators
>> sma10 <- SMA(price, n=10)
>>
>> for(i in 1:length(price)){ buy[i] <- NA; sell[i] <- NA }
>> # Buy signal
>> buy[which(price > sma10)] <- 1
>> buy[which(is.na(buy))] <- 0
>>
>> # Sell signal
>> sell[which(price < sma10)] <- -1
>> sell[which(is.na(sell))] <- 0
>>
>> signal <- buy + sell
>> signal[which(is.na(signal))] <- 0
>>
>> x <- NA
>>
>> for(i in 1:length(signal)){
>> ?# Start with buying not selling
>> if(signal[i-1] == 0 && signal[i] == -1) {
>> signal[i] = 0
>> }
>> }
>>
>> for(i in 1:length(signal)){
>>
>> if(signal[i-1] == 0 && signal[i] == 1) {
>> x[i] <- 1
>> }
>> if(signal[i-1] == -1 && signal[i] == 1) {
>> x[i] <- 1
>> }
>> if(signal[i-1] == 1 && signal[i] == -1) {
>> x[i] <- -1
>> }
>> }
>>
>> x[which(is.na(x))] <- 0
>>
>> money <- 100000 -> initEq
>> stock <- 0
>> numinP <- 0
>>
>> for(i in 1:length(x)){
>> ?if(x[i] == 1) {
>> p <- price[i]
>> b <- floor(money/p)
>> numinP <- numinP + b
>> money <- money - p*b
>> stock <- p*b
>> ?}
>> if(x[i] == -1) {
>> p <- price[i]
>> money <- money + p*numinP
>> stock <- 0
>> numinP <- 0
>> }
>> }
>>
>> total <- money + stock
>> print(paste("The initial equity:",initEq))
>> print(paste("After 10 years of trading using TAA:",total))
>>
>>
>> I appreciate all your help
>>
>> --
>> Aaditya Nanduri
>> aaditya.nanduri at gmail.com
>>
>> ? ? ? [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions
>> should go.
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From megh700004 at yahoo.com  Tue Dec 14 18:38:05 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Tue, 14 Dec 2010 09:38:05 -0800 (PST)
Subject: [R-SIG-Finance] Forcasting VAR/VEC
In-Reply-To: <B89F0CE41D45644A97CCC93DF548C1C328577463@GBHENXMB02.corp.amvescap.net>
Message-ID: <534878.24427.qm@web58102.mail.re3.yahoo.com>

I tied to post it through Nabble, however it perhaps failed........ Here is my query. Your help will be highly appreciated.

I found a direct problem while implementing predict method. To use that, I need to give values for argument "object": 

object: An object of class ??varest??; generated by ?VAR()?, or an 
          object of class ??vec2var??; generated by ?vec2var()?. 

Here what I have I the estimated coefficients and last few values (required for prediction). Given those, how can I construct object of that class? 

For example, I have VAR[2] model with estimated coefficients: 

A1 <- t(matrix(c(-0.9444135,  0.5289205,  1.54338344, -1.2059849,  0.08658383, -0.7626375, 0.5384060,  1.34211012, -0.1540462,  0.07684465, 
-1.5000912,  0.5975748,  2.08629175, -1.3629879,  0.16405863,  0.5622497, -0.5749668, -0.01207330,  1.6547463, -0.37280903, -1.1190102, 
0.4834678,  1.04152221, -0.5084529,  0.91748918), 5)) 

A2 <- t(matrix(c(-0.5281084,  0.6750694, -0.00700632,  0.5744008, -0.540538174, -0.5115759,  0.6663074, -0.03690401,  0.1015040, 
-0.483984397, -0.6669159,  0.7810531, -0.08478713,  0.2837110, -0.634807434,  0.2474859, -0.2126529,  -0.04611398, -0.2851814, -0.003198122, 
0.1136257, -0.4070806, -0.15362813,  0.1043871, -0.570401589), 5)) 

## and deterministic terms with monthly seasonal dummy (11 dummy variables + constant): 

Mu <- t(matrix(c(0.01971314683, 7.392074e-05, 0.06745512042, 0.03066764063, -0.05716243051, -0.01666261294, -0.02648375478, -0.07739940822, 
-0.08537205872, -0.03454705454, 0.01026347102, 3.93408495893, 0.01124435027, 0.00826573416, 0.07232184812, 0.02643898799, -0.02290620244, 
0.00631679187, -0.02120713774, -0.06034222549, -0.06737971493, -0.02466344307, 0.01574220616, 3.67816873865, 0.01817359276, 0.00511780538, 
0.06717006338, 0.06206760303, -0.04353428003, -0.03033956305, -0.00535023233, -0.06992876937, -0.10020345332, -0.04323120694, 0.00399287988, 
3.01849213684,-0.00696500762, 0.00784220761, 0.00337317617, -0.00771413903, 0.03016416594, 0.02404299199, 0.00752992866, 0.01211247641, 
0.01442465011, 0.00162618787, 0.00646325736, 0.18377741575,0.06172376263, 0.03093119587, 0.00519357485, -0.00720735363, -0.02268228948, 
-0.03428031321, 0.01599783772, -0.01470977952, -0.00498472297, -0.03734476303, -0.03712904004, 2.95905626288), ncol=5)) 

## and last 4 values of TS 

YY <- t(matrix(c(-0.55367226, 3.276980, -0.57634682, 3.827854, 4.248918, -0.57806007, 3.254492, -0.61281320, 3.835869, 4.280090, -0.51697066, 
3.300236, -0.55756556, 3.815981, 4.274613, -0.47619582, 3.320164, -0.48689008, 3.793915, 4.216955), 5)) 

Given those information, how I can predict values for next 2 steps? 

Thanks,

--- On Mon, 12/13/10, Pfaff, Bernhard Dr. <Bernhard_Pfaff at fra.invesco.com> wrote:

> From: Pfaff, Bernhard Dr. <Bernhard_Pfaff at fra.invesco.com>
> Subject: AW: [R-SIG-Finance] Forcasting VAR/VEC
> To: "Megh" <megh700004 at yahoo.com>, r-sig-finance at stat.math.ethz.ch
> Date: Monday, December 13, 2010, 2:19 PM
> ?vars::predict 
> 
> > -----Urspr?ngliche Nachricht-----
> > Von: r-sig-finance-bounces at r-project.org
> 
> > [mailto:r-sig-finance-bounces at r-project.org]
> Im Auftrag von Megh
> > Gesendet: Montag, 13. Dezember 2010 07:57
> > An: r-sig-finance at stat.math.ethz.ch
> > Betreff: [R-SIG-Finance] Forcasting VAR/VEC
> > 
> > 
> > Hi dears, I am looking for some function to predict
> through 
> > horizon "h", say, given the corefficients of a VAR/VEC
> model. 
> > I have moderately gone through packages "urca" &
> "vars" but 
> > did not find any significant:
> > 
> > > ls("package:vars")
> >? [1] "A"? ? ? ? ? ?
> ? "Acoef"? ? ? ? ?
> "arch"? ? ? ? ???
> > "arch.test"? ? ? "B"? ?
> ? ? ? ???
> > "Bcoef"? ? ? ? ? "BQ"?
> ? ? ? ?
> ???"causality"? ???
> >? [9] "fanchart"? ?
> ???"fevd"? ? ? ?
> ???"irf"? ? ? ? ?
> ? 
> > "normality"? ???
> > "normality.test" "Phi"? ? ? ?
> ? ? "Psi"? ? ? ? ? ?
> "restrict"? ? ? 
> > [17] "roots"? ? ? ? ?
> "serial"? ? ?
> ???"serial.test"? ? 
> > "stability"? ???
> > "SVAR"? ? ? ?
> ???"SVEC"? ? ? ?
> ???"VAR"? ? ? ? ?
> ? "VARselect"? ???
> > [25] "vec2var"? ? ???
> > > ls("package:urca")
> >? [1] "ablrtest"? ? ?
> "alphaols"? ? ? "alrtest"? ?
> ???"bh5lrtest"? ? 
> > "bh6lrtest"? ???"blrtest"?
> ? ???"ca.jo"? ? ?
> ???"ca.po"? ? ? ? 
> >? [9] "cajolst"? ?
> ???"cajools"? ?
> ???"cajorls"? ?
> ???"lttest" 
> >? ? ? ? "plot"? ? ?
> ???
> > "plotres"? ?
> ???"punitroot"?
> ???"qunitroot"? ? 
> > [17] "summary"? ?
> ???"unitrootTable" "ur.df"? ?
> ? ???"ur.ers"? ?
> ???
> > "ur.kpss"? ? ???"ur.pp"?
> ? ? ???"ur.sp"? ? ?
> ???"ur.za"? ? ???
> > 
> > Can somebofy help in finding any relevant function for
> prediction?
> > 
> > Thanks,
> > --
> > View this message in context: 
> > http://r.789695.n4.nabble.com/Forcasting-VAR-VEC-tp3084994p308
> 4994.html
> > Sent from the Rmetrics mailing list archive at
> Nabble.com.
> > 
> > _______________________________________________
> > R-SIG-Finance at r-project.org
> mailing list 
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post,
> subscribe first.
> > -- Also note that this is not the r-help list where
> general R 
> > questions should go.
> > 
> *****************************************************************
> Confidentiality Note: The information contained in this
> message,
> and any attachments, may contain confidential and/or
> privileged
> material. It is intended solely for the person(s) or entity
> to
> which it is addressed. Any review, retransmission,
> dissemination,
> or taking of any action in reliance upon this information
> by
> persons or entities other than the intended recipient(s)
> is
> prohibited. If you received this in error, please contact
> the
> sender and delete the material from any computer.
> *****************************************************************
> 
> 





From satimis at yahoo.com  Wed Dec 15 06:01:56 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Tue, 14 Dec 2010 21:01:56 -0800 (PST)
Subject: [R-SIG-Finance] About yahooImport to display output on R console
Message-ID: <375493.82041.qm@web113204.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101214/7f61ec03/attachment.pl>

From jeff.a.ryan at gmail.com  Wed Dec 15 06:08:55 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Tue, 14 Dec 2010 23:08:55 -0600
Subject: [R-SIG-Finance] About yahooImport to display output on R console
In-Reply-To: <375493.82041.qm@web113204.mail.gq1.yahoo.com>
References: <375493.82041.qm@web113204.mail.gq1.yahoo.com>
Message-ID: <AANLkTimFnvSN_REO+STrv=895hUMHpiPX1CQthRvEHv9@mail.gmail.com>

Hi Stephen,

Try:

library(quantmod)

getSymbols("IBM")
getSymbols("IBM", src="google")

Both will autoload into your global environment, though this is settable.

HTH
Jeff

On Tue, Dec 14, 2010 at 11:01 PM, Stephen Liu <satimis at yahoo.com> wrote:
> Hi all,
>
> OS - Ubuntu 1010 desktop 64bit w/o gui
>
>> require('fImport')
> Loading required package: fImport
> Loading required package: timeDate
> Loading required package: timeSeries
>
>> yahooImport("IBM")
> trying URL
> 'http://chart.yahoo.com/table.csv?s=IBM&a=&b=&c=&d=11&e=15&f=2010&g=d&x=.csv'
> Content type 'text/csv' length unknown
> opened URL
> .......... .......... .......... .......... ..........
> .......... .......... .......... .......... ..........
> .......... .......
> downloaded 617 Kb
>
> It won't display the data on R console
>
>
> I must run;
>> yahooImport("IBM", file="IBM.csv", save=T)
> to save the file.
>
>> list.files(getwd(), full.name=T)
> ?[1] "/home/satimisub1010dk02/Desktop"
> ?[2] "/home/satimisub1010dk02/Documents"
> ?[3] "/home/satimisub1010dk02/Downloads"
> ?[4] "/home/satimisub1010dk02/examples.desktop"
> ?[5] "/home/satimisub1010dk02/IBM.csv"
> .....
> ....
>
>
> I looked at ?yahooImport and couldn't resolve making it display the stock data
> on R console. ?Any advice?
>
>
> Besides is there a tool to download stock data from Google finance instead of
> using their download tool?
>
> TIA
>
> B.R.
> Stephen L
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>



-- 
Jeffrey Ryan
jeffrey.ryan at lemnica.com

www.lemnica.com


From stephen at organicfoodmarkets.com.au  Wed Dec 15 06:22:31 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 15 Dec 2010 16:22:31 +1100
Subject: [R-SIG-Finance] placeOrder
Message-ID: <4D085097.5000105@organicfoodmarkets.com.au>

Hi

I don't want to stray into an IB issues so I already trawled their site 
and made sure I have ticked bypass API precautions so I', hoping this is 
a IBrokers issues.   Sorry if it is not.

When I try to do this:

 > tws <- twsConnect()
 > tws
<twsConnection,1 @ 20101215 15:46:12 Eastern Standard Time (New South 
Wales), nextId=>
 > id<- reqIds(tws)
 > x <-placeOrder(tws, twsEquity('CBA','SNFE','AUD'), twsOrder(id, 
'BUY', '100', 'MKT'))
 >
 >
 > closeAllConnections()
 > x
NULL
 >

I don't get an order through to the TWS but I don't get any information 
why not.  I can get prices, etc no problems.

I even tried this, as I have seen it in Jeffs code:

tws
<twsConnection,1 @ 20101215 15:56:26 Eastern Standard Time (New South 
Wales), nextId=56>
 > id<- reqIds(tws)
 > IBrokers:::.placeOrder(tws, twsEquity('CBA','SNFE','AUD'), 
twsOrder(55, 'BUY', '50', 'MKT'))
 >
 >
 > closeAllConnections()

but to no avail.



-- 
Stephen Choularton Ph.D., FIoD


From satimis at yahoo.com  Wed Dec 15 06:27:45 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Tue, 14 Dec 2010 21:27:45 -0800 (PST)
Subject: [R-SIG-Finance] About yahooImport to display output on R console
In-Reply-To: <AANLkTimFnvSN_REO+STrv=895hUMHpiPX1CQthRvEHv9@mail.gmail.com>
References: <375493.82041.qm@web113204.mail.gq1.yahoo.com>
	<AANLkTimFnvSN_REO+STrv=895hUMHpiPX1CQthRvEHv9@mail.gmail.com>
Message-ID: <703144.82763.qm@web113203.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101214/96f684d0/attachment.pl>

From satimis at yahoo.com  Wed Dec 15 08:18:28 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Tue, 14 Dec 2010 23:18:28 -0800 (PST)
Subject: [R-SIG-Finance] How check IBrokers
Message-ID: <191493.88372.qm@web113202.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101214/a431875b/attachment.pl>

From corey at coreygallon.com  Wed Dec 15 20:13:37 2010
From: corey at coreygallon.com (Corey Gallon)
Date: Wed, 15 Dec 2010 19:13:37 +0000
Subject: [R-SIG-Finance] CRSP and R
Message-ID: <979DD7967E2630469AF05D1820F561C104AE52@BL2PRD0103MB005.prod.exchangelabs.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101215/7bd7b8bf/attachment.pl>

From brian at braverock.com  Wed Dec 15 20:18:47 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 15 Dec 2010 13:18:47 -0600
Subject: [R-SIG-Finance] CRSP and R
In-Reply-To: <979DD7967E2630469AF05D1820F561C104AE52@BL2PRD0103MB005.prod.exchangelabs.com>
References: <979DD7967E2630469AF05D1820F561C104AE52@BL2PRD0103MB005.prod.exchangelabs.com>
Message-ID: <4D091497.9070504@braverock.com>

On 12/15/2010 01:13 PM, Corey Gallon wrote:
> I am using the CRSP US Stock&  US Indices database.  CRSP seems to favor the use of SAS with their data, but I am curious if the community has found using R with CRSP data to be manageable and what, if any, tools or libraries are available to R programmers to facilitate analysis of CRSP data.
>
> Your thoughts and feedback will be appreciated.

You could likely help us, and yourself, out if you told us a little more 
about the format of the data and what you're trying to do.

- how do you obtain the data?
- what format are the files in?
- is this just instrument prices, or also fundamentals data?
- what type of analysis do you want to do?
- what analytical tools and techniques do you need for that analysis?
- what have you tried already in R to use this data?


Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Wed Dec 15 20:49:27 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 15 Dec 2010 13:49:27 -0600
Subject: [R-SIG-Finance] Problems with quantstrat and my own code
In-Reply-To: <4bd961381586420b2deb24ced0e57f1b@braverock.com>
References: <AANLkTing3U1EAMX0cmrVot3FZ=CHS4QdGEJC27Rp5O6C@mail.gmail.com>
	<4bd961381586420b2deb24ced0e57f1b@braverock.com>
Message-ID: <4D091BC7.5050108@braverock.com>

I located a subtle bug in the nextIndex function inside applyRules 
(which is in turn called by applyStrategy).  It didn't affect all 
instruments or strategies, so it took a little while to locate and fix it.

R-Forge svn r500 contains the fix.

Thanks for the report.  Attached please find the pdf output from 
chart.Posn() of the 'faber' example code run on instrument 'TYC'

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


On 12/14/2010 04:57 AM, Brian G. Peterson wrote:
> OK, first, to your question:
>
> There is no book that will teach you modeling in R.  Strategy modeling is
> a very complex and often proprietary task.  There are many books that
> purport to teach strategy modeling.  All the ones I own are pretty bad.
> None of them use R.  Some of them are useful as a compilation of common
> widely known strategy parameters, indicators, signals, and rules.
>
> There's a reason that successful quantitative strategists are well
> compensated: what we do is hard, and involves art, science, math, and a
> little bit of luck.  'quantstrat', and the rest of the toolchain, represent
> tools that you can use to make you more productive as you create
> strategies.
>
> Second, to your problems.
>
> 1>  quantstrat
>
> That's a *Warning*, not an *Error*, and is coming out of xts somewhere,
> probably in subsetting, since we do so much of that.  Because it is a
> Warning, and not an Error, I haven't taken the time to figure out where it
> is and either code around it or suppress it.
>
> 2>  your code
>
> I'm not going to debug your ad-hoc strategy code for you, sorry.  Every
> time I set out to write an ad-hoc backtest of a strategy, I screw
> *something* up. We wrote a framework to concentrate the bugs in one place,
> so that we could eliminate them one at a time, and spend more time actually
> modeling strategies. Another way of putting that would be that we we wrote
> the framework so that we could have a different kind of discussion with the
> user of our open source code.  That discussion would look something like
> this:
>
> "I ran the quantstrat demo('faber') code on instrument 'TYC' and
> instrument 'XLY', pdf's of chart.Posn() attached.
> I believe the demo code for market orders is creating incorrect results
> here<insert detailed description>  by<insert your hypothesis of what is
> wrong>. Could someone please check this and let me know?  I'd be happy to
> help patch the code.  Thanks."
>
> Since I think that's probably more or less what you meant, I'll take a
> look at the faber demo on TYC and XLY when I get to the office, and look
> for any obvious problems with the trades and P&L.  If you've found
> something specific that might raise concerns (all the data is available
> either  in the output of applyStrategy or in the portfolio to double-check
> the indicators, signals, and rules), please share.
>
> Regards,
>
>    - Brian
>
>
> On Tue, 14 Dec 2010 00:53:33 -0600, Aaditya Nanduri
> <aaditya.nanduri at gmail.com>  wrote:
>> Hello All,
>>
>> I have 2 problems and 1 question today.
>>
>> QUESTION : Are there any book that teach modelling in R? Hopefully an
>> introductory book. I would like to learn how to build/backtest
> strategies,
>> so if there are any introductory books, please share.
>>
>> PROBLEMS:
>> 1) Quantstrat
>>
>> I tried to use the Faber demo but changed all the symbols to just "TYC"
>> and I get the following errors:
>>     .
>>     .
>>     .
>>   # Process the indicators and generate trades
>>> start_t<-Sys.time()
>>> out<-try(applyStrategy(strategy=stratFaber , portfolios='faber'))
>> *Warning message:*
>> *In max(i) : no non-missing arguments to max; returning -Inf*
>>> end_t<-Sys.time()
>>     .
>>     .
>>     .
>> *Warning messages:*
>> *1: In max(i) : no non-missing arguments to max; returning -Inf*
>> *2: In max(i) : no non-missing arguments to max; returning -Inf*
>>
>> I have no idea what they mean...
>>
>> 2) My code:
>>
>>
>> I know this code is wrong but I dont know where the error is. To me, it
>> seems right. But when I ran "XLY" through the faber demo and the code I
>> wrote, the end results couldnt be further from each other.
>> I also know that my code is highly inefficient so if there are any
> helpful
>> hints that you would like to throw my way, I am open to everything.
>>
>>
> ------------------------------------------------CODE-----------------------------------
>> library(quantmod)
>>
>> # Get Data
>> getSymbols("TYC", from = "1998-01-01", to = Sys.Date())
>>
>> # Convert from daily to monthly
>> x<- get(TYC)
>> x<- to.monthly(XLY, indexAt = 'lastof', drop.time= TRUE)
>> indexFormat(x)<- '%Y-%m-%d'
>> colnames(x)<- gsub("x", "XLY", colnames(x))
>> assign("XLY", x)
>>
>> price<- as.numeric(Cl(XLY))
>> # Build indicators
>> sma10<- SMA(price, n=10)
>>
>> for(i in 1:length(price)){ buy[i]<- NA; sell[i]<- NA }
>> # Buy signal
>> buy[which(price>  sma10)]<- 1
>> buy[which(is.na(buy))]<- 0
>>
>> # Sell signal
>> sell[which(price<  sma10)]<- -1
>> sell[which(is.na(sell))]<- 0
>>
>> signal<- buy + sell
>> signal[which(is.na(signal))]<- 0
>>
>> x<- NA
>>
>> for(i in 1:length(signal)){
>>   # Start with buying not selling
>> if(signal[i-1] == 0&&  signal[i] == -1) {
>> signal[i] = 0
>> }
>> }
>>
>> for(i in 1:length(signal)){
>>
>> if(signal[i-1] == 0&&  signal[i] == 1) {
>> x[i]<- 1
>> }
>> if(signal[i-1] == -1&&  signal[i] == 1) {
>> x[i]<- 1
>> }
>> if(signal[i-1] == 1&&  signal[i] == -1) {
>> x[i]<- -1
>> }
>> }
>>
>> x[which(is.na(x))]<- 0
>>
>> money<- 100000 ->  initEq
>> stock<- 0
>> numinP<- 0
>>
>> for(i in 1:length(x)){
>>   if(x[i] == 1) {
>> p<- price[i]
>> b<- floor(money/p)
>> numinP<- numinP + b
>> money<- money - p*b
>> stock<- p*b
>>   }
>> if(x[i] == -1) {
>> p<- price[i]
>> money<- money + p*numinP
>> stock<- 0
>> numinP<- 0
>> }
>> }
>>
>> total<- money + stock
>> print(paste("The initial equity:",initEq))
>> print(paste("After 10 years of trading using TAA:",total))
>>
>>
>> I appreciate all your help
>>
>> --
>> Aaditya Nanduri
>> aaditya.nanduri at gmail.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: quantstratTYCfaber_test.pdf
Type: application/pdf
Size: 42870 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101215/fb300286/attachment.pdf>

From matthieu.stigler at gmail.com  Thu Dec 16 10:17:06 2010
From: matthieu.stigler at gmail.com (mat)
Date: Thu, 16 Dec 2010 10:17:06 +0100
Subject: [R-SIG-Finance] Forcasting VAR/VEC
In-Reply-To: <534878.24427.qm@web58102.mail.re3.yahoo.com>
References: <534878.24427.qm@web58102.mail.re3.yahoo.com>
Message-ID: <4D09D912.2070504@gmail.com>


library(vars)
data(Canada)
modeleVAR<-VAR(Canada, p=2)

class(modeleVAR) # so you have your varest object!
predict(modeleVAR, n.ahead=3)

Hope this helps?

Matthieu

Le 14. 12. 10 18:38, Megh Dal a ?crit :
> I tied to post it through Nabble, however it perhaps failed........ Here is my query. Your help will be highly appreciated.
>
> I found a direct problem while implementing predict method. To use that, I need to give values for argument "object":
>
> object: An object of class ??varest??; generated by ?VAR()?, or an
>            object of class ??vec2var??; generated by ?vec2var()?.
>
> Here what I have I the estimated coefficients and last few values (required for prediction). Given those, how can I construct object of that class?
>
> For example, I have VAR[2] model with estimated coefficients:
>
> A1<- t(matrix(c(-0.9444135,  0.5289205,  1.54338344, -1.2059849,  0.08658383, -0.7626375, 0.5384060,  1.34211012, -0.1540462,  0.07684465,
> -1.5000912,  0.5975748,  2.08629175, -1.3629879,  0.16405863,  0.5622497, -0.5749668, -0.01207330,  1.6547463, -0.37280903, -1.1190102,
> 0.4834678,  1.04152221, -0.5084529,  0.91748918), 5))
>
> A2<- t(matrix(c(-0.5281084,  0.6750694, -0.00700632,  0.5744008, -0.540538174, -0.5115759,  0.6663074, -0.03690401,  0.1015040,
> -0.483984397, -0.6669159,  0.7810531, -0.08478713,  0.2837110, -0.634807434,  0.2474859, -0.2126529,  -0.04611398, -0.2851814, -0.003198122,
> 0.1136257, -0.4070806, -0.15362813,  0.1043871, -0.570401589), 5))
>
> ## and deterministic terms with monthly seasonal dummy (11 dummy variables + constant):
>
> Mu<- t(matrix(c(0.01971314683, 7.392074e-05, 0.06745512042, 0.03066764063, -0.05716243051, -0.01666261294, -0.02648375478, -0.07739940822,
> -0.08537205872, -0.03454705454, 0.01026347102, 3.93408495893, 0.01124435027, 0.00826573416, 0.07232184812, 0.02643898799, -0.02290620244,
> 0.00631679187, -0.02120713774, -0.06034222549, -0.06737971493, -0.02466344307, 0.01574220616, 3.67816873865, 0.01817359276, 0.00511780538,
> 0.06717006338, 0.06206760303, -0.04353428003, -0.03033956305, -0.00535023233, -0.06992876937, -0.10020345332, -0.04323120694, 0.00399287988,
> 3.01849213684,-0.00696500762, 0.00784220761, 0.00337317617, -0.00771413903, 0.03016416594, 0.02404299199, 0.00752992866, 0.01211247641,
> 0.01442465011, 0.00162618787, 0.00646325736, 0.18377741575,0.06172376263, 0.03093119587, 0.00519357485, -0.00720735363, -0.02268228948,
> -0.03428031321, 0.01599783772, -0.01470977952, -0.00498472297, -0.03734476303, -0.03712904004, 2.95905626288), ncol=5))
>
> ## and last 4 values of TS
>
> YY<- t(matrix(c(-0.55367226, 3.276980, -0.57634682, 3.827854, 4.248918, -0.57806007, 3.254492, -0.61281320, 3.835869, 4.280090, -0.51697066,
> 3.300236, -0.55756556, 3.815981, 4.274613, -0.47619582, 3.320164, -0.48689008, 3.793915, 4.216955), 5))
>
> Given those information, how I can predict values for next 2 steps?
>
> Thanks,
>
> --- On Mon, 12/13/10, Pfaff, Bernhard Dr.<Bernhard_Pfaff at fra.invesco.com>  wrote:
>
>> From: Pfaff, Bernhard Dr.<Bernhard_Pfaff at fra.invesco.com>
>> Subject: AW: [R-SIG-Finance] Forcasting VAR/VEC
>> To: "Megh"<megh700004 at yahoo.com>, r-sig-finance at stat.math.ethz.ch
>> Date: Monday, December 13, 2010, 2:19 PM
>> ?vars::predict
>>
>>> -----Urspr?ngliche Nachricht-----
>>> Von: r-sig-finance-bounces at r-project.org
>>> [mailto:r-sig-finance-bounces at r-project.org]
>> Im Auftrag von Megh
>>> Gesendet: Montag, 13. Dezember 2010 07:57
>>> An: r-sig-finance at stat.math.ethz.ch
>>> Betreff: [R-SIG-Finance] Forcasting VAR/VEC
>>>
>>>
>>> Hi dears, I am looking for some function to predict
>> through
>>> horizon "h", say, given the corefficients of a VAR/VEC
>> model.
>>> I have moderately gone through packages "urca"&
>> "vars" but
>>> did not find any significant:
>>>
>>>> ls("package:vars")
>>>    [1] "A"
>>    "Acoef"         
>> "arch"
>>> "arch.test"      "B"
>>
>>> "Bcoef"          "BQ"
>>         
>>     "causality"
>>>    [9] "fanchart"
>>     "fevd"       
>>     "irf"
>>
>>> "normality"     
>>> "normality.test" "Phi"
>>      "Psi"           
>> "restrict"
>>> [17] "roots"
>> "serial"     
>>     "serial.test"
>>> "stability"     
>>> "SVAR"
>>     "SVEC"       
>>     "VAR"         
>>    "VARselect"
>>> [25] "vec2var"
>>>> ls("package:urca")
>>>    [1] "ablrtest"
>> "alphaols"      "alrtest"   
>>     "bh5lrtest"
>>> "bh6lrtest"     "blrtest"
>>       "ca.jo"     
>>     "ca.po"
>>>    [9] "cajolst"
>>     "cajools"   
>>     "cajorls"   
>>     "lttest"
>>>          "plot"
>>
>>> "plotres"
>>     "punitroot" 
>>     "qunitroot"
>>> [17] "summary"
>>     "unitrootTable" "ur.df"   
>>       "ur.ers"
>>
>>> "ur.kpss"       "ur.pp"
>>         "ur.sp"     
>>     "ur.za"
>>> Can somebofy help in finding any relevant function for
>> prediction?
>>> Thanks,
>>> --
>>> View this message in context:
>>> http://r.789695.n4.nabble.com/Forcasting-VAR-VEC-tp3084994p308
>> 4994.html
>>> Sent from the Rmetrics mailing list archive at
>> Nabble.com.
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org
>> mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post,
>> subscribe first.
>>> -- Also note that this is not the r-help list where
>> general R
>>> questions should go.
>>>
>> *****************************************************************
>> Confidentiality Note: The information contained in this
>> message,
>> and any attachments, may contain confidential and/or
>> privileged
>> material. It is intended solely for the person(s) or entity
>> to
>> which it is addressed. Any review, retransmission,
>> dissemination,
>> or taking of any action in reliance upon this information
>> by
>> persons or entities other than the intended recipient(s)
>> is
>> prohibited. If you received this in error, please contact
>> the
>> sender and delete the material from any computer.
>> *****************************************************************
>>
>>
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From m_hofert at web.de  Thu Dec 16 13:41:51 2010
From: m_hofert at web.de (Marius Hofert)
Date: Thu, 16 Dec 2010 13:41:51 +0100
Subject: [R-SIG-Finance] How to obtain data from *all* companies in the S&P
	500 + sector information?
Message-ID: <D9C8BCB5-4E3F-4DCA-9CC4-CDC96F0DD68E@web.de>

Dear expeRts,

Is it possible to obtain quotes from all companies of the S&P 500 via R?
I know that I can use the following code to get historical data from the index, but what about the 500 companies?

If this is possible, is it also possible to obtain the GICS sector information (see http://en.wikipedia.org/wiki/Global_Industry_Classification_Standard) for each of the 500 companies? Basically, the sector information is given here:
http://en.wikipedia.org/wiki/List_of_S%26P_500_companies (it suffices to have the sector information [not the industry groups etc.])
The problem would then be to match the sector information with the companies. I once obtained the 500 time series from Thompson Datastream and tried to match the GICS sectors (obtained from the webpage) by hand, which was very tedious and prone to errors. That's why I'm asking.

Cheers,

Marius

## ==== snippet start ====

library(quantmod)
sp500.sym <- getSymbols("^GSPC") 
sp500 <- get(sp500.sym)
sp500. <- sp500["2009-01-01::2010-01-01",4] # end-day quotes

## ==== snippet end ====

From brian at braverock.com  Thu Dec 16 13:56:28 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 16 Dec 2010 06:56:28 -0600
Subject: [R-SIG-Finance] How to obtain data from *all* companies in the
 S&P	500 + sector information?
In-Reply-To: <D9C8BCB5-4E3F-4DCA-9CC4-CDC96F0DD68E@web.de>
References: <D9C8BCB5-4E3F-4DCA-9CC4-CDC96F0DD68E@web.de>
Message-ID: <4D0A0C7C.70507@braverock.com>

On 12/16/2010 06:41 AM, Marius Hofert wrote:
> Dear expeRts,
>
> Is it possible to obtain quotes from all companies of the S&P 500 via R?
> I know that I can use the following code to get historical data from the index, but what about the 500 companies?
>
> If this is possible, is it also possible to obtain the GICS sector information (see http://en.wikipedia.org/wiki/Global_Industry_Classification_Standard) for each of the 500 companies? Basically, the sector information is given here:
> http://en.wikipedia.org/wiki/List_of_S%26P_500_companies (it suffices to have the sector information [not the industry groups etc.])
> The problem would then be to match the sector information with the companies. I once obtained the 500 time series from Thompson Datastream and tried to match the GICS sectors (obtained from the webpage) by hand, which was very tedious and prone to errors. That's why I'm asking.

I use the FinancialInstrument package to store instrument metadata on a 
couple thousand instruments.  Then you can slice and dice by building 
hierarchies as you like.  Peter Carl is working to make that slicing and 
dicing more transparent.

Basically, the full GICS data is a commercial product, and you have to 
pay for it.

'quotes', e.g. tick data, will likewise have to come from a commercial 
source.  There are many, many posts here in the list archives about 
connecting to commercial services like Bloomberg, Interactive Brokers, 
and Reuters.

Daily OHLC data is of course available from Google and Yahoo, and both 
may be accessed via getSymbols()

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From risk2009 at ath.forthnet.gr  Thu Dec 16 15:21:19 2010
From: risk2009 at ath.forthnet.gr (Costas)
Date: Thu, 16 Dec 2010 16:21:19 +0200
Subject: [R-SIG-Finance] getSymbols problem in quantmod
Message-ID: <4D0A205F.7000205@ath.forthnet.gr>

Hi,

It seems that getting SP500 daily prices before 1980 or so from 
yahoo.finance via the getSymbols() in quantmod becomes problematic:

> > getSymbols('^GSPC',src='yahoo',  from='1950-01-03', 
> return.class='xts');tail(GSPC)
> [1] "GSPC"
>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
> GSPC.Adjusted
> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
> 1240.46
> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
> 1241.59
> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
> 1235.23
> <NA>          100.18    100.74    99.36      99.85    13880000         
> 99.85
> <NA>           80.86     81.45    80.49      81.10     5070000         
> 81.10
> <NA>           18.05     18.05    18.05      18.05     2950000         
> 18.05
> > getSymbols('^GSPC',src='yahoo',  from='2010-01-03', 
> return.class='xts');tail(GSPC)
> [1] "GSPC"
>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
> GSPC.Adjusted
> 2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000       
> 1228.28
> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
> 1233.00
> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
> 1240.40
> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
> 1240.46
> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
> 1241.59
> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
> 1235.23
> > getSymbols('^GSPC',src='yahoo',  from='1990-01-03', 
> return.class='xts');tail(GSPC)
> [1] "GSPC"
>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
> GSPC.Adjusted
> 2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000       
> 1228.28
> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
> 1233.00
> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
> 1240.40
> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
> 1240.46
> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
> 1241.59
> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
> 1235.23
> > getSymbols('^GSPC',src='yahoo',  from='1980-01-03', 
> return.class='xts');tail(GSPC)
> [1] "GSPC"
>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
> GSPC.Adjusted
> 2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000       
> 1228.28
> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
> 1233.00
> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
> 1240.40
> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
> 1240.46
> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
> 1241.59
> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
> 1235.23
> > getSymbols('^GSPC',src='yahoo',  from='1970-01-03', 
> return.class='xts');tail(GSPC)
> [1] "GSPC"
>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
> GSPC.Adjusted
> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
> 1233.00
> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
> 1240.40
> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
> 1240.46
> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
> 1241.59
> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
> 1235.23
> <NA>          100.18    100.74    99.36      99.85    13880000         
> 99.85
> >
Look at the appended data row under the last dated price.....

Why so?

Anyone else with the same problems out there?

Best,
Costas


From breman.mark at gmail.com  Thu Dec 16 15:25:35 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Thu, 16 Dec 2010 15:25:35 +0100
Subject: [R-SIG-Finance] getSymbols problem in quantmod
In-Reply-To: <4D0A205F.7000205@ath.forthnet.gr>
References: <4D0A205F.7000205@ath.forthnet.gr>
Message-ID: <AANLkTik3dm4XH=uMuQ_3BYfd+38W3xFeogMGUHS-kpmM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101216/e64f1b6a/attachment.pl>

From risk2009 at ath.forthnet.gr  Thu Dec 16 15:29:06 2010
From: risk2009 at ath.forthnet.gr (Costas)
Date: Thu, 16 Dec 2010 16:29:06 +0200
Subject: [R-SIG-Finance] getSymbols problem in quantmod
In-Reply-To: <4D0A205F.7000205@ath.forthnet.gr>
References: <4D0A205F.7000205@ath.forthnet.gr>
Message-ID: <4D0A2232.5030300@ath.forthnet.gr>

WRT my previous email, I am using R:

platform       i386-pc-mingw32
arch           i386
os             mingw32
system         i386, mingw32
status
major          2
minor          12.0
year           2010
month          10
day            15
svn rev        53317
language       R
version.string R version 2.12.0 (2010-10-15)

On a windows XP machine....

I seems that the same code in a linux platform (Ubuntu) exhibits no such 
problem...

The data downloads ok...

So I assume it is a problem of the windows quantmod library....

I hope this helps...


On 16/12/2010 16:21, Costas wrote:
> Hi,
>
> It seems that getting SP500 daily prices before 1980 or so from 
> yahoo.finance via the getSymbols() in quantmod becomes problematic:
>
>> > getSymbols('^GSPC',src='yahoo',  from='1950-01-03', 
>> return.class='xts');tail(GSPC)
>> [1] "GSPC"
>>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
>> GSPC.Adjusted
>> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
>> 1240.46
>> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
>> 1241.59
>> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
>> 1235.23
>> <NA>          100.18    100.74    99.36      99.85    
>> 13880000         99.85
>> <NA>           80.86     81.45    80.49      81.10     
>> 5070000         81.10
>> <NA>           18.05     18.05    18.05      18.05     
>> 2950000         18.05
>> > getSymbols('^GSPC',src='yahoo',  from='2010-01-03', 
>> return.class='xts');tail(GSPC)
>> [1] "GSPC"
>>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
>> GSPC.Adjusted
>> 2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000       
>> 1228.28
>> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
>> 1233.00
>> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
>> 1240.40
>> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
>> 1240.46
>> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
>> 1241.59
>> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
>> 1235.23
>> > getSymbols('^GSPC',src='yahoo',  from='1990-01-03', 
>> return.class='xts');tail(GSPC)
>> [1] "GSPC"
>>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
>> GSPC.Adjusted
>> 2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000       
>> 1228.28
>> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
>> 1233.00
>> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
>> 1240.40
>> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
>> 1240.46
>> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
>> 1241.59
>> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
>> 1235.23
>> > getSymbols('^GSPC',src='yahoo',  from='1980-01-03', 
>> return.class='xts');tail(GSPC)
>> [1] "GSPC"
>>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
>> GSPC.Adjusted
>> 2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000       
>> 1228.28
>> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
>> 1233.00
>> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
>> 1240.40
>> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
>> 1240.46
>> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
>> 1241.59
>> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
>> 1235.23
>> > getSymbols('^GSPC',src='yahoo',  from='1970-01-03', 
>> return.class='xts');tail(GSPC)
>> [1] "GSPC"
>>            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume 
>> GSPC.Adjusted
>> 2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000       
>> 1233.00
>> 2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000       
>> 1240.40
>> 2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       
>> 1240.46
>> 2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       
>> 1241.59
>> 2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       
>> 1235.23
>> <NA>          100.18    100.74    99.36      99.85    
>> 13880000         99.85
>> >
> Look at the appended data row under the last dated price.....
>
> Why so?
>
> Anyone else with the same problems out there?
>
> Best,
> Costas


From josh.m.ulrich at gmail.com  Thu Dec 16 15:32:41 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 16 Dec 2010 08:32:41 -0600
Subject: [R-SIG-Finance] getSymbols problem in quantmod
In-Reply-To: <4D0A2232.5030300@ath.forthnet.gr>
References: <4D0A205F.7000205@ath.forthnet.gr>
	<4D0A2232.5030300@ath.forthnet.gr>
Message-ID: <AANLkTim576BYS62zQDubEkGhnVUmOViBrFHLVS8vrYsQ@mail.gmail.com>

Costas,

Thanks for the session info.  Please tell us which version of quantmod
you are using.  I cannot replicate your issue using the latest
quantmod from CRAN or from r-forge. I am using Windows XP.

Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Thu, Dec 16, 2010 at 8:29 AM, Costas <risk2009 at ath.forthnet.gr> wrote:
> WRT my previous email, I am using R:
>
> platform ? ? ? i386-pc-mingw32
> arch ? ? ? ? ? i386
> os ? ? ? ? ? ? mingw32
> system ? ? ? ? i386, mingw32
> status
> major ? ? ? ? ?2
> minor ? ? ? ? ?12.0
> year ? ? ? ? ? 2010
> month ? ? ? ? ?10
> day ? ? ? ? ? ?15
> svn rev ? ? ? ?53317
> language ? ? ? R
> version.string R version 2.12.0 (2010-10-15)
>
> On a windows XP machine....
>
> I seems that the same code in a linux platform (Ubuntu) exhibits no such
> problem...
>
> The data downloads ok...
>
> So I assume it is a problem of the windows quantmod library....
>
> I hope this helps...
>
>
> On 16/12/2010 16:21, Costas wrote:
>>
>> Hi,
>>
>> It seems that getting SP500 daily prices before 1980 or so from
>> yahoo.finance via the getSymbols() in quantmod becomes problematic:
>>
>>> > getSymbols('^GSPC',src='yahoo', ?from='1950-01-03',
>>> > return.class='xts');tail(GSPC)
>>> [1] "GSPC"
>>> ? ? ? ? ? GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>> GSPC.Adjusted
>>> 2010-12-13 ? 1242.52 ? 1246.73 ?1240.34 ? ?1240.46 ?4361240000
>>> 1240.46
>>> 2010-12-14 ? 1241.84 ? 1246.59 ?1238.17 ? ?1241.59 ?4132350000
>>> 1241.59
>>> 2010-12-15 ? 1241.58 ? 1244.25 ?1234.01 ? ?1235.23 ?4407340000
>>> 1235.23
>>> <NA> ? ? ? ? ?100.18 ? ?100.74 ? ?99.36 ? ? ?99.85 ? ?13880000
>>> 99.85
>>> <NA> ? ? ? ? ? 80.86 ? ? 81.45 ? ?80.49 ? ? ?81.10 ? ? 5070000
>>> 81.10
>>> <NA> ? ? ? ? ? 18.05 ? ? 18.05 ? ?18.05 ? ? ?18.05 ? ? 2950000
>>> 18.05
>>> > getSymbols('^GSPC',src='yahoo', ?from='2010-01-03',
>>> > return.class='xts');tail(GSPC)
>>> [1] "GSPC"
>>> ? ? ? ? ? GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>> GSPC.Adjusted
>>> 2010-12-08 ? 1225.02 ? 1228.93 ?1219.50 ? ?1228.28 ?4607590000
>>> 1228.28
>>> 2010-12-09 ? 1230.14 ? 1234.71 ?1226.85 ? ?1233.00 ?4522510000
>>> 1233.00
>>> 2010-12-10 ? 1233.85 ? 1240.40 ?1232.58 ? ?1240.40 ?4547310000
>>> 1240.40
>>> 2010-12-13 ? 1242.52 ? 1246.73 ?1240.34 ? ?1240.46 ?4361240000
>>> 1240.46
>>> 2010-12-14 ? 1241.84 ? 1246.59 ?1238.17 ? ?1241.59 ?4132350000
>>> 1241.59
>>> 2010-12-15 ? 1241.58 ? 1244.25 ?1234.01 ? ?1235.23 ?4407340000
>>> 1235.23
>>> > getSymbols('^GSPC',src='yahoo', ?from='1990-01-03',
>>> > return.class='xts');tail(GSPC)
>>> [1] "GSPC"
>>> ? ? ? ? ? GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>> GSPC.Adjusted
>>> 2010-12-08 ? 1225.02 ? 1228.93 ?1219.50 ? ?1228.28 ?4607590000
>>> 1228.28
>>> 2010-12-09 ? 1230.14 ? 1234.71 ?1226.85 ? ?1233.00 ?4522510000
>>> 1233.00
>>> 2010-12-10 ? 1233.85 ? 1240.40 ?1232.58 ? ?1240.40 ?4547310000
>>> 1240.40
>>> 2010-12-13 ? 1242.52 ? 1246.73 ?1240.34 ? ?1240.46 ?4361240000
>>> 1240.46
>>> 2010-12-14 ? 1241.84 ? 1246.59 ?1238.17 ? ?1241.59 ?4132350000
>>> 1241.59
>>> 2010-12-15 ? 1241.58 ? 1244.25 ?1234.01 ? ?1235.23 ?4407340000
>>> 1235.23
>>> > getSymbols('^GSPC',src='yahoo', ?from='1980-01-03',
>>> > return.class='xts');tail(GSPC)
>>> [1] "GSPC"
>>> ? ? ? ? ? GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>> GSPC.Adjusted
>>> 2010-12-08 ? 1225.02 ? 1228.93 ?1219.50 ? ?1228.28 ?4607590000
>>> 1228.28
>>> 2010-12-09 ? 1230.14 ? 1234.71 ?1226.85 ? ?1233.00 ?4522510000
>>> 1233.00
>>> 2010-12-10 ? 1233.85 ? 1240.40 ?1232.58 ? ?1240.40 ?4547310000
>>> 1240.40
>>> 2010-12-13 ? 1242.52 ? 1246.73 ?1240.34 ? ?1240.46 ?4361240000
>>> 1240.46
>>> 2010-12-14 ? 1241.84 ? 1246.59 ?1238.17 ? ?1241.59 ?4132350000
>>> 1241.59
>>> 2010-12-15 ? 1241.58 ? 1244.25 ?1234.01 ? ?1235.23 ?4407340000
>>> 1235.23
>>> > getSymbols('^GSPC',src='yahoo', ?from='1970-01-03',
>>> > return.class='xts');tail(GSPC)
>>> [1] "GSPC"
>>> ? ? ? ? ? GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>> GSPC.Adjusted
>>> 2010-12-09 ? 1230.14 ? 1234.71 ?1226.85 ? ?1233.00 ?4522510000
>>> 1233.00
>>> 2010-12-10 ? 1233.85 ? 1240.40 ?1232.58 ? ?1240.40 ?4547310000
>>> 1240.40
>>> 2010-12-13 ? 1242.52 ? 1246.73 ?1240.34 ? ?1240.46 ?4361240000
>>> 1240.46
>>> 2010-12-14 ? 1241.84 ? 1246.59 ?1238.17 ? ?1241.59 ?4132350000
>>> 1241.59
>>> 2010-12-15 ? 1241.58 ? 1244.25 ?1234.01 ? ?1235.23 ?4407340000
>>> 1235.23
>>> <NA> ? ? ? ? ?100.18 ? ?100.74 ? ?99.36 ? ? ?99.85 ? ?13880000
>>> 99.85
>>> >
>>
>> Look at the appended data row under the last dated price.....
>>
>> Why so?
>>
>> Anyone else with the same problems out there?
>>
>> Best,
>> Costas
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From risk2009 at ath.forthnet.gr  Thu Dec 16 15:36:03 2010
From: risk2009 at ath.forthnet.gr (Costas)
Date: Thu, 16 Dec 2010 16:36:03 +0200
Subject: [R-SIG-Finance] getSymbols problem in quantmod
In-Reply-To: <AANLkTik3dm4XH=uMuQ_3BYfd+38W3xFeogMGUHS-kpmM@mail.gmail.com>
References: <4D0A205F.7000205@ath.forthnet.gr>
	<AANLkTik3dm4XH=uMuQ_3BYfd+38W3xFeogMGUHS-kpmM@mail.gmail.com>
Message-ID: <4D0A23D3.1060200@ath.forthnet.gr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101216/840e4173/attachment.pl>

From risk2009 at ath.forthnet.gr  Thu Dec 16 15:42:12 2010
From: risk2009 at ath.forthnet.gr (Costas)
Date: Thu, 16 Dec 2010 16:42:12 +0200
Subject: [R-SIG-Finance] getSymbols problem in quantmod
Message-ID: <4D0A2544.9060606@ath.forthnet.gr>

Dear Josh,

Under windows:

Package: quantmod
Type: Package
Title: Quantitative Financial Modelling Framework
Version: 0.3-15
Date: 2010-12-01
Author: Jeffrey A. Ryan
Depends: Defaults, xts(>= 0.7-5), zoo, TTR(>= 0.2), methods
Suggests: DBI,RMySQL,RSQLite,timeSeries,its
Maintainer: Jeffrey A. Ryan<jeff.a.ryan at gmail.com>
Description: Specify, build, trade, and analyse quantitative financial
         trading strategies
LazyLoad: yes
License: GPL-3
URL: http://www.quantmod.com
         http://r-forge.r-project.org/projects/quantmod
Packaged: 2010-12-01 12:35:17 UTC; jryan
Repository: CRAN
Date/Publication: 2010-12-01 14:30:16
Built: R 2.12.0; ; 2010-12-04 13:19:33 UTC; windows

This is what I get:


R version 2.12.0 (2010-10-15)
Copyright (C) 2010 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i386-pc-mingw32/i386 (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

   Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

>  library(quantmod)
Loading required package: Defaults
Loading required package: xts
Loading required package: zoo
Loading required package: TTR
>  library(quantmod)
>
>  #setSymbolLookup(^GSPC='yahoo')
>  getSymbols('^GSPC', from='1950-01-01')
[1] "GSPC"
>  tail(GSPC)
            GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
GSPC.Adjusted
2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000       1240.46
2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000       1241.59
2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000       1235.23
<NA>           100.18    100.74    99.36      99.85    13880000         99.85
<NA>            80.86     81.45    80.49      81.10     5070000         81.10
<NA>            18.05     18.05    18.05      18.05     2950000         18.05
>

Best,
Costas

On 16/12/2010 16:32, Joshua Ulrich wrote:
>  Costas,
>
>  Thanks for the session info.  Please tell us which version of quantmod
>  you are using.  I cannot replicate your issue using the latest
>  quantmod from CRAN or from r-forge. I am using Windows XP.
>
>  Best,
>  --
>  Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
>  On Thu, Dec 16, 2010 at 8:29 AM, Costas<risk2009 at ath.forthnet.gr>   wrote:
>>  WRT my previous email, I am using R:
>>
>>  platform       i386-pc-mingw32
>>  arch           i386
>>  os             mingw32
>>  system         i386, mingw32
>>  status
>>  major          2
>>  minor          12.0
>>  year           2010
>>  month          10
>>  day            15
>>  svn rev        53317
>>  language       R
>>  version.string R version 2.12.0 (2010-10-15)
>>
>>  On a windows XP machine....
>>
>>  I seems that the same code in a linux platform (Ubuntu) exhibits no such
>>  problem...
>>
>>  The data downloads ok...
>>
>>  So I assume it is a problem of the windows quantmod library....
>>
>>  I hope this helps...
>>
>>
>>  On 16/12/2010 16:21, Costas wrote:
>>>  Hi,
>>>
>>>  It seems that getting SP500 daily prices before 1980 or so from
>>>  yahoo.finance via the getSymbols() in quantmod becomes problematic:
>>>
>>>>>  getSymbols('^GSPC',src='yahoo',  from='1950-01-03',
>>>>>  return.class='xts');tail(GSPC)
>>>>  [1] "GSPC"
>>>>             GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>>>  GSPC.Adjusted
>>>>  2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000
>>>>  1240.46
>>>>  2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000
>>>>  1241.59
>>>>  2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000
>>>>  1235.23
>>>>  <NA>             100.18    100.74    99.36      99.85    13880000
>>>>  99.85
>>>>  <NA>              80.86     81.45    80.49      81.10     5070000
>>>>  81.10
>>>>  <NA>              18.05     18.05    18.05      18.05     2950000
>>>>  18.05
>>>>>  getSymbols('^GSPC',src='yahoo',  from='2010-01-03',
>>>>>  return.class='xts');tail(GSPC)
>>>>  [1] "GSPC"
>>>>             GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>>>  GSPC.Adjusted
>>>>  2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000
>>>>  1228.28
>>>>  2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000
>>>>  1233.00
>>>>  2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000
>>>>  1240.40
>>>>  2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000
>>>>  1240.46
>>>>  2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000
>>>>  1241.59
>>>>  2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000
>>>>  1235.23
>>>>>  getSymbols('^GSPC',src='yahoo',  from='1990-01-03',
>>>>>  return.class='xts');tail(GSPC)
>>>>  [1] "GSPC"
>>>>             GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>>>  GSPC.Adjusted
>>>>  2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000
>>>>  1228.28
>>>>  2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000
>>>>  1233.00
>>>>  2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000
>>>>  1240.40
>>>>  2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000
>>>>  1240.46
>>>>  2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000
>>>>  1241.59
>>>>  2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000
>>>>  1235.23
>>>>>  getSymbols('^GSPC',src='yahoo',  from='1980-01-03',
>>>>>  return.class='xts');tail(GSPC)
>>>>  [1] "GSPC"
>>>>             GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>>>  GSPC.Adjusted
>>>>  2010-12-08   1225.02   1228.93  1219.50    1228.28  4607590000
>>>>  1228.28
>>>>  2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000
>>>>  1233.00
>>>>  2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000
>>>>  1240.40
>>>>  2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000
>>>>  1240.46
>>>>  2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000
>>>>  1241.59
>>>>  2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000
>>>>  1235.23
>>>>>  getSymbols('^GSPC',src='yahoo',  from='1970-01-03',
>>>>>  return.class='xts');tail(GSPC)
>>>>  [1] "GSPC"
>>>>             GSPC.Open GSPC.High GSPC.Low GSPC.Close GSPC.Volume
>>>>  GSPC.Adjusted
>>>>  2010-12-09   1230.14   1234.71  1226.85    1233.00  4522510000
>>>>  1233.00
>>>>  2010-12-10   1233.85   1240.40  1232.58    1240.40  4547310000
>>>>  1240.40
>>>>  2010-12-13   1242.52   1246.73  1240.34    1240.46  4361240000
>>>>  1240.46
>>>>  2010-12-14   1241.84   1246.59  1238.17    1241.59  4132350000
>>>>  1241.59
>>>>  2010-12-15   1241.58   1244.25  1234.01    1235.23  4407340000
>>>>  1235.23
>>>>  <NA>             100.18    100.74    99.36      99.85    13880000
>>>>  99.85
>>>  Look at the appended data row under the last dated price.....
>>>
>>>  Why so?
>>>
>>>  Anyone else with the same problems out there?
>>>
>>>  Best,
>>>  Costas
>>  _______________________________________________
>>  R-SIG-Finance at r-project.org mailing list
>>  https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>  -- Subscriber-posting only. If you want to post, subscribe first.
>>  -- Also note that this is not the r-help list where general R questions
>>  should go.
>>


From alan.lue at gmail.com  Thu Dec 16 17:41:35 2010
From: alan.lue at gmail.com (Alan Lue)
Date: Thu, 16 Dec 2010 08:41:35 -0800
Subject: [R-SIG-Finance] CRSP and R
In-Reply-To: <4D091497.9070504@braverock.com>
References: <979DD7967E2630469AF05D1820F561C104AE52@BL2PRD0103MB005.prod.exchangelabs.com>
	<4D091497.9070504@braverock.com>
Message-ID: <AANLkTikFNJZbYvCmxqNwKPx9-NQcPh8FjigBx4-D2x4o@mail.gmail.com>

I haven't experience any problems using CRSP with R.  If you're using
WRDS to get CRSP data, you might use the following output settings:

? Output format: tab-delimited text (*.txt)
? Date format: YYMMDDs10. (e.g. 1984/07/25)

Then use read.delim() with the 'colClasses' argument set to "Date" for
the date column, and R should load the dates correctly.

Alan Lue


On Wed, Dec 15, 2010 at 11:18 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 12/15/2010 01:13 PM, Corey Gallon wrote:
>>
>> I am using the CRSP US Stock& ?US Indices database. ?CRSP seems to favor
>> the use of SAS with their data, but I am curious if the community has found
>> using R with CRSP data to be manageable and what, if any, tools or libraries
>> are available to R programmers to facilitate analysis of CRSP data.
>>
>> Your thoughts and feedback will be appreciated.
>
> You could likely help us, and yourself, out if you told us a little more
> about the format of the data and what you're trying to do.
>
> - how do you obtain the data?
> - what format are the files in?
> - is this just instrument prices, or also fundamentals data?
> - what type of analysis do you want to do?
> - what analytical tools and techniques do you need for that analysis?
> - what have you tried already in R to use this data?
>
>
> Regards,
>
> ?- Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
Alan Lue
Master of Financial Engineering
UCLA Anderson School of Management


From m_hofert at web.de  Thu Dec 16 21:05:54 2010
From: m_hofert at web.de (mhofert)
Date: Thu, 16 Dec 2010 12:05:54 -0800 (PST)
Subject: [R-SIG-Finance] How to obtain data from *all* companies in the
 S&P	500 + sector information?
In-Reply-To: <4D0A0C7C.70507@braverock.com>
References: <D9C8BCB5-4E3F-4DCA-9CC4-CDC96F0DD68E@web.de>
	<4D0A0C7C.70507@braverock.com>
Message-ID: <1292529954304-3091558.post@n4.nabble.com>


Dear Brian,

thank you for your quick response. 
Unfortunately, I wasn't able to install "FinancialInstrument" from R-forge
via 

install.packages("FinancialInstrument",
repos="http://R-Forge.R-project.org"):
> install.packages("FinancialInstrument",
> repos="http://R-Forge.R-project.org")
Warning in install.packages("FinancialInstrument", repos =
"http://R-Forge.R-project.org") :
  argument 'lib' is missing: using '/Users/user/Library/R/2.11/library'
Warning message:
In getDependencies(pkgs, dependencies, available, lib) :
  package ?FinancialInstrument? is not available

Cheers,

Marius
-- 
View this message in context: http://r.789695.n4.nabble.com/How-to-obtain-data-from-all-companies-in-the-S-P-500-sector-information-tp3090759p3091558.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From josh.m.ulrich at gmail.com  Thu Dec 16 21:07:40 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Thu, 16 Dec 2010 14:07:40 -0600
Subject: [R-SIG-Finance] How to obtain data from *all* companies in the
 S&P 500 + sector information?
In-Reply-To: <1292529954304-3091558.post@n4.nabble.com>
References: <D9C8BCB5-4E3F-4DCA-9CC4-CDC96F0DD68E@web.de>
	<4D0A0C7C.70507@braverock.com>
	<1292529954304-3091558.post@n4.nabble.com>
Message-ID: <AANLkTi=tQsHauzH_LsV9S8ku+_LtfQTTmY1Fa8xHNFsE@mail.gmail.com>

You need to upgrade to R-2.12.0.
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Thu, Dec 16, 2010 at 2:05 PM, mhofert <m_hofert at web.de> wrote:
>
> Dear Brian,
>
> thank you for your quick response.
> Unfortunately, I wasn't able to install "FinancialInstrument" from R-forge
> via
>
> install.packages("FinancialInstrument",
> repos="http://R-Forge.R-project.org"):
>> install.packages("FinancialInstrument",
>> repos="http://R-Forge.R-project.org")
> Warning in install.packages("FinancialInstrument", repos =
> "http://R-Forge.R-project.org") :
> ?argument 'lib' is missing: using '/Users/user/Library/R/2.11/library'
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
> ?package ?FinancialInstrument? is not available
>
> Cheers,
>
> Marius
> --
> View this message in context: http://r.789695.n4.nabble.com/How-to-obtain-data-from-all-companies-in-the-S-P-500-sector-information-tp3090759p3091558.html
> Sent from the Rmetrics mailing list archive at Nabble.com.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From satimis at yahoo.com  Fri Dec 17 10:17:26 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Fri, 17 Dec 2010 01:17:26 -0800 (PST)
Subject: [R-SIG-Finance] Where to download odbcConnectExcel2007
Message-ID: <6033.54056.qm@web113210.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101217/ec330e89/attachment.pl>

From breman.mark at gmail.com  Fri Dec 17 10:53:41 2010
From: breman.mark at gmail.com (Mark Breman)
Date: Fri, 17 Dec 2010 10:53:41 +0100
Subject: [R-SIG-Finance] Where to download odbcConnectExcel2007
In-Reply-To: <6033.54056.qm@web113210.mail.gq1.yahoo.com>
References: <6033.54056.qm@web113210.mail.gq1.yahoo.com>
Message-ID: <AANLkTi=yB7QfhBCayY0UUv=xvP_Q9pWCx9Hc9Ud3e2Q4@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101217/ffcc3da3/attachment.pl>

From satimis at yahoo.com  Fri Dec 17 14:39:18 2010
From: satimis at yahoo.com (Stephen Liu)
Date: Fri, 17 Dec 2010 05:39:18 -0800 (PST)
Subject: [R-SIG-Finance] Where to download odbcConnectExcel2007
In-Reply-To: <AANLkTi=yB7QfhBCayY0UUv=xvP_Q9pWCx9Hc9Ud3e2Q4@mail.gmail.com>
References: <6033.54056.qm@web113210.mail.gq1.yahoo.com>
	<AANLkTi=yB7QfhBCayY0UUv=xvP_Q9pWCx9Hc9Ud3e2Q4@mail.gmail.com>
Message-ID: <777273.21709.qm@web113206.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101217/937b8a60/attachment.pl>

From brian at braverock.com  Fri Dec 17 15:03:26 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 17 Dec 2010 08:03:26 -0600
Subject: [R-SIG-Finance] Where to download odbcConnectExcel2007
In-Reply-To: <777273.21709.qm@web113206.mail.gq1.yahoo.com>
References: <6033.54056.qm@web113210.mail.gq1.yahoo.com>	<AANLkTi=yB7QfhBCayY0UUv=xvP_Q9pWCx9Hc9Ud3e2Q4@mail.gmail.com>
	<777273.21709.qm@web113206.mail.gq1.yahoo.com>
Message-ID: <4D0B6DAE.8050504@braverock.com>

On 12/17/2010 07:39 AM, Stephen Liu wrote:
> Hi Mark,
>
> Ok. Thanks
>
> I was testing "Export to multiple-sheet xls file in R" on a Win7 64bit PC.
>
> On running;
>> xlsFile<- odbcConnectExcel("C:\\Temp\\test.xls", readOnly = FALSE
>
> it complained saying 32 bit odbcConnectExcel can't work.
>
>
> Then I googled around and found;
>
> 4.3.2 Package RODBC
>
> On "R Data Import/Export"
>
> http://bioinformatics.holstegelab.nl/manuals/R/doc/manual/R-data.html
>
> it said "There are versions for Excel 2007 and Access 2007 (go to
> http://download.microsoft.com, select `Office' and search for `ODBC', which will
> lead to AccessDatabaseEngine.exe).
>
>
> Following their link I found the URL in my original posting.
>
>
> I'll post my question on MS Excel forum.

You may also get more help on the r-help list.  the r-data doc is not 
finance specific, even if your work is.

If you do choose to post to R-Help, make sure you proved the 'R' context 
of what you're trying to do.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From megh700004 at yahoo.com  Fri Dec 17 16:37:02 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Fri, 17 Dec 2010 07:37:02 -0800 (PST)
Subject: [R-SIG-Finance] Forcasting VAR/VEC
In-Reply-To: <4D09D912.2070504@gmail.com>
Message-ID: <719480.37395.qm@web58103.mail.re3.yahoo.com>

Thanks Mat for your reply. However this is not what I wanted. I already have the coefficients estimated and using those estimated coefficients I want to forecast. Here your input is TS data, from that data you have estimated coefficients, which is of specific class. Therefore you could use directly predict() function.

As I have coefficients in Matrix class, I cant convert them to specific class for prediction. Is there any way to do that?

2ndly I wondering how without the initial values i.e. last few observations of TS, predict() function in your example could actually predict?

Thanks,


--- On Thu, 12/16/10, mat <matthieu.stigler at gmail.com> wrote:

> From: mat <matthieu.stigler at gmail.com>
> Subject: Re: [R-SIG-Finance] Forcasting VAR/VEC
> To: "Megh Dal" <megh700004 at yahoo.com>, "R Finance" <r-sig-finance at stat.math.ethz.ch>, "Dr. Bernhard Pfaff" <bernhard at pfaffikus.de>
> Date: Thursday, December 16, 2010, 2:47 PM
> 
> library(vars)
> data(Canada)
> modeleVAR<-VAR(Canada, p=2)
> 
> class(modeleVAR) # so you have your varest object!
> predict(modeleVAR, n.ahead=3)
> 
> Hope this helps?
> 
> Matthieu
> 
> Le 14. 12. 10 18:38, Megh Dal a ?crit :
> > I tied to post it through Nabble, however it perhaps
> failed........ Here is my query. Your help will be highly
> appreciated.
> > 
> > I found a direct problem while implementing predict
> method. To use that, I need to give values for argument
> "object":
> > 
> > object: An object of class ??varest??;
> generated by ?VAR()?, or an
> >? ? ? ? ? ? object of
> class ??vec2var??; generated by ?vec2var()?.
> > 
> > Here what I have I the estimated coefficients and last
> few values (required for prediction). Given those, how can I
> construct object of that class?
> > 
> > For example, I have VAR[2] model with estimated
> coefficients:
> > 
> > A1<- t(matrix(c(-0.9444135,? 0.5289205,?
> 1.54338344, -1.2059849,? 0.08658383, -0.7626375,
> 0.5384060,? 1.34211012, -0.1540462,? 0.07684465,
> > -1.5000912,? 0.5975748,? 2.08629175,
> -1.3629879,? 0.16405863,? 0.5622497, -0.5749668,
> -0.01207330,? 1.6547463, -0.37280903, -1.1190102,
> > 0.4834678,? 1.04152221, -0.5084529,?
> 0.91748918), 5))
> > 
> > A2<- t(matrix(c(-0.5281084,? 0.6750694,
> -0.00700632,? 0.5744008, -0.540538174,
> -0.5115759,? 0.6663074, -0.03690401,? 0.1015040,
> > -0.483984397, -0.6669159,? 0.7810531,
> -0.08478713,? 0.2837110, -0.634807434,? 0.2474859,
> -0.2126529,? -0.04611398, -0.2851814, -0.003198122,
> > 0.1136257, -0.4070806, -0.15362813,? 0.1043871,
> -0.570401589), 5))
> > 
> > ## and deterministic terms with monthly seasonal dummy
> (11 dummy variables + constant):
> > 
> > Mu<- t(matrix(c(0.01971314683, 7.392074e-05,
> 0.06745512042, 0.03066764063, -0.05716243051,
> -0.01666261294, -0.02648375478, -0.07739940822,
> > -0.08537205872, -0.03454705454, 0.01026347102,
> 3.93408495893, 0.01124435027, 0.00826573416, 0.07232184812,
> 0.02643898799, -0.02290620244,
> > 0.00631679187, -0.02120713774, -0.06034222549,
> -0.06737971493, -0.02466344307, 0.01574220616,
> 3.67816873865, 0.01817359276, 0.00511780538,
> > 0.06717006338, 0.06206760303, -0.04353428003,
> -0.03033956305, -0.00535023233, -0.06992876937,
> -0.10020345332, -0.04323120694, 0.00399287988,
> > 3.01849213684,-0.00696500762, 0.00784220761,
> 0.00337317617, -0.00771413903, 0.03016416594, 0.02404299199,
> 0.00752992866, 0.01211247641,
> > 0.01442465011, 0.00162618787, 0.00646325736,
> 0.18377741575,0.06172376263, 0.03093119587, 0.00519357485,
> -0.00720735363, -0.02268228948,
> > -0.03428031321, 0.01599783772, -0.01470977952,
> -0.00498472297, -0.03734476303, -0.03712904004,
> 2.95905626288), ncol=5))
> > 
> > ## and last 4 values of TS
> > 
> > YY<- t(matrix(c(-0.55367226, 3.276980, -0.57634682,
> 3.827854, 4.248918, -0.57806007, 3.254492, -0.61281320,
> 3.835869, 4.280090, -0.51697066,
> > 3.300236, -0.55756556, 3.815981, 4.274613,
> -0.47619582, 3.320164, -0.48689008, 3.793915, 4.216955),
> 5))
> > 
> > Given those information, how I can predict values for
> next 2 steps?
> > 
> > Thanks,
> > 
> > --- On Mon, 12/13/10, Pfaff, Bernhard Dr.<Bernhard_Pfaff at fra.invesco.com>?
> wrote:
> > 
> >> From: Pfaff, Bernhard Dr.<Bernhard_Pfaff at fra.invesco.com>
> >> Subject: AW: [R-SIG-Finance] Forcasting VAR/VEC
> >> To: "Megh"<megh700004 at yahoo.com>,
> r-sig-finance at stat.math.ethz.ch
> >> Date: Monday, December 13, 2010, 2:19 PM
> >> ?vars::predict
> >> 
> >>> -----Urspr?ngliche Nachricht-----
> >>> Von: r-sig-finance-bounces at r-project.org
> >>> [mailto:r-sig-finance-bounces at r-project.org]
> >> Im Auftrag von Megh
> >>> Gesendet: Montag, 13. Dezember 2010 07:57
> >>> An: r-sig-finance at stat.math.ethz.ch
> >>> Betreff: [R-SIG-Finance] Forcasting VAR/VEC
> >>> 
> >>> 
> >>> Hi dears, I am looking for some function to
> predict
> >> through
> >>> horizon "h", say, given the corefficients of a
> VAR/VEC
> >> model.
> >>> I have moderately gone through packages
> "urca"&
> >> "vars" but
> >>> did not find any significant:
> >>> 
> >>>> ls("package:vars")
> >>>? ? [1] "A"
> >>? ? "Acoef"? ? ?
> ???"arch"
> >>> "arch.test"? ? ? "B"
> >> 
> >>> "Bcoef"? ? ? ? ?
> "BQ"
> >>? ? ? ? ?
> ???"causality"
> >>>? ? [9] "fanchart"
> >>? ???"fevd"? ? ?
> ? ???"irf"
> >> 
> >>> "normality"?
> ???"normality.test" "Phi"
> >>? ? ? "Psi"? ? ?
> ? ???"restrict"
> >>> [17] "roots"
> >> "serial"? ? ?
> ???"serial.test"
> >>> "stability"? ???"SVAR"
> >>? ???"SVEC"? ? ?
> ? ???"VAR"? ? ? ?
> ? ? "VARselect"
> >>> [25] "vec2var"
> >>>> ls("package:urca")
> >>>? ? [1] "ablrtest"
> >> "alphaols"? ? ? "alrtest"?
> ? ???"bh5lrtest"
> >>> "bh6lrtest"? ???"blrtest"
> >>? ? ???"ca.jo"?
> ? ? ???"ca.po"
> >>>? ? [9] "cajolst"
> >>? ???"cajools"? ?
> ???"cajorls"? ?
> ???"lttest"
> >>>? ? ? ? ? "plot"
> >> 
> >>> "plotres"
> >>? ???"punitroot"?
> ???"qunitroot"
> >>> [17] "summary"
> >>? ???"unitrootTable"
> "ur.df"? ? ? ???"ur.ers"
> >> 
> >>> "ur.kpss"? ?
> ???"ur.pp"
> >>? ? ?
> ???"ur.sp"? ? ?
> ???"ur.za"
> >>> Can somebofy help in finding any relevant
> function for
> >> prediction?
> >>> Thanks,
> >>> --
> >>> View this message in context:
> >>> http://r.789695.n4.nabble.com/Forcasting-VAR-VEC-tp3084994p308
> >> 4994.html
> >>> Sent from the Rmetrics mailing list archive
> at
> >> Nabble.com.
> >>>
> _______________________________________________
> >>> R-SIG-Finance at r-project.org
> >> mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >>> -- Subscriber-posting only. If you want to
> post,
> >> subscribe first.
> >>> -- Also note that this is not the r-help list
> where
> >> general R
> >>> questions should go.
> >>> 
> >>
> *****************************************************************
> >> Confidentiality Note: The information contained in
> this
> >> message,
> >> and any attachments, may contain confidential
> and/or
> >> privileged
> >> material. It is intended solely for the person(s)
> or entity
> >> to
> >> which it is addressed. Any review,
> retransmission,
> >> dissemination,
> >> or taking of any action in reliance upon this
> information
> >> by
> >> persons or entities other than the intended
> recipient(s)
> >> is
> >> prohibited. If you received this in error, please
> contact
> >> the
> >> sender and delete the material from any computer.
> >>
> *****************************************************************
> >> 
> >> 
> > 
> > 
> > 
> > _______________________________________________
> > R-SIG-Finance at r-project.org
> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post,
> subscribe first.
> > -- Also note that this is not the r-help list where
> general R questions should go.
> 
> 





From brian at braverock.com  Fri Dec 17 17:35:43 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 17 Dec 2010 10:35:43 -0600
Subject: [R-SIG-Finance] Forcasting VAR/VEC
In-Reply-To: <719480.37395.qm@web58103.mail.re3.yahoo.com>
References: <719480.37395.qm@web58103.mail.re3.yahoo.com>
Message-ID: <4D0B915F.9020302@braverock.com>

On 12/17/2010 09:37 AM, Megh Dal wrote:
> Thanks Mat for your reply. However this is not what I wanted. I already have the coefficients estimated and using those estimated coefficients I want to forecast. Here your input is TS data, from that data you have estimated coefficients, which is of specific class. Therefore you could use directly predict() function.

Not what you wanted is different from what you asked, which was how to 
predict a VAR/VEC model.  Bernhard and Mat have given you an answer 
which is not what you wanted to hear, which seems to be that someone 
else would magically have invented the same custom data format that you 
choose to use?

> As I have coefficients in Matrix class, I cant convert them to specific class for prediction. Is there any way to do that?

Then you will likely have to modify the predict() function to either 
take the coefficients directly, or you will have to take your custom 
non-package-compliant Matrix and format it into a vars object like that 
that predict() is .

see

?vars::VAR

for the format of the 'varest' list to give you input on what you will 
need to do to transform your data so that it will work with predict()

> 2ndly I wondering how without the initial values i.e. last few observations of TS, predict() function in your example could actually predict?

You need the data to make a prediction.  Period.

   - Brian

> --- On Thu, 12/16/10, mat<matthieu.stigler at gmail.com>  wrote:
>
>> From: mat<matthieu.stigler at gmail.com>
>> Subject: Re: [R-SIG-Finance] Forcasting VAR/VEC
>> To: "Megh Dal"<megh700004 at yahoo.com>, "R Finance"<r-sig-finance at stat.math.ethz.ch>, "Dr. Bernhard Pfaff"<bernhard at pfaffikus.de>
>> Date: Thursday, December 16, 2010, 2:47 PM
>>
>> library(vars)
>> data(Canada)
>> modeleVAR<-VAR(Canada, p=2)
>>
>> class(modeleVAR) # so you have your varest object!
>> predict(modeleVAR, n.ahead=3)
>>
>> Hope this helps?
>>
>> Matthieu
>>
>> Le 14. 12. 10 18:38, Megh Dal a ?crit :
>>> I tied to post it through Nabble, however it perhaps
>> failed........ Here is my query. Your help will be highly
>> appreciated.
>>>
>>> I found a direct problem while implementing predict
>> method. To use that, I need to give values for argument
>> "object":
>>>
>>> object: An object of class ??varest??;
>> generated by ?VAR()?, or an
>>>              object of
>> class ??vec2var??; generated by ?vec2var()?.
>>>
>>> Here what I have I the estimated coefficients and last
>> few values (required for prediction). Given those, how can I
>> construct object of that class?
>>>
>>> For example, I have VAR[2] model with estimated
>> coefficients:
>>>
>>> A1<- t(matrix(c(-0.9444135,  0.5289205,
>> 1.54338344, -1.2059849,  0.08658383, -0.7626375,
>> 0.5384060,  1.34211012, -0.1540462,  0.07684465,
>>> -1.5000912,  0.5975748,  2.08629175,
>> -1.3629879,  0.16405863,  0.5622497, -0.5749668,
>> -0.01207330,  1.6547463, -0.37280903, -1.1190102,
>>> 0.4834678,  1.04152221, -0.5084529,
>> 0.91748918), 5))
>>>
>>> A2<- t(matrix(c(-0.5281084,  0.6750694,
>> -0.00700632,  0.5744008, -0.540538174,
>> -0.5115759,  0.6663074, -0.03690401,  0.1015040,
>>> -0.483984397, -0.6669159,  0.7810531,
>> -0.08478713,  0.2837110, -0.634807434,  0.2474859,
>> -0.2126529,  -0.04611398, -0.2851814, -0.003198122,
>>> 0.1136257, -0.4070806, -0.15362813,  0.1043871,
>> -0.570401589), 5))
>>>
>>> ## and deterministic terms with monthly seasonal dummy
>> (11 dummy variables + constant):
>>>
>>> Mu<- t(matrix(c(0.01971314683, 7.392074e-05,
>> 0.06745512042, 0.03066764063, -0.05716243051,
>> -0.01666261294, -0.02648375478, -0.07739940822,
>>> -0.08537205872, -0.03454705454, 0.01026347102,
>> 3.93408495893, 0.01124435027, 0.00826573416, 0.07232184812,
>> 0.02643898799, -0.02290620244,
>>> 0.00631679187, -0.02120713774, -0.06034222549,
>> -0.06737971493, -0.02466344307, 0.01574220616,
>> 3.67816873865, 0.01817359276, 0.00511780538,
>>> 0.06717006338, 0.06206760303, -0.04353428003,
>> -0.03033956305, -0.00535023233, -0.06992876937,
>> -0.10020345332, -0.04323120694, 0.00399287988,
>>> 3.01849213684,-0.00696500762, 0.00784220761,
>> 0.00337317617, -0.00771413903, 0.03016416594, 0.02404299199,
>> 0.00752992866, 0.01211247641,
>>> 0.01442465011, 0.00162618787, 0.00646325736,
>> 0.18377741575,0.06172376263, 0.03093119587, 0.00519357485,
>> -0.00720735363, -0.02268228948,
>>> -0.03428031321, 0.01599783772, -0.01470977952,
>> -0.00498472297, -0.03734476303, -0.03712904004,
>> 2.95905626288), ncol=5))
>>>
>>> ## and last 4 values of TS
>>>
>>> YY<- t(matrix(c(-0.55367226, 3.276980, -0.57634682,
>> 3.827854, 4.248918, -0.57806007, 3.254492, -0.61281320,
>> 3.835869, 4.280090, -0.51697066,
>>> 3.300236, -0.55756556, 3.815981, 4.274613,
>> -0.47619582, 3.320164, -0.48689008, 3.793915, 4.216955),
>> 5))
>>>
>>> Given those information, how I can predict values for
>> next 2 steps?
>>>
>>> Thanks,
>>>
>>> --- On Mon, 12/13/10, Pfaff, Bernhard Dr.<Bernhard_Pfaff at fra.invesco.com>
>> wrote:
>>>
>>>> From: Pfaff, Bernhard Dr.<Bernhard_Pfaff at fra.invesco.com>
>>>> Subject: AW: [R-SIG-Finance] Forcasting VAR/VEC
>>>> To: "Megh"<megh700004 at yahoo.com>,
>> r-sig-finance at stat.math.ethz.ch
>>>> Date: Monday, December 13, 2010, 2:19 PM
>>>> ?vars::predict
>>>>
>>>>> -----Urspr?ngliche Nachricht-----
>>>>> Von: r-sig-finance-bounces at r-project.org
>>>>> [mailto:r-sig-finance-bounces at r-project.org]
>>>> Im Auftrag von Megh
>>>>> Gesendet: Montag, 13. Dezember 2010 07:57
>>>>> An: r-sig-finance at stat.math.ethz.ch
>>>>> Betreff: [R-SIG-Finance] Forcasting VAR/VEC
>>>>>
>>>>>
>>>>> Hi dears, I am looking for some function to
>> predict
>>>> through
>>>>> horizon "h", say, given the corefficients of a
>> VAR/VEC
>>>> model.
>>>>> I have moderately gone through packages
>> "urca"&
>>>> "vars" but
>>>>> did not find any significant:
>>>>>
>>>>>> ls("package:vars")
>>>>>      [1] "A"
>>>>      "Acoef"
>>     "arch"
>>>>> "arch.test"      "B"
>>>>
>>>>> "Bcoef"
>> "BQ"
>>>>
>>     "causality"
>>>>>      [9] "fanchart"
>>>>       "fevd"
>>       "irf"
>>>>
>>>>> "normality"
>>     "normality.test" "Phi"
>>>>        "Psi"
>>       "restrict"
>>>>> [17] "roots"
>>>> "serial"
>>     "serial.test"
>>>>> "stability"     "SVAR"
>>>>       "SVEC"
>>       "VAR"
>>      "VARselect"
>>>>> [25] "vec2var"
>>>>>> ls("package:urca")
>>>>>      [1] "ablrtest"
>>>> "alphaols"      "alrtest"
>>       "bh5lrtest"
>>>>> "bh6lrtest"     "blrtest"
>>>>         "ca.jo"
>>         "ca.po"
>>>>>      [9] "cajolst"
>>>>       "cajools"
>>     "cajorls"
>>     "lttest"
>>>>>            "plot"
>>>>
>>>>> "plotres"
>>>>       "punitroot"
>>     "qunitroot"
>>>>> [17] "summary"
>>>>       "unitrootTable"
>> "ur.df"         "ur.ers"
>>>>
>>>>> "ur.kpss"
>>     "ur.pp"
>>>>
>>     "ur.sp"
>>     "ur.za"
>>>>> Can somebofy help in finding any relevant
>> function for
>>>> prediction?
>>>>> Thanks,
>>>>> --
>>>>> View this message in context:
>>>>> http://r.789695.n4.nabble.com/Forcasting-VAR-VEC-tp3084994p308
>>>> 4994.html
>>>>> Sent from the Rmetrics mailing list archive
>> at
>>>> Nabble.com.
>>>>>
>> _______________________________________________
>>>>> R-SIG-Finance at r-project.org
>>>> mailing list
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>>> -- Subscriber-posting only. If you want to
>> post,
>>>> subscribe first.
>>>>> -- Also note that this is not the r-help list
>> where
>>>> general R
>>>>> questions should go.
>>>>>
>>>>
>> *****************************************************************
>>>> Confidentiality Note: The information contained in
>> this
>>>> message,
>>>> and any attachments, may contain confidential
>> and/or
>>>> privileged
>>>> material. It is intended solely for the person(s)
>> or entity
>>>> to
>>>> which it is addressed. Any review,
>> retransmission,
>>>> dissemination,
>>>> or taking of any action in reliance upon this
>> information
>>>> by
>>>> persons or entities other than the intended
>> recipient(s)
>>>> is
>>>> prohibited. If you received this in error, please
>> contact
>>>> the
>>>> sender and delete the material from any computer.
>>>>
>> *****************************************************************
>>>>
>>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org
>> mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post,
>> subscribe first.
>>> -- Also note that this is not the r-help list where
>> general R questions should go.
>>
>>
>
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From leijin56 at gmail.com  Sat Dec 18 17:42:52 2010
From: leijin56 at gmail.com (Lei Jin)
Date: Sat, 18 Dec 2010 08:42:52 -0800
Subject: [R-SIG-Finance] Question in blotter::updatePosPL file: argument is
	of length zero
Message-ID: <AANLkTikOsoTTwg6t0dM5b8NhuKhDVt2_aAM_GiMj0sQ+@mail.gmail.com>

In the file updatePosPL.R, line 35 is

if(ncol(Prices)>1) Prices=getPrice(Prices,Symbol)

However, if the Prices() is NULL (which is by the default parameter to
this function), then ncol(Prices) is also NULL, and
this will cause the error below.

Should line 35 checks the prices, not Prices?

==================================================
debug: if (ncol(Prices) > 1) Prices = getPrice(Prices, Symbol)
Browse[2]> print(Prices)
NULL
Browse[2]> print(ncol(Prices))
NULL
Browse[2]> n
Error in if (ncol(Prices) > 1) Prices = getPrice(Prices, Symbol) :
 argument is of length zero
>

-- 
Lei


From babel at centrum.sk  Sun Dec 19 01:34:25 2010
From: babel at centrum.sk (babel at centrum.sk)
Date: Sun, 19 Dec 2010 01:34:25 +0100
Subject: [R-SIG-Finance] Expost prediction for ARMA or GARCH
Message-ID: <1292718865.698356.12568.nullmailer@mail1008.cent>


Dear researchers

I would like to ask, if there is a way how to make in R (fGarch,tseries,..) EXPOST prediction(quasi future). Correct me, if I am wrong, but the command predict(x,n.ahead) makes EXANTE predictions(true future prediction) only. In contrast with Eviews, where forecast function produces expost results. Another idea, is to divide the testing set into training and validation sets, estimate for example ARMA coefficients for training set and use them with validations set to produce expost predictions. In pseudocode it looks like this:

testing_set (1:100)
training_set(1:90)
validation_set(91:100)



arma_coef<-fit(training_set,~arma(1,1))

expost_prediction<- arma_coef * validation_set

Is this a way how to produce EXPOST predictions, or my approach is completely wrong? I beleive, there is much easier way how to do it in R, but I just cant find the satysfying solution by myself. Thank you any help.

Sincerely Jan


From arun.kumar.saha at gmail.com  Sun Dec 19 13:15:28 2010
From: arun.kumar.saha at gmail.com (Arun.stat)
Date: Sun, 19 Dec 2010 04:15:28 -0800 (PST)
Subject: [R-SIG-Finance] Expost prediction for ARMA or GARCH
In-Reply-To: <1292718865.698356.12568.nullmailer@mail1008.cent>
References: <1292718865.698356.12568.nullmailer@mail1008.cent>
Message-ID: <1292760928308-3094391.post@n4.nabble.com>


Perhaps following thread will be of your benefit:

http://r.789695.n4.nabble.com/Forecasting-GARCH-td930240.html#a930243

Thanks,


-- 
View this message in context: http://r.789695.n4.nabble.com/Expost-prediction-for-ARMA-or-GARCH-tp3094155p3094391.html
Sent from the Rmetrics mailing list archive at Nabble.com.


From brian at braverock.com  Sun Dec 19 13:23:01 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 19 Dec 2010 06:23:01 -0600
Subject: [R-SIG-Finance] Expost prediction for ARMA or GARCH
In-Reply-To: <1292718865.698356.12568.nullmailer@mail1008.cent>
References: <1292718865.698356.12568.nullmailer@mail1008.cent>
Message-ID: <ef97a35ed5bb460cbccb0f3be7cb2517@braverock.com>

On Sun, 19 Dec 2010 01:34:25 +0100, <babel at centrum.sk> wrote:
> Dear researchers
> 
> I would like to ask, if there is a way how to make in R
> (fGarch,tseries,..) EXPOST prediction(quasi future). Correct me, if I am
> wrong, but the command predict(x,n.ahead) makes EXANTE predictions(true
> future prediction) only. In contrast with Eviews, where forecast
function
> produces expost results. Another idea, is to divide the testing set into
> training and validation sets, estimate for example ARMA coefficients for
> training set and use them with validations set to produce expost
> predictions. In pseudocode it looks like this:
> 
> testing_set (1:100)
> training_set(1:90)
> validation_set(91:100)
> 
> arma_coef<-fit(training_set,~arma(1,1))
> 
> expost_prediction<- arma_coef * validation_set
> 
> Is this a way how to produce EXPOST predictions, or my approach is
> completely wrong? I beleive, there is much easier way how to do it in R,
> but I just cant find the satysfying solution by myself. Thank you any
help.

I believe what you are asking is:

"How do I use a pre-set (trained) set of ARMA or GARCH coefficients on a
new data set without changing the model?"

This is not ex post 'prediction'.  The model fitting is ex post.  predict
is *always* using the current model to predict future movements (ex ante)
on observations in the time series that come in after the model is fit.

In fGarch, at least, there is no way to do this.  See a list post from me
approximately one+ year ago asking about predict and pre-fitted values for
fGarch, and Yohan's helpful reply on the modifications that would be
necessary to fGarch.

In any GARCH model, the conditional volatility may be (and usually is)
displayed on the prior data.

for arma(), I don't know the answer, but I suspect it will involve some
coding on your part.

Regards,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Sun Dec 19 13:28:15 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 19 Dec 2010 06:28:15 -0600
Subject: [R-SIG-Finance] Expost prediction for ARMA or GARCH
In-Reply-To: <1292760928308-3094391.post@n4.nabble.com>
References: <1292718865.698356.12568.nullmailer@mail1008.cent>
	<1292760928308-3094391.post@n4.nabble.com>
Message-ID: <3223595a0f74a97500a378092837777a@braverock.com>

On Sun, 19 Dec 2010 04:15:28 -0800 (PST), "Arun.stat"
<arun.kumar.saha at gmail.com> wrote:
> Perhaps following thread will be of your benefit:
> 
> http://r.789695.n4.nabble.com/Forecasting-GARCH-td930240.html#a930243

Arun,

This is precisely the thread I was talking about in my reply.  Thank You.

I did not check after that thread to see if Alexios added the
functionality to the rgarch package or not, but it looks like he did, from
this quote on the rgarch website:

"Forecast (from spec or fit), Simulation (from fit or spec)"
http://rgarch.r-forge.r-project.org/

To the OP's question, this would be forcast from specification.

Regards,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From megh700004 at yahoo.com  Sun Dec 19 21:38:14 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Sun, 19 Dec 2010 12:38:14 -0800 (PST)
Subject: [R-SIG-Finance] VECM estimation
Message-ID: <7398.56457.qm@web58105.mail.re3.yahoo.com>

Hi, I wanted to estimate a VEC model using vars package and gone through it's ca.jo() function. However I could not find any option to have following inputs:

1. Intercept and linear trend in cointegration equation (either one is available but not both option)
2. I want to explicitly specify the rank. It seems ca.jo() chooses rank through testing. However what if I want to put my own rank disregarding any statistical test?
3. I also want to get all estimated coefficients

I have tried following, however getting error:


> data(denmark)
> sjd <- as.matrix(denmark[, c("LRM", "LRY", "IBO", "IDE")])
> ca.jo(sjd, ecdet = c("const", "trend"), type="eigen", K=2, spec="transitory")
Error in match.arg(ecdet) : 'arg' must be of length 1

I would be grateful I somebody points me how to achieve that.

Thanks,


From matthieu.stigler at gmail.com  Sun Dec 19 23:17:21 2010
From: matthieu.stigler at gmail.com (mat)
Date: Sun, 19 Dec 2010 23:17:21 +0100
Subject: [R-SIG-Finance] VECM estimation
In-Reply-To: <7398.56457.qm@web58105.mail.re3.yahoo.com>
References: <7398.56457.qm@web58105.mail.re3.yahoo.com>
Message-ID: <4D0E8471.8040709@gmail.com>

Le 19. 12. 10 21:38, Megh Dal a ?crit :
> Hi, I wanted to estimate a VEC model using vars package and gone through it's ca.jo() function. However I could not find any option to have following inputs:
>
Starting with:

library(vars)
data(Canada)
ve<-ca.jo(Canada, spec="transitory")
> 1. Intercept and linear trend in cointegration equation (either one is available but not both option)
indeed I think it is not possible...
> 2. I want to explicitly specify the rank. It seems ca.jo() chooses rank through testing. However what if I want to put my own rank disregarding any statistical test?
cajorls(ve, r=2)
> 3. I also want to get all estimated coefficients
also obtained with cajorls()

Another possibility would have been to use package tsDyn (but less 
features than vars):

ve2<-VECM(Canada, lag=1, r=2, estim="ML")

summary(ve2)
> I have tried following, however getting error:
>
>
>> data(denmark)
>> sjd<- as.matrix(denmark[, c("LRM", "LRY", "IBO", "IDE")])
>> ca.jo(sjd, ecdet = c("const", "trend"), type="eigen", K=2, spec="transitory")
> Error in match.arg(ecdet) : 'arg' must be of length 1
>
> I would be grateful I somebody points me how to achieve that.
>
> Thanks,
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From megh700004 at yahoo.com  Sun Dec 19 23:35:58 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Sun, 19 Dec 2010 14:35:58 -0800 (PST)
Subject: [R-SIG-Finance] VECM estimation
In-Reply-To: <4D0E8471.8040709@gmail.com>
Message-ID: <354369.37053.qm@web58103.mail.re3.yahoo.com>

Thanks Matthieu the VECM() function is quite okay on what I need however I also need to have structural analysis (atleast B-model) of my fitted model. It seems that tsDyn package does not have any option for that, whereas vars package has with SVEC() function. But problem I am facing is again, it needs specific object type as: "Object of class ?ca.jo?; generated by ca.jo() contained in urca".

Is there any option to use object returned from VECM() in SVEC()? Or can you suggest anything else?

Thanks,

--- On Mon, 12/20/10, mat <matthieu.stigler at gmail.com> wrote:

> From: mat <matthieu.stigler at gmail.com>
> Subject: Re: [R-SIG-Finance] VECM estimation
> To: "Megh Dal" <megh700004 at yahoo.com>
> Cc: "r-sig-finance at stat.math.ethz.ch" <r-sig-finance at stat.math.ethz.ch>
> Date: Monday, December 20, 2010, 3:47 AM
> Le 19. 12. 10 21:38, Megh Dal a
> ?crit :
> > Hi, I wanted to estimate a VEC model using vars
> package and gone through it's ca.jo() function. However I
> could not find any option to have following inputs:
> >
> Starting with:
> 
> library(vars)
> data(Canada)
> ve<-ca.jo(Canada, spec="transitory")
> > 1. Intercept and linear trend in cointegration
> equation (either one is available but not both option)
> indeed I think it is not possible...
> > 2. I want to explicitly specify the rank. It seems
> ca.jo() chooses rank through testing. However what if I want
> to put my own rank disregarding any statistical test?
> cajorls(ve, r=2)
> > 3. I also want to get all estimated coefficients
> also obtained with cajorls()
> 
> Another possibility would have been to use package tsDyn
> (but less 
> features than vars):
> 
> ve2<-VECM(Canada, lag=1, r=2, estim="ML")
> 
> summary(ve2)
> > I have tried following, however getting error:
> >
> >
> >> data(denmark)
> >> sjd<- as.matrix(denmark[, c("LRM", "LRY",
> "IBO", "IDE")])
> >> ca.jo(sjd, ecdet = c("const", "trend"),
> type="eigen", K=2, spec="transitory")
> > Error in match.arg(ecdet) : 'arg' must be of length 1
> >
> > I would be grateful I somebody points me how to
> achieve that.
> >
> > Thanks,
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org
> mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post,
> subscribe first.
> > -- Also note that this is not the r-help list where
> general R questions should go.
> 
> 





From matthieu.stigler at gmail.com  Sun Dec 19 23:40:36 2010
From: matthieu.stigler at gmail.com (mat)
Date: Sun, 19 Dec 2010 23:40:36 +0100
Subject: [R-SIG-Finance] VECM estimation
In-Reply-To: <354369.37053.qm@web58103.mail.re3.yahoo.com>
References: <354369.37053.qm@web58103.mail.re3.yahoo.com>
Message-ID: <4D0E89E4.1060704@gmail.com>

Le 19. 12. 10 23:35, Megh Dal a ?crit :
> Thanks Matthieu the VECM() function is quite okay on what I need however I also need to have structural analysis (atleast B-model) of my fitted model. It seems that tsDyn package does not have any option for that, whereas vars package has with SVEC() function.

if you need structural analysis, then vars is definitely more appropriate
> But problem I am facing is again, it needs specific object type as: "Object of class ?ca.jo?; generated by ca.jo() contained in urca".
>
did you check the help file of SVEC? There is a "r" argument:

  r: Integer, the cointegration rank of x.

Is this not what you need? If not, please indicate more precisely (i.e. 
also with code) where the problem is

Hope this helps

Mat

> Is there any option to use object returned from VECM() in SVEC()? Or can you suggest anything else?
>
> Thanks,
>
> --- On Mon, 12/20/10, mat<matthieu.stigler at gmail.com>  wrote:
>
>> From: mat<matthieu.stigler at gmail.com>
>> Subject: Re: [R-SIG-Finance] VECM estimation
>> To: "Megh Dal"<megh700004 at yahoo.com>
>> Cc: "r-sig-finance at stat.math.ethz.ch"<r-sig-finance at stat.math.ethz.ch>
>> Date: Monday, December 20, 2010, 3:47 AM
>> Le 19. 12. 10 21:38, Megh Dal a
>> ?crit :
>>> Hi, I wanted to estimate a VEC model using vars
>> package and gone through it's ca.jo() function. However I
>> could not find any option to have following inputs:
>> Starting with:
>>
>> library(vars)
>> data(Canada)
>> ve<-ca.jo(Canada, spec="transitory")
>>> 1. Intercept and linear trend in cointegration
>> equation (either one is available but not both option)
>> indeed I think it is not possible...
>>> 2. I want to explicitly specify the rank. It seems
>> ca.jo() chooses rank through testing. However what if I want
>> to put my own rank disregarding any statistical test?
>> cajorls(ve, r=2)
>>> 3. I also want to get all estimated coefficients
>> also obtained with cajorls()
>>
>> Another possibility would have been to use package tsDyn
>> (but less
>> features than vars):
>>
>> ve2<-VECM(Canada, lag=1, r=2, estim="ML")
>>
>> summary(ve2)
>>> I have tried following, however getting error:
>>>
>>>
>>>> data(denmark)
>>>> sjd<- as.matrix(denmark[, c("LRM", "LRY",
>> "IBO", "IDE")])
>>>> ca.jo(sjd, ecdet = c("const", "trend"),
>> type="eigen", K=2, spec="transitory")
>>> Error in match.arg(ecdet) : 'arg' must be of length 1
>>>
>>> I would be grateful I somebody points me how to
>> achieve that.
>>> Thanks,
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org
>> mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post,
>> subscribe first.
>>> -- Also note that this is not the r-help list where
>> general R questions should go.
>>
>>
>
>


From megh700004 at yahoo.com  Mon Dec 20 00:03:45 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Sun, 19 Dec 2010 15:03:45 -0800 (PST)
Subject: [R-SIG-Finance] VECM estimation
In-Reply-To: <4D0E89E4.1060704@gmail.com>
Message-ID: <738026.68774.qm@web58102.mail.re3.yahoo.com>

Let consider the example with SVEC()

SR <- matrix(NA, nrow = 4, ncol = 4)
SR[4, 2] <- 0
SR
LR <- matrix(NA, nrow = 4, ncol = 4)
LR[1, 2:4] <- 0
LR[2:4, 4] <- 0
LR

vecm <- ca.jo(Canada[, c("prod", "e", "U", "rw")], type = "trace", ecdet = "trend", K = 3, spec = "transitory")

# Here I do not have option to put both trend and intercept with ecdet

SVEC(vecm, LR = LR, SR = SR, r = 1, lrtest = FALSE, boot = FALSE)
# this is okay with me.

I really could not understand, what is the actual job of ca.jo(). Is it to determine rank of the system? Does it also estimate the VECM parameters? If it does then what rank it uses and how to specify that rank?

I also noticed that values from SVEC() do not match with jMulti estimation. 

SVEC() gives following:

> vecm <- ca.jo(Canada[, c("prod", "e", "U", "rw")], type = "trace", ecdet = "none", K = 3, spec = "transitory")
> SVEC(vecm, LR = LR, SR = SR, r = 1, lrtest = FALSE, boot = FALSE)

SVEC Estimation Results:
======================== 


Estimated contemporaneous impact matrix:
         prod        e         U       rw
prod  0.51477  0.09477 -0.323277 0.006354
e    -0.15117  0.24352 -0.116054 0.122847
U     0.05164 -0.26747  0.004129 0.037027
rw    0.36441  0.00000  0.432744 0.457597

Estimated long run impact matrix:
         prod       e       U rw
prod  0.52448  0.0000  0.0000  0
e    -0.03750  0.5807 -0.5355  0
U     0.05365 -0.3530  0.1064  0
rw    0.46911  0.5521 -0.6817  0


Similar input on jMulti, gives following result:

This is a B-model with long run restrictions

Long run restrictions provide(s) 5 independent restriction(s).
Contemporaneous restrictions provide(s) 1 additional restriction(s).

Structural VAR Estimation Results
ML Estimation, Scoring Algorithm (see Amisano & Giannini (1992))
Convergence after 10 iterations
Log Likelihood: 129.1165 
Structural VAR is just identified

Estimated B matrix
  0.5965  -0.1364   0.1266   0.1291 
  0.0435   0.2727  -0.1454   0.1228 
 -0.0711  -0.2599   0.0091   0.0477 
 -0.1442   0.0000   0.6046   0.3948 

Estimated long run impact matrix
  1.4477   0.0000   0.0000   0.0000 
  2.5655   0.9560  -0.8542   0.0000 
 -0.4426  -0.3369   0.1923   0.0000 
  4.7192   1.5188  -0.7510   0.0000 

SigmaU~*100
 40.7114  -1.3784   0.0349   4.1515 
 -1.3784  11.2499  -6.9452  -4.5702 
  0.0349  -6.9452   7.4965   3.4569 
  4.1515  -4.5702   3.4569  54.2212 
end of ML estimation

Is it differing just because of different algorithm?

Thanks,


--- On Mon, 12/20/10, mat <matthieu.stigler at gmail.com> wrote:

> From: mat <matthieu.stigler at gmail.com>
> Subject: Re: [R-SIG-Finance] VECM estimation
> To: "Megh Dal" <megh700004 at yahoo.com>
> Cc: "r-sig-finance at stat.math.ethz.ch" <r-sig-finance at stat.math.ethz.ch>
> Date: Monday, December 20, 2010, 4:10 AM
> Le 19. 12. 10 23:35, Megh Dal a
> ?crit :
> > Thanks Matthieu the VECM() function is quite okay on
> what I need however I also need to have structural analysis
> (atleast B-model) of my fitted model. It seems that tsDyn
> package does not have any option for that, whereas vars
> package has with SVEC() function.
> 
> if you need structural analysis, then vars is definitely
> more appropriate
> > But problem I am facing is again, it needs specific
> object type as: "Object of class ?ca.jo?; generated by
> ca.jo() contained in urca".
> >
> did you check the help file of SVEC? There is a "r"
> argument:
> 
> ? r: Integer, the cointegration rank of x.
> 
> Is this not what you need? If not, please indicate more
> precisely (i.e. 
> also with code) where the problem is
> 
> Hope this helps
> 
> Mat
> 
> > Is there any option to use object returned from VECM()
> in SVEC()? Or can you suggest anything else?
> >
> > Thanks,
> >
> > --- On Mon, 12/20/10, mat<matthieu.stigler at gmail.com>?
> wrote:
> >
> >> From: mat<matthieu.stigler at gmail.com>
> >> Subject: Re: [R-SIG-Finance] VECM estimation
> >> To: "Megh Dal"<megh700004 at yahoo.com>
> >> Cc: "r-sig-finance at stat.math.ethz.ch"<r-sig-finance at stat.math.ethz.ch>
> >> Date: Monday, December 20, 2010, 3:47 AM
> >> Le 19. 12. 10 21:38, Megh Dal a
> >> ?crit :
> >>> Hi, I wanted to estimate a VEC model using
> vars
> >> package and gone through it's ca.jo() function.
> However I
> >> could not find any option to have following
> inputs:
> >> Starting with:
> >>
> >> library(vars)
> >> data(Canada)
> >> ve<-ca.jo(Canada, spec="transitory")
> >>> 1. Intercept and linear trend in
> cointegration
> >> equation (either one is available but not both
> option)
> >> indeed I think it is not possible...
> >>> 2. I want to explicitly specify the rank. It
> seems
> >> ca.jo() chooses rank through testing. However what
> if I want
> >> to put my own rank disregarding any statistical
> test?
> >> cajorls(ve, r=2)
> >>> 3. I also want to get all estimated
> coefficients
> >> also obtained with cajorls()
> >>
> >> Another possibility would have been to use package
> tsDyn
> >> (but less
> >> features than vars):
> >>
> >> ve2<-VECM(Canada, lag=1, r=2, estim="ML")
> >>
> >> summary(ve2)
> >>> I have tried following, however getting
> error:
> >>>
> >>>
> >>>> data(denmark)
> >>>> sjd<- as.matrix(denmark[, c("LRM",
> "LRY",
> >> "IBO", "IDE")])
> >>>> ca.jo(sjd, ecdet = c("const", "trend"),
> >> type="eigen", K=2, spec="transitory")
> >>> Error in match.arg(ecdet) : 'arg' must be of
> length 1
> >>>
> >>> I would be grateful I somebody points me how
> to
> >> achieve that.
> >>> Thanks,
> >>>
> >>>
> _______________________________________________
> >>> R-SIG-Finance at r-project.org
> >> mailing list
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >>> -- Subscriber-posting only. If you want to
> post,
> >> subscribe first.
> >>> -- Also note that this is not the r-help list
> where
> >> general R questions should go.
> >>
> >>
> >
> >
> 
> 





From megh700004 at yahoo.com  Mon Dec 20 00:51:07 2010
From: megh700004 at yahoo.com (Megh Dal)
Date: Sun, 19 Dec 2010 15:51:07 -0800 (PST)
Subject: [R-SIG-Finance] VECM estimation
Message-ID: <39213.66074.qm@web58105.mail.re3.yahoo.com>

I have got few more questions on ca.jo(), while I was playing with it. In the help page, it is written that: "ecdet	 Character, ?none? for no intercept in cointegration, ?const? for constant term in cointegration and ?trend? for trend variable in cointegration."

So if I choose "none" then I should not expect any intercept term in my equation. But it is not the case here:

> vec2var(ca.jo(Canada[, c("prod", "e", "U", "rw")], type = "trace", ecdet = "none", K = 3, spec = "transitory"), 2)

Coefficient matrix of lagged endogenous variables:

A1:
         prod.l1       e.l1       U.l1        rw.l1
prod  1.17313085 -0.1988161 -0.7607317  0.051311441
e     0.16357256  1.7650576  0.1244759 -0.089332240
U    -0.10372069 -0.6093859  0.6805110  0.008815039
rw   -0.02333968 -0.5437062 -0.1599481  0.952450235


A2:
         prod.l2       e.l2        U.l2       rw.l2
prod -0.21526728 -0.2382885  0.83809495 -0.19924884
e    -0.10115954 -1.1704565 -0.05430437 -0.02535674
U     0.09230408  0.5342155 -0.08776523  0.06871551
rw   -0.24738219  0.5644188 -0.26581284 -0.13807970


A3:
           prod.l3        e.l3       U.l3       rw.l3
prod  0.0870002364  0.58547868 0.32084340  0.09149056
e     0.0001627702  0.58526677 0.36095879  0.03854017
U    -0.0201851094 -0.03920456 0.08150674 -0.03682937
rw    0.2822890641 -0.09079635 0.03126377  0.18140798


Coefficient matrix of deterministic regressor(s).

       constant
prod -136.73773
e    -165.37988
U     106.15426
rw     68.44533

Similarly if I choose "const" then I should expect constant in C.I. but not any intercept in diff. equation. Comparing with jMulti, this is exactly coming correct!!!

Next if I choose "trend" then only trend variable and no intercept I should expect. However I am getting both intercept and trend. Comparing with jMulti figures I got that: Intercept is for diff. equation but linear trend is for C.I. equation.

> vec2var(ca.jo(Canada[, c("prod", "e", "U", "rw")], type = "trace", ecdet = "trend", K = 3, spec = "transitory"), 2)

Coefficient matrix of lagged endogenous variables:

A1:
        prod.l1       e.l1       U.l1        rw.l1
prod  1.2273127 -0.2301307 -1.0248394 -0.013479836
e     0.1949000  1.7546123  0.0766481 -0.068519800
U    -0.1449562 -0.6105280  0.7398885 -0.005188448
rw   -0.1238361 -0.5472103 -0.2113089  0.870432067


A2:
        prod.l2       e.l2        U.l2       rw.l2
prod -0.2720027 -0.3491925  0.83323529 -0.19363998
e    -0.1194676 -1.2182065 -0.03025085 -0.02284172
U     0.1180995  0.5931123 -0.11283118  0.06605628
rw   -0.2198719  0.6347517 -0.39091786 -0.13828306


A3:
         prod.l3        e.l3        U.l3       rw.l3
prod  0.01052027  0.54370168  0.07683680  0.20433062
e     0.03020434  0.61157061  0.31515346  0.03773604
U    -0.03940489 -0.06214962  0.14851820 -0.04902809
rw    0.15169818 -0.27519714 -0.04045504  0.23160048


Coefficient matrix of deterministic regressor(s).

       constant    trend.l1
prod   49.86523  0.01486974
e    -161.45187 -0.01521660
U      98.31138  0.02031367
rw    274.89572  0.09372355

I would be really grateful, if somebody clarify me what is really going on. or I am missing something?

Thanks,


--- On Mon, 12/20/10, Megh Dal <megh700004 at yahoo.com> wrote:

> From: Megh Dal <megh700004 at yahoo.com>
> Subject: Re: [R-SIG-Finance] VECM estimation
> To: "mat" <matthieu.stigler at gmail.com>
> Cc: "r-sig-finance at stat.math.ethz.ch" <r-sig-finance at stat.math.ethz.ch>
> Date: Monday, December 20, 2010, 4:33 AM
> Let consider the example with SVEC()
> 
> SR <- matrix(NA, nrow = 4, ncol = 4)
> SR[4, 2] <- 0
> SR
> LR <- matrix(NA, nrow = 4, ncol = 4)
> LR[1, 2:4] <- 0
> LR[2:4, 4] <- 0
> LR
> 
> vecm <- ca.jo(Canada[, c("prod", "e", "U", "rw")], type
> = "trace", ecdet = "trend", K = 3, spec = "transitory")
> 
> # Here I do not have option to put both trend and intercept
> with ecdet
> 
> SVEC(vecm, LR = LR, SR = SR, r = 1, lrtest = FALSE, boot =
> FALSE)
> # this is okay with me.
> 
> I really could not understand, what is the actual job of
> ca.jo(). Is it to determine rank of the system? Does it also
> estimate the VECM parameters? If it does then what rank it
> uses and how to specify that rank?
> 
> I also noticed that values from SVEC() do not match with
> jMulti estimation. 
> 
> SVEC() gives following:
> 
> > vecm <- ca.jo(Canada[, c("prod", "e", "U", "rw")],
> type = "trace", ecdet = "none", K = 3, spec = "transitory")
> > SVEC(vecm, LR = LR, SR = SR, r = 1, lrtest = FALSE,
> boot = FALSE)
> 
> SVEC Estimation Results:
> ======================== 
> 
> 
> Estimated contemporaneous impact matrix:
> ? ? ? ???prod? ?
> ? ? e? ? ?
> ???U? ? ???rw
> prod? 0.51477? 0.09477 -0.323277 0.006354
> e? ? -0.15117? 0.24352 -0.116054 0.122847
> U? ???0.05164 -0.26747? 0.004129
> 0.037027
> rw? ? 0.36441? 0.00000? 0.432744
> 0.457597
> 
> Estimated long run impact matrix:
> ? ? ? ???prod? ?
> ???e? ? ???U rw
> prod? 0.52448? 0.0000? 0.0000? 0
> e? ? -0.03750? 0.5807 -0.5355? 0
> U? ???0.05365 -0.3530?
> 0.1064? 0
> rw? ? 0.46911? 0.5521 -0.6817? 0
> 
> 
> Similar input on jMulti, gives following result:
> 
> This is a B-model with long run restrictions
> 
> Long run restrictions provide(s) 5 independent
> restriction(s).
> Contemporaneous restrictions provide(s) 1 additional
> restriction(s).
> 
> Structural VAR Estimation Results
> ML Estimation, Scoring Algorithm (see Amisano &
> Giannini (1992))
> Convergence after 10 iterations
> Log Likelihood: 129.1165 
> Structural VAR is just identified
> 
> Estimated B matrix
> ? 0.5965?
> -0.1364???0.1266???0.1291 
> ? 0.0435???0.2727?
> -0.1454???0.1228 
>  -0.0711?
> -0.2599???0.0091???0.0477 
> 
> -0.1442???0.0000???0.6046???0.3948
> 
> 
> Estimated long run impact matrix
> ?
> 1.4477???0.0000???0.0000???0.0000
> 
> ? 2.5655???0.9560?
> -0.8542???0.0000 
>  -0.4426?
> -0.3369???0.1923???0.0000 
> ? 4.7192???1.5188?
> -0.7510???0.0000 
> 
> SigmaU~*100
>  40.7114?
> -1.3784???0.0349???4.1515 
>  -1.3784? 11.2499? -6.9452? -4.5702 
> ? 0.0349?
> -6.9452???7.4965???3.4569 
> ? 4.1515? -4.5702???3.4569?
> 54.2212 
> end of ML estimation
> 
> Is it differing just because of different algorithm?
> 
> Thanks,
> 
> 
> --- On Mon, 12/20/10, mat <matthieu.stigler at gmail.com>
> wrote:
> 
> > From: mat <matthieu.stigler at gmail.com>
> > Subject: Re: [R-SIG-Finance] VECM estimation
> > To: "Megh Dal" <megh700004 at yahoo.com>
> > Cc: "r-sig-finance at stat.math.ethz.ch"
> <r-sig-finance at stat.math.ethz.ch>
> > Date: Monday, December 20, 2010, 4:10 AM
> > Le 19. 12. 10 23:35, Megh Dal a
> > ?crit :
> > > Thanks Matthieu the VECM() function is quite okay
> on
> > what I need however I also need to have structural
> analysis
> > (atleast B-model) of my fitted model. It seems that
> tsDyn
> > package does not have any option for that, whereas
> vars
> > package has with SVEC() function.
> > 
> > if you need structural analysis, then vars is
> definitely
> > more appropriate
> > > But problem I am facing is again, it needs
> specific
> > object type as: "Object of class ?ca.jo?;
> generated by
> > ca.jo() contained in urca".
> > >
> > did you check the help file of SVEC? There is a "r"
> > argument:
> > 
> > ? r: Integer, the cointegration rank of x.
> > 
> > Is this not what you need? If not, please indicate
> more
> > precisely (i.e. 
> > also with code) where the problem is
> > 
> > Hope this helps
> > 
> > Mat
> > 
> > > Is there any option to use object returned from
> VECM()
> > in SVEC()? Or can you suggest anything else?
> > >
> > > Thanks,
> > >
> > > --- On Mon, 12/20/10, mat<matthieu.stigler at gmail.com>?
> > wrote:
> > >
> > >> From: mat<matthieu.stigler at gmail.com>
> > >> Subject: Re: [R-SIG-Finance] VECM estimation
> > >> To: "Megh Dal"<megh700004 at yahoo.com>
> > >> Cc: "r-sig-finance at stat.math.ethz.ch"<r-sig-finance at stat.math.ethz.ch>
> > >> Date: Monday, December 20, 2010, 3:47 AM
> > >> Le 19. 12. 10 21:38, Megh Dal a
> > >> ?crit :
> > >>> Hi, I wanted to estimate a VEC model
> using
> > vars
> > >> package and gone through it's ca.jo()
> function.
> > However I
> > >> could not find any option to have following
> > inputs:
> > >> Starting with:
> > >>
> > >> library(vars)
> > >> data(Canada)
> > >> ve<-ca.jo(Canada, spec="transitory")
> > >>> 1. Intercept and linear trend in
> > cointegration
> > >> equation (either one is available but not
> both
> > option)
> > >> indeed I think it is not possible...
> > >>> 2. I want to explicitly specify the rank.
> It
> > seems
> > >> ca.jo() chooses rank through testing. However
> what
> > if I want
> > >> to put my own rank disregarding any
> statistical
> > test?
> > >> cajorls(ve, r=2)
> > >>> 3. I also want to get all estimated
> > coefficients
> > >> also obtained with cajorls()
> > >>
> > >> Another possibility would have been to use
> package
> > tsDyn
> > >> (but less
> > >> features than vars):
> > >>
> > >> ve2<-VECM(Canada, lag=1, r=2, estim="ML")
> > >>
> > >> summary(ve2)
> > >>> I have tried following, however getting
> > error:
> > >>>
> > >>>
> > >>>> data(denmark)
> > >>>> sjd<- as.matrix(denmark[,
> c("LRM",
> > "LRY",
> > >> "IBO", "IDE")])
> > >>>> ca.jo(sjd, ecdet = c("const",
> "trend"),
> > >> type="eigen", K=2, spec="transitory")
> > >>> Error in match.arg(ecdet) : 'arg' must be
> of
> > length 1
> > >>>
> > >>> I would be grateful I somebody points me
> how
> > to
> > >> achieve that.
> > >>> Thanks,
> > >>>
> > >>>
> > _______________________________________________
> > >>> R-SIG-Finance at r-project.org
> > >> mailing list
> > >>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > >>> -- Subscriber-posting only. If you want
> to
> > post,
> > >> subscribe first.
> > >>> -- Also note that this is not the r-help
> list
> > where
> > >> general R questions should go.
> > >>
> > >>
> > >
> > >
> > 
> > 
> 
> 
> 
> 





From babel at centrum.sk  Mon Dec 20 12:58:09 2010
From: babel at centrum.sk (babel at centrum.sk)
Date: Mon, 20 Dec 2010 12:58:09 +0100
Subject: [R-SIG-Finance] Expost prediction for ARMA or GARCH
In-Reply-To: <3223595a0f74a97500a378092837777a@braverock.com>
References: <1292718865.698356.12568.nullmailer@mail1008.cent>	<1292760928308-3094391.post@n4.nabble.com>
	<3223595a0f74a97500a378092837777a@braverock.com>
Message-ID: <1292846289.803604.12764.nullmailer@mail1009.cent>


Dear Brian, Arun and Alex

Thank you all  for helping, I am going to check all your suggestions. At the end, I would like to provide few lines of code, just in case, if someone can utilize it in future:

library(quantmod)
library(tseries)
getSymbols("XPT/USD",src="oanda")

# 2 time series, 
x<-XPTUSD
y<-Lag(x,k=1)

length(x)
> 500

## fitting arma model on first 450 observations,
fit <- arma(x[1:450], order = c(1, 0))
fitted_model<-fit$fitted.values


## lets calculate it all, on a full length, 1:450 are same, 451:500 would be expost
for (i in 1:500)
fitted_manual[i]<-fit$coef[1]+(fit$coef[2]*y[i])

## for comparision, I show, that values fitted by model (fitted_model) are exactly the same as those, that were calculated with coefficients and lagged time series (fitted_manual), what its ##not a suprise :)))

comparision<-cbind(fitted_mode,fitted_manual[1:450]);comparision   ## same

## so I thing, the last 50 values could be considered as expost predictions, because arma coeficients were estimated only on first 450 observations
comparision_expost<-cbind(x[451:500],fitted_manual[451:500]);comparision_expost

plot(comparision_expost[,1],type="l")


Best regards


From brian at braverock.com  Mon Dec 20 13:52:47 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 20 Dec 2010 06:52:47 -0600
Subject: [R-SIG-Finance] Question in blotter::updatePosPL file: argument
 is	of length zero
In-Reply-To: <AANLkTikOsoTTwg6t0dM5b8NhuKhDVt2_aAM_GiMj0sQ+@mail.gmail.com>
References: <AANLkTikOsoTTwg6t0dM5b8NhuKhDVt2_aAM_GiMj0sQ+@mail.gmail.com>
Message-ID: <4D0F519F.9040500@braverock.com>

On 12/18/2010 10:42 AM, Lei Jin wrote:
> In the file updatePosPL.R, line 35 is
>
> if(ncol(Prices)>1) Prices=getPrice(Prices,Symbol)
>
> However, if the Prices() is NULL (which is by the default parameter to
> this function), then ncol(Prices) is also NULL, and
> this will cause the error below.
>
> Should line 35 checks the prices, not Prices?

Thank you for the report.

I've tested the change and it is now in R-Forge SVN r502.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From markknecht at gmail.com  Mon Dec 20 17:17:53 2010
From: markknecht at gmail.com (Mark Knecht)
Date: Mon, 20 Dec 2010 08:17:53 -0800
Subject: [R-SIG-Finance] Expost prediction for ARMA or GARCH
In-Reply-To: <1292846289.803604.12764.nullmailer@mail1009.cent>
References: <1292718865.698356.12568.nullmailer@mail1008.cent>
	<1292760928308-3094391.post@n4.nabble.com>
	<3223595a0f74a97500a378092837777a@braverock.com>
	<1292846289.803604.12764.nullmailer@mail1009.cent>
Message-ID: <AANLkTi=wZbM8Qx2Hs66jyF-GgT+D9V+MopNrkW5dLGze@mail.gmail.com>

On Mon, Dec 20, 2010 at 3:58 AM,  <babel at centrum.sk> wrote:
>
> Dear Brian, Arun and Alex
>
> Thank you all ?for helping, I am going to check all your suggestions. At the end, I would like to provide few lines of code, just in case, if someone can utilize it in future:
>
> library(quantmod)
> library(tseries)
> getSymbols("XPT/USD",src="oanda")
>
> # 2 time series,
> x<-XPTUSD
> y<-Lag(x,k=1)
>
> length(x)
>> 500
>
> ## fitting arma model on first 450 observations,
> fit <- arma(x[1:450], order = c(1, 0))
> fitted_model<-fit$fitted.values
>
>
> ## lets calculate it all, on a full length, 1:450 are same, 451:500 would be expost
> for (i in 1:500)
> fitted_manual[i]<-fit$coef[1]+(fit$coef[2]*y[i])
>
> ## for comparision, I show, that values fitted by model (fitted_model) are exactly the same as those, that were calculated with coefficients and lagged time series (fitted_manual), what its ##not a suprise :)))
>
> comparision<-cbind(fitted_mode,fitted_manual[1:450]);comparision ? ## same
>
> ## so I thing, the last 50 values could be considered as expost predictions, because arma coeficients were estimated only on first 450 observations
> comparision_expost<-cbind(x[451:500],fitted_manual[451:500]);comparision_expost
>
> plot(comparision_expost[,1],type="l")
>

I tried running the code but it's having trouble early on with the
getSymbols command. Are downloads from Oanda supposed to be free and
open or are they subscription based?

> getSymbols("XPT/USD",src="oanda")
[1] "XPTUSD"
Warning message:
In readLines(tmp) :
  incomplete final line found on
'C:\DOCUME~1\Mark\LOCALS~1\Temp\RtmpDJGlT6\file7cac6eba'
>

The 'LOCALS~1' looks strange as the directory doesn't exist in my
directory. (Unless it's hidden by default.)

- Mark


From stephen at organicfoodmarkets.com.au  Mon Dec 20 21:11:12 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 21 Dec 2010 07:11:12 +1100
Subject: [R-SIG-Finance] can't find blotter
Message-ID: <4D0FB860.4040804@organicfoodmarkets.com.au>

Hi

I want to use blotter.

)
 > library(blotter)

gets me :

Error in library(blotter) : there is no package called 'blotter'
 >

but I cannot find blotter at the Australian repository.

Can anyone point me to it?

-- 
Stephen Choularton Ph.D., FIoD


From brian at braverock.com  Mon Dec 20 21:13:58 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 20 Dec 2010 14:13:58 -0600
Subject: [R-SIG-Finance] can't find blotter
In-Reply-To: <4D0FB860.4040804@organicfoodmarkets.com.au>
References: <4D0FB860.4040804@organicfoodmarkets.com.au>
Message-ID: <4D0FB906.8080308@braverock.com>

On 12/20/2010 02:11 PM, Stephen Choularton wrote:
> Hi
>
> I want to use blotter.
>
> )
>  > library(blotter)
>
> gets me :
>
> Error in library(blotter) : there is no package called 'blotter'
>  >
>
> but I cannot find blotter at the Australian repository.
>
> Can anyone point me to it?
>

https://r-forge.r-project.org/R/?group_id=316

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From BChiquoine at tiff.org  Mon Dec 20 22:04:43 2010
From: BChiquoine at tiff.org (Chiquoine, Ben)
Date: Mon, 20 Dec 2010 21:04:43 +0000
Subject: [R-SIG-Finance] ks test to compare manager alphas.
Message-ID: <60E01F7C81AAAE468B66CD1A361EFDB4AA4341@sw8exch2010bk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101220/0bf7165d/attachment.pl>

From matthieu.stigler at gmail.com  Mon Dec 20 22:17:00 2010
From: matthieu.stigler at gmail.com (mat)
Date: Mon, 20 Dec 2010 22:17:00 +0100
Subject: [R-SIG-Finance] ks test to compare manager alphas.
In-Reply-To: <60E01F7C81AAAE468B66CD1A361EFDB4AA4341@sw8exch2010bk>
References: <60E01F7C81AAAE468B66CD1A361EFDB4AA4341@sw8exch2010bk>
Message-ID: <4D0FC7CC.5070707@gmail.com>

Le 20. 12. 10 22:04, Chiquoine, Ben a ?crit :
> Hi,
>
> I've recently discovered ks.test() in the stats package.  I'd like to apply it to alphas generated by hedge fund managers. I have several years of monthly excess returns for each manager and I'd like to see which come from distributions that are not statistically different.  I have two questions for the group.  The first question is whether the KS test is valid for two returns series which are likely not iid?  I think I read that as long as the difference in empirical distributions functions (ecdf) is iid from the true distribution (which I don't know) the test is valid.  My second question is more focused on R.  ks.test gives me the source code for the R function but there are several calls to C code within the function.  I'm wondering if there is any way to view the source for the C functions?  I've searched R help for an answer to this less finance related question but only found one post in which they said the source could be found in a file called ks.c.  Unfortunately I!
>    can't find this file on my hard drive or on the web.  Any help this group can offer is greatly appreciated.
you are most likely to find the file you search downloading the sources:
http://stat.ethz.ch/CRAN/sources.html
then (at least in R 2.9 sources)
src/library/stats/src

> Thanks,
>
> Ben
>
> ___________________________________________
> This message and any attached documents contain
> information which may be confidential, subject to
> privilege or exempt from disclosure under applicable
> law. These materials are solely for the use of the
> intended recipient. If you are not the intended
> recipient of this transmission, you are hereby
> notified that any distribution, disclosure, printing,
> copying, storage, modification or the taking of any
> action in reliance upon this transmission is strictly
> prohibited. Delivery of this message to any person
> other than the intended recipient shall not
> compromise or waive such confidentiality, privilege
> or exemption from disclosure as to this
> communication.
>
> If you have received this communication in error,
> please notify the sender immediately and delete
> this message from your system.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From bogaso.christofer at gmail.com  Tue Dec 21 01:06:19 2010
From: bogaso.christofer at gmail.com (Christofer Bogaso)
Date: Tue, 21 Dec 2010 05:36:19 +0530
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
Message-ID: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101221/5c0345dc/attachment.pl>

From ezivot at u.washington.edu  Tue Dec 21 01:11:47 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Mon, 20 Dec 2010 16:11:47 -0800
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
Message-ID: <008601cba0a3$a86fe550$f94faff0$@washington.edu>

I especially like Econbrowser  (  http://www.econbrowser.com/  ) by James
Hamilton and Menzie Chinn. 

-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Christofer Bogaso
Sent: Monday, December 20, 2010 4:06 PM
To: r-sig-finance at r-project.org
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion

Hi friends, I am looking for some good and well active forums for
Macro-economics related discussions. Can people here name a few on that?

Thanks and regards,

	[[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From mdothan at gmail.com  Tue Dec 21 01:23:04 2010
From: mdothan at gmail.com (Michael Dothan)
Date: Mon, 20 Dec 2010 16:23:04 -0800
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
Message-ID: <AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>

Check out these sites:

http://baselinescenario.com/

http://www.nakedcapitalism.com/

http://www.voxeu.org/

http://modelsagents.blogspot.com/

http://krugman.blogs.nytimes.com/

Best,

Michael

On 12/20/10, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
> Hi friends, I am looking for some good and well active forums for
> Macro-economics related discussions. Can people here name a few on that?
>
> Thanks and regards,
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From stephen at organicfoodmarkets.com.au  Tue Dec 21 03:42:17 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 21 Dec 2010 13:42:17 +1100
Subject: [R-SIG-Finance] ROC
Message-ID: <4D101409.2090803@organicfoodmarkets.com.au>

Hi

I am having a bit of a problem with ROC.  I am doing some quick 
backtesting and at one point I use this:

ret <- ROC(price)
ret[1] <- 0

having established the spread between two stocks earlier like this:

price <- spread$Close - spread$Close.1

when I have been working before this has always been positive as the 
first share has always been greater in value than the second.  But just 
now I have done this with two stocks which are approximately the same 
value and whose values have crossed each other and I get a lot of NAN's

I have put the info into a table below

                        Close    Mean Upper.Boundary Lower.Boundary 
Signal  Daily Return
2007-01-12 -3.87 -3.9565  -3.6844106184    -4.22858938      0           NaN
2007-01-15 -3.95 -3.9595  -3.6854677314    -4.23353227      0           NaN
2007-01-16 -3.99 -3.9810  -3.6598900828    -4.30210992      0           NaN
2007-01-17 -3.87 -3.9790  -3.6599949679    -4.29800503      0           NaN
2007-01-18 -4.03 -3.9695  -3.6794927406    -4.25950726      0           NaN
2007-01-19 -4.02 -3.9600  -3.6900292413    -4.22997076      0           NaN.
.
.
.
.
2007-05-15 -2.20 -3.0000  -2.1068211707    -3.89317883      0           NaN
2007-05-16 -1.97 -2.9755  -2.0843156904    -3.86668431      0           NaN
2007-05-17 -2.87 -2.9375  -2.0836326369    -3.79136736      0           NaN
2007-05-18 -2.87 -2.9045  -2.0836538384    -3.72534616     -1           NaN
2007-05-21 -2.96 -2.8900  -2.0855125856    -3.69448741     -1           NaN
2007-05-22 -2.92 -2.8785  -2.0941725979    -3.66282740      0           NaN
2007-05-23 -3.22 -2.8650  -2.1195577081    -3.61044229      0           NaN
2007-05-24 -2.98 -2.8675  -2.1119764799    -3.62302352      0           NaN
2007-05-25 -2.97 -2.8785  -2.0990190661    -3.65798093      0           NaN
.
.
.
.
.2007-10-25 -1.46 -0.9005   1.5666694841    -3.36766948      0           NaN
2007-10-26 -0.60 -0.7765   1.7468501123    -3.29985011      0           NaN
2007-10-29 -0.07 -0.6650   1.8963442195    -3.22634422      0           NaN
2007-10-30  0.26 -0.5735   1.9383688786    -3.08536888      0           NaN
2007-10-31  0.44 -0.4585   1.9300540660    -2.84705407      0  5.260931e-01
2007-11-01  0.64 -0.3545   1.9303284515    -2.63932845      0  3.746934e-01
2007-11-02  0.50 -0.2285   1.8929421609    -2.34994216      0 -2.468601e-01
2007-11-05  0.36 -0.1080   1.7407959097    -1.95679591      0 -3.285041e-01
2007-11-06  0.51 -0.0230   1.5140799383    -1.56007994      0  3.483067e-01
2007-11-07 -0.02  0.0725   1.1553592755    -1.01035928      0           NaN
2007-11-08  0.49  0.1305   0.9630856997    -0.70208570      0           NaN
2007-11-09  0.67  0.1380   0.9451939700    -0.66919397      0  3.128723e-01
2007-11-12  0.60  0.1230   0.9571677226    -0.71116772      0 -1.103481e-01
2007-11-13 -0.03  0.1190   0.9511664813    -0.71316648      0           NaN
2007-11-14  0.01  0.1025   0.9208391396    -0.71583914      0           NaN
2007-11-15  0.08  0.0680   0.8482185929    -0.71221859      0  2.079442e+00
2007-11-16  0.29  0.0515   0.8068117168    -0.70381172      0  1.287854e+00
2007-11-19 -0.03  0.0510   0.8054646063    -0.70346461      0           NaN
2007-11-20 -0.69  0.0420   0.7774654810    -0.69346548      0           NaN
2007-11-21 -0.50  0.0750   0.8565369473    -0.70653695      0           NaN
2007-11-22 -0.30  0.0595   0.8183488512    -0.69934885      0           NaN
2007-11-23 -0.45  0.0485   0.7758101127    -0.67881011      0           NaN
2007-11-26 -0.37  0.0515   0.7888144726    -0.68581447      0           NaN
2007-11-27  0.18  0.1115   1.0005746224    -0.77757462      0           NaN
2007-11-28  0.11  0.1865   1.2710959713    -0.89809597      0 -4.924765e-01
2007-11-29 -0.05  0.2605   1.5047114391    -0.98371144      0           NaN
2007-11-30  0.17  0.3160   1.6607191059    -1.02871911      0           NaN
2007-12-03  0.35  0.3850   1.7950018664    -1.02500187      0  7.221347e-01
2007-12-04  0.33  0.4975   1.9054006394    -0.91040064      0 -5.884050e-02
2007-12-05  0.64  0.5695   1.9081949655    -0.76919497      0  6.623755e-01
2007-12-06  0.18  0.6070   1.8837244273    -0.66972443      0 -1.268511e+00
etc

As you can see when the spread goes negative ROC returns 0.

Is there some way of getting it to produce the right result?

It should work out if there is as later on I go to do this:

# Calculate equity curves
eq_up <- cumprod(1+ret*sigup)
eq_dn <- cumprod(1+ret*sigdn*-1)
eq_all <- cumprod(1+ret*sig)

so that should work appropriately on negative and positive returns 
(shouldn't it)


-- 


Stephen Choularton Ph.D., FIoD


From josh.m.ulrich at gmail.com  Tue Dec 21 03:55:15 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 20 Dec 2010 20:55:15 -0600
Subject: [R-SIG-Finance] ROC
In-Reply-To: <4D101409.2090803@organicfoodmarkets.com.au>
References: <4D101409.2090803@organicfoodmarkets.com.au>
Message-ID: <AANLkTikh02s5-2_ih634Nac_jRRHMtPrT1i52hi9bvLc@mail.gmail.com>

Stephen,

On Mon, Dec 20, 2010 at 8:42 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Hi
>
> I am having a bit of a problem with ROC. ?I am doing some quick backtesting
> and at one point I use this:
>
> ret <- ROC(price)
> ret[1] <- 0
>
> having established the spread between two stocks earlier like this:
>
> price <- spread$Close - spread$Close.1
>
> when I have been working before this has always been positive as the first
> share has always been greater in value than the second. ?But just now I have
> done this with two stocks which are approximately the same value and whose
> values have crossed each other and I get a lot of NAN's
>
<snip>
>
> As you can see when the spread goes negative ROC returns 0.
>
> Is there some way of getting it to produce the right result?
>
You're trying to take the log of a negative number.  What would you
consider to be the right result?

I suspect you want:
ROC(price, type="discrete")

Documentation and the source are available.  Please use them to
investigate "odd" behavior.

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



> It should work out if there is as later on I go to do this:
>
> # Calculate equity curves
> eq_up <- cumprod(1+ret*sigup)
> eq_dn <- cumprod(1+ret*sigdn*-1)
> eq_all <- cumprod(1+ret*sig)
>
> so that should work appropriately on negative and positive returns
> (shouldn't it)
>
>
> --
>
>
> Stephen Choularton Ph.D., FIoD
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From patrick at burns-stat.com  Tue Dec 21 10:37:35 2010
From: patrick at burns-stat.com (Patrick Burns)
Date: Tue, 21 Dec 2010 09:37:35 +0000
Subject: [R-SIG-Finance] ks test to compare manager alphas.
In-Reply-To: <60E01F7C81AAAE468B66CD1A361EFDB4AA4341@sw8exch2010bk>
References: <60E01F7C81AAAE468B66CD1A361EFDB4AA4341@sw8exch2010bk>
Message-ID: <4D10755F.9000206@burns-stat.com>

I think there are some practical problems.

The ks.test will test if funds are different.
It doesn't really test if one fund is better
than the other.

For the data that you are likely to have, I
doubt you have much power.  I would try
simulating with some known distributions to
see how much power there is.

On 20/12/2010 21:04, Chiquoine, Ben wrote:
> Hi,
>
> I've recently discovered ks.test() in the stats package.  I'd like to apply it to alphas generated by hedge fund managers. I have several years of monthly excess returns for each manager and I'd like to see which come from distributions that are not statistically different.  I have two questions for the group.  The first question is whether the KS test is valid for two returns series which are likely not iid?  I think I read that as long as the difference in empirical distributions functions (ecdf) is iid from the true distribution (which I don't know) the test is valid.  My second question is more focused on R.  ks.test gives me the source code for the R function but there are several calls to C code within the function.  I'm wondering if there is any way to view the source for the C functions?  I've searched R help for an answer to this less finance related question but only found one post in which they said the source could be found in a file called ks.c.  Unfortunately
 I!
>    can't find this file on my hard drive or on the web.  Any help this group can offer is greatly appreciated.
>
> Thanks,
>
> Ben
>
> ___________________________________________
> This message and any attached documents contain
> information which may be confidential, subject to
> privilege or exempt from disclosure under applicable
> law. These materials are solely for the use of the
> intended recipient. If you are not the intended
> recipient of this transmission, you are hereby
> notified that any distribution, disclosure, printing,
> copying, storage, modification or the taking of any
> action in reliance upon this transmission is strictly
> prohibited. Delivery of this message to any person
> other than the intended recipient shall not
> compromise or waive such confidentiality, privilege
> or exemption from disclosure as to this
> communication.
>
> If you have received this communication in error,
> please notify the sender immediately and delete
> this message from your system.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe


From wobwu22 at yahoo.de  Tue Dec 21 15:19:29 2010
From: wobwu22 at yahoo.de (Wolfgang Wu)
Date: Tue, 21 Dec 2010 14:19:29 +0000 (GMT)
Subject: [R-SIG-Finance] Possible bug in blotter
Message-ID: <439873.83210.qm@web29614.mail.ird.yahoo.com>

Consider the following example. Initialise portfolio on day 1 with 100 USD, buy 
stock ABC on day 2 at a price of 100, sell stock ABC on day 3 at a price of 100. 
Now the End.Eq in getAccount is showing 200 USD. 


library(blotter)
currency('USD')
stock('ABC', currency='USD', multiplier=1)
initPortf('portA', symbols="ABC", initDate='2010-01-01');
initAcct('accA',portfolios='portA', initDate='2010-01-01', initEq=100);
#Buy on day 2
addTxn("portA", Symbol='ABC', TxnDate='2010-01-02', TxnPrice=100, TxnQty = 1, 
TxnFees=0, verbose=TRUE)
currentPrice <- xts(100, order.by=as.Date('2010-01-02'))
updatePortf('portA', Dates = '2010-01-02', Prices=currentPrice)
updateAcct('accA', Dates = '2010-01-02')
updateEndEq('accA', Dates = '2010-01-02')
#Sell on day 3
addTxn("portA", Symbol='ABC', TxnDate='2010-01-03', TxnPrice=100, TxnQty = -1, 
TxnFees=0, verbose=TRUE)
currentPrice <- xts(100, order.by=as.Date('2010-01-03'))
updatePortf('portA', Dates = '2010-01-03', Prices=currentPrice)
updateAcct('accA', Dates = '2010-01-03')
updateEndEq('accA', Dates = '2010-01-03')
#Equity wrong?
getPortfolio('portA')
getAccount('accA') 

Wolfgang Wu





From peter at braverock.com  Tue Dec 21 16:40:06 2010
From: peter at braverock.com (Peter Carl)
Date: Tue, 21 Dec 2010 09:40:06 -0600
Subject: [R-SIG-Finance] Possible bug in blotter
In-Reply-To: <439873.83210.qm@web29614.mail.ird.yahoo.com>
References: <439873.83210.qm@web29614.mail.ird.yahoo.com>
Message-ID: <a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>

Wolfgang,

Your example is sending in prices in a way that blotter doesn't expect. 
I've modified your example to construct the price series that blotter can
work with.  We'll have to figure out a way to check the price series and
warn the user when it's mangled, so I appreciate the use case.

I've modified your script to construct a time series of prices for the
instrument being traded, ABC.  blotter uses FinancialInstrument to
associate the prices with the instrument, so that you don't have to.  I'd
refer you to the documentation, but we're still writing it...

library(blotter)
currency('USD')
stock('ABC', currency='USD', multiplier=1)
initPortf('portA', symbols="ABC", initDate='2010-01-01');
initAcct('accA',portfolios='portA', initDate='2010-01-01', initEq=100);
#Buy on day 2
addTxn("portA", Symbol='ABC', TxnDate='2010-01-02', TxnPrice=100, TxnQty =
1, TxnFees=0, verbose=TRUE)
ABC <- xts(100, order.by=as.Date('2010-01-02'))
colnames(ABC) = "Close"
updatePortf('portA', Dates = '2010-01-02')
updateAcct('accA', Dates = '2010-01-02')
updateEndEq('accA', Dates = '2010-01-02')
#Sell on day 3
addTxn("portA", Symbol='ABC', TxnDate='2010-01-03', TxnPrice=100, TxnQty =
-1, TxnFees=0, verbose=TRUE)
ABC <- rbind(ABC, xts(100, order.by=as.Date('2010-01-03')))
updatePortf('portA', Dates = '2010-01-03')
updateAcct('accA', Dates = '2010-01-03')
updateEndEq('accA', Dates = '2010-01-03')
#Equity wrong?
getPortfolio('portA')
getAccount('accA')

That results in:
> getAccount('accA')
$portfolios
$portfolios$portA
           Long.Value Short.Value Net.Value Gross.Value Realized.PL
2010-01-01          0           0         0           0           0
2010-01-02        100           0       100         100           0
2010-01-03          0           0         0           0           0
           Unrealized.PL Gross.Trading.PL Txn.Fees Net.Trading.PL
2010-01-01             0                0        0              0
2010-01-02             0                0        0              0
2010-01-03             0                0        0              0


$summary
           Additions Withdrawals Realized.PL Unrealized.PL Int.Income
2010-01-01         0           0           0             0          0
2010-01-02         0           0           0             0          0
2010-01-03         0           0           0             0          0
           Gross.Trading.PL Txn.Fees Net.Trading.PL Advisory.Fees
2010-01-01                0        0              0             0
2010-01-02                0        0              0             0
2010-01-03                0        0              0             0
           Net.Performance End.Eq
2010-01-01               0    100
2010-01-02               0    100
2010-01-03               0    100

attr(,"currency")
[1] "USD"
attr(,"initEq")
[1] 100
attr(,"class")
[1] "portfolio_account" "account"

... which is, I think, what you're looking for.

pcc
-- 
Peter Carl
http://www.braverock.com/~peter

> Consider the following example. Initialise portfolio on day 1 with 100
> USD, buy
> stock ABC on day 2 at a price of 100, sell stock ABC on day 3 at a price
> of 100.
> Now the End.Eq in getAccount is showing 200 USD.
>
>
> library(blotter)
> currency('USD')
> stock('ABC', currency='USD', multiplier=1)
> initPortf('portA', symbols="ABC", initDate='2010-01-01');
> initAcct('accA',portfolios='portA', initDate='2010-01-01', initEq=100);
> #Buy on day 2
> addTxn("portA", Symbol='ABC', TxnDate='2010-01-02', TxnPrice=100, TxnQty =
> 1,
> TxnFees=0, verbose=TRUE)
> currentPrice <- xts(100, order.by=as.Date('2010-01-02'))
> updatePortf('portA', Dates = '2010-01-02', Prices=currentPrice)
> updateAcct('accA', Dates = '2010-01-02')
> updateEndEq('accA', Dates = '2010-01-02')
> #Sell on day 3
> addTxn("portA", Symbol='ABC', TxnDate='2010-01-03', TxnPrice=100, TxnQty =
> -1,
> TxnFees=0, verbose=TRUE)
> currentPrice <- xts(100, order.by=as.Date('2010-01-03'))
> updatePortf('portA', Dates = '2010-01-03', Prices=currentPrice)
> updateAcct('accA', Dates = '2010-01-03')
> updateEndEq('accA', Dates = '2010-01-03')
> #Equity wrong?
> getPortfolio('portA')
> getAccount('accA')
>
> Wolfgang Wu
>
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From megh700004 at gmail.com  Tue Dec 21 18:40:24 2010
From: megh700004 at gmail.com (Megh Dal)
Date: Tue, 21 Dec 2010 23:10:24 +0530
Subject: [R-SIG-Finance] Problem in SVEC estimation, please help
Message-ID: <AANLkTintStWgRG=-fK-FYnP-Oh4vnLYZ3QB405eSd2qz@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101221/85943e0c/attachment.pl>

From ezivot at u.washington.edu  Tue Dec 21 18:45:52 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Tue, 21 Dec 2010 09:45:52 -0800
Subject: [R-SIG-Finance] ks test to compare manager alphas.
In-Reply-To: <4D10755F.9000206@burns-stat.com>
References: <60E01F7C81AAAE468B66CD1A361EFDB4AA4341@sw8exch2010bk>
	<4D10755F.9000206@burns-stat.com>
Message-ID: <000001cba136$e94043c0$bbc0cb40$@washington.edu>

A better method would be to use the bootstrap technique described by Wolfe
and Wunderli. This explicitly controls for the issue of multiple testing.
Similar techniques for controlling data snooping biases are implemented
ttrTest package. 
http://www.iew.uzh.ch/wp/iewwp445.pdf


-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Patrick Burns
Sent: Tuesday, December 21, 2010 1:38 AM
To: r-sig-finance at r-project.org; BChiquoine at tiff.org
Subject: Re: [R-SIG-Finance] ks test to compare manager alphas.

I think there are some practical problems.

The ks.test will test if funds are different.
It doesn't really test if one fund is better
than the other.

For the data that you are likely to have, I
doubt you have much power.  I would try
simulating with some known distributions to
see how much power there is.

On 20/12/2010 21:04, Chiquoine, Ben wrote:
> Hi,
>
> I've recently discovered ks.test() in the stats package.  I'd like to
apply it to alphas generated by hedge fund managers. I have several years of
monthly excess returns for each manager and I'd like to see which come from
distributions that are not statistically different.  I have two questions
for the group.  The first question is whether the KS test is valid for two
returns series which are likely not iid?  I think I read that as long as the
difference in empirical distributions functions (ecdf) is iid from the true
distribution (which I don't know) the test is valid.  My second question is
more focused on R.  ks.test gives me the source code for the R function but
there are several calls to C code within the function.  I'm wondering if
there is any way to view the source for the C functions?  I've searched R
help for an answer to this less finance related question but only found one
post in which they said the source could be found in a file called ks.c.
Unfortunately
 I!
>    can't find this file on my hard drive or on the web.  Any help this
group can offer is greatly appreciated.
>
> Thanks,
>
> Ben
>
> ___________________________________________
> This message and any attached documents contain
> information which may be confidential, subject to
> privilege or exempt from disclosure under applicable
> law. These materials are solely for the use of the
> intended recipient. If you are not the intended
> recipient of this transmission, you are hereby
> notified that any distribution, disclosure, printing,
> copying, storage, modification or the taking of any
> action in reliance upon this transmission is strictly
> prohibited. Delivery of this message to any person
> other than the intended recipient shall not
> compromise or waive such confidentiality, privilege
> or exemption from disclosure as to this
> communication.
>
> If you have received this communication in error,
> please notify the sender immediately and delete
> this message from your system.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From stephen at organicfoodmarkets.com.au  Tue Dec 21 23:06:56 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 22 Dec 2010 09:06:56 +1100
Subject: [R-SIG-Finance] can't find blotter
In-Reply-To: <4D0FB906.8080308@braverock.com>
References: <4D0FB860.4040804@organicfoodmarkets.com.au>
	<4D0FB906.8080308@braverock.com>
Message-ID: <4D112500.8030301@organicfoodmarkets.com.au>

Thanks, but when I tried:


 > install.packages("blotter", repos="http://R-Forge.R-project.org")


from that page I got:

Warning in install.packages("blotter", repos = 
"http://R-Forge.R-project.org") :
argument 'lib' is missing: using 
'C:\Users\Stephen\Documents/R/win-library/2.11'
Warning: unable to access index for repository 
http://R-Forge.R-project.org/bin/windows/contrib/2.11
Warning message:
In getDependencies(pkgs, dependencies, available, lib) :
package ?blotter? is not available

Stephen Choularton Ph.D., FIoD


On 21/12/2010 7:13 AM, Brian G. Peterson wrote:
> On 12/20/2010 02:11 PM, Stephen Choularton wrote:
>> Hi
>>
>> I want to use blotter.
>>
>> )
>> > library(blotter)
>>
>> gets me :
>>
>> Error in library(blotter) : there is no package called 'blotter'
>> >
>>
>> but I cannot find blotter at the Australian repository.
>>
>> Can anyone point me to it?
>>
>
> https://r-forge.r-project.org/R/?group_id=316
>
> Regards,
>
> - Brian
>
>


From josh.m.ulrich at gmail.com  Tue Dec 21 23:11:18 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 21 Dec 2010 16:11:18 -0600
Subject: [R-SIG-Finance] can't find blotter
In-Reply-To: <4D112500.8030301@organicfoodmarkets.com.au>
References: <4D0FB860.4040804@organicfoodmarkets.com.au>
	<4D0FB906.8080308@braverock.com>
	<4D112500.8030301@organicfoodmarkets.com.au>
Message-ID: <AANLkTikJiFACzDXeSQ7qGtH8fJek0jawoL=nxrOaJyVZ@mail.gmail.com>

Hi Stephen,

On Tue, Dec 21, 2010 at 4:06 PM, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> Thanks, but when I tried:
>
>
>> install.packages("blotter", repos="http://R-Forge.R-project.org")
>
>
> from that page I got:
>
> Warning in install.packages("blotter", repos =
> "http://R-Forge.R-project.org") :
> argument 'lib' is missing: using
> 'C:\Users\Stephen\Documents/R/win-library/2.11'
> Warning: unable to access index for repository
> http://R-Forge.R-project.org/bin/windows/contrib/2.11
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
> package ?blotter? is not available
>
> Stephen Choularton Ph.D., FIoD
>
>
Notice "2.11" in the error.  R-forge does not create Windows builds
for anything other than the current major release of R (i.e. 2.12.x).
So you need to upgrade your R installation or build blotter from
source.

Best,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



> On 21/12/2010 7:13 AM, Brian G. Peterson wrote:
>>
>> On 12/20/2010 02:11 PM, Stephen Choularton wrote:
>>>
>>> Hi
>>>
>>> I want to use blotter.
>>>
>>> )
>>> > library(blotter)
>>>
>>> gets me :
>>>
>>> Error in library(blotter) : there is no package called 'blotter'
>>> >
>>>
>>> but I cannot find blotter at the Australian repository.
>>>
>>> Can anyone point me to it?
>>>
>>
>> https://r-forge.r-project.org/R/?group_id=316
>>
>> Regards,
>>
>> - Brian
>>
>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>


From wobwu22 at yahoo.de  Wed Dec 22 11:30:17 2010
From: wobwu22 at yahoo.de (Wolfgang Wu)
Date: Wed, 22 Dec 2010 10:30:17 +0000 (GMT)
Subject: [R-SIG-Finance] Possible bug in blotter
In-Reply-To: <a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>
References: <439873.83210.qm@web29614.mail.ird.yahoo.com>
	<a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>
Message-ID: <24722.79205.qm@web29606.mail.ird.yahoo.com>

Peter, 

thank you for the explanation. I understand this now. However consider a 
different example where the security is now a futures contract with a multiplier 
of 2. Then blotter will produce a wrong End.Eq. (See example code) I suspect the 
Con.Mult column in the first row of the portfolio object is set wrongly and is 
causing the problem.  Would you agree?


library(blotter)
currency('USD')
future('ABC', currency='USD', multiplier=2, tick_size=1)
initPortf('portA', symbols="ABC", initDate='2010-01-01');
initAcct('accA',portfolios='portA', initDate='2010-01-01', initEq=100);
#Buy on day 2
addTxn("portA", Symbol='ABC', TxnDate='2010-01-02', TxnPrice=100, TxnQty =1, 
TxnFees=0, verbose=TRUE)
ABC <- xts(100, order.by=as.Date('2010-01-02'))
colnames(ABC) = "Close"
updatePortf('portA', Dates = '2010-01-02')
updateAcct('accA', Dates = '2010-01-02')
updateEndEq('accA', Dates = '2010-01-02')
#Sell on day 3
addTxn("portA", Symbol='ABC', TxnDate='2010-01-03', TxnPrice=100, TxnQty =-1, 
TxnFees=0, verbose=TRUE)
ABC <- rbind(ABC, xts(100, order.by=as.Date('2010-01-03')))
updatePortf('portA', Dates = '2010-01-03')
updateAcct('accA', Dates = '2010-01-03')
updateEndEq('accA', Dates = '2010-01-03')
#Equity wrong?
getPortfolio('portA')
getAccount('accA')


I then get the following result 

> getPortfolio('portA')
$symbols
$symbols$ABC
$symbols$ABC$txn
           Txn.Qty Txn.Price Txn.Value Txn.Avg.Cost Pos.Qty Pos.Avg.Cost
2010-01-01       0         0         0            0       0            0
2010-01-02       1       100       200          100       1          100
2010-01-03      -1       100      -200          100       0            0
           Gross.Txn.Realized.PL Txn.Fees Net.Txn.Realized.PL Con.Mult
2010-01-01                     0        0                   0        0
2010-01-02                     0        0                   0        2
2010-01-03                     0        0                   0        2

$symbols$ABC$posPL
           Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost Txn.Value
2010-01-01       0        1        1         0            0         0
2010-01-02       1        2        1       200          100       200
2010-01-03       0        2        1         0            0      -200
           Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL Txn.Fees
2010-01-01                  0                    0                0        0
2010-01-02                  0                    0                0        0
2010-01-03                  0                  100              100        0
           Net.Trading.PL
2010-01-01              0
2010-01-02              0
2010-01-03            100

$symbols$ABC$posPL.USD
           Pos.Qty Con.Mult Ccy.Mult Pos.Value Pos.Avg.Cost Txn.Value
2010-01-01       0        1        1         0            0         0
2010-01-02       1        2        1       200          100       200
2010-01-03       0        2        1         0            0      -200
           Period.Realized.PL Period.Unrealized.PL Gross.Trading.PL Txn.Fees
2010-01-01                  0                    0                0        0
2010-01-02                  0                    0                0        0
2010-01-03                  0                  100              100        0
           Net.Trading.PL
2010-01-01              0
2010-01-02              0
2010-01-03            100



$summary
           Long.Value Short.Value Net.Value Gross.Value Period.Realized.PL
2010-01-03          0           0         0           0                  0
           Period.Unrealized.PL Gross.Trading.PL Txn.Fees Net.Trading.PL
2010-01-03                  100              100        0            100

attr(,"class")
[1] "blotter_portfolio" "portfolio"        
attr(,"currency")
[1] "USD"
attr(,"initDate")
[1] "2010-01-01"
> getAccount('accA')
$portfolios
$portfolios$portA
           Long.Value Short.Value Net.Value Gross.Value Realized.PL
2010-01-01          0           0         0           0           0
2010-01-02        200           0       200         200           0
2010-01-03          0           0         0           0           0
           Unrealized.PL Gross.Trading.PL Txn.Fees Net.Trading.PL
2010-01-01             0                0        0              0
2010-01-02             0                0        0              0
2010-01-03           100              100        0            100


$summary
           Additions Withdrawals Realized.PL Unrealized.PL Int.Income
2010-01-01         0           0           0             0          0
2010-01-02         0           0           0             0          0
2010-01-03         0           0           0           100          0
           Gross.Trading.PL Txn.Fees Net.Trading.PL Advisory.Fees
2010-01-01                0        0              0             0
2010-01-02                0        0              0             0
2010-01-03              100        0            100             0
           Net.Performance End.Eq
2010-01-01               0    100
2010-01-02               0    100
2010-01-03             100    200

attr(,"currency")
[1] "USD"
attr(,"initEq")
[1] 100
attr(,"class")
[1] "portfolio_account" "account"          



Thank you!

Regards, Wolfgang Wu




From brian at braverock.com  Wed Dec 22 14:43:24 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 22 Dec 2010 07:43:24 -0600
Subject: [R-SIG-Finance] Possible bug in blotter
In-Reply-To: <24722.79205.qm@web29606.mail.ird.yahoo.com>
References: <439873.83210.qm@web29614.mail.ird.yahoo.com>	<a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>
	<24722.79205.qm@web29606.mail.ird.yahoo.com>
Message-ID: <4D12007C.3060402@braverock.com>

On 12/22/2010 04:30 AM, Wolfgang Wu wrote:
> thank you for the explanation. I understand this now. However consider a
> different example where the security is now a futures contract with a multiplier
> of 2. Then blotter will produce a wrong End.Eq. (See example code) I suspect the
> Con.Mult column in the first row of the portfolio object is set wrongly and is
> causing the problem.  Would you agree?

The first row doesn't have anything to do with it.  That row has a zero 
value, and is only there to initialize things.

It does appear that your example highlights a problem in the multiplier 
being applied to one of the Avg.Cost columns in the $posPL slot.

We'll investigate and fix.  Thanks for the report.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From wobwu22 at yahoo.de  Wed Dec 22 15:06:27 2010
From: wobwu22 at yahoo.de (Wolfgang Wu)
Date: Wed, 22 Dec 2010 14:06:27 +0000 (GMT)
Subject: [R-SIG-Finance] Possible bug in blotter
In-Reply-To: <4D12007C.3060402@braverock.com>
References: <439873.83210.qm@web29614.mail.ird.yahoo.com>
	<a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>
	<24722.79205.qm@web29606.mail.ird.yahoo.com>
	<4D12007C.3060402@braverock.com>
Message-ID: <74676.38185.qm@web29614.mail.ird.yahoo.com>

I don't fully understand the code but the following patch fixes the problem for 
me. 


 tmpPL$Con.Mult.1 <- na.locf(tmpPL$Con.Mult.1)
 tmpPL$Con.Mult.1 <- ifelse(is.na(tmpPL$Con.Mult) & !is.na(tmpPL$Con.Mult.1) , 
tmpPL$Con.Mult.1, tmpPL$Con.Mult)
 tmpPL$Con.Mult <- na.locf(tmpPL$Con.Mult)
+tmpPL$Con.Mult <- na.locf(tmpPL$Con.Mult, fromLast=TRUE)
 tmpPL$Con.Mult <- ifelse(is.na(tmpPL$Con.Mult) ,1, tmpPL$Con.Mult)

There might be a more elegant solution however as I think it might be this bit 
of code quickly assumes that the multiplier is 1 when is.na == true

 tmpPL$Con.Mult <- ifelse(is.na(tmpPL$Con.Mult) ,1, tmpPL$Con.Mult) 

 Wolfgang Wu



----- Urspr?ngliche Mail ----
Von: Brian G. Peterson <brian at braverock.com>
An: r-sig-finance at r-project.org
Gesendet: Mittwoch, den 22. Dezember 2010, 13:43:24 Uhr
Betreff: Re: [R-SIG-Finance] Possible bug in blotter

On 12/22/2010 04:30 AM, Wolfgang Wu wrote:
> thank you for the explanation. I understand this now. However consider a
> different example where the security is now a futures contract with a 
>multiplier
> of 2. Then blotter will produce a wrong End.Eq. (See example code) I suspect 
>the
> Con.Mult column in the first row of the portfolio object is set wrongly and is
> causing the problem.  Would you agree?

The first row doesn't have anything to do with it.  That row has a zero value, 
and is only there to initialize things.

It does appear that your example highlights a problem in the multiplier being 
applied to one of the Avg.Cost columns in the $posPL slot.

We'll investigate and fix.  Thanks for the report.

Regards,

  - Brian

-- Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should 
go.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: updatePosPL.patch
Type: application/octet-stream
Size: 571 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101222/e196a0de/attachment.obj>

From anass.mouhsine at gmail.com  Wed Dec 22 15:24:09 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Wed, 22 Dec 2010 15:24:09 +0100
Subject: [R-SIG-Finance] [quantstrat] Trading a synthetic asset
Message-ID: <4D120A09.6010206@gmail.com>

Hi all,

While using the demos in package quantstrat ( btw a very nice and useful 
package), I wondered about the application on a synthetic asset.
I've seen the possibilities offered by the FinancialInstrument package 
on the subject. This package enables us to define a synthetic asset e.g. 
a spread between two stocks.

My question is about the way of using this synthetic asset in a 
quantstrat strategy.
How is it constructed? How is it handled by the getSymbols function used.

My problem can be seen in two ways:

1- I have a constructed a synthetic spread (of two stocks) as an xts 
object with a varying ratios through time.
How can use it in a quantstrategy as an asset itself? Specifically, 
since quantstrat uses mainly the getSymbols function, how the data 
loading is done?

2-Suppose now I have the original symbols series and a time series of 
weights defining the spread ratio.
I can use the getSymbols function to load original data. How can I 
construct my time-varying spread using the package FinancialInstrument 
and use it in a quantstrat framework?

I would like to know a little bit more about the logic intended when 
facing this kind of use of the quantstrat framework.

Thank you for your insights,

Anass


From brian at braverock.com  Wed Dec 22 15:56:43 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 22 Dec 2010 08:56:43 -0600
Subject: [R-SIG-Finance] [quantstrat] Trading a synthetic asset
In-Reply-To: <4D120A09.6010206@gmail.com>
References: <4D120A09.6010206@gmail.com>
Message-ID: <4D1211AB.3070005@braverock.com>

On 12/22/2010 08:24 AM, Anass Mouhsine wrote:
> Hi all,
>
> While using the demos in package quantstrat ( btw a very nice and useful
> package), I wondered about the application on a synthetic asset.
> I've seen the possibilities offered by the FinancialInstrument package
> on the subject. This package enables us to define a synthetic asset e.g.
> a spread between two stocks.

Yes.  I use it in this way.

> My question is about the way of using this synthetic asset in a
> quantstrat strategy.
> How is it constructed? How is it handled by the getSymbols function used.

There are two answers to this question, the 'simple' answer, and the 
more complex one.  I'll describe the 'simple' answer in some depth, and 
the more complex one more briefly.

> My problem can be seen in two ways:
>
> 1- I have a constructed a synthetic spread (of two stocks) as an xts
> object with a varying ratios through time.
> How can use it in a quantstrategy as an asset itself? Specifically,
> since quantstrat uses mainly the getSymbols function, how the data
> loading is done?

This is the 'simple' approach, and the one I recommend.

You construct the spread time series as an xts object, and tell 
FinancialInstrument (FI) about your spread() instrument.

You can then either use quantmod's setSymbolLookup or FI's 
setSymbolLookup.FI to tell it where you're storing the files or objects, 
or you can just name your xts series for the primary_id of the 'spread' 
instrument, keep it in your .GlobalEnv, and get() and getSymbols() will 
'just find it'.

> 2-Suppose now I have the original symbols series and a time series of
> weights defining the spread ratio.
> I can use the getSymbols function to load original data. How can I
> construct my time-varying spread using the package FinancialInstrument
> and use it in a quantstrat framework?

This gets to be a little more complicated, but still quite feasible. 
There is a simple buildSpread() function in FI that uses OHLC data. 
We're sanitizing and cleaning up a version of this function with more 
functionality that works on tick TBBO data. If you're using the 
getSymbols function on free OHLC data, the existing buildSpread function 
may meet your needs.  Please let us know.

> I would like to know a little bit more about the logic intended when
> facing this kind of use of the quantstrat framework.

I hope this helps answer your direct questions.

I find when building/testing strategies that using a univariate spread 
series is much easier than modeling transactions on the underlying 
instruments. There are several reasons for this, including that most 
modern trading execution platforms have spread execution engines, and 
think of the spread as a single product with multiple execution legs. 
This means that logically, the spread is one product, not all of its 
legs.  Also, the complexity of modeling the orders (in quantstrat or any 
other package) for all the individual legs doesn't seem to add a lot of 
accuracy to your tests, and introduces significant additional 
complexity.  I've done it, but don't tend to do this level of modeling 
anymore, as it detracts from the time I could be spending creating and 
refining strategies by miring me down in execution details.  If that's 
part of your 'edge', then maybe that would be warranted, but it's not 
for me (right now).

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From richard.c.herron at gmail.com  Wed Dec 22 18:21:57 2010
From: richard.c.herron at gmail.com (Richard Herron)
Date: Wed, 22 Dec 2010 12:21:57 -0500
Subject: [R-SIG-Finance] CRSP and R
In-Reply-To: <AANLkTikFNJZbYvCmxqNwKPx9-NQcPh8FjigBx4-D2x4o@mail.gmail.com>
References: <979DD7967E2630469AF05D1820F561C104AE52@BL2PRD0103MB005.prod.exchangelabs.com>
	<4D091497.9070504@braverock.com>
	<AANLkTikFNJZbYvCmxqNwKPx9-NQcPh8FjigBx4-D2x4o@mail.gmail.com>
Message-ID: <AANLkTinEnUbgboeOFPxbgkZ=xT8JapqSwwhEUa=5=OTD@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101222/fd5d31e8/attachment.pl>

From brian at braverock.com  Wed Dec 22 18:44:38 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 22 Dec 2010 11:44:38 -0600
Subject: [R-SIG-Finance] Possible bug in blotter
In-Reply-To: <74676.38185.qm@web29614.mail.ird.yahoo.com>
References: <439873.83210.qm@web29614.mail.ird.yahoo.com>
	<a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>
	<24722.79205.qm@web29606.mail.ird.yahoo.com>
	<4D12007C.3060402@braverock.com>
	<74676.38185.qm@web29614.mail.ird.yahoo.com>
Message-ID: <4D123906.1070406@braverock.com>

On 12/22/2010 08:06 AM, Wolfgang Wu wrote:
> + tmpPL$Con.Mult<- na.locf(tmpPL$Con.Mult, fromLast=TRUE)

I've applied this patch in R-Forge SVN r506.

The 'better' method of NA handling would be to first check the contract 
multiplier in the instrument, but that will take more work to 
incorporate than your one-line patch.

As always, thanks for the report, test case, and patch.

I will try to incorporate your test case directly into the 'tests' for 
blotter soon so we can catch any regression or changes.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From BChiquoine at tiff.org  Wed Dec 22 19:01:03 2010
From: BChiquoine at tiff.org (Chiquoine, Ben)
Date: Wed, 22 Dec 2010 18:01:03 +0000
Subject: [R-SIG-Finance] ks test to compare manager alphas.
In-Reply-To: <000001cba136$e94043c0$bbc0cb40$@washington.edu>
References: <60E01F7C81AAAE468B66CD1A361EFDB4AA4341@sw8exch2010bk>
	<4D10755F.9000206@burns-stat.com>
	<000001cba136$e94043c0$bbc0cb40$@washington.edu>
Message-ID: <60E01F7C81AAAE468B66CD1A361EFDB4AA7958@sw8exch2010bk>

Eric and Pat,

Thanks for the suggestions. I found the paper by Wolfe and Wunderli to be very clearly written and easy to understand however I'm not sure it's the right answer to my problem. I hadn't intended the ks test to be  a tool which would tell me which managers were the best. What I was actually looking for was a test to see which managers were similar and which were different.  This could provide a useful answer to questions like "Do I really want to invest with a new manager whose returns are extremely similar to a manger that is already in my portfolio?" and "Are a managers claims that they are different from other managers w/ the same strategy enforced by examining the historical return distributions?" My guess is that the ks test's indifference to the correlation between two managers may make it less useful than I'd hoped but anecdotal evidence based on 100 months of historical return data seems to suggest that it may have some value.

Thanks,

Ben
 
-----Original Message-----
From: Eric Zivot [mailto:ezivot at u.washington.edu] 
Sent: Tuesday, December 21, 2010 12:46 PM
To: 'Patrick Burns'; r-sig-finance at r-project.org; Chiquoine, Ben
Subject: RE: [R-SIG-Finance] ks test to compare manager alphas.

A better method would be to use the bootstrap technique described by Wolfe
and Wunderli. This explicitly controls for the issue of multiple testing.
Similar techniques for controlling data snooping biases are implemented
ttrTest package. 
http://www.iew.uzh.ch/wp/iewwp445.pdf


-----Original Message-----
From: r-sig-finance-bounces at r-project.org
[mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Patrick Burns
Sent: Tuesday, December 21, 2010 1:38 AM
To: r-sig-finance at r-project.org; BChiquoine at tiff.org
Subject: Re: [R-SIG-Finance] ks test to compare manager alphas.

I think there are some practical problems.

The ks.test will test if funds are different.
It doesn't really test if one fund is better
than the other.

For the data that you are likely to have, I
doubt you have much power.  I would try
simulating with some known distributions to
see how much power there is.

On 20/12/2010 21:04, Chiquoine, Ben wrote:
> Hi,
>
> I've recently discovered ks.test() in the stats package.  I'd like to
apply it to alphas generated by hedge fund managers. I have several years of
monthly excess returns for each manager and I'd like to see which come from
distributions that are not statistically different.  I have two questions
for the group.  The first question is whether the KS test is valid for two
returns series which are likely not iid?  I think I read that as long as the
difference in empirical distributions functions (ecdf) is iid from the true
distribution (which I don't know) the test is valid.  My second question is
more focused on R.  ks.test gives me the source code for the R function but
there are several calls to C code within the function.  I'm wondering if
there is any way to view the source for the C functions?  I've searched R
help for an answer to this less finance related question but only found one
post in which they said the source could be found in a file called ks.c.
Unfortunately
 I!
>    can't find this file on my hard drive or on the web.  Any help this
group can offer is greatly appreciated.
>
> Thanks,
>
> Ben
>
> ___________________________________________
> This message and any attached documents contain
> information which may be confidential, subject to
> privilege or exempt from disclosure under applicable
> law. These materials are solely for the use of the
> intended recipient. If you are not the intended
> recipient of this transmission, you are hereby
> notified that any distribution, disclosure, printing,
> copying, storage, modification or the taking of any
> action in reliance upon this transmission is strictly
> prohibited. Delivery of this message to any person
> other than the intended recipient shall not
> compromise or waive such confidentiality, privilege
> or exemption from disclosure as to this
> communication.
>
> If you have received this communication in error,
> please notify the sender immediately and delete
> this message from your system.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
should go.
>

-- 
Patrick Burns
patrick at burns-stat.com
http://www.burns-stat.com
http://www.portfolioprobe.com/blog
twitter: @portfolioprobe

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.

___________________________________________
This message and any attached documents contain
information which may be confidential, subject to 
privilege or exempt from disclosure under applicable
law. These materials are solely for the use of the 
intended recipient. If you are not the intended 
recipient of this transmission, you are hereby 
notified that any distribution, disclosure, printing, 
copying, storage, modification or the taking of any
action in reliance upon this transmission is strictly
prohibited. Delivery of this message to any person
other than the intended recipient shall not
compromise or waive such confidentiality, privilege
or exemption from disclosure as to this 
communication. 

If you have received this communication in error, 
please notify the sender immediately and delete
this message from your system. 



From stephen at organicfoodmarkets.com.au  Wed Dec 22 20:01:52 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Thu, 23 Dec 2010 06:01:52 +1100
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
Message-ID: <4D124B20.80401@organicfoodmarkets.com.au>

Hi

I'm working on the Blotter example by kafka from R-bloggers.  The code 
goes like this:

require(xts)
require(quantmod)
Sys.setenv(TZ="GMT")
initDate='2000-01-01'
getSymbols('SPY',from=initDate,index.class=c("POSIXt","POSIXct"))
SPY<-adjustOHLC(SPY,use.Adjusted=T)

#yesterday's price
tmp<-lag(SPY,1)

# if today's low is higher than yesterday's close 1, else 0
signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
signal[1]<-0

#let's plot cumulitative return to make sure, that we are on the right path
tmp<-lag(Delt(Cl(SPY)),-1)
tmp[length(tmp)]<-0
plot(cumprod(signal*tmp+1))
  
SPY<-Cl(SPY)
symbols<-c('SPY')

rm(list=ls(envir=.blotter),envir=.blotter)
initPortf(ltportfolio,symbols, initDate=initDate)
initAcct(ltaccount,portfolios=c(ltportfolio), initDate=initDate,initEq=initEq)
  
signal<-signal['2000-02-01::']

for(iin  1:length(signal))
{
	currentDate=  time(signal)[i]
	equity=  getEndEq(ltaccount, currentDate)
	position=  getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)	

	if(position==0)
	{
		#open a new position if signal is>0
		if(signal[i]>0)
		{
			closePrice<-as.double(Cl(SPY[currentDate]))
			unitSize=  as.numeric(trunc((equity/closePrice)))
                         # 5$ per transaction
			addTxn(ltportfolio, Symbol=symbols[1],  TxnDate=currentDate, TxnPrice=closePrice, TxnQty=  -unitSize , TxnFees=5, verbose=T)
		}

	}
	else
	{
		#position is open. If signal is 0 - close it.
		if(as.double(signal[i])==0  &amp;&amp;  position<0)
		{
			position=  getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
			closePrice<-as.double((Cl(SPY[currentDate])))#as.double(get(symbols[1])[i+100])

                         # 5$ per transaction
			addTxn(ltportfolio, Symbol=symbols[1],  TxnDate=currentDate, TxnPrice=closePrice, TxnQty=  -position , TxnFees=5, verbose=T)

		}

	}
	updatePortf(ltportfolio, Dates=  currentDate)
	updateAcct(ltaccount, Dates=  currentDate)
	updateEndEq(ltaccount, Dates=  currentDate)



There appears to be some sort of transcription problem at:

	if(as.double(signal[i])==0  &amp;&amp;  position<0)

so I have changed it to:

	if(as.double(signal[i])==0  &&  position<0)

so the code now reads:

require(xts)
require(quantmod)

Sys.setenv(TZ="GMT")
initDate='2000-01-01'
getSymbols('SPY',from=initDate,index.class=c("POSIXt","POSIXct"))
SPY<-adjustOHLC(SPY,use.Adjusted=T)

#yesterday's price
tmp<-lag(SPY,1)

# if today's low is higher than yesterday's close 1, else 0
signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
signal[1]<-0

#let's plot cumulitative return to make sure, that we are on the right path
tmp<-lag(Delt(Cl(SPY)),-1)
tmp[length(tmp)]<-0
plot(cumprod(signal*tmp+1))
  
SPY<-Cl(SPY)
symbols<-c('SPY')

rm(list=ls(envir=.blotter),envir=.blotter)
initPortf(ltportfolio,symbols, initDate=initDate)
initAcct(ltaccount,portfolios=c(ltportfolio), initDate=initDate,initEq=initEq)
  
signal<-signal['2000-02-01::']

for(iin  1:length(signal))
{
	currentDate=  time(signal)[i]
	equity=  getEndEq(ltaccount, currentDate)
	position=  getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)	

	if(position==0)
	{
		#open a new position if signal is>0
		if(signal[i]>0)
		{
			closePrice<-as.double(Cl(SPY[currentDate]))
			unitSize=  as.numeric(trunc((equity/closePrice)))
                         # 5$ per transaction
			addTxn(ltportfolio, Symbol=symbols[1],  TxnDate=currentDate, TxnPrice=closePrice, TxnQty=  -unitSize , TxnFees=5, verbose=T)
		}

	}
	else
	{
		#position is open. If signal is 0 - close it.
		if(as.double(signal[i])==0  &&  position<0)
		{
			position=  getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
			closePrice<-as.double((Cl(SPY[currentDate])))#as.double(get(symbols[1])[i+100])

                         # 5$ per transaction
			addTxn(ltportfolio, Symbol=symbols[1],  TxnDate=currentDate, TxnPrice=closePrice, TxnQty=  -position , TxnFees=5, verbose=T)

		}

	}
	updatePortf(ltportfolio, Dates=  currentDate)
	updateAcct(ltaccount, Dates=  currentDate)
	updateEndEq(ltaccount, Dates=  currentDate)
  
	equity=  getEndEq(ltaccount, currentDate)

}
plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)

	equity=  getEndEq(ltaccount, currentDate)

}
plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)

but I keep on getting error messages like this:

Error in getEndEq(ltaccount, currentDate) : object 'ltaccount' not found
 > plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
Error in getAccount(ltaccount) : object 'ltaccount' not found
 >
 > equity = getEndEq(ltaccount, currentDate)
Error in getEndEq(ltaccount, currentDate) : object 'ltaccount' not found
 >
 > }
Error: unexpected '}' in "}"
 > plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
Error in getAccount(ltaccount) : object 'ltaccount' not found

I have tried references to blotter like library(blotter) and 
require(blotter) but it makes no difference.

I appreciate I haven't declared these objects/variables but often with R 
and finance they seem to come with the package.  Can anyone point out 
what I am doing wrong?

-- 
Stephen Choularton Ph.D., FIoD


From brian at braverock.com  Wed Dec 22 20:06:41 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 22 Dec 2010 13:06:41 -0600
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
In-Reply-To: <4D124B20.80401@organicfoodmarkets.com.au>
References: <4D124B20.80401@organicfoodmarkets.com.au>
Message-ID: <4D124C41.60106@braverock.com>

Pull his code directly, don't cut and paste HTML:

https://github.com/kafka399/Rproject/blob/master/3lowDays.R

That code Works for Me(tm)

If it doesn't work for you, then you may need to call

update.packages()

or

update.packages('blotter', repos="http://R-Forge.R-project.org")

Regards.

   - Brian

On 12/22/2010 01:01 PM, Stephen Choularton wrote:
> Hi
>
> I'm working on the Blotter example by kafka from R-bloggers. The code
> goes like this:
>
> require(xts)
> require(quantmod)
> Sys.setenv(TZ="GMT")
> initDate='2000-01-01'
> getSymbols('SPY',from=initDate,index.class=c("POSIXt","POSIXct"))
> SPY<-adjustOHLC(SPY,use.Adjusted=T)
>
> #yesterday's price
> tmp<-lag(SPY,1)
>
> # if today's low is higher than yesterday's close 1, else 0
> signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
> signal[1]<-0
>
> #let's plot cumulitative return to make sure, that we are on the right path
> tmp<-lag(Delt(Cl(SPY)),-1)
> tmp[length(tmp)]<-0
> plot(cumprod(signal*tmp+1))
>
> SPY<-Cl(SPY)
> symbols<-c('SPY')
>
> rm(list=ls(envir=.blotter),envir=.blotter)
> initPortf(ltportfolio,symbols, initDate=initDate)
> initAcct(ltaccount,portfolios=c(ltportfolio),
> initDate=initDate,initEq=initEq)
>
> signal<-signal['2000-02-01::']
>
> for(iin 1:length(signal))
> {
> currentDate= time(signal)[i]
> equity= getEndEq(ltaccount, currentDate)
> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
>
> if(position==0)
> {
> #open a new position if signal is>0
> if(signal[i]>0)
> {
> closePrice<-as.double(Cl(SPY[currentDate]))
> unitSize= as.numeric(trunc((equity/closePrice)))
> # 5$ per transaction
> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
> TxnPrice=closePrice, TxnQty= -unitSize , TxnFees=5, verbose=T)
> }
>
> }
> else
> {
> #position is open. If signal is 0 - close it.
> if(as.double(signal[i])==0 &amp;&amp; position<0)
> {
> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
> closePrice<-as.double((Cl(SPY[currentDate])))#as.double(get(symbols[1])[i+100])
>
>
> # 5$ per transaction
> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
> TxnPrice=closePrice, TxnQty= -position , TxnFees=5, verbose=T)
>
> }
>
> }
> updatePortf(ltportfolio, Dates= currentDate)
> updateAcct(ltaccount, Dates= currentDate)
> updateEndEq(ltaccount, Dates= currentDate)
>
>
>
> There appears to be some sort of transcription problem at:
>
> if(as.double(signal[i])==0 &amp;&amp; position<0)
>
> so I have changed it to:
>
> if(as.double(signal[i])==0 && position<0)
>
> so the code now reads:
>
> require(xts)
> require(quantmod)
>
> Sys.setenv(TZ="GMT")
> initDate='2000-01-01'
> getSymbols('SPY',from=initDate,index.class=c("POSIXt","POSIXct"))
> SPY<-adjustOHLC(SPY,use.Adjusted=T)
>
> #yesterday's price
> tmp<-lag(SPY,1)
>
> # if today's low is higher than yesterday's close 1, else 0
> signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
> signal[1]<-0
>
> #let's plot cumulitative return to make sure, that we are on the right path
> tmp<-lag(Delt(Cl(SPY)),-1)
> tmp[length(tmp)]<-0
> plot(cumprod(signal*tmp+1))
>
> SPY<-Cl(SPY)
> symbols<-c('SPY')
>
> rm(list=ls(envir=.blotter),envir=.blotter)
> initPortf(ltportfolio,symbols, initDate=initDate)
> initAcct(ltaccount,portfolios=c(ltportfolio),
> initDate=initDate,initEq=initEq)
>
> signal<-signal['2000-02-01::']
>
> for(iin 1:length(signal))
> {
> currentDate= time(signal)[i]
> equity= getEndEq(ltaccount, currentDate)
> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
>
> if(position==0)
> {
> #open a new position if signal is>0
> if(signal[i]>0)
> {
> closePrice<-as.double(Cl(SPY[currentDate]))
> unitSize= as.numeric(trunc((equity/closePrice)))
> # 5$ per transaction
> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
> TxnPrice=closePrice, TxnQty= -unitSize , TxnFees=5, verbose=T)
> }
>
> }
> else
> {
> #position is open. If signal is 0 - close it.
> if(as.double(signal[i])==0 && position<0)
> {
> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
> closePrice<-as.double((Cl(SPY[currentDate])))#as.double(get(symbols[1])[i+100])
>
>
> # 5$ per transaction
> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
> TxnPrice=closePrice, TxnQty= -position , TxnFees=5, verbose=T)
>
> }
>
> }
> updatePortf(ltportfolio, Dates= currentDate)
> updateAcct(ltaccount, Dates= currentDate)
> updateEndEq(ltaccount, Dates= currentDate)
>
> equity= getEndEq(ltaccount, currentDate)
>
> }
> plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
>
> equity= getEndEq(ltaccount, currentDate)
>
> }
> plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
>
> but I keep on getting error messages like this:
>
> Error in getEndEq(ltaccount, currentDate) : object 'ltaccount' not found
>  > plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
> Error in getAccount(ltaccount) : object 'ltaccount' not found
>  >
>  > equity = getEndEq(ltaccount, currentDate)
> Error in getEndEq(ltaccount, currentDate) : object 'ltaccount' not found
>  >
>  > }
> Error: unexpected '}' in "}"
>  > plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
> Error in getAccount(ltaccount) : object 'ltaccount' not found
>
> I have tried references to blotter like library(blotter) and
> require(blotter) but it makes no difference.
>
> I appreciate I haven't declared these objects/variables but often with R
> and finance they seem to come with the package. Can anyone point out
> what I am doing wrong?
>


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From jctoll at gmail.com  Thu Dec 23 16:29:18 2010
From: jctoll at gmail.com (jctoll)
Date: Thu, 23 Dec 2010 09:29:18 -0600
Subject: [R-SIG-Finance] yahooKeystats broken?
Message-ID: <AANLkTi=VpR_c7MgAHJSaSUzpYpZosfHCuz2GHvcFbQ5e@mail.gmail.com>

Hi,

I've been trying to use the yahooKeystats function from fImport, but I
think it may be broken.

> yahooKeystats("IBM", try=FALSE)
trying URL 'http://finance.yahoo.com/q/ks?s=IBM'
Content type 'text/html; charset=utf-8' length unknown
opened URL
.......... .......... .......... ...
downloaded 33 Kb

Read 151 items
Error in matrix(unlist(strsplit(x, "@")), byrow = TRUE, ncol = 2) :
  attempt to set an attribute on NULL

I tried to check out the code and the problem is that x is basically
empty when it gets passed to matrix().

I think the problem is with this earlier section of code:

if (length(Index) > 0)
            x = x[-Index]

I'm not sure what they were trying to do with that code, but this
looks like the problem.

I was hoping someone could confirm whether yahooKeystats is working or
not for them.

Thanks,


James



> sessionInfo()
R version 2.12.1 (2010-12-16)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] graphics  grDevices utils     datasets  stats     methods   base

other attached packages:
[1] fImport_2110.79              timeSeries_2130.90
timeDate_2130.91             PerformanceAnalytics_1.0.3.2
[5] quantmod_0.3-15              Defaults_1.1-1
TTR_0.20-2                   xts_0.7-5
[9] zoo_1.6-4

loaded via a namespace (and not attached):
[1] grid_2.12.1     lattice_0.19-13


From stephen at organicfoodmarkets.com.au  Thu Dec 23 20:48:45 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Fri, 24 Dec 2010 06:48:45 +1100
Subject: [R-SIG-Finance] reqHistoricalData
In-Reply-To: <AANLkTi=yCC_USLh2kEYL9zonpbyb1d85MnKJyhC_OrFK@mail.gmail.com>
References: <4D085097.5000105@organicfoodmarkets.com.au>	<AANLkTin7JssiUZuKrpU9XKzgvx=R=FgV17p8LP+LDgVF@mail.gmail.com>	<4D094F3F.9020102@organicfoodmarkets.com.au>	<AANLkTi=jw6XHHX-9Z9zCBDw1Zg_sk354UMcQczBNwX3=@mail.gmail.com>	<4D097EDD.90700@organicfoodmarkets.com.au>
	<AANLkTi=yCC_USLh2kEYL9zonpbyb1d85MnKJyhC_OrFK@mail.gmail.com>
Message-ID: <4D13A79D.1060604@organicfoodmarkets.com.au>

Following the logic Jeff's reply to my Re: [R-SIG-Finance] placeOrder 
posting,  I have been trying to reqHistoricalData:


tws <- twsConnect()
tws
reqHistoricalData(tws, twsContract(conId='45998522', symbol='BHP',  
sectype='STK', exch='SNFE', primary='',  expiry='', strike='', 
currency="AUD",  right= "", local = "BJK6", multiplier= "",  
combo_legs_desc= "", comboleg= "", include_expired= "",  secIdType = "", 
secId = ""))
closeAllConnections()

but failing:


 > tws <- twsConnect()
 > tws
<twsConnection,1 @ 20101224 06:11:21 Eastern Standard Time (New South 
Wales), nextId=64>
 > reqHistoricalData(tws, twsContract(conId='45998522', symbol='BHP',  
sectype='STK', exch='SNFE', primary='',  expiry='', strike='', 
currency="AUD",  right= "", local = "BJK6", multiplier= "",  
combo_legs_desc= "", comboleg= "",            include_expired= "",  
secIdType = "", secId = ""))
TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
TWS Message: 2 -1 2106 HMDS data farm connection is OK:hkhmds2
TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
waiting for TWS reply ....NULL
Warning message:
In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106,  :
   No security definition has been found for the request
 >
 > #reqHistoricalData(tws, 'BHP', 'CFD', 'SNFE', 'AUD',duration = '1 M')
 > closeAllConnections()

I'm pretty sure I have the contract correct:


 > tws <- twsConnect()
 > tws
<twsConnection,1 @ 20101224 06:17:03 Eastern Standard Time (New South 
Wales), nextId=64>
 > bhp_cfd <- twsContract("", "BHP", "CFD", "SNFE", "", "", "", "AUD", 
"","","",NULL,NULL,0)
 > reqContractDetails(tws, bhp_cfd)[[1]]
List of 18
  $ version       : chr "6"
  $ contract      :List of 16
   ..$ conId          : chr "45998522"
   ..$ symbol         : chr "BHP"
   ..$ sectype        : chr "CFD"
   ..$ exch           : chr "SNFE"
   ..$ primary        : chr ""
   ..$ expiry         : chr ""
   ..$ strike         : chr "0"
   ..$ currency       : chr "AUD"
   ..$ right          : chr ""
   ..$ local          : chr "BJK6"
   ..$ multiplier     : chr ""
   ..$ combo_legs_desc: chr ""
   ..$ comboleg       : chr ""
   ..$ include_expired: chr ""
   ..$ secIdType      : chr ""
   ..$ secId          : chr ""
   ..- attr(*, "class")= chr "twsContract"
  $ marketName    : chr "BJ"
  $ tradingClass  : chr "BJ"
  $ conId         : chr "45998522"
  $ minTick       : chr "0.01"
  $ orderTypes    : chr [1:33] "ACTIVETIM" "ADJUST" "ALERT" "ALLOC" ...
  $ validExchanges: chr "SNFE"
  $ priceMagnifier: chr "1"
  $ underConId    : chr "4036812"
  $ longName      : chr "BHP BILLITON LIMITED"
  $ contractMonth : chr ""
  $ industry      : chr "Basic Materials"
  $ category      : chr "Mining"
  $ subcategory   : chr "Diversified Minerals"
  $ timeZoneId    : chr "AET"
  $ tradingHours  : chr "20101224:1000-1400;20101229:1000-1600"
  $ liquidHours   : chr "20101224:1000-1400;20101229:1000-1600"
 > closeAllConnections()
 >

I wonder where I am going wrong.


Stephen Choularton Ph.D., FIoD


On 17/12/2010 3:05 AM, Jeff Ryan wrote:
> reqContractDetails(tws, cba_cfd)[[1]]


From jeff.a.ryan at gmail.com  Thu Dec 23 21:16:41 2010
From: jeff.a.ryan at gmail.com (Jeff Ryan)
Date: Thu, 23 Dec 2010 14:16:41 -0600
Subject: [R-SIG-Finance] reqHistoricalData
In-Reply-To: <4D13A79D.1060604@organicfoodmarkets.com.au>
References: <4D085097.5000105@organicfoodmarkets.com.au>
	<AANLkTin7JssiUZuKrpU9XKzgvx=R=FgV17p8LP+LDgVF@mail.gmail.com>
	<4D094F3F.9020102@organicfoodmarkets.com.au>
	<AANLkTi=jw6XHHX-9Z9zCBDw1Zg_sk354UMcQczBNwX3=@mail.gmail.com>
	<4D097EDD.90700@organicfoodmarkets.com.au>
	<AANLkTi=yCC_USLh2kEYL9zonpbyb1d85MnKJyhC_OrFK@mail.gmail.com>
	<4D13A79D.1060604@organicfoodmarkets.com.au>
Message-ID: <C1FF41F7-1473-4494-AE0D-695A4CE65942@gmail.com>

The failure is that you aren't using the contract that succeeds in the reqContractDetails call, instead you are  constructing a new one - incorrectly. 

So the TWS is reporting correctly that there is no contract matching your request. 

Try keeping it simple first, and build upon past successes. You can even extract the correct contract from the reqContractDetails call using as.twsContract()



Hint: STK should be CFD (contract for difference).  

Best,
Jeff


Jeffrey Ryan    |    Founder    |    jeffrey.ryan at lemnica.com

www.lemnica.com

On Dec 23, 2010, at 1:48 PM, Stephen Choularton <stephen at organicfoodmarkets.com.au> wrote:

> Following the logic Jeff's reply to my Re: [R-SIG-Finance] placeOrder posting,  I have been trying to reqHistoricalData:
> 
> 
> tws <- twsConnect()
> tws
> reqHistoricalData(tws, twsContract(conId='45998522', symbol='BHP',  sectype='STK', exch='SNFE', primary='',  expiry='', strike='', currency="AUD",  right= "", local = "BJK6", multiplier= "",  combo_legs_desc= "", comboleg= "", include_expired= "",  secIdType = "", secId = ""))
> closeAllConnections()
> 
> but failing:
> 
> 
> > tws <- twsConnect()
> > tws
> <twsConnection,1 @ 20101224 06:11:21 Eastern Standard Time (New South Wales), nextId=64>
> > reqHistoricalData(tws, twsContract(conId='45998522', symbol='BHP',  sectype='STK', exch='SNFE', primary='',  expiry='', strike='', currency="AUD",  right= "", local = "BJK6", multiplier= "",  combo_legs_desc= "", comboleg= "",            include_expired= "",  secIdType = "", secId = ""))
> TWS Message: 2 -1 2104 Market data farm connection is OK:aufarm
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:hkhmds2
> TWS Message: 2 -1 2106 HMDS data farm connection is OK:ushmds2a
> waiting for TWS reply ....NULL
> Warning message:
> In errorHandler(con, verbose, OK = c(165, 300, 366, 2104, 2106,  :
>  No security definition has been found for the request
> >
> > #reqHistoricalData(tws, 'BHP', 'CFD', 'SNFE', 'AUD',duration = '1 M')
> > closeAllConnections()
> 
> I'm pretty sure I have the contract correct:
> 
> 
> > tws <- twsConnect()
> > tws
> <twsConnection,1 @ 20101224 06:17:03 Eastern Standard Time (New South Wales), nextId=64>
> > bhp_cfd <- twsContract("", "BHP", "CFD", "SNFE", "", "", "", "AUD", "","","",NULL,NULL,0)
> > reqContractDetails(tws, bhp_cfd)[[1]]
> List of 18
> $ version       : chr "6"
> $ contract      :List of 16
>  ..$ conId          : chr "45998522"
>  ..$ symbol         : chr "BHP"
>  ..$ sectype        : chr "CFD"
>  ..$ exch           : chr "SNFE"
>  ..$ primary        : chr ""
>  ..$ expiry         : chr ""
>  ..$ strike         : chr "0"
>  ..$ currency       : chr "AUD"
>  ..$ right          : chr ""
>  ..$ local          : chr "BJK6"
>  ..$ multiplier     : chr ""
>  ..$ combo_legs_desc: chr ""
>  ..$ comboleg       : chr ""
>  ..$ include_expired: chr ""
>  ..$ secIdType      : chr ""
>  ..$ secId          : chr ""
>  ..- attr(*, "class")= chr "twsContract"
> $ marketName    : chr "BJ"
> $ tradingClass  : chr "BJ"
> $ conId         : chr "45998522"
> $ minTick       : chr "0.01"
> $ orderTypes    : chr [1:33] "ACTIVETIM" "ADJUST" "ALERT" "ALLOC" ...
> $ validExchanges: chr "SNFE"
> $ priceMagnifier: chr "1"
> $ underConId    : chr "4036812"
> $ longName      : chr "BHP BILLITON LIMITED"
> $ contractMonth : chr ""
> $ industry      : chr "Basic Materials"
> $ category      : chr "Mining"
> $ subcategory   : chr "Diversified Minerals"
> $ timeZoneId    : chr "AET"
> $ tradingHours  : chr "20101224:1000-1400;20101229:1000-1600"
> $ liquidHours   : chr "20101224:1000-1400;20101229:1000-1600"
> > closeAllConnections()
> >
> 
> I wonder where I am going wrong.
> 
> 
> Stephen Choularton Ph.D., FIoD
> 
> 
> On 17/12/2010 3:05 AM, Jeff Ryan wrote:
>> reqContractDetails(tws, cba_cfd)[[1]]


From thomas.chan.sf at boci-pru.com.hk  Fri Dec 24 09:16:13 2010
From: thomas.chan.sf at boci-pru.com.hk (thomas.chan.sf at boci-pru.com.hk)
Date: Fri, 24 Dec 2010 16:16:13 +0800
Subject: [R-SIG-Finance] error message from portfolioFrontier function
Message-ID: <OF5B0842A8.F83E490E-ON48257803.002D3B6A-48257803.002D6E5D@boci-pru.com.hk>


Hello,

I have tried to use the function portfolioFrontier a few times and always
get this error message:

Execution stopped:
  The minimum risk portfolio could not be computed.
Possible Reason:
  Your portfolio constraints may be too restrictive.
Status Information:
  status=1 from solver solveRquadprog.
Error:
  returned from Rmetrics

Could anyone give me a hint? Thanks.

---------------------------------------------------------------------------------------

Important : The information contained in this e-mail and any attachment thereof is intended only for use of the addressee and is confidential and may be privileged and/or otherwise protected from disclosure. If you are not the intended recipient, you are hereby notified that any use, copying, dissemination or any other action taken or omitted to be taken in reliance upon this information is strictly prohibited. If you have received this communication in error, please notify the sender immediately by reply and delete this message from your system. Any views expressed in this e-mail are those of the individual sender except where the e-mail states otherwise and the sender is authorized to state them to be the views of BOCI-Prudential Asset Management Limited. Unless otherwise stated, any information given in this e-mail shall not be regarded as an offer, solicitation, invitation, advice or recommendation to buy or sell any investment or securities within or outside Hong Kong SAR. Any reference to the terms of executed transactions should be treated as preliminary only and subject to our formal written confirmation.


______________________________________________________________________
This email has been scanned by the MessageLabs Email Security System.
For more information please visit http://www.messagelabs.com/email


From anass.mouhsine at gmail.com  Fri Dec 24 09:45:49 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Fri, 24 Dec 2010 09:45:49 +0100
Subject: [R-SIG-Finance] R-SIG-Finance Digest, Vol 79, Issue 23
In-Reply-To: <mailman.1.1293102002.4036.r-sig-finance@r-project.org>
References: <mailman.1.1293102002.4036.r-sig-finance@r-project.org>
Message-ID: <4D145DBD.3050002@gmail.com>

Thank you Brian for your insights.

I understand a little bit more the philosophy behind the spread 
definition with Financial Instruments.
I totally agree with you on the necessity to test a spread as a 
univariate time series without entering in the constitution of the 
portfolio synthetizing it.
The modus operandi that I understand now is to construct whatever spread 
I want (varying or not) using my own calculations functions in R and 
then declaring it in FI in order to be handled by quantstrat.

Thank you again and merry christmas ;-)

On 23/12/2010 12:00, r-sig-finance-request at r-project.org wrote:
> Message: 4
> Date: Wed, 22 Dec 2010 08:56:43 -0600
> From: "Brian G. Peterson"<brian at braverock.com>
> To:r-sig-finance at r-project.org
> Subject: Re: [R-SIG-Finance] [quantstrat] Trading a synthetic asset
> Message-ID:<4D1211AB.3070005 at braverock.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> On 12/22/2010 08:24 AM, Anass Mouhsine wrote:
>> >  Hi all,
>> >
>> >  While using the demos in package quantstrat ( btw a very nice and useful
>> >  package), I wondered about the application on a synthetic asset.
>> >  I've seen the possibilities offered by the FinancialInstrument package
>> >  on the subject. This package enables us to define a synthetic asset e.g.
>> >  a spread between two stocks.
> Yes.  I use it in this way.
>
>> >  My question is about the way of using this synthetic asset in a
>> >  quantstrat strategy.
>> >  How is it constructed? How is it handled by the getSymbols function used.
> There are two answers to this question, the 'simple' answer, and the
> more complex one.  I'll describe the 'simple' answer in some depth, and
> the more complex one more briefly.
>
>> >  My problem can be seen in two ways:
>> >
>> >  1- I have a constructed a synthetic spread (of two stocks) as an xts
>> >  object with a varying ratios through time.
>> >  How can use it in a quantstrategy as an asset itself? Specifically,
>> >  since quantstrat uses mainly the getSymbols function, how the data
>> >  loading is done?
> This is the 'simple' approach, and the one I recommend.
>
> You construct the spread time series as an xts object, and tell
> FinancialInstrument (FI) about your spread() instrument.
>
> You can then either use quantmod's setSymbolLookup or FI's
> setSymbolLookup.FI to tell it where you're storing the files or objects,
> or you can just name your xts series for the primary_id of the 'spread'
> instrument, keep it in your .GlobalEnv, and get() and getSymbols() will
> 'just find it'.
>
>> >  2-Suppose now I have the original symbols series and a time series of
>> >  weights defining the spread ratio.
>> >  I can use the getSymbols function to load original data. How can I
>> >  construct my time-varying spread using the package FinancialInstrument
>> >  and use it in a quantstrat framework?
> This gets to be a little more complicated, but still quite feasible.
> There is a simple buildSpread() function in FI that uses OHLC data.
> We're sanitizing and cleaning up a version of this function with more
> functionality that works on tick TBBO data. If you're using the
> getSymbols function on free OHLC data, the existing buildSpread function
> may meet your needs.  Please let us know.
>
>> >  I would like to know a little bit more about the logic intended when
>> >  facing this kind of use of the quantstrat framework.
> I hope this helps answer your direct questions.
>
> I find when building/testing strategies that using a univariate spread
> series is much easier than modeling transactions on the underlying
> instruments. There are several reasons for this, including that most
> modern trading execution platforms have spread execution engines, and
> think of the spread as a single product with multiple execution legs.
> This means that logically, the spread is one product, not all of its
> legs.  Also, the complexity of modeling the orders (in quantstrat or any
> other package) for all the individual legs doesn't seem to add a lot of
> accuracy to your tests, and introduces significant additional
> complexity.  I've done it, but don't tend to do this level of modeling
> anymore, as it detracts from the time I could be spending creating and
> refining strategies by miring me down in execution details.  If that's
> part of your 'edge', then maybe that would be warranted, but it's not
> for me (right now).
>
> Regards,
>
>     - Brian
>
> -- Brian G. Peterson http://braverock.com/brian/ Ph: 773-459-4973 IM: 
> bgpbraverock


From wobwu22 at yahoo.de  Fri Dec 24 10:35:05 2010
From: wobwu22 at yahoo.de (Wolfgang Wu)
Date: Fri, 24 Dec 2010 09:35:05 +0000 (GMT)
Subject: [R-SIG-Finance] Another blotter test case
In-Reply-To: <4D123906.1070406@braverock.com>
References: <439873.83210.qm@web29614.mail.ird.yahoo.com>
	<a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>
	<24722.79205.qm@web29606.mail.ird.yahoo.com>
	<4D12007C.3060402@braverock.com>
	<74676.38185.qm@web29614.mail.ird.yahoo.com>
	<4D123906.1070406@braverock.com>
Message-ID: <326444.13307.qm@web29613.mail.ird.yahoo.com>

I am still bumping into problems trying to implement some of our trading 
strategies using blotter. So here is another one that seems to go wrong using 
r511.

library(blotter)
dateRange <- as.Date(as.Date('2010-01-02'):as.Date('2010-01-05'))
currency('USD')
stock('ABC', currency='USD')
ABC <- xts(102:105, order.by=dateRange)
colnames(ABC) = "Close"

initPortf('portA', symbols="ABC", initDate='2010-01-01');
initAcct('accA',portfolios='portA', initDate='2010-01-01', initEq=100);
addTxn("portA", Symbol='ABC', TxnDate='2010-01-02', TxnPrice=102, TxnQty =1, 
TxnFees=0, verbose=TRUE)
updatePortf('portA', Dates = dateRange)
updateAcct('accA', Dates = dateRange)
updateEndEq('accA', Dates = dateRange)
#Equity wrong?
getAccount('accA')



I get the following result with the End.Eq staying at 101 where I am expecting 
it to increase as the stock increases in value.

$portfolios
$portfolios$portA
           Long.Value Short.Value Net.Value Gross.Value Realized.PL
2010-01-01          0           0         0           0           0
2010-01-02        102           0       102         102           0
2010-01-03        103           0       103         103           0
2010-01-04        104           0       104         104           0
2010-01-05        105           0       105         105           0
           Unrealized.PL Gross.Trading.PL Txn.Fees Net.Trading.PL
2010-01-01             0                0        0              0
2010-01-02             0                0        0              0
2010-01-03             1                1        0              1
2010-01-04             1                1        0              1
2010-01-05             1                1        0              1


$summary
           Additions Withdrawals Realized.PL Unrealized.PL Int.Income
2010-01-01         0           0           0             0          0
2010-01-02         0           0           0             0          0
2010-01-03         0           0           0             1          0
2010-01-04         0           0           0             1          0
2010-01-05         0           0           0             1          0
           Gross.Trading.PL Txn.Fees Net.Trading.PL Advisory.Fees
2010-01-01                0        0              0             0
2010-01-02                0        0              0             0
2010-01-03                1        0              1             0
2010-01-04                1        0              1             0
2010-01-05                1        0              1             0
           Net.Performance End.Eq
2010-01-01               0    100
2010-01-02               0    100
2010-01-03               1    101
2010-01-04               1    101
2010-01-05               1    101

attr(,"currency")
[1] "USD"
attr(,"initEq")
[1] 100
attr(,"class")
[1] "portfolio_account" "account"          


Regards, Wolfgang Wu




From brian at braverock.com  Fri Dec 24 13:38:53 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Dec 2010 06:38:53 -0600
Subject: [R-SIG-Finance] Another blotter test case
In-Reply-To: <326444.13307.qm@web29613.mail.ird.yahoo.com>
References: <439873.83210.qm@web29614.mail.ird.yahoo.com>	<a6c6174c82865adf999d730ad0548991.squirrel@mail.braverock.com>	<24722.79205.qm@web29606.mail.ird.yahoo.com>	<4D12007C.3060402@braverock.com>	<74676.38185.qm@web29614.mail.ird.yahoo.com>	<4D123906.1070406@braverock.com>
	<326444.13307.qm@web29613.mail.ird.yahoo.com>
Message-ID: <4D14945D.7080902@braverock.com>

On 12/24/2010 03:35 AM, Wolfgang Wu wrote:
> I am still bumping into problems trying to implement some of our trading
> strategies using blotter. So here is another one that seems to go wrong using
> r511.
>
> library(blotter)
> dateRange<- as.Date(as.Date('2010-01-02'):as.Date('2010-01-05'))
> currency('USD')
> stock('ABC', currency='USD')
> ABC<- xts(102:105, order.by=dateRange)
> colnames(ABC) = "Close"
>
> initPortf('portA', symbols="ABC", initDate='2010-01-01');
> initAcct('accA',portfolios='portA', initDate='2010-01-01', initEq=100);
> addTxn("portA", Symbol='ABC', TxnDate='2010-01-02', TxnPrice=102, TxnQty =1,
> TxnFees=0, verbose=TRUE)
> updatePortf('portA', Dates = dateRange)
> updateAcct('accA', Dates = dateRange)
> updateEndEq('accA', Dates = dateRange)
> #Equity wrong?
> getAccount('accA')
>
>
>
> I get the following result with the End.Eq staying at 101 where I am expecting
> it to increase as the stock increases in value.
>

This looks like a bug.  Looks like for some reason updateEndEq isn't 
accumulating the Trading.PL.  It's showing properly in the $posPL slot 
as Unrealized.PL and Trading.PL, so we'll have to sort out what's wrong 
with the equity calculation.

Thanks for the report, should be fixed at the latest early next week. 
As always, thank you for the reproducible test case, these always make 
debugging easier.

Also, for 'bug reports', it's generally considered best to email the 
maintainer of the package first, to not bother the list.  For 'help' or 
'support' requests, the list may be a better outlet, as others will 
likely have relevant experience and all benefit from sharing.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Fri Dec 24 13:41:03 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Dec 2010 06:41:03 -0600
Subject: [R-SIG-Finance] error message from portfolioFrontier function
In-Reply-To: <OF5B0842A8.F83E490E-ON48257803.002D3B6A-48257803.002D6E5D@boci-pru.com.hk>
References: <OF5B0842A8.F83E490E-ON48257803.002D3B6A-48257803.002D6E5D@boci-pru.com.hk>
Message-ID: <4D1494DF.7050509@braverock.com>

On 12/24/2010 02:16 AM, thomas.chan.sf at boci-pru.com.hk wrote:
>
> Hello,
>
> I have tried to use the function portfolioFrontier a few times and always
> get this error message:
>
> Execution stopped:
>    The minimum risk portfolio could not be computed.
> Possible Reason:
>    Your portfolio constraints may be too restrictive.
> Status Information:
>    status=1 from solver solveRquadprog.
> Error:
>    returned from Rmetrics
>
> Could anyone give me a hint? Thanks.

The error message *is* a hint, and likely describes the problem you are 
having precisely.

You need to construct a minimal reproducible example, per the posting 
guide, so that others may reproduce your problem, and confirm whether 
the problem is in your constraints, as indicated by the error, or in the 
code.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From anass.mouhsine at gmail.com  Fri Dec 24 14:40:03 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Fri, 24 Dec 2010 14:40:03 +0100
Subject: [R-SIG-Finance] [quantstrat] trading a synthetic asset -- example
Message-ID: <4D14A2B3.5080006@gmail.com>

Hi all,

here is an example code for a basic strategy on a synthetic asset. (with 
error :-( )
Let us assume  I already calculated the synthetic asset.
You will find it attached.

require(quantstrat)

try(rm("order_book.testP",pos=.strategy),silent=TRUE)
try(rm("account.testP","portfolio.testP",pos=.blotter),silent=TRUE)
try(rm("account.st","portfolio.st","synth.str","stratComp","initDate","initEq",'start_t','end_t'),silent=TRUE)


### Here I prepare the asset####
synth.str='test'
testdata<-read.csv("test.csv",colClasses=c("character","numeric"),sep=";")
test<-as.xts(testdata[,2],order.by=as.POSIXct(testdata[,1],format="%Y-%m-%d"),tzone="America/New_York", 
src="csv", updated=Sys.time())
colnames(test)<-"test"

####Then I will define it####
currency('USD')
synthetic(synth.str,currency='USD',multiplier=1,tick_size=0.000001)
# BTW, I have to specify a multiplier and a tick_size otherwise there is 
an error

initDate='2007-11-01'
initEq=1000000
portfolio.st='testP'
account.st='testP'

initPortf(portfolio.st,symbols=synth.str, initDate=initDate)
initAcct(account.st,portfolios=portfolio.st, initDate=initDate)
initOrders(portfolio=portfolio.st,initDate=initDate)

buyin=-1.5*sd(C15)

#Define function stand
stand<-function(x)
{
   t<-cbind(x,x)
   colnames(t)<-c(colnames(x),"signal")
   return(t)
}


stratComp <- strategy(portfolio.st)

stratComp <- add.indicator(strategy = stratComp, name = "stand", 
arguments = list(x=quote(mktdata)) )

stratComp <- add.signal(strategy = 
stratComp,name="sigThreshold",arguments = 
list(column="signal",relationship="gt",threshold=buyin,cross=TRUE),label="signal.gt.buyin")

#buy rule
stratComp <- add.rule(strategy = stratComp,name='ruleSignal', arguments 
= list(sigcol="signal.gt.buyin",sigval=TRUE, orderqty=1, 
ordertype='market', orderside='long', threshold=NULL),type='enter')
stratComp <- add.rule(strategy = stratComp,name='ruleSignal', arguments 
= list(sigcol="signal.gt.buyin",sigval=TRUE, orderqty=-1, 
ordertype='stoplimit', orderside='long', 
threshold=.90,tmult=TRUE),type='risk')

out<-try(applyStrategy(strategy=stratComp , portfolios=portfolio.st))

I have then the following error

Error in getPrice(x = data, prefer = prefer) :
   subscript out of bounds, no price was discernible from the data
De plus : Message d'avis :
In max(i) : aucun argument pour max ; -Inf est renvoy?
Error in if (price == 0) stop("price", price, "must be positive or 
negative") :
   valeur manquante l? o? TRUE / FALSE est requis

I understand that the getPrice function works on OHLC prices.
the synthetic asset, as such, is just a one column price time-series.

Is there a way to use the applyStrategy function on non-OHLC time-series?

Thx in advance

Anass
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101224/31cd0cd6/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.csv
Type: application/vnd.ms-excel
Size: 29369 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101224/31cd0cd6/attachment.xlb>

From brian at braverock.com  Fri Dec 24 14:59:48 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Dec 2010 07:59:48 -0600
Subject: [R-SIG-Finance] [quantstrat] trading a synthetic asset --
	example
In-Reply-To: <4D14A2B3.5080006@gmail.com>
References: <4D14A2B3.5080006@gmail.com>
Message-ID: <4D14A754.905@braverock.com>

Either pass

prefer='test'

since that's what you called the price column, or better yet, name the 
column 'Price', or 'price' , or 'spread.price' (basically anything with 
'price' in it.

getPrice will then be able to figure it out.

I'll run your example later to confirm, but this is almost certainly the 
issue.

Regards,

   - Brian



On 12/24/2010 07:40 AM, Anass Mouhsine wrote:
> Hi all,
>
> here is an example code for a basic strategy on a synthetic asset. (with
> error :-( )
> Let us assume I already calculated the synthetic asset.
> You will find it attached.
>
> require(quantstrat)
>
> try(rm("order_book.testP",pos=.strategy),silent=TRUE)
> try(rm("account.testP","portfolio.testP",pos=.blotter),silent=TRUE)
> try(rm("account.st","portfolio.st","synth.str","stratComp","initDate","initEq",'start_t','end_t'),silent=TRUE)
>
>
> ### Here I prepare the asset####
> synth.str='test'
> testdata<-read.csv("test.csv",colClasses=c("character","numeric"),sep=";")
> test<-as.xts(testdata[,2],order.by=as.POSIXct(testdata[,1],format="%Y-%m-%d"),tzone="America/New_York",
> src="csv", updated=Sys.time())
> colnames(test)<-"test"
>
> ####Then I will define it####
> currency('USD')
> synthetic(synth.str,currency='USD',multiplier=1,tick_size=0.000001)
> # BTW, I have to specify a multiplier and a tick_size otherwise there is
> an error
>
> initDate='2007-11-01'
> initEq=1000000
> portfolio.st='testP'
> account.st='testP'
>
> initPortf(portfolio.st,symbols=synth.str, initDate=initDate)
> initAcct(account.st,portfolios=portfolio.st, initDate=initDate)
> initOrders(portfolio=portfolio.st,initDate=initDate)
>
> buyin=-1.5*sd(C15)
>
> #Define function stand
> stand<-function(x)
> {
> t<-cbind(x,x)
> colnames(t)<-c(colnames(x),"signal")
> return(t)
> }
>
>
> stratComp <- strategy(portfolio.st)
>
> stratComp <- add.indicator(strategy = stratComp, name = "stand",
> arguments = list(x=quote(mktdata)) )
>
> stratComp <- add.signal(strategy =
> stratComp,name="sigThreshold",arguments =
> list(column="signal",relationship="gt",threshold=buyin,cross=TRUE),label="signal.gt.buyin")
>
> #buy rule
> stratComp <- add.rule(strategy = stratComp,name='ruleSignal', arguments
> = list(sigcol="signal.gt.buyin",sigval=TRUE, orderqty=1,
> ordertype='market', orderside='long', threshold=NULL),type='enter')
> stratComp <- add.rule(strategy = stratComp,name='ruleSignal', arguments
> = list(sigcol="signal.gt.buyin",sigval=TRUE, orderqty=-1,
> ordertype='stoplimit', orderside='long',
> threshold=.90,tmult=TRUE),type='risk')
>
> out<-try(applyStrategy(strategy=stratComp , portfolios=portfolio.st))
>
> I have then the following error
>
> Error in getPrice(x = data, prefer = prefer) :
> subscript out of bounds, no price was discernible from the data
> De plus : Message d'avis :
> In max(i) : aucun argument pour max ; -Inf est renvoy?
> Error in if (price == 0) stop("price", price, "must be positive or
> negative") :
> valeur manquante l? o? TRUE / FALSE est requis
>
> I understand that the getPrice function works on OHLC prices.
> the synthetic asset, as such, is just a one column price time-series.
>
> Is there a way to use the applyStrategy function on non-OHLC time-series?
>
> Thx in advance
>
> Anass
>
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Fri Dec 24 15:21:18 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 24 Dec 2010 08:21:18 -0600
Subject: [R-SIG-Finance] [quantstrat] trading a synthetic asset --
	example
In-Reply-To: <4D14A2B3.5080006@gmail.com>
References: <4D14A2B3.5080006@gmail.com>
Message-ID: <4D14AC5E.1020509@braverock.com>

On 12/24/2010 07:40 AM, Anass Mouhsine wrote:
> I understand that the getPrice function works on OHLC prices.
> the synthetic asset, as such, is just a one column price time-series.

I figure I should probably clarify this too.

getPrice tries to figure things out from the structure of the data.  As 
such, it tests for OHLC, TBBO (tick), or univariate 'price' series and 
makes its best guess.

Beyond that, if the best guess isn't good enough, as in the proffered 
test case, the 'prefer=' argument will tell getPrice what column to go 
looking for in your data.

> Is there a way to use the applyStrategy function on non-OHLC time-series?

Yes.  We do it all the time on tick data, including synthetic 
instruments that may be univariate price series, or (for example) 
bid/ask/mid columns for a spread (to show execution slippage when 
crossing markets to hit the other side of the spread, for example).

Regards,

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From edd at debian.org  Fri Dec 24 17:12:11 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Fri, 24 Dec 2010 10:12:11 -0600
Subject: [R-SIG-Finance] R/Finance 2011: Call for Papers: Now with prices
	and travel money
Message-ID: <19732.50779.560330.531348@max.nulle.part>


Dear R / Finance community,

The preparations for R/Finance 2011 are progressing, and due to favourable
responses from the different sponsors we contacted, we are now able to offer

  a) a competition for best paper, which given the focus of the conference
     will award for both an 'academic' paper and an 'industry' paper

  b) availability of travel grants for up to two graduate students provided
     suitable papers were accepted for presentations

More details are below in the updated Call for Papers. Please feel free to
re-circulate this Call for Papers with collegues, students and other
associations.

Cheers, and Season's Greeting,

Dirk (on behalf of the organizing / program committee)




Call for Papers:

R/Finance 2011: Applied Finance with R
April 29 and 30, 2011
Chicago, IL, USA


The third annual R/Finance conference for applied finance using R will be
held this spring in Chicago, IL, USA on April 29 and 30, 2011.  The two-day
conference will cover topics including portfolio management, time series
analysis, advanced risk tools, high-performance computing, market
microstructure and econometrics. All will be discussed within the context of
using R as a primary tool for financial risk management, portfolio
construction, and trading.

Complete papers or one-page abstracts (in txt or pdf format) are invited to
be submitted for consideration. Academic and practitioner proposals related
to R are encouraged. We welcome submissions for full talks, abbreviated
"lightning talks", and for a limited number of pre-conference (longer)
seminar sessions.


Presenters are strongly encouraged to provide working R code to accompany the
presentation/paper.  Data sets should also be made public for the purposes of
reproducibility (though we realize this may be limited due to contracts with
data vendors). Preference may be given to presenters who have released R
packages.

The conference will award two $1000 prizes for best paper: one for best
practitioner-oriented paper and one for best academic-oriented paper.
Further, to defray costs for graduate students, two travel and expense grants
of up to $500 each will be awarded to graduate students whose papers are
accepted.  To be eligible, a submission must be a full paper; extended
abstracts are not eligible.

Please send submissions to: committee "at" RinFinance.com

The submission deadline is February 15th, 2011.  Early submissions may
receive early acceptance and scheduling.  The graduate student grant winners
will be notified by February 23rd, 2011.

Submissions will be evaluated and submitters notified via email on a rolling
basis. Determination of whether a presentation will be a long presentation or
a lightning talk will be made once the full list of presenters is known.


R/Finance 2009 and 2010 included attendees from around the world and featured
keynote presentations from prominent academics and practitioners. 2009-2010
presenters names and presentations are online at the conference website. We
anticipate another exciting line-up for 2011---including keynote
presentations from John Bollinger, Mebane Faber, Stefano Iacus, and Louis
Kates.  Additional details will be announced via the conference website
http://www.RinFinance.com/ as they become available.


For the program committee:

	Gib Bassett, Peter Carl, Dirk Eddelbuettel, Brian Peterson, 
	Dale Rosenthal, Jeffrey Ryan, Joshua Ulrich


-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From alex.rudnev at gmail.com  Fri Dec 24 20:33:20 2010
From: alex.rudnev at gmail.com (alex.rudnev at gmail.com)
Date: Fri, 24 Dec 2010 19:33:20 +0000
Subject: [R-SIG-Finance] error message from portfolioFrontier function
In-Reply-To: <4D1494DF.7050509@braverock.com>
References: <OF5B0842A8.F83E490E-ON48257803.002D3B6A-48257803.002D6E5D@boci-pru.com.hk><4D1494DF.7050509@braverock.com>
Message-ID: <2079197138-1293219218-cardhu_decombobulator_blackberry.rim.net-562882739-@bda342.bisx.prod.on.blackberry>

I had several variations of the same problem and I have data set and code to reproduce it on R2.11 (REvolution 4.0). It happened on R2.12 as well, but on different data sets, and I never got the it captured due to lack of time.
It boils down to problem in Fortran code that is part of solve.QP, which in turn is called from .rquadprog. And the optimization problem is almost certainly solvable for that data set / constraints...

Error from the solver can be better handled in Rmetrics code, but it seems that root of it is in quadprog code. Should I send it to maintainers of both packages just in case (I guess I'll do it anyway), or simply post it here?
 
Regards,
Alex

Sent via BlackBerry by AT&T

-----Original Message-----
From: "Brian G. Peterson" <brian at braverock.com>
Sender: r-sig-finance-bounces at r-project.org
Date: Fri, 24 Dec 2010 06:41:03 
To: <r-sig-finance at r-project.org>
Subject: Re: [R-SIG-Finance] error message from portfolioFrontier function

On 12/24/2010 02:16 AM, thomas.chan.sf at boci-pru.com.hk wrote:
>
> Hello,
>
> I have tried to use the function portfolioFrontier a few times and always
> get this error message:
>
> Execution stopped:
>    The minimum risk portfolio could not be computed.
> Possible Reason:
>    Your portfolio constraints may be too restrictive.
> Status Information:
>    status=1 from solver solveRquadprog.
> Error:
>    returned from Rmetrics
>
> Could anyone give me a hint? Thanks.

The error message *is* a hint, and likely describes the problem you are 
having precisely.

You need to construct a minimal reproducible example, per the posting 
guide, so that others may reproduce your problem, and confirm whether 
the problem is in your constraints, as indicated by the error, or in the 
code.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.

From anass.mouhsine at gmail.com  Mon Dec 27 13:15:41 2010
From: anass.mouhsine at gmail.com (Anass Mouhsine)
Date: Mon, 27 Dec 2010 13:15:41 +0100
Subject: [R-SIG-Finance] [quantstrat] trading a synthetic asset --
	example
Message-ID: <4D18836D.3010008@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101227/341a84f7/attachment.pl>

From noah at smartmediacorp.com  Mon Dec 27 19:02:59 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 27 Dec 2010 10:02:59 -0800
Subject: [R-SIG-Finance] LSPM - Unexpected Results
Message-ID: <4D18D4D3.5030501@smartmediacorp.com>

Hi,

I've been playing with the LSPM library from optimizing a portfolio of
13 assets (Using the interesting Leverage Space model developed by Ralph
Vince.)

Using the function:  maxProbProfit

res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
calc.max=4, snow=cl, control=DEctrl)

It takes a LONG time for the optmizer to find a solution.

It has found a solution that has a 100% probability of profit given the
constraints.

The odd thing is that several of the values (optimal F) are negative. 
My understanding is that indicates shorting the asset.  This assets in
this portfolio can't be shorted.

I've never read about shorting with the LSPM model, is this common?
Is there a way to indicate, as a constraint, not to short?
I have a portfolio of X dollars to allocate, so the percentages must sum
to one, how do I do this once I get the F values?

Thanks in advance for any and all suggestions!

--
Noah


From markknecht at gmail.com  Mon Dec 27 19:07:13 2010
From: markknecht at gmail.com (Mark Knecht)
Date: Mon, 27 Dec 2010 10:07:13 -0800
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <4D18D4D3.5030501@smartmediacorp.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
Message-ID: <AANLkTinhBGaN99PD7WNVPi96njtMX9Cki+ks90GC16L-@mail.gmail.com>

On Mon, Dec 27, 2010 at 10:02 AM, Noah Silverman
<noah at smartmediacorp.com> wrote:
<SNP>
> It has found a solution that has a 100% probability of profit given the
> constraints.
<SNIP>

I don't know anything about that package but anytime I see a computer
program tell me there's a 100% chance of profit it's a big red flag
that I probably did something wrong.

That's just me though. ;-)

Cheers,
Mark


From noah at smartmediacorp.com  Mon Dec 27 19:19:38 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 27 Dec 2010 10:19:38 -0800
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <AANLkTinhBGaN99PD7WNVPi96njtMX9Cki+ks90GC16L-@mail.gmail.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
	<AANLkTinhBGaN99PD7WNVPi96njtMX9Cki+ks90GC16L-@mail.gmail.com>
Message-ID: <4D18D8BA.50302@smartmediacorp.com>

Mark,

Clearly this is a THEORETICAL value.  One of the first things I ever
learned about finance was that past performance is not a predictor of
future performance.  Since the portfolio optimization is based on past
returns, then its obvious we don't expect the same performance in the
future.

I suggest you read Vince's book on LSPM or Handbook of Portfolio
Mathematics.

-N

On 12/27/10 10:07 AM, Mark Knecht wrote:
> On Mon, Dec 27, 2010 at 10:02 AM, Noah Silverman
> <noah at smartmediacorp.com> wrote:
> <SNP>
>> It has found a solution that has a 100% probability of profit given the
>> constraints.
> <SNIP>
>
> I don't know anything about that package but anytime I see a computer
> program tell me there's a 100% chance of profit it's a big red flag
> that I probably did something wrong.
>
> That's just me though. ;-)
>
> Cheers,
> Mark


From josh.m.ulrich at gmail.com  Mon Dec 27 19:23:38 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 27 Dec 2010 12:23:38 -0600
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <4D18D4D3.5030501@smartmediacorp.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
Message-ID: <AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>

Noah,

On Mon, Dec 27, 2010 at 12:02 PM, Noah Silverman
<noah at smartmediacorp.com> wrote:
> Hi,
>
> I've been playing with the LSPM library from optimizing a portfolio of
> 13 assets (Using the interesting Leverage Space model developed by Ralph
> Vince.)
>
Which version (and revision) of LSPM are you using?  Which version of R?

> Using the function: ?maxProbProfit
>
> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
> calc.max=4, snow=cl, control=DEctrl)
>
> It takes a LONG time for the optmizer to find a solution.
>
It's always going to take a long time, especially with 13 assets and
100 optimizer iterations (the default).  How many observations are in
your lsp object?  A reproducible example, or just some sample data,
would really help here.

> It has found a solution that has a 100% probability of profit given the
> constraints.
>
> The odd thing is that several of the values (optimal F) are negative.
> My understanding is that indicates shorting the asset. ?This assets in
> this portfolio can't be shorted.
>
I doubt any f values are negative because they're bound between [0,1]
during the optimization.  My guess is that you're referring to the two
"z" values, which will always be negative.

Here's a quick example from ?maxProbProfit:

require(LSPM)
data(port)
ipop <- cbind(runif(50,0,0.01),runif(50,0,0.01),runif(50,0,0.01),
  runif(50,-1,-0.8),runif(50,-1,-0.8))
DEctrl <- list(itermax=11, NP=50, initial=ipop)
res <- maxProbProfit(port, 1e-6, 4, probDrawdown, 0.1,
  DD=0.2, calc.max=4, control=DEctrl)

> res
$f
[1] 0.002308994 0.001884296 0.116972712

$z
    zminus      zplus
-0.9256852 -0.9976883

$profitProb
[1] 0.9963587


> I've never read about shorting with the LSPM model, is this common?
> Is there a way to indicate, as a constraint, not to short?
> I have a portfolio of X dollars to allocate, so the percentages must sum
> to one, how do I do this once I get the F values?
>
You need to do this during the optimization via the "margin" and
"equity" arguments.

HTH,
--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com



> Thanks in advance for any and all suggestions!
>
> --
> Noah
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From noah at smartmediacorp.com  Mon Dec 27 20:10:47 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 27 Dec 2010 11:10:47 -0800
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
	<AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>
Message-ID: <4D18E4B7.7080402@smartmediacorp.com>

Josh,

1)
R version: 2.11.0
LSPM Version:  (Don't know where to check)

2)
I'm fine with it taking many hours - that's to be expected.  There are
48 observations for each of the 13 assets.

3)
The last output line from the optimizer is:
0 0.5908 0.545 0.0954 0.41 0 0.0969 0.0078 0.6066 0.4896 0.0113 0.7568 1
-0.5036 -1 best value:  -1

The last two values are negative, which I am now assuming are the "z"
values.  But do not know what "z" values are - don't see any mention of
them in the Handbook of Portfolio Mathematics.

4)
Is there documentation about how to specify the margin and other
constraints?  The help files in R left me a bit lost.

I'm trying this while looking at a portfolio that is a "fund of funds". 
So, they want to invest 100% of their fund and can't short anything. 
Furthermore, they can only re-balance every 90 days, which only adds
further constraint. 


I'm using the jpt example function from your blog with n=4 and the
following call in R:
DEctrl <- list(NP=100, itermax=1000, trace=1 )
res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
calc.max=4, snow=cl, control=DEctrl)


Thanks!!!!

--
Noah
 



On 12/27/10 10:23 AM, Joshua Ulrich wrote:
> Noah,
>
> On Mon, Dec 27, 2010 at 12:02 PM, Noah Silverman
> <noah at smartmediacorp.com> wrote:
>> Hi,
>>
>> I've been playing with the LSPM library from optimizing a portfolio of
>> 13 assets (Using the interesting Leverage Space model developed by Ralph
>> Vince.)
>>
> Which version (and revision) of LSPM are you using?  Which version of R?
>
>> Using the function:  maxProbProfit
>>
>> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
>> calc.max=4, snow=cl, control=DEctrl)
>>
>> It takes a LONG time for the optmizer to find a solution.
>>
> It's always going to take a long time, especially with 13 assets and
> 100 optimizer iterations (the default).  How many observations are in
> your lsp object?  A reproducible example, or just some sample data,
> would really help here.
>
>> It has found a solution that has a 100% probability of profit given the
>> constraints.
>>
>> The odd thing is that several of the values (optimal F) are negative.
>> My understanding is that indicates shorting the asset.  This assets in
>> this portfolio can't be shorted.
>>
> I doubt any f values are negative because they're bound between [0,1]
> during the optimization.  My guess is that you're referring to the two
> "z" values, which will always be negative.
>
> Here's a quick example from ?maxProbProfit:
>
> require(LSPM)
> data(port)
> ipop <- cbind(runif(50,0,0.01),runif(50,0,0.01),runif(50,0,0.01),
>   runif(50,-1,-0.8),runif(50,-1,-0.8))
> DEctrl <- list(itermax=11, NP=50, initial=ipop)
> res <- maxProbProfit(port, 1e-6, 4, probDrawdown, 0.1,
>   DD=0.2, calc.max=4, control=DEctrl)
>
>> res
> $f
> [1] 0.002308994 0.001884296 0.116972712
>
> $z
>     zminus      zplus
> -0.9256852 -0.9976883
>
> $profitProb
> [1] 0.9963587
>
>
>> I've never read about shorting with the LSPM model, is this common?
>> Is there a way to indicate, as a constraint, not to short?
>> I have a portfolio of X dollars to allocate, so the percentages must sum
>> to one, how do I do this once I get the F values?
>>
> You need to do this during the optimization via the "margin" and
> "equity" arguments.
>
> HTH,
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
>> Thanks in advance for any and all suggestions!
>>
>> --
>> Noah
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>


From josh.m.ulrich at gmail.com  Mon Dec 27 21:07:56 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 27 Dec 2010 14:07:56 -0600
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <4D18E4B7.7080402@smartmediacorp.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
	<AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>
	<4D18E4B7.7080402@smartmediacorp.com>
Message-ID: <AANLkTinffdG6Y=LGN=Yn1aefrZD2oLLbsgYHD52hAGbU@mail.gmail.com>

On Mon, Dec 27, 2010 at 1:10 PM, Noah Silverman <noah at smartmediacorp.com> wrote:
> Josh,
>
> 1)
> R version: 2.11.0
> LSPM Version: ?(Don't know where to check)
>
packageDescription("LSPM")  # revision 49 is most recent

> 2)
> I'm fine with it taking many hours - that's to be expected. ?There are
> 48 observations for each of the 13 assets.
>
> 3)
> The last output line from the optimizer is:
> 0 0.5908 0.545 0.0954 0.41 0 0.0969 0.0078 0.6066 0.4896 0.0113 0.7568 1
> -0.5036 -1 best value: ?-1
>
> The last two values are negative, which I am now assuming are the "z"
> values. ?But do not know what "z" values are - don't see any mention of
> them in the Handbook of Portfolio Mathematics.
>
They're discussed in The Leverage Space Trading Model.  They control
the aggressiveness of your position sizing when your equity is above /
below target.

> 4)
> Is there documentation about how to specify the margin and other
> constraints? ?The help files in R left me a bit lost.
>
Sorry about the lack of documentation... here's how to specify margin
constraints:
http://blog.fosstrading.com/2010/08/margin-constraints-with-lspm.html

Other constraints can be specified and passed via the
constrFun/constrVal arguments, just like you specified the drawdown
constraint.

> I'm trying this while looking at a portfolio that is a "fund of funds".
> So, they want to invest 100% of their fund and can't short anything.
> Furthermore, they can only re-balance every 90 days, which only adds
> further constraint.
>
>
> I'm using the jpt example function from your blog with n=4 and the
> following call in R:
> DEctrl <- list(NP=100, itermax=1000, trace=1 )
> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
> calc.max=4, snow=cl, control=DEctrl)
>
Why are you setting itermax=1000?

>
> Thanks!!!!
>
> --
> Noah
>
>

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


>
>
> On 12/27/10 10:23 AM, Joshua Ulrich wrote:
>> Noah,
>>
>> On Mon, Dec 27, 2010 at 12:02 PM, Noah Silverman
>> <noah at smartmediacorp.com> wrote:
>>> Hi,
>>>
>>> I've been playing with the LSPM library from optimizing a portfolio of
>>> 13 assets (Using the interesting Leverage Space model developed by Ralph
>>> Vince.)
>>>
>> Which version (and revision) of LSPM are you using? ?Which version of R?
>>
>>> Using the function: ?maxProbProfit
>>>
>>> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
>>> calc.max=4, snow=cl, control=DEctrl)
>>>
>>> It takes a LONG time for the optmizer to find a solution.
>>>
>> It's always going to take a long time, especially with 13 assets and
>> 100 optimizer iterations (the default). ?How many observations are in
>> your lsp object? ?A reproducible example, or just some sample data,
>> would really help here.
>>
>>> It has found a solution that has a 100% probability of profit given the
>>> constraints.
>>>
>>> The odd thing is that several of the values (optimal F) are negative.
>>> My understanding is that indicates shorting the asset. ?This assets in
>>> this portfolio can't be shorted.
>>>
>> I doubt any f values are negative because they're bound between [0,1]
>> during the optimization. ?My guess is that you're referring to the two
>> "z" values, which will always be negative.
>>
>> Here's a quick example from ?maxProbProfit:
>>
>> require(LSPM)
>> data(port)
>> ipop <- cbind(runif(50,0,0.01),runif(50,0,0.01),runif(50,0,0.01),
>> ? runif(50,-1,-0.8),runif(50,-1,-0.8))
>> DEctrl <- list(itermax=11, NP=50, initial=ipop)
>> res <- maxProbProfit(port, 1e-6, 4, probDrawdown, 0.1,
>> ? DD=0.2, calc.max=4, control=DEctrl)
>>
>>> res
>> $f
>> [1] 0.002308994 0.001884296 0.116972712
>>
>> $z
>> ? ? zminus ? ? ?zplus
>> -0.9256852 -0.9976883
>>
>> $profitProb
>> [1] 0.9963587
>>
>>
>>> I've never read about shorting with the LSPM model, is this common?
>>> Is there a way to indicate, as a constraint, not to short?
>>> I have a portfolio of X dollars to allocate, so the percentages must sum
>>> to one, how do I do this once I get the F values?
>>>
>> You need to do this during the optimization via the "margin" and
>> "equity" arguments.
>>
>> HTH,
>> --
>> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>>
>>
>>
>>> Thanks in advance for any and all suggestions!
>>>
>>> --
>>> Noah
>>>
>>> _______________________________________________
>>> R-SIG-Finance at r-project.org mailing list
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>> -- Also note that this is not the r-help list where general R questions should go.
>>>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From christophe00 at gmx.ch  Mon Dec 27 22:13:55 2010
From: christophe00 at gmx.ch (christophe00 at gmx.ch)
Date: Mon, 27 Dec 2010 22:13:55 +0100
Subject: [R-SIG-Finance] package 'blotter' is not available (OS X,
	R 2.12.1 32 bit)
Message-ID: <20101227211355.23230@gmx.net>

Hi 

can anybody help me with this error (R version 2.12.1 (2010-12-16)
Platform: i386-apple-darwin9.8.0/i386 (32-bit):

> install.packages("blotter", repos="http://R-Forge.R-project.org") 
Installing package(s) into '/Users/Christoph/.R/library'
(as 'lib' is unspecified)
Warning message:
In getDependencies(pkgs, dependencies, available, lib) :
  package 'blotter' is not available


Thank you and best regards,
Chris
--


From brian at braverock.com  Tue Dec 28 01:11:32 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 27 Dec 2010 18:11:32 -0600
Subject: [R-SIG-Finance] package 'blotter' is not available (OS X,
 R 2.12.1 32 bit)
In-Reply-To: <20101227211355.23230@gmx.net>
References: <20101227211355.23230@gmx.net>
Message-ID: <358502d048dad9615d8f396ecf1b6ab9@braverock.com>

On Mon, 27 Dec 2010 22:13:55 +0100, christophe00 at gmx.ch wrote:
> Hi 
> 
> can anybody help me with this error (R version 2.12.1 (2010-12-16)
> Platform: i386-apple-darwin9.8.0/i386 (32-bit):
> 
>> install.packages("blotter", repos="http://R-Forge.R-project.org") 
> Installing package(s) into '/Users/Christoph/.R/library'
> (as 'lib' is unspecified)
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
>   package 'blotter' is not available

You could have found this out yourself, but it looks like R-Forge's Mac
build environment doesn't seem to install other R-Forge packages.

https://r-forge.r-project.org/R/?group_id=316&log=build_mac&pkg=blotter&flavor=patched

complains that FinancialInstrument isn't available, even though that same
build environment builds FinancialInstrument without issue.  You might try
a support request to R-Forge itself, and see if they can adress the issue
in the Mac build environment.  

Alternately, I believe that you can install .tar.gz files to R on the Mac
manually, but you'd have to look up how to do that, as I don't use a Mac.

Regards,

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From noah at smartmediacorp.com  Tue Dec 28 01:20:20 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 27 Dec 2010 16:20:20 -0800
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <AANLkTinffdG6Y=LGN=Yn1aefrZD2oLLbsgYHD52hAGbU@mail.gmail.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
	<AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>
	<4D18E4B7.7080402@smartmediacorp.com>
	<AANLkTinffdG6Y=LGN=Yn1aefrZD2oLLbsgYHD52hAGbU@mail.gmail.com>
Message-ID: <4D192D44.40303@smartmediacorp.com>

Answers below

On 12/27/10 12:07 PM, Joshua Ulrich wrote:
> On Mon, Dec 27, 2010 at 1:10 PM, Noah Silverman <noah at smartmediacorp.com> wrote:
>> Josh,
>>
>> 1)
>> R version: 2.11.0
>> LSPM Version:  (Don't know where to check)
>>
> packageDescription("LSPM")  # revision 49 is most recent
>
I realized that on that machine, both R and LSPM weren't the newest
versions.  So I did a clean install of the latest R and the latest
LSPM.  Subsequently, what took about 20 hours before looks like it will
finish in about 5.  (This version is linked to the BLAS library, and was
custom configured for the 64 bit cpu on this machine.)

>> 2)
>> I'm fine with it taking many hours - that's to be expected.  There are
>> 48 observations for each of the 13 assets.
>>
>> 3)
>> The last output line from the optimizer is:
>> 0 0.5908 0.545 0.0954 0.41 0 0.0969 0.0078 0.6066 0.4896 0.0113 0.7568 1
>> -0.5036 -1 best value:  -1
>>
>> The last two values are negative, which I am now assuming are the "z"
>> values.  But do not know what "z" values are - don't see any mention of
>> them in the Handbook of Portfolio Mathematics.
>>
> They're discussed in The Leverage Space Trading Model.  They control
> the aggressiveness of your position sizing when your equity is above /
> below target.
I'll have to read that section.  Thank You.


>> 4)
>> Is there documentation about how to specify the margin and other
>> constraints?  The help files in R left me a bit lost.
>>
> Sorry about the lack of documentation... here's how to specify margin
> constraints:
> http://blog.fosstrading.com/2010/08/margin-constraints-with-lspm.html
>
> Other constraints can be specified and passed via the
> constrFun/constrVal arguments, just like you specified the drawdown
> constraint.
>
If I understand your blog correctly, the margin constraints are not part
of the optimal f calculation, but come into play afterward.  I'll try
your code and let you know what the results are


>> I'm trying this while looking at a portfolio that is a "fund of funds".
>> So, they want to invest 100% of their fund and can't short anything.
>> Furthermore, they can only re-balance every 90 days, which only adds
>> further constraint.
>>
>>
>> I'm using the jpt example function from your blog with n=4 and the
>> following call in R:
>> DEctrl <- list(NP=100, itermax=1000, trace=1 )
>> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
>> calc.max=4, snow=cl, control=DEctrl)
>>
> Why are you setting itermax=1000?
An initial run of 100 didn't look like it was producing optimal
results.  I thought that I'd try an extreme value and can always adjust
it lower if needed.  However, since speed isn't an issue here, I don't
mind the extra processing time if it leads to a better result.


Thanks!



>> Thanks!!!!
>>
>> --
>> Noah
>>
>>
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>>
>> On 12/27/10 10:23 AM, Joshua Ulrich wrote:
>>> Noah,
>>>
>>> On Mon, Dec 27, 2010 at 12:02 PM, Noah Silverman
>>> <noah at smartmediacorp.com> wrote:
>>>> Hi,
>>>>
>>>> I've been playing with the LSPM library from optimizing a portfolio of
>>>> 13 assets (Using the interesting Leverage Space model developed by Ralph
>>>> Vince.)
>>>>
>>> Which version (and revision) of LSPM are you using?  Which version of R?
>>>
>>>> Using the function:  maxProbProfit
>>>>
>>>> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
>>>> calc.max=4, snow=cl, control=DEctrl)
>>>>
>>>> It takes a LONG time for the optmizer to find a solution.
>>>>
>>> It's always going to take a long time, especially with 13 assets and
>>> 100 optimizer iterations (the default).  How many observations are in
>>> your lsp object?  A reproducible example, or just some sample data,
>>> would really help here.
>>>
>>>> It has found a solution that has a 100% probability of profit given the
>>>> constraints.
>>>>
>>>> The odd thing is that several of the values (optimal F) are negative.
>>>> My understanding is that indicates shorting the asset.  This assets in
>>>> this portfolio can't be shorted.
>>>>
>>> I doubt any f values are negative because they're bound between [0,1]
>>> during the optimization.  My guess is that you're referring to the two
>>> "z" values, which will always be negative.
>>>
>>> Here's a quick example from ?maxProbProfit:
>>>
>>> require(LSPM)
>>> data(port)
>>> ipop <- cbind(runif(50,0,0.01),runif(50,0,0.01),runif(50,0,0.01),
>>>   runif(50,-1,-0.8),runif(50,-1,-0.8))
>>> DEctrl <- list(itermax=11, NP=50, initial=ipop)
>>> res <- maxProbProfit(port, 1e-6, 4, probDrawdown, 0.1,
>>>   DD=0.2, calc.max=4, control=DEctrl)
>>>
>>>> res
>>> $f
>>> [1] 0.002308994 0.001884296 0.116972712
>>>
>>> $z
>>>     zminus      zplus
>>> -0.9256852 -0.9976883
>>>
>>> $profitProb
>>> [1] 0.9963587
>>>
>>>
>>>> I've never read about shorting with the LSPM model, is this common?
>>>> Is there a way to indicate, as a constraint, not to short?
>>>> I have a portfolio of X dollars to allocate, so the percentages must sum
>>>> to one, how do I do this once I get the F values?
>>>>
>>> You need to do this during the optimization via the "margin" and
>>> "equity" arguments.
>>>
>>> HTH,
>>> --
>>> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>>>
>>>
>>>
>>>> Thanks in advance for any and all suggestions!
>>>>
>>>> --
>>>> Noah
>>>>
>>>> _______________________________________________
>>>> R-SIG-Finance at r-project.org mailing list
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>>>> -- Subscriber-posting only. If you want to post, subscribe first.
>>>> -- Also note that this is not the r-help list where general R questions should go.
>>>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>>


From noah at smartmediacorp.com  Tue Dec 28 02:52:26 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 27 Dec 2010 17:52:26 -0800
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <AANLkTinffdG6Y=LGN=Yn1aefrZD2oLLbsgYHD52hAGbU@mail.gmail.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
	<AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>
	<4D18E4B7.7080402@smartmediacorp.com>
	<AANLkTinffdG6Y=LGN=Yn1aefrZD2oLLbsgYHD52hAGbU@mail.gmail.com>
Message-ID: <4D1942DA.9050509@smartmediacorp.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101227/a9311832/attachment.pl>

From josh.m.ulrich at gmail.com  Tue Dec 28 04:17:07 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 27 Dec 2010 21:17:07 -0600
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <4D1942DA.9050509@smartmediacorp.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
	<AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>
	<4D18E4B7.7080402@smartmediacorp.com>
	<AANLkTinffdG6Y=LGN=Yn1aefrZD2oLLbsgYHD52hAGbU@mail.gmail.com>
	<4D1942DA.9050509@smartmediacorp.com>
Message-ID: <AANLkTi=iUpzBKbHtVkpc2V+OKqXvb78ssT9efnQKwWbR@mail.gmail.com>

On Mon, Dec 27, 2010 at 7:52 PM, Noah Silverman <noah at smartmediacorp.com> wrote:
> Josh,
>
> On your blog, you wrote that.
>
> "The methodology therein suggests finding optimal f values first, then
> calculating the portfolio that satisfies the margin constraints but keeps
> the ratio of each market system to one another the same."
>
> Since I want to invest 100% of my portfolio with no margin allowed, couldn't
> I just take:
> f / sum(f) for each asset.
>
> Then use those as the percentage of my port to invest?
>
That was the point of the post.  If it were as easy as f/sum(f), the
blog post would be a very convoluted way to accomplish the same thing.

> The concept of "contracts" or "units" doesn't seem applicable since I'm just
> interested in percentage of fund to invest in each asset.
>
> Do I have this correct?
>
The f values are not the same as portfolio allocation percentages and
contracts / units are applicable since that's a part of how f is
defined.  If you're interested in allocation percentages, you'll need
to calculate them from each fund's f, max loss, current price, and
your current account equity.

--
Joshua Ulrich  |  FOSS Trading: www.fosstrading.com


> -N
>
> On 12/27/10 12:07 PM, Joshua Ulrich wrote:
>
> On Mon, Dec 27, 2010 at 1:10 PM, Noah Silverman <noah at smartmediacorp.com>
> wrote:
>
> Josh,
>
> 1)
> R version: 2.11.0
> LSPM Version: ?(Don't know where to check)
>
> packageDescription("LSPM")  # revision 49 is most recent
>
> 2)
> I'm fine with it taking many hours - that's to be expected. ?There are
> 48 observations for each of the 13 assets.
>
> 3)
> The last output line from the optimizer is:
> 0 0.5908 0.545 0.0954 0.41 0 0.0969 0.0078 0.6066 0.4896 0.0113 0.7568 1
> -0.5036 -1 best value: ?-1
>
> The last two values are negative, which I am now assuming are the "z"
> values. ?But do not know what "z" values are - don't see any mention of
> them in the Handbook of Portfolio Mathematics.
>
> They're discussed in The Leverage Space Trading Model.  They control
> the aggressiveness of your position sizing when your equity is above /
> below target.
>
> 4)
> Is there documentation about how to specify the margin and other
> constraints? ?The help files in R left me a bit lost.
>
> Sorry about the lack of documentation... here's how to specify margin
> constraints:
> http://blog.fosstrading.com/2010/08/margin-constraints-with-lspm.html
>
> Other constraints can be specified and passed via the
> constrFun/constrVal arguments, just like you specified the drawdown
> constraint.
>
> I'm trying this while looking at a portfolio that is a "fund of funds".
> So, they want to invest 100% of their fund and can't short anything.
> Furthermore, they can only re-balance every 90 days, which only adds
> further constraint.
>
>
> I'm using the jpt example function from your blog with n=4 and the
> following call in R:
> DEctrl <- list(NP=100, itermax=1000, trace=1 )
> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
> calc.max=4, snow=cl, control=DEctrl)
>
> Why are you setting itermax=1000?
>
> Thanks!!!!
>
> --
> Noah
>
>
> --
> Joshua Ulrich  |  FOSS Trading: www.fosstrading.com
>
>
>
> On 12/27/10 10:23 AM, Joshua Ulrich wrote:
>
> Noah,
>
> On Mon, Dec 27, 2010 at 12:02 PM, Noah Silverman
> <noah at smartmediacorp.com> wrote:
>
> Hi,
>
> I've been playing with the LSPM library from optimizing a portfolio of
> 13 assets (Using the interesting Leverage Space model developed by Ralph
> Vince.)
>
> Which version (and revision) of LSPM are you using? ?Which version of R?
>
> Using the function: ?maxProbProfit
>
> res <- maxProbProfit(jpt, 1e-6, 6, probDrawdown, 0.1, DD=0.2,
> calc.max=4, snow=cl, control=DEctrl)
>
> It takes a LONG time for the optmizer to find a solution.
>
> It's always going to take a long time, especially with 13 assets and
> 100 optimizer iterations (the default). ?How many observations are in
> your lsp object? ?A reproducible example, or just some sample data,
> would really help here.
>
> It has found a solution that has a 100% probability of profit given the
> constraints.
>
> The odd thing is that several of the values (optimal F) are negative.
> My understanding is that indicates shorting the asset. ?This assets in
> this portfolio can't be shorted.
>
> I doubt any f values are negative because they're bound between [0,1]
> during the optimization. ?My guess is that you're referring to the two
> "z" values, which will always be negative.
>
> Here's a quick example from ?maxProbProfit:
>
> require(LSPM)
> data(port)
> ipop <- cbind(runif(50,0,0.01),runif(50,0,0.01),runif(50,0,0.01),
> ? runif(50,-1,-0.8),runif(50,-1,-0.8))
> DEctrl <- list(itermax=11, NP=50, initial=ipop)
> res <- maxProbProfit(port, 1e-6, 4, probDrawdown, 0.1,
> ? DD=0.2, calc.max=4, control=DEctrl)
>
> res
>
> $f
> [1] 0.002308994 0.001884296 0.116972712
>
> $z
> ? ? zminus ? ? ?zplus
> -0.9256852 -0.9976883
>
> $profitProb
> [1] 0.9963587
>
>
> I've never read about shorting with the LSPM model, is this common?
> Is there a way to indicate, as a constraint, not to short?
> I have a portfolio of X dollars to allocate, so the percentages must sum
> to one, how do I do this once I get the F values?
>
> You need to do this during the optimization via the "margin" and
> "equity" arguments.
>
> HTH,
> --
> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>
>
>
> Thanks in advance for any and all suggestions!
>
> --
> Noah
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
>


From noah at smartmediacorp.com  Tue Dec 28 05:06:09 2010
From: noah at smartmediacorp.com (Noah Silverman)
Date: Mon, 27 Dec 2010 20:06:09 -0800
Subject: [R-SIG-Finance] LSPM - Unexpected Results
In-Reply-To: <AANLkTi=iUpzBKbHtVkpc2V+OKqXvb78ssT9efnQKwWbR@mail.gmail.com>
References: <4D18D4D3.5030501@smartmediacorp.com>
	<AANLkTikr+OZBP_T_b4UHv-sQjFrEwmi7vYo+bHjgK9W_@mail.gmail.com>
	<4D18E4B7.7080402@smartmediacorp.com>
	<AANLkTinffdG6Y=LGN=Yn1aefrZD2oLLbsgYHD52hAGbU@mail.gmail.com>
	<4D1942DA.9050509@smartmediacorp.com>
	<AANLkTi=iUpzBKbHtVkpc2V+OKqXvb78ssT9efnQKwWbR@mail.gmail.com>
Message-ID: <4D196231.1040602@smartmediacorp.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101227/d5f777fc/attachment.pl>

From stephen at organicfoodmarkets.com.au  Tue Dec 28 08:14:09 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Tue, 28 Dec 2010 18:14:09 +1100
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
In-Reply-To: <f5255610624f16b9615507cbb55aecfb@braverock.com>
References: <4D124B20.80401@organicfoodmarkets.com.au>
	<4D124C41.60106@braverock.com>
	<4D1272A6.6060502@organicfoodmarkets.com.au>
	<f5255610624f16b9615507cbb55aecfb@braverock.com>
Message-ID: <4D198E41.3080802@organicfoodmarkets.com.au>

Hi

I'm still not winning with this.   I  installed blotter again from 
https://r-forge.r-project.org/R/?group_id=316 but now I am getting  this 
inside the loop:

There were 50 or more warnings (use warnings() to see the first 50)
 > warnings()
Warning messages:
1: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
2: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
3: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
4: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
5: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
6: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
7: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
8: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
9: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
10: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
11: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
12: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
13: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
14: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
15: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
16: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
17: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
18: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
19: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
20: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
21: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
22: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
23: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
24: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
25: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
26: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
27: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
28: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
29: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
30: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
31: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
32: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
33: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
34: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
35: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
36: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
37: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
38: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
39: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
40: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
41: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
42: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
43: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
44: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
45: In getInstrument(symbol) : Instrument SPY  not found, please create 
it first.
46: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
47: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  ... :
   Instrument SPY  not found, things may break
48: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
49: In getInstrument(Symbol) : Instrument SPY  not found, please create 
it first.
50: In addTxn(ltportfolio, Symbol = symbols[1], TxnDate = currentDate,  
... :
   Instrument SPY  not found, using contract multiplier of 1
 >

getInstrument doesn't even appear in the code so I'm not sure where this 
is going wrong.


Stephen Choularton Ph.D., FIoD
On 23/12/2010 9:12 AM, Brian G. Peterson wrote:
> Error in if (ncol(Prices)>  1) Prices = getPrice(Prices, Symbol) :
>     argument is of length zero
>
> This bug was fixed in svn r502, from a couple days ago.  It looked like
> R-Forge had the new version earlier today.
>
> So, I'd say your best bet might be to download and install manually, or
> wait 24 hours and see if R-Forge catches up.
>
> On Thu, 23 Dec 2010 08:50:30 +1100, Stephen Choularton
> <stephen at organicfoodmarkets.com.au>  wrote:
>> Hi Brian
>>
>> Thanks.  I did go there and ran the code but I still got a problem so I
> did
>>
>> update.packages()
>>
>> and
>>
>> update.packages('blotter', repos="http://R-Forge.R-project.org")
>>
>> but still ended up with problems when I came out of the loop:
>>
>> }
>> + updatePortf(ltportfolio, Dates = currentDate)
>> + updateAcct(ltaccount, Dates = currentDate)
>> + updateEndEq(ltaccount, Dates = currentDate)
>> + }
>> [1] 0
>> [1] "1995-01-04"
>> Error in if (ncol(Prices)>  1) Prices = getPrice(Prices, Symbol) :
>>     argument is of length zero
>> In addition: Warning messages:
>> 1: In getInstrument(symbol) :
>>     Instrument SPY  not found, please create it first.
>> 2: In getInstrument(Symbol) :
>>     Instrument SPY  not found, please create it first.
>> 3: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),  :
>>     Instrument SPY  not found, things may break
>>   >  rez1<-(getPortfolio(ltaccount))
>>   >  plot(cumsum(rez1$symbols$SPY$txn[,9]))
>> Error in if (on == "years") { : missing value where TRUE/FALSE needed
>>   >
>>   >  #gross profit
>>   >  result<-rez1$symbols$SPY$txn[,7]
>>   >  result<-result[result!=0]
>>   >
>>   >  #fix commission rate 2*3
>>   >  plot(cumsum(result-6))
>> Error in try.xts(x, error = "must be either xts-coercible or timeBased")
> :
>>     must be either xts-coercible or timeBased
>>   >
>>   >  chart.CumReturns(cbind((result)/10000,(result-6)/10000))
>> Error in `[.xts`(x, start.row, 1) : subscript out of bounds
>>   >
>>   >
>>
>> The full code I used was:
>>
>> require('xts')
>> require('quantmod')
>> require('blotter')
>> require('PerformanceAnalytics')
>> require('FinancialInstrument')
>> Sys.setenv(TZ="GMT")
>>
>> getSymbols('SPY',from='1995-01-01',index.class=c("POSIXt","POSIXct"))
>>
> dividends<-getDividends('SPY',from='1995-01-01',index.class=c("POSIXt","POSIXct"))
>> temp<-cbind(dividends,SPY)
>> temp[,1][is.na(temp[,1])]<-0
>>
>> SPY<-cbind(temp[,2],temp[,3],temp[,4],temp[,1]+temp[,5])
>> colnames(SPY)<-c('Open','High','Low','Close')
>>
>> #one day before
>> lag1<-lag((SPY),1)
>>
>> #two days defore
>> lag2<-lag((SPY),2)
>>
>> signal<-ifelse( (Cl(lag2)>Cl(lag1)&  Cl(lag1)>Cl(SPY))&
>>               (Hi(lag2)>Hi(lag1)&  Hi(lag1)>Hi(SPY))&
>>               (Op(lag2)>Op(lag1)&  Op(lag1)>Op(SPY)),
>>               1,0
>> )
>> #one day later
>> lag3<-lag(Cl(SPY),-1)
>>
>>
>> profit<-(lag3/Cl(SPY)-1)*signal
>> chart.CumReturns(profit)
>>
>> #------------------
>> tmp<-(Hi(lag2)/Lo(SPY)-1)*signal
>>
>> #blotter code
>> symbols<-c('SPY')
>> SPY<-Cl(SPY)
>> initDate=time(get(symbols)[1])
>> initEq=10000
>> rm(list=ls(envir=.blotter),envir=.blotter)
>> ltportfolio='3days'
>> ltaccount='3days'
>> initPortf(ltportfolio,symbols, initDate=initDate)
>> initAcct(ltaccount,portfolios=c(ltportfolio),
>> initDate=initDate,initEq=initEq)
>> currency("USD")
>> stock(symbol,currency="USD",multiplier=1)
>>
>> signal[is.na(signal)]<-0
>>
>>
>> counter<-0
>>
>> for(i in 2:length(signal))
>> {
>>       currentDate= time(signal)[i]
>>       equity = 10000 #getEndEq(ltaccount, currentDate)
>>       position = getPosQty(ltportfolio, Symbol=symbols[1],
> Date=currentDate)
>>       print(position)
>>       print(currentDate)
>>       if(position==0)
>>       {
>>           #open a new position if signal is>0
>>           if(signal[i]>0&counter ==0)
>>           {
>>               print('open position')
>>               closePrice<-as.double(Cl(SPY[currentDate]))
>>               print(closePrice)
>>               unitSize = as.numeric(trunc((equity/closePrice)))
>>               print(unitSize)
>>               commssions=-unitSize*closePrice*0.0003
>>               addTxn(ltportfolio, Symbol=symbols[1],
>> TxnDate=currentDate, TxnPrice=closePrice, TxnQty = unitSize ,
>> TxnFees=commssions, verbose=T)
>>               counter<-1
>>           }
>>
>>       }
>>       else
>>       {
>>           #position is open. If signal is 0 - close it.
>>           if(position>0&counter>=1)
>>           {
>>               position = getPosQty(ltportfolio, Symbol=symbols[1],
>> Date=currentDate)
>>
>>
> closePrice<-as.double((Cl(SPY[currentDate])))#as.double(get(symbols[1])[i+100])
>>               commssions=-position*closePrice*0.0003
>>               addTxn(ltportfolio, Symbol=symbols[1],
>> TxnDate=currentDate, TxnPrice=closePrice, TxnQty = -position ,
>> TxnFees=commssions, verbose=T)
>>               counter<-0
>>           }
>>           else
>>           {
>>               print(counter)
>>               counter<-counter+1
>>           }
>>       }
>>       updatePortf(ltportfolio, Dates = currentDate)
>>       updateAcct(ltaccount, Dates = currentDate)
>>       updateEndEq(ltaccount, Dates = currentDate)
>> }
>> rez1<-(getPortfolio(ltaccount))
>> plot(cumsum(rez1$symbols$SPY$txn[,9]))
>>
>> #gross profit
>> result<-rez1$symbols$SPY$txn[,7]
>> result<-result[result!=0]
>>
>> #fix commission rate 2*3
>> plot(cumsum(result-6))
>>
>> chart.CumReturns(cbind((result)/10000,(result-6)/10000))
>>
>> Does it work for you?
>>
>> Stephen Choularton Ph.D., FIoD
>>
>> On 23/12/2010 6:06 AM, Brian G. Peterson wrote:
>>> Pull his code directly, don't cut and paste HTML:
>>>
>>> https://github.com/kafka399/Rproject/blob/master/3lowDays.R
>>>
>>> That code Works for Me(tm)
>>>
>>> If it doesn't work for you, then you may need to call
>>>
>>> update.packages()
>>>
>>> or
>>>
>>> update.packages('blotter', repos="http://R-Forge.R-project.org")
>>>
>>> Regards.
>>>
>>>    - Brian
>>>
>>> On 12/22/2010 01:01 PM, Stephen Choularton wrote:
>>>> Hi
>>>>
>>>> I'm working on the Blotter example by kafka from R-bloggers. The code
>>>> goes like this:
>>>>
>>>> require(xts)
>>>> require(quantmod)
>>>> Sys.setenv(TZ="GMT")
>>>> initDate='2000-01-01'
>>>> getSymbols('SPY',from=initDate,index.class=c("POSIXt","POSIXct"))
>>>> SPY<-adjustOHLC(SPY,use.Adjusted=T)
>>>>
>>>> #yesterday's price
>>>> tmp<-lag(SPY,1)
>>>>
>>>> # if today's low is higher than yesterday's close 1, else 0
>>>> signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
>>>> signal[1]<-0
>>>>
>>>> #let's plot cumulitative return to make sure, that we are on the
>>>> right path
>>>> tmp<-lag(Delt(Cl(SPY)),-1)
>>>> tmp[length(tmp)]<-0
>>>> plot(cumprod(signal*tmp+1))
>>>>
>>>> SPY<-Cl(SPY)
>>>> symbols<-c('SPY')
>>>>
>>>> rm(list=ls(envir=.blotter),envir=.blotter)
>>>> initPortf(ltportfolio,symbols, initDate=initDate)
>>>> initAcct(ltaccount,portfolios=c(ltportfolio),
>>>> initDate=initDate,initEq=initEq)
>>>>
>>>> signal<-signal['2000-02-01::']
>>>>
>>>> for(iin 1:length(signal))
>>>> {
>>>> currentDate= time(signal)[i]
>>>> equity= getEndEq(ltaccount, currentDate)
>>>> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
>>>>
>>>> if(position==0)
>>>> {
>>>> #open a new position if signal is>0
>>>> if(signal[i]>0)
>>>> {
>>>> closePrice<-as.double(Cl(SPY[currentDate]))
>>>> unitSize= as.numeric(trunc((equity/closePrice)))
>>>> # 5$ per transaction
>>>> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
>>>> TxnPrice=closePrice, TxnQty= -unitSize , TxnFees=5, verbose=T)
>>>> }
>>>>
>>>> }
>>>> else
>>>> {
>>>> #position is open. If signal is 0 - close it.
>>>> if(as.double(signal[i])==0&&  position<0)
>>>> {
>>>> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
>>>>
> closePrice<-as.double((Cl(SPY[currentDate])))#as.double(get(symbols[1])[i+100])
>>>>
>>>>
>>>>
>>>> # 5$ per transaction
>>>> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
>>>> TxnPrice=closePrice, TxnQty= -position , TxnFees=5, verbose=T)
>>>>
>>>> }
>>>>
>>>> }
>>>> updatePortf(ltportfolio, Dates= currentDate)
>>>> updateAcct(ltaccount, Dates= currentDate)
>>>> updateEndEq(ltaccount, Dates= currentDate)
>>>>
>>>>
>>>>
>>>> There appears to be some sort of transcription problem at:
>>>>
>>>> if(as.double(signal[i])==0&&  position<0)
>>>>
>>>> so I have changed it to:
>>>>
>>>> if(as.double(signal[i])==0&&  position<0)
>>>>
>>>> so the code now reads:
>>>>
>>>> require(xts)
>>>> require(quantmod)
>>>>
>>>> Sys.setenv(TZ="GMT")
>>>> initDate='2000-01-01'
>>>> getSymbols('SPY',from=initDate,index.class=c("POSIXt","POSIXct"))
>>>> SPY<-adjustOHLC(SPY,use.Adjusted=T)
>>>>
>>>> #yesterday's price
>>>> tmp<-lag(SPY,1)
>>>>
>>>> # if today's low is higher than yesterday's close 1, else 0
>>>> signal<-ifelse(Lo(SPY)>Cl(tmp),1,0)
>>>> signal[1]<-0
>>>>
>>>> #let's plot cumulitative return to make sure, that we are on the
>>>> right path
>>>> tmp<-lag(Delt(Cl(SPY)),-1)
>>>> tmp[length(tmp)]<-0
>>>> plot(cumprod(signal*tmp+1))
>>>>
>>>> SPY<-Cl(SPY)
>>>> symbols<-c('SPY')
>>>>
>>>> rm(list=ls(envir=.blotter),envir=.blotter)
>>>> initPortf(ltportfolio,symbols, initDate=initDate)
>>>> initAcct(ltaccount,portfolios=c(ltportfolio),
>>>> initDate=initDate,initEq=initEq)
>>>>
>>>> signal<-signal['2000-02-01::']
>>>>
>>>> for(iin 1:length(signal))
>>>> {
>>>> currentDate= time(signal)[i]
>>>> equity= getEndEq(ltaccount, currentDate)
>>>> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
>>>>
>>>> if(position==0)
>>>> {
>>>> #open a new position if signal is>0
>>>> if(signal[i]>0)
>>>> {
>>>> closePrice<-as.double(Cl(SPY[currentDate]))
>>>> unitSize= as.numeric(trunc((equity/closePrice)))
>>>> # 5$ per transaction
>>>> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
>>>> TxnPrice=closePrice, TxnQty= -unitSize , TxnFees=5, verbose=T)
>>>> }
>>>>
>>>> }
>>>> else
>>>> {
>>>> #position is open. If signal is 0 - close it.
>>>> if(as.double(signal[i])==0&&  position<0)
>>>> {
>>>> position= getPosQty(ltportfolio, Symbol=symbols[1], Date=currentDate)
>>>>
> closePrice<-as.double((Cl(SPY[currentDate])))#as.double(get(symbols[1])[i+100])
>>>>
>>>>
>>>>
>>>> # 5$ per transaction
>>>> addTxn(ltportfolio, Symbol=symbols[1], TxnDate=currentDate,
>>>> TxnPrice=closePrice, TxnQty= -position , TxnFees=5, verbose=T)
>>>>
>>>> }
>>>>
>>>> }
>>>> updatePortf(ltportfolio, Dates= currentDate)
>>>> updateAcct(ltaccount, Dates= currentDate)
>>>> updateEndEq(ltaccount, Dates= currentDate)
>>>>
>>>> equity= getEndEq(ltaccount, currentDate)
>>>>
>>>> }
>>>> plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
>>>>
>>>> equity= getEndEq(ltaccount, currentDate)
>>>>
>>>> }
>>>> plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
>>>>
>>>> but I keep on getting error messages like this:
>>>>
>>>> Error in getEndEq(ltaccount, currentDate) : object 'ltaccount' not
> found
>>>>> plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
>>>> Error in getAccount(ltaccount) : object 'ltaccount' not found
>>>>> equity = getEndEq(ltaccount, currentDate)
>>>> Error in getEndEq(ltaccount, currentDate) : object 'ltaccount' not
> found
>>>>> }
>>>> Error: unexpected '}' in "}"
>>>>> plot(getAccount(ltaccount)[["TOTAL"]]$End.Eq)
>>>> Error in getAccount(ltaccount) : object 'ltaccount' not found
>>>>
>>>> I have tried references to blotter like library(blotter) and
>>>> require(blotter) but it makes no difference.
>>>>
>>>> I appreciate I haven't declared these objects/variables but often with
> R
>>>> and finance they seem to come with the package. Can anyone point out
>>>> what I am doing wrong?
>>>>
>>>


From brian at braverock.com  Tue Dec 28 11:56:59 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 28 Dec 2010 04:56:59 -0600
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
In-Reply-To: <4D198E41.3080802@organicfoodmarkets.com.au>
References: <4D124B20.80401@organicfoodmarkets.com.au>
	<4D124C41.60106@braverock.com>
	<4D1272A6.6060502@organicfoodmarkets.com.au>
	<f5255610624f16b9615507cbb55aecfb@braverock.com>
	<4D198E41.3080802@organicfoodmarkets.com.au>
Message-ID: <ad29406d0c73eaeb9a6513afb1820c6a@braverock.com>

On Tue, 28 Dec 2010 18:14:09 +1100, Stephen Choularton
<stephen at organicfoodmarkets.com.au> wrote:
> I'm still not winning with this.   


Really, does the script fail?  
No: these are warnings.

Alternately: Does it produce incorrect results?  Does it replicate the
charts on his blog?  It does when I run it (warnings aside).


> I  installed blotter again from 
> https://r-forge.r-project.org/R/?group_id=316 but now I am getting  this

> inside the loop:


Please at least attempt to read the documentation before posting.  

Failing that, please try to figure out what a given *Warning* (these are
not Errors!) is telling you.


I've trimmed the following to keep only unique warnings. 


> There were 50 or more warnings (use warnings() to see the first 50)
>  > warnings()
> Warning messages:
> 1: In getInstrument(symbol) : Instrument SPY  not found, please create 
> it first.
> 2: In getInstrument(Symbol) : Instrument SPY  not found, please create 
> it first.
> 3: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol), 
... :
>    Instrument SPY  not found, things may break


getInstrument is called by all sorts of things.  The warning is saying
that you don't have an instrument definition, and things may be wonky.  Per
the documentation, we'll *attempt* to assume USD for the currency, and a
multiplier of 1, but this may not work everywhere, and per one comment in
the documentation which you apparently haven't read and Warnings
3,11,15,19, etc. from your output, "things may break".

adding this somewhere near the beginning of the script (after loading
blotter) should eliminate all of the warnings related to the lack of an
instrument:

currency("USD")
stock("SPY",currency="USD",multiplier=1)

but they are Warnings, and are there to inform you that something unhappy
might be going on.  Errors actually stop R in most cases, because it can't
continue.

<...>

> 8: In updatePortf(ltportfolio, Dates = currentDate) :
>    Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="


I've never seen this one before in blotter, even when running the script
you are using to test this, which works for me.  It may have something to
do with the script, as I know it has a loop on Dates with an updatePortf
after every day in order to do position sizing (which is a lot of heavy
lifting for the computer to do, and you likely won't want to do something
like this for most strategies when backtesting, though obviously running
once a day or even once an hour on real portfolios wouldn't be a problem.)


<...>

> 50: In addTxn(ltportfolio, Symbol = symbols[1], TxnDate = currentDate,  
> ... :
>    Instrument SPY  not found, using contract multiplier of 1


See my earlier comments about assuming a multiplier of 1 ...  your
computer told you that before I re-highlighted it.

 
> getInstrument doesn't even appear in the code so I'm not sure where this

> is going wrong.

.../blotter/R$ grep -c getInstrument *.R | grep -v 0
addTxn.R:3
chart.Spread.R:1
updateAcct.R:1
updatePortf.R:1
updatePosPL.R:2

The code you're running calls every file/function in the output above
except for chart.Spread, so getInstrument does 'appear in the code' (which
you have always had available to you for inspection)

  - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From eburgene at gmail.com  Tue Dec 28 12:16:52 2010
From: eburgene at gmail.com (Emanuel Burgener)
Date: Tue, 28 Dec 2010 12:16:52 +0100
Subject: [R-SIG-Finance] Quantstrat problem
Message-ID: <AANLkTinoG5Op4ZUbMZBS200qGzgY87mYhL_X=RFs9tvG@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101228/0f358175/attachment.pl>

From brian at braverock.com  Tue Dec 28 15:02:45 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 28 Dec 2010 08:02:45 -0600
Subject: [R-SIG-Finance] Quantstrat problem
In-Reply-To: <AANLkTinoG5Op4ZUbMZBS200qGzgY87mYhL_X=RFs9tvG@mail.gmail.com>
References: <AANLkTinoG5Op4ZUbMZBS200qGzgY87mYhL_X=RFs9tvG@mail.gmail.com>
Message-ID: <4D19EE05.8020809@braverock.com>



On 12/28/2010 05:16 AM, Emanuel Burgener wrote:
> Hi all,
>
> I would need your help to solve the following problem. I get this error when
> I run my code for quantstrat (cf hereunder):
> *
> Error in do.call(opr, list(data[, colNums[1]], data[, colNums[2]])) :
>    'what' must be a character string or a function*
>
> I would really appreciate your help.
> Maybe two comments regarding my code:
>
>     - the aim is to have an indicator that can take different values, for
>     example -2,-1,0,1,2 (currently only -1,0,1 are implemented). And according
>     to this indicator, I would like to have a position of Indicator*100 shares
>     (hence the maybe too complicated "minusOne", "minusZero", etc episode).

I really try not to code custom indicators to give integer results like 
this.  I find that they are typically difficult to understand and debug. 
  See the 'macd' and 'rsi' demos for examples of how to use an indicator 
that you believe has some predictive power without having to further 
transform your indicator.  In practice, we use more 'sigFormula' calls 
than the simpler sigThreshold and sigCrossover calls, since this lets us 
do things like combine indicators (or prior signals) to get more 
business-oriented logic into the strategy.

> Any suggestion to improve my not-so-elegant solution is welcome.

Your indicator function doesn't name the columns but your sigCrossover 
expects columns named:

"minusOne","minusZero","Indicator"

Which will never work.

traceback says:

 > out<-applyStrategy(strategy=stratTest , portfolios="Test")
Error in do.call(opr, list(data[, colNums[1]], data[, colNums[2]])) :
   'what' must be a character string or a function
 > traceback()
7: do.call(opr, list(data[, colNums[1]], data[, colNums[2]]))
6: sigComparison(label = label, data = data, columns = columns[c(i,
        lng)], relationship = relationship)
5: diff(sigComparison(label = label, data = data, columns = columns[c(i,
        lng)], relationship = relationship))
4: function (label, data = mktdata, columns, relationship = c("gt",
        "lt", "eq", "gte", "lte"))
    {
        ret_sig = FALSE
        lng <- length(columns)
        for (i in 1:(lng - 1)) {
            ret_sig = ret_sig | diff(sigComparison(label = label,
                data = data, columns = columns[c(i, lng)], relationship 
= relationship)) ==
                1
        }
        is.na(ret_sig) <- which(!ret_sig)
        colnames(ret_sig) <- label
        return(ret_sig)
    }(label = "signal.sell1", data = mktdata, columns = c("minusOne",
    "minusZero", "Indicator"), relationship = "op")
3: do.call(fun, .formals)
2: applySignals(strategy = strategy, mktdata = mktdata, sret$indicators,
        parameters = parameters, ...)
1: applyStrategy(strategy = stratTest, portfolios = "Test")

Please look at the 'macross' demo, which does what you are trying to do 
in your example here. You'll probably be better served by extending it 
than by writing from scratch.

>     - I actually first started to implement and test my strategies with
>     blotter. But, as it is rather slow in terms of testing, I decided to
>     transfer my Indicator into the quantstrat environment. So if there is an
>     easy solution to transfer "blotter"-code into "quantstrat"-code, this would
>     be the best solution for me (or any other way to speed things up with
>     blotter).

'blotter' is for transaction P&L.  I *never* call blotter by hand, 
except for the occasional addTxn call from inside a custom risk rule 
function or something similar.

We wrote quantstrat to simplify strategy modeling, and to reduce the 
amount of code needed to model and test a strategy.  I never 
contemplated using blotter for strategy modeling, just for P&L, so there 
in no 'simple' way to translate custom strategy code to quantstrat.  For 
an example of 'similar' things done in blotter and then again in 
quantstrat, see the 'longtrend' demo in blotter and the 'faber' example 
in quantstrat.  We'll be working on generalized capital-based order 
sizing functions in the next few weeks, so hopefully you'll have some 
examples of more sophisticated order sizing logic soon too.

> Again, thank you very much for your help, you're doing a great job with this
> forum.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From stephen at organicfoodmarkets.com.au  Tue Dec 28 20:28:54 2010
From: stephen at organicfoodmarkets.com.au (Stephen Choularton)
Date: Wed, 29 Dec 2010 06:28:54 +1100
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
In-Reply-To: <ad29406d0c73eaeb9a6513afb1820c6a@braverock.com>
References: <4D124B20.80401@organicfoodmarkets.com.au>	<4D124C41.60106@braverock.com>	<4D1272A6.6060502@organicfoodmarkets.com.au>	<f5255610624f16b9615507cbb55aecfb@braverock.com>	<4D198E41.3080802@organicfoodmarkets.com.au>
	<ad29406d0c73eaeb9a6513afb1820c6a@braverock.com>
Message-ID: <4D1A3A76.9010406@organicfoodmarkets.com.au>

My apologies.

I did not realize the script worked so slowly.  I reduced the time scale 
it covered so it commenced at the beginning of the year and it did run 
to completion.  I will try the full term and see if it produces the same 
graphs as the original example.

I'm always a bit worried about warnings as they often mean something is 
going wrong and it might be useful if kafta had warned one not to worry 
about them.  Mind you I think he did say it all took a long time ;-)

I can assure you I do try and read man before I ask for help but dealing 
with other people's code is not always easy particularly when working 
with a programming system that uses a different paradigm like R with its 
emphasis on operations on vectors and the like. and the extensive use of 
calls to functions each of which often require a wet towel and cup of 
coffee to understand.

I added the parameter definitions you suggest:

currency("USD")
stock("SPY",currency="USD",multiplier=1)

and the warnings reduced to one:

Warning messages:
1: In updatePortf(ltportfolio, Dates = currentDate) :
   Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="

updatePortf goes:

updatePortf
function (Portfolio, Symbols = NULL, Dates = NULL, Prices = NULL,
     ...)
{
     pname <- Portfolio
     Portfolio <- getPortfolio(pname)
     if (is.null(Symbols)) {
         Symbols = names(Portfolio$symbols)
     }
     for (symbol in Symbols) {
         tmp_instr <- try(getInstrument(symbol))
         .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
             Dates = Dates, Prices = Prices, ... = ...)
     }
     Portfolio <- getPortfolio(pname)
     if (is.null(Dates))
         Dates <- time(Portfolio$symbols[[1]]$posPL)
     Attributes = c("Long.Value", "Short.Value", "Net.Value",
         "Gross.Value", "Period.Realized.PL", "Period.Unrealized.PL",
         "Gross.Trading.PL", "Txn.Fees", "Net.Trading.PL")
     summary = NULL
     tmp.attr = NULL
     for (attribute in Attributes) {
         result = NULL
         switch(attribute, Net.Value = , Gross.Value = , Long.Value = ,
             Short.Value = , {
                 if (is.null(tmp.attr)) {
                   table = .getBySymbol(Portfolio = Portfolio,
                     Attribute = "Pos.Value", Dates = Dates, Symbols = 
Symbols)
                   tmp.attr = "Pos.Value"
                 }
                 switch(attribute, Gross.Value = {
                   result = xts(rowSums(abs(table), na.rm = TRUE),
                     order.by = index(table))
                 }, Long.Value = {
                   tmat = apply(table, MARGIN = c(1, 2), FUN = max,
                     0)
                   result = xts(rowSums(tmat, na.rm = TRUE), order.by = 
index(table))
                 }, Short.Value = {
                   tmat = apply(table, MARGIN = c(1, 2), FUN = min,
                     0)
                   result = xts(rowSums(tmat, na.rm = TRUE), order.by = 
index(table))
                 }, Net.Value = {
                   result = xts(rowSums(table, na.rm = TRUE),
                     order.by = index(table))
                 })
             }, Period.Realized.PL = , Period.Unrealized.PL = ,
             Gross.Trading.PL = , Txn.Fees = , Net.Trading.PL = {
                 table = .getBySymbol(Portfolio = Portfolio, Attribute = 
attribute,
                   Dates = Dates, Symbols = Symbols)
                 tmp.attr = NULL
                 result = xts(rowSums(table, na.rm = TRUE), order.by = 
index(table))
             })
         colnames(result) = attribute
         if (is.null(summary)) {
             summary = result
         }
         else {
             summary = cbind(summary, result)
         }
     }
     if (!is.timeBased(Dates))
         Dates = time(Portfolio$symbols[[1]][Dates])
     startDate = first(xts:::.parseISO8601(Dates))$first.time -
         1
     if (attr(Portfolio, "initDate") >= startDate | 
length(Portfolio$summary) ==
         0) {
         Portfolio$summary <- summary
     }
     else {
         Portfolio$summary <- rbind(Portfolio$summary[paste("::",
             startDate, sep = "")], summary)
     }
     assign(paste("portfolio", pname, sep = "."), Portfolio, envir = 
.blotter)
     return(pname)
}
<environment: namespace:blotter>
 >

"Ops.Date", "Ops.POSIXt" don't appear in the function call so they must 
be somewhere deeper.  I'm afraid I'm currently a windows user so grep is 
not available and the windows native text search didn't reveal much.  
However, I did find some references in the documentation (Date-Time 
Classes, Operators on the Date Class & S3 Group Generic Functions) but 
Ops.POSIXt doesn't appear therein only POSIXlt and Ops.POSIXct.  Is 
there a typo somewhere ?

It would be nice to get rid of the warnings.

Stephen Choularton Ph.D., FIoD


On 28/12/2010 9:56 PM, Brian G. Peterson wrote:
> On Tue, 28 Dec 2010 18:14:09 +1100, Stephen Choularton
> <stephen at organicfoodmarkets.com.au>  wrote:
>> I'm still not winning with this.
>
> Really, does the script fail?
> No: these are warnings.
>
> Alternately: Does it produce incorrect results?  Does it replicate the
> charts on his blog?  It does when I run it (warnings aside).
>
>
>> I  installed blotter again from
>> https://r-forge.r-project.org/R/?group_id=316 but now I am getting  this
>> inside the loop:
>
> Please at least attempt to read the documentation before posting.
>
> Failing that, please try to figure out what a given *Warning* (these are
> not Errors!) is telling you.
>
>
> I've trimmed the following to keep only unique warnings.
>
>
>> There were 50 or more warnings (use warnings() to see the first 50)
>>   >  warnings()
>> Warning messages:
>> 1: In getInstrument(symbol) : Instrument SPY  not found, please create
>> it first.
>> 2: In getInstrument(Symbol) : Instrument SPY  not found, please create
>> it first.
>> 3: In .updatePosPL(Portfolio = pname, Symbol = as.character(symbol),
> ... :
>>     Instrument SPY  not found, things may break
>
> getInstrument is called by all sorts of things.  The warning is saying
> that you don't have an instrument definition, and things may be wonky.  Per
> the documentation, we'll *attempt* to assume USD for the currency, and a
> multiplier of 1, but this may not work everywhere, and per one comment in
> the documentation which you apparently haven't read and Warnings
> 3,11,15,19, etc. from your output, "things may break".
>
> adding this somewhere near the beginning of the script (after loading
> blotter) should eliminate all of the warnings related to the lack of an
> instrument:
>
> currency("USD")
> stock("SPY",currency="USD",multiplier=1)
>
> but they are Warnings, and are there to inform you that something unhappy
> might be going on.  Errors actually stop R in most cases, because it can't
> continue.
>
> <...>
>
>> 8: In updatePortf(ltportfolio, Dates = currentDate) :
>>     Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
>
> I've never seen this one before in blotter, even when running the script
> you are using to test this, which works for me.  It may have something to
> do with the script, as I know it has a loop on Dates with an updatePortf
> after every day in order to do position sizing (which is a lot of heavy
> lifting for the computer to do, and you likely won't want to do something
> like this for most strategies when backtesting, though obviously running
> once a day or even once an hour on real portfolios wouldn't be a problem.)
>
>
> <...>
>
>> 50: In addTxn(ltportfolio, Symbol = symbols[1], TxnDate = currentDate,
>> ... :
>>     Instrument SPY  not found, using contract multiplier of 1
>
> See my earlier comments about assuming a multiplier of 1 ...  your
> computer told you that before I re-highlighted it.
>
>
>> getInstrument doesn't even appear in the code so I'm not sure where this
>> is going wrong.
> .../blotter/R$ grep -c getInstrument *.R | grep -v 0
> addTxn.R:3
> chart.Spread.R:1
> updateAcct.R:1
> updatePortf.R:1
> updatePosPL.R:2
>
> The code you're running calls every file/function in the output above
> except for chart.Spread, so getInstrument does 'appear in the code' (which
> you have always had available to you for inspection)
>
>    - Brian
>


From brian at braverock.com  Tue Dec 28 21:18:06 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 28 Dec 2010 14:18:06 -0600
Subject: [R-SIG-Finance] Blotter example by kafka from R-bloggers
In-Reply-To: <4D1A3A76.9010406@organicfoodmarkets.com.au>
References: <4D124B20.80401@organicfoodmarkets.com.au>	<4D124C41.60106@braverock.com>	<4D1272A6.6060502@organicfoodmarkets.com.au>	<f5255610624f16b9615507cbb55aecfb@braverock.com>	<4D198E41.3080802@organicfoodmarkets.com.au>	<ad29406d0c73eaeb9a6513afb1820c6a@braverock.com>
	<4D1A3A76.9010406@organicfoodmarkets.com.au>
Message-ID: <4D1A45FE.6070007@braverock.com>

On 12/28/2010 01:28 PM, Stephen Choularton wrote:
> My apologies.
>
> I did not realize the script worked so slowly.  I reduced the time scale
> it covered so it commenced at the beginning of the year and it did run
> to completion.  I will try the full term and see if it produces the same
> graphs as the original example.
 >
> I'm always a bit worried about warnings as they often mean something is
> going wrong and it might be useful if kafta had warned one not to worry
> about them.  Mind you I think he did say it all took a long time ;-)


The reason this script runs slowly is that it is calling updatePortf, 
updateAcct, and updateEndEq after each and every observation to do order 
sizing.

As a matter of practice, if you can 'cheat' and say 'I've got $1000000 
to invest, and I don't mind being a little leveraged', you don't need to 
do that, and things are *much* faster.  For example, we can typically 
run a strategy backtest on *tick* data (millions of observations) in 
less than a minute per day.

The reason for this divergent length of time is that the blotter update* 
functions do a *lot* of calculations, and all of those take time, even 
though they are vectorized where possible.

Perhaps a middle ground would be to call the update* functions monthly, 
or something similar.

I found his example script to be slower than I am used to, but not 
unbearable, and believe that it finished in a couple minutes, though its 
been a while since I ran it...


> I can assure you I do try and read man before I ask for help but dealing
> with other people's code is not always easy particularly when working
> with a programming system that uses a different paradigm like R with its
> emphasis on operations on vectors and the like. and the extensive use of
> calls to functions each of which often require a wet towel and cup of
> coffee to understand.
>
> I added the parameter definitions you suggest:
>
> currency("USD")
> stock("SPY",currency="USD",multiplier=1)
>
> and the warnings reduced to one:

Good.

> Warning messages:
> 1: In updatePortf(ltportfolio, Dates = currentDate) :
>    Incompatible methods ("Ops.Date", "Ops.POSIXt") for ">="
<...>

> "Ops.Date", "Ops.POSIXt" don't appear in the function call so they must
> be somewhere deeper.  I'm afraid I'm currently a windows user so grep is
> not available and the windows native text search didn't reveal much.
> However, I did find some references in the documentation (Date-Time
> Classes, Operators on the Date Class & S3 Group Generic Functions) but
> Ops.POSIXt doesn't appear therein only POSIXlt and Ops.POSIXct.  Is
> there a typo somewhere ?

It's likely not a typo, but rather an incompatible index between one 
time series and another.  You'd need to check the indices of each of the 
input series, or of the custom order sizing function from the script to 
see what's going on.  If the output from your run and the blog post 
agree, I wouldn't bother.

> It would be nice to get rid of the warnings.


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From klemen.koselj at gmail.com  Wed Dec 29 02:56:56 2010
From: klemen.koselj at gmail.com (Klemen Koselj)
Date: Wed, 29 Dec 2010 02:56:56 +0100
Subject: [R-SIG-Finance] Strategy performance summary report
Message-ID: <AANLkTimMpau4cDNhit6rtRhY6HGk3wQC5mPwx968Onrw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/d4eeaf94/attachment.pl>

From brian at braverock.com  Wed Dec 29 18:08:55 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 29 Dec 2010 11:08:55 -0600
Subject: [R-SIG-Finance] Strategy performance summary report
In-Reply-To: <AANLkTimMpau4cDNhit6rtRhY6HGk3wQC5mPwx968Onrw@mail.gmail.com>
References: <AANLkTimMpau4cDNhit6rtRhY6HGk3wQC5mPwx968Onrw@mail.gmail.com>
Message-ID: <4D1B6B27.4050606@braverock.com>

On 12/28/2010 07:56 PM, Klemen Koselj wrote:
> Hi,
>
> I have been learning R and trying to learn/use quanstrat/blotter for some
> time now and I find it very nice. I would like to thank developers and the
> community for creating and improving it.
>
> I have a very simple problem: I would like to create a strategy perfomance
> summary report (since I can not find it in the package or in the
> r-sig-finance list archives). I would like to display information about
> strategy performance in simmilar way as is done here
> http://quantumfinancier.wordpress.com/2010/09/24/new-strategy-performance-summary/.
> Most of the info was calculating using PerformanceAnalytics as shown
> in
> http://quantumfinancier.wordpress.com/2010/06/26/support-vector-machine-rsi-system/.
> I can replicate that. I am having problems with how to calculate trade
> statistics Win%, Average/Median Trade/win/loss, Win/Loss ratio etc. The only
> example I found was from Josh Urlich
> http://blog.fosstrading.com/2009/06/rsi2-evaluation.html unfortunately not
> using blotter...
>
> My problem is that I do not (yet) understand blotter internal data
> structures in order to be able to extract data needed for calculations. I
> would very much appreciate if someone could share an example of how to get
> this data from blotter.
>
> Thanks in advance for any hints/examples/...

Attached please find the prototype of the function that will make it 
into blotter for trade stats (just as soon as I write the 
documentation).  Comments and additions always appreciated.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: table.TradeStats.R
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/f696ddd9/attachment.pl>

From ezivot at u.washington.edu  Wed Dec 29 18:46:27 2010
From: ezivot at u.washington.edu (Eric Zivot)
Date: Wed, 29 Dec 2010 09:46:27 -0800
Subject: [R-SIG-Finance] UW Online Course: R Programming for Computational
	Finance
Message-ID: <005301cba780$51669180$f433b480$@washington.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/e3b27193/attachment.pl>

From nick.torenvliet at gmail.com  Wed Dec 29 19:09:20 2010
From: nick.torenvliet at gmail.com (Nick Torenvliet)
Date: Wed, 29 Dec 2010 13:09:20 -0500
Subject: [R-SIG-Finance] as.POSIXct issue
Message-ID: <AANLkTi=TJ54WWryxWXZVbqgtcr-LOViwvWjMufEsc-an@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/2710032c/attachment.pl>

From josh.m.ulrich at gmail.com  Wed Dec 29 19:14:51 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 29 Dec 2010 12:14:51 -0600
Subject: [R-SIG-Finance] as.POSIXct issue
In-Reply-To: <AANLkTi=TJ54WWryxWXZVbqgtcr-LOViwvWjMufEsc-an@mail.gmail.com>
References: <AANLkTi=TJ54WWryxWXZVbqgtcr-LOViwvWjMufEsc-an@mail.gmail.com>
Message-ID: <AANLkTikTShwf98uXRXSb7g59qVD-99sEwM_8NgDSBY2G@mail.gmail.com>

This is really more suited for R-help.  I'm surprised you weren't able
to find the answer in the documentation.

>From ?as.POSIXct:

  format: character string giving a date-time format as used by ?strptime?.

Which points you to 'strptime'.  From ?strptime:

  format: A character string.  The default for the ?format? methods is
          ?"%Y-%m-%d %H:%M:%S"? if any component has a time component
          which is not midnight, and ?"%Y-%m-%d"? otherwise.  If
          ?options("digits.secs")? is set, up to the specified number
          of digits will be printed for seconds.

--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Wed, Dec 29, 2010 at 12:09 PM, Nick Torenvliet
<nick.torenvliet at gmail.com> wrote:
> Hey all, happy new year to everyone!
>
> Little problem with some intraday data...
>
> I am working with a data.frame with the following format
>
> ? ? ? ? ? ? ? ? Date ? ? ? ? ?amp1 ? ? ?amp2 ? ? ? amp3 ? ? ?amp4
> amp5 ? ? ?amp6
> 1 19-10-2010 10:00:00 107.9531 105.6093 107.7965 109.1090 105.7922 107.4480
> 2 ?19-10-2010 9:00:00 110.4417 104.5610 106.9595 108.7497 105.5956 106.2880
> 3 ?19-10-2010 8:00:00 107.9917 105.0005 107.3482 108.6856 105.7174 107.6556
> 4 ?19-10-2010 7:00:00 109.1250 105.3563 107.8153 106.7011 106.5455 107.4221
> 5 ?19-10-2010 6:00:00 106.9048 104.7166 107.6824 106.0305 105.4604 108.3743
> 6 ?19-10-2010 5:00:00 108.2507 105.9069 107.6404 107.9394 106.0853 108.6718
>
> I would like to convert to xts So I do something like
>
>> xamps <- as.xts(amps[,-1],order.by=as.POSIXct(amps[,1]))
>
> and get
>
>> head(xamps)
> ? ? ? ? ? ? ? ? ?amp1 ? ? ?amp2 ? ? ? amp3 ? ? ?amp4 ? ? ?amp5 ? ? ?amp6
> 0009-10-20 111.4689 109.7270 106.1861 106.6256 106.0793 103.8423
> 0009-10-20 108.7130 109.9188 105.9373 106.9048 104.9599 104.5320
> 0009-10-20 109.7888 110.9390 107.3443 103.5092 105.9069 104.9364
> 0009-10-20 108.3422 110.2832 105.6447 106.0327 105.0138 103.5630
> 0009-10-20 109.1262 109.6370 106.2502 106.6233 104.6663 103.3754
> 0009-10-20 108.1395 110.4855 105.2810 104.1202 105.0546 103.2907
>
> I've narrowed the issue down to the as.POSIXct statement... and have
> consulted the literature/experimented to no avail.
>
> So what arguments do I need to supply the as.POSIXct to convert a character
> vector fomatted as "dd-mm-YYYY hh:mm:ss" to an equivalent xts index?
>
> Thanks in advance,
>
> Nick
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From nick.torenvliet at gmail.com  Wed Dec 29 19:21:43 2010
From: nick.torenvliet at gmail.com (Nick Torenvliet)
Date: Wed, 29 Dec 2010 13:21:43 -0500
Subject: [R-SIG-Finance] as.POSIXct issue
In-Reply-To: <AANLkTikTShwf98uXRXSb7g59qVD-99sEwM_8NgDSBY2G@mail.gmail.com>
References: <AANLkTi=TJ54WWryxWXZVbqgtcr-LOViwvWjMufEsc-an@mail.gmail.com>
	<AANLkTikTShwf98uXRXSb7g59qVD-99sEwM_8NgDSBY2G@mail.gmail.com>
Message-ID: <AANLkTimD5w-NeaoswvXRQRA4g_CCYBaRzVJgeHEr6=Xh@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/14ecf1cc/attachment.pl>

From markknecht at gmail.com  Wed Dec 29 19:25:10 2010
From: markknecht at gmail.com (Mark Knecht)
Date: Wed, 29 Dec 2010 10:25:10 -0800
Subject: [R-SIG-Finance] Strategy performance summary report
In-Reply-To: <4D1B6B27.4050606@braverock.com>
References: <AANLkTimMpau4cDNhit6rtRhY6HGk3wQC5mPwx968Onrw@mail.gmail.com>
	<4D1B6B27.4050606@braverock.com>
Message-ID: <AANLkTik0ffXvM83_8YCbxdeyXuwEs1WtSRDrmR_Uigan@mail.gmail.com>

On Wed, Dec 29, 2010 at 9:08 AM, Brian G. Peterson <brian at braverock.com> wrote:
> On 12/28/2010 07:56 PM, Klemen Koselj wrote:
>>
>> Hi,
>>
>> I have been learning R and trying to learn/use quanstrat/blotter for some
>> time now and I find it very nice. I would like to thank developers and the
>> community for creating and improving it.
>>
>> I have a very simple problem: I would like to create a strategy perfomance
>> summary report (since I can not find it in the package or in the
>> r-sig-finance list archives). I would like to display information about
>> strategy performance in simmilar way as is done here
>>
>> http://quantumfinancier.wordpress.com/2010/09/24/new-strategy-performance-summary/.
>> Most of the info was calculating using PerformanceAnalytics as shown
>> in
>>
>> http://quantumfinancier.wordpress.com/2010/06/26/support-vector-machine-rsi-system/.
>> I can replicate that. I am having problems with how to calculate trade
>> statistics Win%, Average/Median Trade/win/loss, Win/Loss ratio etc. The
>> only
>> example I found was from Josh Urlich
>> http://blog.fosstrading.com/2009/06/rsi2-evaluation.html unfortunately not
>> using blotter...
>>
>> My problem is that I do not (yet) understand blotter internal data
>> structures in order to be able to extract data needed for calculations. I
>> would very much appreciate if someone could share an example of how to get
>> this data from blotter.
>>
>> Thanks in advance for any hints/examples/...
>
> Attached please find the prototype of the function that will make it into
> blotter for trade stats (just as soon as I write the documentation).
> ?Comments and additions always appreciated.
>
> Regards,
>
> ?- Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
There is no question that Brian has forgotten 100 times more about R
than I will ever know but as a second set of code to look at and
comment back on here's part of a larger function file I have in my
work. This assumes an easily definable trade format as input from
TradeStation. The first function reads the TS data, the second adds
the statistics to the data frame.

In the spirit of learning, better coders are encouraged to make me a
little better. (Nicely!) ;-)

Cheers,
Mark

## Read in csv file, convert header names to things R likes
## and handle bad characters in the number fields
## Returns a data.frame names for the trading system
readMSA = function (MyFile) {
	x <- read.csv(MyFile,      header = TRUE, sep = ",", quote="\"",
dec=".",fill = TRUE, comment.char="", skip=1,check.names=FALSE)
	names(x)[1] <- "Trade"
	names(x)[2] <- "SysNumber"
	names(x)[3] <- "Date"
	names(x)[4] <- "PL_Size"
	names(x)[5] <- "PS_Method"
	names(x)[6] <- "Size"
	names(x)[7] <- "PL_Pos"
	names(x)[8] <- "DDDollars"
	names(x)[9] <- "DDPercent"
	names(x)[10]<- "Equity"
	x$Trade     <- as.numeric(sub('[",]', '', x$Trade))
	x$PL_Size   <- as.numeric(sub('[",]', '', x$PL_Size))
	x$PL_Pos    <- as.numeric(sub('[",]', '', x$PL_Pos))
	x$DDDollars <- as.numeric(sub('[",]', '', x$DDDollars))
	x$DDPercent <- round(as.numeric(sub('[",]', '', x$DDPercent)),2)
	x$Equity    <- as.numeric(sub('[",]', '', x$Equity))
	return(x)
	}

#################################################################
## Main function to collect Tharp statistics on Trading System ##
#################################################################

DoTharp = function (System) {
	pos <- System$PL_Pos > 0
	System$Profit[pos] <- System$PL_Pos[pos]
	System$Loss[!pos]  <- System$PL_Pos[!pos]
	System$Winners <- cumsum(System$Profit > 0)
	System$Losers  <- cumsum(System$Loss < 0)
	System$TotalWins   <- cumsum(System$Profit)
	System$TotalLosses <- cumsum(System$Loss)
	System$AvgWin  <- as.integer(System$TotalWins / System$Winners)
	System$AvgLoss <- as.integer(System$TotalLosses / System$Losers)
	System$PercentWins <- round((System$Winners /
(System$Winners+System$Losers)),2)
	System$LargestWin <- cummax(System$Profit)
	System$LargestLoss <- cummin(System$Loss)
	System$TotalProfit <- System$TotalWins + System$TotalLosses
	System$ProfitFactor <- round(System$TotalWins/(-1*System$TotalLosses),2)
	System$AvgWinAvgLoss <- round(System$AvgWin / (-1*System$AvgLoss),2)
	System$EquityHigh <- cummax(System$TotalProfit)
	System$NewHigh <- ifelse(System$EquityHigh != System$TotalProfit,0,1)
	System$DrawDown <- System$EquityHigh - System$TotalProfit
	System$CumSumPL <- cumsum(System$PL_Pos)
	return(System)
	}


From nick.torenvliet at gmail.com  Wed Dec 29 19:27:38 2010
From: nick.torenvliet at gmail.com (Nick Torenvliet)
Date: Wed, 29 Dec 2010 13:27:38 -0500
Subject: [R-SIG-Finance] as.POSIXct issue
In-Reply-To: <AANLkTimD5w-NeaoswvXRQRA4g_CCYBaRzVJgeHEr6=Xh@mail.gmail.com>
References: <AANLkTi=TJ54WWryxWXZVbqgtcr-LOViwvWjMufEsc-an@mail.gmail.com>
	<AANLkTikTShwf98uXRXSb7g59qVD-99sEwM_8NgDSBY2G@mail.gmail.com>
	<AANLkTimD5w-NeaoswvXRQRA4g_CCYBaRzVJgeHEr6=Xh@mail.gmail.com>
Message-ID: <AANLkTikZPk91XAbpd_9nquHTkjr4bKtGMzGzFriYxOLz@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/07f91a91/attachment.pl>

From josh.m.ulrich at gmail.com  Wed Dec 29 19:39:04 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 29 Dec 2010 12:39:04 -0600
Subject: [R-SIG-Finance] as.POSIXct issue
In-Reply-To: <AANLkTimD5w-NeaoswvXRQRA4g_CCYBaRzVJgeHEr6=Xh@mail.gmail.com>
References: <AANLkTi=TJ54WWryxWXZVbqgtcr-LOViwvWjMufEsc-an@mail.gmail.com>
	<AANLkTikTShwf98uXRXSb7g59qVD-99sEwM_8NgDSBY2G@mail.gmail.com>
	<AANLkTimD5w-NeaoswvXRQRA4g_CCYBaRzVJgeHEr6=Xh@mail.gmail.com>
Message-ID: <AANLkTimsQxhU3RenNDjhhsjTTQQ5NE-CAidL7jdFUtWS@mail.gmail.com>

Then my guess is that your date column is a factor, not character.
as.POSIXlt.factor doesn't pass dots, which is why your specified
format wasn't affecting anything.
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Wed, Dec 29, 2010 at 12:21 PM, Nick Torenvliet
<nick.torenvliet at gmail.com> wrote:
> Yes, I did all that... I am having trouble deciphering, in as.xts what is
> passing what to what to what and in what required format though... so as I
> say my experimentation with formats and strptime has left me cold...
>
> On Wed, Dec 29, 2010 at 1:14 PM, Joshua Ulrich <josh.m.ulrich at gmail.com>wrote:
>
>> This is really more suited for R-help. ?I'm surprised you weren't able
>> to find the answer in the documentation.
>>
>> From ?as.POSIXct:
>>
>> ?format: character string giving a date-time format as used by ?strptime?.
>>
>> Which points you to 'strptime'. ?From ?strptime:
>>
>> ?format: A character string. ?The default for the ?format? methods is
>> ? ? ? ? ??"%Y-%m-%d %H:%M:%S"? if any component has a time component
>> ? ? ? ? ?which is not midnight, and ?"%Y-%m-%d"? otherwise. ?If
>> ? ? ? ? ??options("digits.secs")? is set, up to the specified number
>> ? ? ? ? ?of digits will be printed for seconds.
>>
>> --
>> Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com
>>
>>
>>
>> On Wed, Dec 29, 2010 at 12:09 PM, Nick Torenvliet
>> <nick.torenvliet at gmail.com> wrote:
>> > Hey all, happy new year to everyone!
>> >
>> > Little problem with some intraday data...
>> >
>> > I am working with a data.frame with the following format
>> >
>> > ? ? ? ? ? ? ? ? Date ? ? ? ? ?amp1 ? ? ?amp2 ? ? ? amp3 ? ? ?amp4
>> > amp5 ? ? ?amp6
>> > 1 19-10-2010 10:00:00 107.9531 105.6093 107.7965 109.1090 105.7922
>> 107.4480
>> > 2 ?19-10-2010 9:00:00 110.4417 104.5610 106.9595 108.7497 105.5956
>> 106.2880
>> > 3 ?19-10-2010 8:00:00 107.9917 105.0005 107.3482 108.6856 105.7174
>> 107.6556
>> > 4 ?19-10-2010 7:00:00 109.1250 105.3563 107.8153 106.7011 106.5455
>> 107.4221
>> > 5 ?19-10-2010 6:00:00 106.9048 104.7166 107.6824 106.0305 105.4604
>> 108.3743
>> > 6 ?19-10-2010 5:00:00 108.2507 105.9069 107.6404 107.9394 106.0853
>> 108.6718
>> >
>> > I would like to convert to xts So I do something like
>> >
>> >> xamps <- as.xts(amps[,-1],order.by=as.POSIXct(amps[,1]))
>> >
>> > and get
>> >
>> >> head(xamps)
>> > ? ? ? ? ? ? ? ? ?amp1 ? ? ?amp2 ? ? ? amp3 ? ? ?amp4 ? ? ?amp5 ? ? ?amp6
>> > 0009-10-20 111.4689 109.7270 106.1861 106.6256 106.0793 103.8423
>> > 0009-10-20 108.7130 109.9188 105.9373 106.9048 104.9599 104.5320
>> > 0009-10-20 109.7888 110.9390 107.3443 103.5092 105.9069 104.9364
>> > 0009-10-20 108.3422 110.2832 105.6447 106.0327 105.0138 103.5630
>> > 0009-10-20 109.1262 109.6370 106.2502 106.6233 104.6663 103.3754
>> > 0009-10-20 108.1395 110.4855 105.2810 104.1202 105.0546 103.2907
>> >
>> > I've narrowed the issue down to the as.POSIXct statement... and have
>> > consulted the literature/experimented to no avail.
>> >
>> > So what arguments do I need to supply the as.POSIXct to convert a
>> character
>> > vector fomatted as "dd-mm-YYYY hh:mm:ss" to an equivalent xts index?
>> >
>> > Thanks in advance,
>> >
>> > Nick
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> should go.
>> >
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From leijin56 at gmail.com  Wed Dec 29 20:53:22 2010
From: leijin56 at gmail.com (Lei Jin)
Date: Wed, 29 Dec 2010 11:53:22 -0800
Subject: [R-SIG-Finance] align time series correctly
Message-ID: <AANLkTiktkAhS_jrm-QsVzewgiAGOiGLXU+-uJtrLvzzn@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/0191e003/attachment.pl>

From josh.m.ulrich at gmail.com  Wed Dec 29 21:08:28 2010
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Wed, 29 Dec 2010 14:08:28 -0600
Subject: [R-SIG-Finance] align time series correctly
In-Reply-To: <AANLkTiktkAhS_jrm-QsVzewgiAGOiGLXU+-uJtrLvzzn@mail.gmail.com>
References: <AANLkTiktkAhS_jrm-QsVzewgiAGOiGLXU+-uJtrLvzzn@mail.gmail.com>
Message-ID: <AANLkTi=ZahZu94oDbWvSC+enrTJ4GowNaLUBLpS2c3Ct@mail.gmail.com>

Use merge.xts:

require(quantmod)
getSymbols("^IRX;^VIX;SPY", from="1994-01-01")
Data <- merge(IRX,VIX,SPY)

# Note that there will be some NAs
# e.g. 1994-01-17 for IRX
head(Data,20)

# use na.omit to drop them
Data <- na.omit(Data)
nrow(Data)  # 4256

# or use merge's 'all' arg
Data <- merge(IRX,VIX,SPY,all=FALSE)
nrow(Data)  # same as na.omit


Best,
--
Joshua Ulrich ?| ?FOSS Trading: www.fosstrading.com



On Wed, Dec 29, 2010 at 1:53 PM, Lei Jin <leijin56 at gmail.com> wrote:
> I am trying to create a data frame that includes data from 3 time series.
> (^IRX, ^VIX, SPY). ?I noticed that getSymbols() from yahoo (default) seems
> to retrieve different rows for the 3 time series for the same time window I
> specified. ?So, I got an "arguments imply differing number of rows". ?My
> simple questions is how do I set # of rows for all 3 time series to be equal
> and aligned by date correctly.
>
>
> ==============================================================
> ?arguments imply differing number of rows: 4279, 4277, 4258
> In addition: Warning message:
> In log(x) : NaNs produced
>> print(NROW(IRX))
> [1] 4258
>> print(NROW(VIX))
> [1] 4277
>> print(NROW(SPY))
> [1] 4279
>
> --
> Thank you,
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
>


From brian at braverock.com  Wed Dec 29 21:27:06 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 29 Dec 2010 14:27:06 -0600
Subject: [R-SIG-Finance] align time series correctly
In-Reply-To: <AANLkTiktkAhS_jrm-QsVzewgiAGOiGLXU+-uJtrLvzzn@mail.gmail.com>
References: <AANLkTiktkAhS_jrm-QsVzewgiAGOiGLXU+-uJtrLvzzn@mail.gmail.com>
Message-ID: <4D1B999A.3060200@braverock.com>

On 12/29/2010 01:53 PM, Lei Jin wrote:
> I am trying to create a data frame that includes data from 3 time series.
> (^IRX, ^VIX, SPY).  I noticed that getSymbols() from yahoo (default) seems
> to retrieve different rows for the 3 time series for the same time window I
> specified.  So, I got an "arguments imply differing number of rows".  My
> simple questions is how do I set # of rows for all 3 time series to be equal
> and aligned by date correctly.

Don't use a data.frame

This is time series data, conveniently returned to you in a time series 
class.

use cbind() on the xts object, and it will all 'just work', putting NA's 
in the missing days, where they belong.

   - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From leijin56 at gmail.com  Wed Dec 29 23:46:50 2010
From: leijin56 at gmail.com (Lei Jin)
Date: Wed, 29 Dec 2010 14:46:50 -0800
Subject: [R-SIG-Finance] align time series correctly
In-Reply-To: <AANLkTi=ZahZu94oDbWvSC+enrTJ4GowNaLUBLpS2c3Ct@mail.gmail.com>
References: <AANLkTiktkAhS_jrm-QsVzewgiAGOiGLXU+-uJtrLvzzn@mail.gmail.com>
	<AANLkTi=ZahZu94oDbWvSC+enrTJ4GowNaLUBLpS2c3Ct@mail.gmail.com>
Message-ID: <AANLkTimua6i9GasLhaJmuUvj7G9sjCMGamaJg+Szugx-@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101229/19673676/attachment.pl>

From sinwise at gmail.com  Thu Dec 30 16:38:51 2010
From: sinwise at gmail.com (Alex Sin)
Date: Fri, 31 Dec 2010 00:38:51 +0900
Subject: [R-SIG-Finance] Fitting returns - High frequency
Message-ID: <AANLkTikQuzJd=7ggDhBOZVChz0nNiGN9b_L2W4g7_6Jq@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101231/d1a5f694/attachment.pl>

From edd at debian.org  Thu Dec 30 17:18:21 2010
From: edd at debian.org (Dirk Eddelbuettel)
Date: Thu, 30 Dec 2010 10:18:21 -0600
Subject: [R-SIG-Finance] Fitting returns - High frequency
In-Reply-To: <AANLkTikQuzJd=7ggDhBOZVChz0nNiGN9b_L2W4g7_6Jq@mail.gmail.com>
References: <AANLkTikQuzJd=7ggDhBOZVChz0nNiGN9b_L2W4g7_6Jq@mail.gmail.com>
Message-ID: <19740.45261.197404.916536@max.nulle.part>


On 31 December 2010 at 00:38, Alex Sin wrote:
| Hello all,
| First, happy new year everyone !
| I'm trying to fit *intraday* returns on R through linear regression and
| experiencing model Heteroskedasticity and residuals autocorrelation..
| Does anyone have good articles / research papers / websites that deal with
| such issues ?

The Gencay et al book on High Frequency Finance is a good introduction. There
are *countless* issues to be aware of.

Dirk

| I would be interested in techniques for 'cleaning' the time series of the
| noise / dealing with time series of non constant variance (non stationary).
| 
| I'm also interested if anyone suggests other statistical methods (apart from
| linear regression..) that can be applied to such a problem.
| 
| Thank you !
| 
| 	[[alternative HTML version deleted]]
| 
| _______________________________________________
| R-SIG-Finance at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| -- Subscriber-posting only. If you want to post, subscribe first.
| -- Also note that this is not the r-help list where general R questions should go.

-- 
Dirk Eddelbuettel | edd at debian.org | http://dirk.eddelbuettel.com


From aidan.corcoran11 at gmail.com  Thu Dec 30 18:29:35 2010
From: aidan.corcoran11 at gmail.com (Aidan Corcoran)
Date: Thu, 30 Dec 2010 17:29:35 +0000
Subject: [R-SIG-Finance] Error using blpConnect in package RBloomberg
Message-ID: <AANLkTinW+_xciSpi7pwWng-L7xSuwxCM6MiAXiG4_+n+@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101230/cb0630cf/attachment.pl>

From markknecht at gmail.com  Thu Dec 30 22:03:43 2010
From: markknecht at gmail.com (Mark Knecht)
Date: Thu, 30 Dec 2010 13:03:43 -0800
Subject: [R-SIG-Finance] ?getSymbol.MySQL
Message-ID: <AANLkTikun9LqF47pD8f9SE220D6Kxr2j_2D1bb1-z9OQ@mail.gmail.com>

Just a quick question. I'm playing around seriously for the first time
with MySQL. The man page for getSymbol.MySQL says I shouldn't call it
directly. However I note from reading that the default assumptions for
column names don't match what I have in my database. Additionally I
have other columns in the database I'd like to fetch if possible.
(Indicators, trading system status, etc.)

Is there any way to remap the column names that get fetched within R
using getSymbol? I.e. - a generic fetch of whatever column I want
instead of just predefined price data?

Am I better off in the long run digging into the getSymbol.MySQL R
code and then making my own function to do this job?

Maybe there's a more general package for MySQL interface vs one used
specifically for stock data?

Thanks in advance,
Mark


From brian at braverock.com  Thu Dec 30 22:11:01 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 30 Dec 2010 15:11:01 -0600
Subject: [R-SIG-Finance] ?getSymbol.MySQL
In-Reply-To: <AANLkTikun9LqF47pD8f9SE220D6Kxr2j_2D1bb1-z9OQ@mail.gmail.com>
References: <AANLkTikun9LqF47pD8f9SE220D6Kxr2j_2D1bb1-z9OQ@mail.gmail.com>
Message-ID: <4D1CF565.6050102@braverock.com>

On 12/30/2010 03:03 PM, Mark Knecht wrote:
> Just a quick question. I'm playing around seriously for the first time
> with MySQL. The man page for getSymbol.MySQL says I shouldn't call it
> directly. However I note from reading that the default assumptions for
> column names don't match what I have in my database. Additionally I
> have other columns in the database I'd like to fetch if possible.
> (Indicators, trading system status, etc.)
>
> Is there any way to remap the column names that get fetched within R
> using getSymbol? I.e. - a generic fetch of whatever column I want
> instead of just predefined price data?
>
> Am I better off in the long run digging into the getSymbol.MySQL R
> code and then making my own function to do this job?
>
> Maybe there's a more general package for MySQL interface vs one used
> specifically for stock data?

Well, certainly there's the RMySQL package...

The 'don't call this directly' bit is a reference to setSymbolLookup. 
Ideally, you use setSymbolLookup to tell getSymbols which method (yahoo, 
rda, google, oanda, MySQL, etc.) to use for a particular symbol.  We do 
that with a little custom function that runs in everybody's .Rprofile to 
point getSymbols at all our in-house tick data stored in rda files by 
day (see getSymbols.FI in the FinancialInstrument package).

I would recommend that you pull apart getSymbols.MySQL and add the 
columns you want.  Make sure you rename the OHLCV or tick data columns 
in your output xts object to line up with what the other quantmod 
functions expect, but otherwise just use whatever columns you want from 
your data.

then use setSymbolLookup to tell getSymbols to use your method function 
'getSymbols.MK_mySQL' (or whatever) to load those symbols.

Regards,

  - Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From brian at braverock.com  Fri Dec 31 00:17:52 2010
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 30 Dec 2010 17:17:52 -0600
Subject: [R-SIG-Finance] Strategy performance summary report
In-Reply-To: <4D1B6B27.4050606@braverock.com>
References: <AANLkTimMpau4cDNhit6rtRhY6HGk3wQC5mPwx968Onrw@mail.gmail.com>
	<4D1B6B27.4050606@braverock.com>
Message-ID: <4D1D1320.9090804@braverock.com>

On 12/29/2010 11:08 AM, Brian G. Peterson wrote:
> Attached please find the prototype of the function that will make it
> into blotter for trade stats (just as soon as I write the
> documentation).  Comments and additions always appreciated.

The tradeStats function  is in blotter in SVN r512.  It is only 
partially documented, but should suffice for now.  Thanks to Josh 
Ulrich, Klemen Koselj, and Mark Knecht for additions to the stats 
calculated by the function and bugfixes. Specific contributions are in 
the documentation.

Because I feel that any statistic calculable strictly from transaction 
P&L without reference to any proprietary strategy rules is likely 
non-proprietary, I will continue to welcome suggestions, resuests, and 
(better yet) additions or patches to add additional statistics to the 
summary information provided by blotter.

Regards,

   - Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From nelson.ana at gmail.com  Fri Dec 31 02:05:33 2010
From: nelson.ana at gmail.com (Ana Nelson)
Date: Fri, 31 Dec 2010 01:05:33 +0000
Subject: [R-SIG-Finance] Error using blpConnect in package RBloomberg
In-Reply-To: <AANLkTinW+_xciSpi7pwWng-L7xSuwxCM6MiAXiG4_+n+@mail.gmail.com>
References: <AANLkTinW+_xciSpi7pwWng-L7xSuwxCM6MiAXiG4_+n+@mail.gmail.com>
Message-ID: <AANLkTi=7161HEx52FXLgDAQ_gsn-B=t0uKK7rSAg0VZ9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20101231/b78e8e3e/attachment.pl>

From pgilbert at bank-banque-canada.ca  Fri Dec 31 21:53:23 2010
From: pgilbert at bank-banque-canada.ca (Paul Gilbert)
Date: Fri, 31 Dec 2010 20:53:23 +0000
Subject: [R-SIG-Finance] [off-topic] Forum for Macro-economics discussion
In-Reply-To: <AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>
References: <AANLkTi=PtOcr54=XpG6s88E=Ak=-8e7w2EbmNn0_j5kJ@mail.gmail.com>
	<AANLkTin+mKV58hkvbD=Paaa=+hqE8YMO0MyQ+ZiF6To=@mail.gmail.com>
Message-ID: <6441154A9FF1CD4386AF4ABF141A056D01F63C@WMEXOSCD2-N1.bocad.bank-banque-canada.ca>

Perhaps there would be too much overlap with R-SIG-Finance, but does anyone think
an  R-SIG-MacroEcon list would be useful?

Paul

>-----Original Message-----
>From: r-sig-finance-bounces at r-project.org [mailto:r-sig-finance-
>bounces at r-project.org] On Behalf Of Michael Dothan
>Sent: December 20, 2010 7:23 PM
>To: Christofer Bogaso
>Cc: r-sig-finance at r-project.org
>Subject: Re: [R-SIG-Finance] [off-topic] Forum for Macro-economics
>discussion
>
>Check out these sites:
>
>http://baselinescenario.com/
>
>http://www.nakedcapitalism.com/
>
>http://www.voxeu.org/
>
>http://modelsagents.blogspot.com/
>
>http://krugman.blogs.nytimes.com/
>
>Best,
>
>Michael
>
>On 12/20/10, Christofer Bogaso <bogaso.christofer at gmail.com> wrote:
>> Hi friends, I am looking for some good and well active forums for
>> Macro-economics related discussions. Can people here name a few on
>that?
>>
>> Thanks and regards,
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R
>questions
>> should go.
>>
>
>_______________________________________________
>R-SIG-Finance at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>-- Subscriber-posting only. If you want to post, subscribe first.
>-- Also note that this is not the r-help list where general R questions
>should go.
====================================================================================

La version fran?aise suit le texte anglais.

------------------------------------------------------------------------------------

This email may contain privileged and/or confidential information, and the Bank of
Canada does not waive any related rights. Any distribution, use, or copying of this
email or the information it contains by other than the intended recipient is
unauthorized. If you received this email in error please delete it immediately from
your system and notify the sender promptly by email that you have done so. 

------------------------------------------------------------------------------------

Le pr?sent courriel peut contenir de l'information privil?gi?e ou confidentielle.
La Banque du Canada ne renonce pas aux droits qui s'y rapportent. Toute diffusion,
utilisation ou copie de ce courriel ou des renseignements qu'il contient par une
personne autre que le ou les destinataires d?sign?s est interdite. Si vous recevez
ce courriel par erreur, veuillez le supprimer imm?diatement et envoyer sans d?lai ?
l'exp?diteur un message ?lectronique pour l'aviser que vous avez ?limin? de votre
ordinateur toute copie du courriel re?u.

