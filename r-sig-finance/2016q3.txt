From pankajsbi at yahoo.com  Tue Jul  5 20:42:34 2016
From: pankajsbi at yahoo.com (Pankaj K Agarwal)
Date: Tue, 5 Jul 2016 18:42:34 +0000 (UTC)
Subject: [R-SIG-Finance] GMM
In-Reply-To: <022b01d1d15d$daa0ccb0$8fe26610$@uw.edu>
References: <416475601.1919765.1467051426633.JavaMail.yahoo.ref@mail.yahoo.com>
	<416475601.1919765.1467051426633.JavaMail.yahoo@mail.yahoo.com>
	<022b01d1d15d$daa0ccb0$8fe26610$@uw.edu>
Message-ID: <295884140.1704081.1467744154500.JavaMail.yahoo@mail.yahoo.com>

Respected Eric SirTo rephrase what you said (just to test my understanding of it): If the OLS moment conditions are perfectly identified, and HAC standard errors are used, the output (standard errors) will be identical to those from GMM. Am i right sir? I am using a linear model which is a CAPM variant with an additional squared market premium term. In this case, will not the GMM and OLS with HAC give same results?Your comment will be invaluable sir.?Regards,Pankaj K Agarwal


 

    On Tuesday, 28 June 2016 10:27 PM, Eric Zivot <ezivot at uw.edu> wrote:
 
 

 No
OLS is a special case of GMM where the number of moment conditions is the same as the number of parameters. In this case the efficient weight matrix does not matter for estimation but does matter for the calculation of an estimate of the asymptotic variance matrix of the OLS parameters. This is what HAC standard errors do in the sandwich function vcovHAC()

-----Original Message-----
From: R-SIG-Finance [mailto:r-sig-finance-bounces at r-project.org] On Behalf Of Pankaj K Agarwal via R-SIG-Finance
Sent: Monday, June 27, 2016 11:17 AM
To: R-sig-finance <r-sig-finance at r-project.org>
Cc: H.K Pradhan <pradhan at xlri.ac.in>
Subject: [R-SIG-Finance] GMM

Apologies if this question is irrelevant for this group.
Does using HAC standard errors (Newey and West: package sandwich) in OLS regression make using GMM (package: GMM) redundant?
 Regards,Pankaj K Agarwal
+91-98397-11444http://in.linkedin.com/in/pankajkagarwal/
??? [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.



  
	[[alternative HTML version deleted]]


From sacios at hotmail.it  Fri Jul  8 16:20:19 2016
From: sacios at hotmail.it (Sachin Kuruvithadam)
Date: Fri, 8 Jul 2016 14:20:19 +0000
Subject: [R-SIG-Finance] Fitting multivariate skew-t distribution with "sn"
	package
Message-ID: <DB4PR06MB0685A56B3A3ADC7A96C9B1BFB73C0@DB4PR06MB0685.eurprd06.prod.outlook.com>

I'm trying to fit a multivariate t distribution to a matrix. Since I want the parameters to be estimated instead of fixed, I thought using the "mst.mple" command. But it says "required argument y is missing", so now I understand this is to be used for a regression with skew-t errors.


So how do you fit a multivariate t distribution (with no covariates / response values etc.) to a given matrix?

	[[alternative HTML version deleted]]


From pankajsbi at yahoo.com  Sat Jul  9 09:37:03 2016
From: pankajsbi at yahoo.com (Pankaj K Agarwal)
Date: Sat, 9 Jul 2016 07:37:03 +0000 (UTC)
Subject: [R-SIG-Finance] Wald test for time-varying OLS parameters
References: <510405484.106366.1468049823163.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <510405484.106366.1468049823163.JavaMail.yahoo@mail.yahoo.com>

Hi1. How can a wald test be performed in R for testing whether parameters estimated through an OLS regression (on a time series of returns) are time varying? Can it be done with lm()Thanks in advance for kind help.
?Regards,Pankaj K Agarwal
+91-98397-11444

	[[alternative HTML version deleted]]


From pankajsbi at yahoo.com  Sat Jul  9 09:37:03 2016
From: pankajsbi at yahoo.com (Pankaj K Agarwal)
Date: Sat, 9 Jul 2016 07:37:03 +0000
Subject: [R-SIG-Finance] Wald test for time-varying OLS parameters
References: <510405484.106366.1468049823163.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <510405484.106366.1468049823163.JavaMail.yahoo@mail.yahoo.com>

Hi1. How can a wald test be performed in R for testing whether parameters estimated through an OLS regression (on a time series of returns) are time varying? Can it be done with lm()Thanks in advance for kind help.
?Regards,Pankaj K Agarwal
+91-98397-11444

	[[alternative HTML version deleted]]


From pankajsbi at yahoo.com  Sat Jul  9 10:12:27 2016
From: pankajsbi at yahoo.com (Pankaj K Agarwal)
Date: Sat, 9 Jul 2016 08:12:27 +0000 (UTC)
Subject: [R-SIG-Finance] Wald test for time-varying OLS parameters
In-Reply-To: <510405484.106366.1468049823163.JavaMail.yahoo@mail.yahoo.com>
References: <510405484.106366.1468049823163.JavaMail.yahoo.ref@mail.yahoo.com>
	<510405484.106366.1468049823163.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1159238352.122569.1468051947104.JavaMail.yahoo@mail.yahoo.com>

Please discard my previous mail. My updated question is as follows:Hi1. How can a wald test be performed in R for testing whether parameters estimated through an OLS regression of the form?yt=a+ bxt+ et??are time varying? Can it be done with lm()Thanks in advance for kind help.


Regards,Pankaj K Agarwal
+91-98397-11444http://in.linkedin.com/in/pankajkagarwal/ 

    On Saturday, 9 July 2016 1:12 PM, Pankaj K Agarwal via R-SIG-Finance <r-sig-finance at r-project.org> wrote:
 
 

 Hi1. How can a wald test be performed in R for testing whether parameters estimated through an OLS regression (on a time series of returns) are time varying? Can it be done with lm()Thanks in advance for kind help.
?Regards,Pankaj K Agarwal
+91-98397-11444

??? [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


  
	[[alternative HTML version deleted]]


From pankajsbi at yahoo.com  Sat Jul  9 10:12:27 2016
From: pankajsbi at yahoo.com (Pankaj K Agarwal)
Date: Sat, 9 Jul 2016 08:12:27 +0000
Subject: [R-SIG-Finance] Wald test for time-varying OLS parameters
In-Reply-To: <510405484.106366.1468049823163.JavaMail.yahoo@mail.yahoo.com>
References: <510405484.106366.1468049823163.JavaMail.yahoo.ref@mail.yahoo.com>
	<510405484.106366.1468049823163.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1159238352.122569.1468051947104.JavaMail.yahoo@mail.yahoo.com>

Please discard my previous mail. My updated question is as follows:Hi1. How can a wald test be performed in R for testing whether parameters estimated through an OLS regression of the form?yt=a+ bxt+ et??are time varying? Can it be done with lm()Thanks in advance for kind help.


Regards,Pankaj K Agarwal
+91-98397-11444http://in.linkedin.com/in/pankajkagarwal/ 

    On Saturday, 9 July 2016 1:12 PM, Pankaj K Agarwal via R-SIG-Finance <r-sig-finance at r-project.org> wrote:
 
 

 Hi1. How can a wald test be performed in R for testing whether parameters estimated through an OLS regression (on a time series of returns) are time varying? Can it be done with lm()Thanks in advance for kind help.
?Regards,Pankaj K Agarwal
+91-98397-11444

??? [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


  
	[[alternative HTML version deleted]]


From ashwinids2nd at gmail.com  Thu Jul 14 08:41:03 2016
From: ashwinids2nd at gmail.com (ASHWINI PAL)
Date: Thu, 14 Jul 2016 02:41:03 -0400
Subject: [R-SIG-Finance] Error while using ugarchsim in Rugarch function -->
 error in calling in c function
Message-ID: <CAGN4Dw5DrhGqnUYf83jEpXW_TdveJVnZRuE4-We2mk2kfY+t=g@mail.gmail.com>

I'm using rugarch for modelling financial time series of returns.

To simulate paths from fitted models, I've defined following function

funcsim <- function(x){
>
>   sim=ugarchsim(x,n.sim=10000,m.sim=5,n.start=1);
>   return(apply(sim at simulation$seriesSim,1,sum))
> }


i=0
> for(fit in Modelfits){
>
>   print(i)
>   sim=funcsim(fit)
>   i=i+1
> }


Modelfits is a named list variable with names PC1,PC2,PC3,PC4,PC5,,...,PC85.


I'm getting error

> ugarchsim-->error: error in calling C function....





Traceback for the error is

>
> stop("\nugarchsim-->error: error in calling C function....\n")
> 5
> .egarchsim1(fit = fit, n.sim = n.sim, n.start = n.start, m.sim = m.sim,
> startMethod = startMethod, presigma = presigma, prereturns = prereturns,
> preresiduals = preresiduals, rseed = rseed, custom.dist = custom.dist,
> mexsimdata = mexsimdata, vexsimdata = vexsimdata)
> startMethod = startMethod, presigma = presigma, prereturns = prereturns,
> preresiduals = preresiduals, rseed = rseed, custom.dist = custom.dist,
> mexsimdata = mexsimdata, vexsimdata = vexsimdata)4
> .egarchsim(fit = fit, n.sim = n.sim, n.start = n.start, m.sim = m.sim,
> startMethod = startMethod, presigma = presigma, prereturns = prereturns,
> preresiduals = preresiduals, rseed = rseed, custom.dist = custom.dist,
> mexsimdata = mexsimdata, vexsimdata = vexsimdata, ...)
> startMethod = startMethod, presigma = presigma, prereturns = prereturns,
> preresiduals = preresiduals, rseed = rseed, custom.dist = custom.dist,
> mexsimdata = mexsimdata, vexsimdata = vexsimdata, ...)3
> ugarchsim(x, n.sim = 10000, m.sim = 5, n.start = 1)
> 2
> ugarchsim(x, n.sim = 10000, m.sim = 5, n.start = 1)
> 1
> funcsim(fit)
>



Error randomly occurs for some of the series in the list.


But, while simulating individually i don't get any error. for example,

funcsim(Modelfits$PC84)



All the models fitted are of form egarch.


Please, can someone help me on this problem?

I've gone through the source code on github, still can't locate the cause
of error.

	[[alternative HTML version deleted]]


From sacios at hotmail.it  Wed Jul 20 16:04:02 2016
From: sacios at hotmail.it (Sachin Kuruvithadam)
Date: Wed, 20 Jul 2016 14:04:02 +0000
Subject: [R-SIG-Finance] Estimating parameters of asymmetric dynamic
 conditional correlation (aDCC)
Message-ID: <DB4PR06MB068576DA4116C7D94A772402B7080@DB4PR06MB0685.eurprd06.prod.outlook.com>

I'm only interested in the second stage of the DCC estimation process, because I've already filtered the residuals from the original returns and obtained the standardized residuals from the first stage, which I then "transform" (that's why I can't use the full DCC model in the rmgarch package). Having these Txd data matrix (T=observations, d=dimension), I want to estimate the parameters of the aDCC as defined in "Asymmetric Dynamics in the Correlations of Global Equity and Bond Returns" (Cappiello, Engle & Sheppard, 2006), i.e.


Q_t = (1-\alpha-\beta)\bar{Q} - \gamma \bar{N} + \alpha z_{t-1}z_{t-1}' + \beta Q_{t-1} +\gamma n_{t-1}n_{t-1}'


where Q_t is a proxy process, R_t is the correlation matrix, z_t is a matrix with vectors (z_1,...,z_d), n_t=1_{z_t<0} z_t is the asymmetric innovation, and \bar{N}=E[n_t n_t'].


Here's an example to play with R:


#data for example
library(rmgarch)
data(dji30retw)
Dat = dji30retw[, 1:6, drop = FALSE]

#specify garch specification (the given parameters come from previous analysis)
models <- list()
for (i in 1:6){
models[[i]]=ugarchspec(variance.model = list(model = "gjrGARCH", garchOrder = c(1, 1),
                                            submodel = NULL, external.regressors = NULL, variance.targeting = TRUE),
                      mean.model = list(armaOrder = c(0,0), include.mean = FALSE, archm = FALSE,
                                        archpow = 1, arfima = FALSE, external.regressors = NULL, archex = FALSE),
                      distribution.model = "norm", start.pars = list(), fixed.pars = list(alpha1=8.81e-02,
                                                                                          beta1=9.41e-01 ,
                                                                                          gamma1=-8.46e-02,
                                                                                          omega=5.016982e-07))
}

#by filtering data with the specification, I create 1-step ahead volatility forecast
filter <- list()
for (i in 1:6){
  filter[[i]]=ugarchfilter(models[[i]],Dat[,i])
}

#standardized residuals (1141 x 6)
st.res <- matrix(ncol=6, nrow=1141)
for (i in 1:6){
  st.res[,i]=residuals(filter[[i]])/sigma(filter[[i]])
}


As I said I'm not really working with GARCH standardized residuals, but if someone can explain how to estimate the aDCC parameters with given data I'd appreciate it very much.


	[[alternative HTML version deleted]]


From gmatysiak at gmail.com  Sun Jul 31 12:38:21 2016
From: gmatysiak at gmail.com (George Matysiak)
Date: Sun, 31 Jul 2016 11:38:21 +0100
Subject: [R-SIG-Finance] Estar Models
Message-ID: <CAEWMk7vvdiZpMZtxqZwLApd7_Tk1E-P9zJVVzZMQUOoLCg7z+g@mail.gmail.com>

Having looked through the documenation of the tsDyn package, I see that
LSTAR models can be estimated but there is no reference to ESTAR models.
I'd be grateful if someone could confirm where ESTAR models could be
estimated, thanks.



*Contact number +48 781 415 432**"In God we trust, all others bring data."*

	[[alternative HTML version deleted]]


From ezivot at uw.edu  Sun Jul 31 17:27:18 2016
From: ezivot at uw.edu (Eric Zivot)
Date: Sun, 31 Jul 2016 08:27:18 -0700
Subject: [R-SIG-Finance] Estar Models
In-Reply-To: <CAEWMk7vvdiZpMZtxqZwLApd7_Tk1E-P9zJVVzZMQUOoLCg7z+g@mail.gmail.com>
References: <CAEWMk7vvdiZpMZtxqZwLApd7_Tk1E-P9zJVVzZMQUOoLCg7z+g@mail.gmail.com>
Message-ID: <1494F62F-23D5-439B-A8AF-E4336E0CDF8B@uw.edu>

Look at the twinkle package from Alexios Ghalanos

Sent from my iPhone

> On Jul 31, 2016, at 3:38 AM, George Matysiak <gmatysiak at gmail.com> wrote:
> 
> Having looked through the documenation of the tsDyn package, I see that
> LSTAR models can be estimated but there is no reference to ESTAR models.
> I'd be grateful if someone could confirm where ESTAR models could be
> estimated, thanks.
> 
> 
> 
> *Contact number +48 781 415 432**"In God we trust, all others bring data."*
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From gmatysiak at gmail.com  Sun Jul 31 17:48:36 2016
From: gmatysiak at gmail.com (George Matysiak)
Date: Sun, 31 Jul 2016 16:48:36 +0100
Subject: [R-SIG-Finance] Estar Models
In-Reply-To: <1494F62F-23D5-439B-A8AF-E4336E0CDF8B@uw.edu>
References: <CAEWMk7vvdiZpMZtxqZwLApd7_Tk1E-P9zJVVzZMQUOoLCg7z+g@mail.gmail.com>
	<1494F62F-23D5-439B-A8AF-E4336E0CDF8B@uw.edu>
Message-ID: <CAEWMk7v_pHCOSgr2dXTif5yrb+fgsviB8pTHiyeMByAtC586Sw@mail.gmail.com>

Many thanks for your prompt reply. I have looked at the *Twinkle* package
and it also does not seem to estimate ESTAR models. It seems that I will
need to write a routine in R if there's not one available.

*"In God we trust, all others bring data."*

On 31 July 2016 at 16:27, Eric Zivot <ezivot at uw.edu> wrote:

> Look at the twinkle package from Alexios Ghalanos
>
> Sent from my iPhone
>
> > On Jul 31, 2016, at 3:38 AM, George Matysiak <gmatysiak at gmail.com>
> wrote:
> >
> > Having looked through the documenation of the tsDyn package, I see that
> > LSTAR models can be estimated but there is no reference to ESTAR models.
> > I'd be grateful if someone could confirm where ESTAR models could be
> > estimated, thanks.
> >
> >
> >
> > *Contact number +48 781 415 432**"In God we trust, all others bring
> data."*
> >
> >    [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> should go.
>
>

	[[alternative HTML version deleted]]


From golam.sakline at gmail.com  Mon Aug  1 12:07:46 2016
From: golam.sakline at gmail.com (golam sakline)
Date: Mon, 1 Aug 2016 14:07:46 +0400
Subject: [R-SIG-Finance] Help required in getting SMA triggered entry with
	quantstrat add.rule
Message-ID: <CAHmZ1ZtURtweAXs1mmcmRU-Maxx8FW236ZE60jSG6JGprQT=tw@mail.gmail.com>

Hi,

In Quantstrat, is it possible to use add.rule that can pick the crossover
between SMA and the price as entry rather than the bar close price? Is
there a way I can add buy-stop and sell-stop order types using limits that
look into the SMA figures.

Also why does it seem like that the trade registration date is one day
late? How can we fix this to register as per the day of the signal?-- See
the mktdata and getTxns output.

Many thanks

Golam

##################################################################################

if(exists('.strategy')) rm.strat(qs.strategy)
if(!exists('.blotter')) .blotter <- new.env()
if(!exists('.strategy')) .strategy <- new.env()

qs.strategy <- "AD26"
initPortf(qs.strategy,'XLE', initDate=initDate)
initAcct(qs.strategy,portfolios=qs.strategy, initDate=initDate, initEq=initEq)
initOrders(portfolio=qs.strategy,initDate=initDate)
strategy(qs.strategy,store=TRUE)
ls(.blotter)
ls(.strategy)
strat <-getStrategy(qs.strategy)
summary(strat)


add.indicator(strategy = qs.strategy, name = "SMA",
          arguments = list(x = quote(Cl(mktdata)), n=21), label="RT")

summary(getStrategy(qs.strategy))

#

add.signal(qs.strategy, name="sigCrossover",
       arguments=list(columns=c("Close", "SMA"), relationship="gte"),
label="Buy")

add.signal(qs.strategy, name="sigCrossover",
       arguments=list(columns=c("Close", "SMA"), relationship="lte"),
label="Sell")

#

summary(getStrategy(qs.strategy))

#

add.rule(qs.strategy, name='ruleSignal',
     arguments = list(sigcol="Buy", sigval=TRUE, orderqty=5000,
ordertype='market', orderside='long'),
     type='enter')

add.rule(qs.strategy, name='ruleSignal',
     arguments = list(sigcol="Sell", sigval=TRUE, orderqty="all",
ordertype='market', orderside='long'),
     type='exit')

add.rule(qs.strategy, name='ruleSignal',
     arguments = list(sigcol="Sell", sigval=TRUE, orderqty=-5000,
ordertype='market', orderside='short'),
     type='enter')

add.rule(qs.strategy, name='ruleSignal',
     arguments = list(sigcol="Buy", sigval=TRUE, orderqty="all",
ordertype='market', orderside='short'),
     type='exit')

summary(getStrategy(qs.strategy))

applyStrategy(strategy=qs.strategy , portfolios=qs.strategy)

getTxns(Portfolio=qs.strategy, Symbol="XLE")

head(mktdata["2016"], 30)

              XLE.Open XLE.High XLE.Low XLE.Close XLE.Volume
XLE.Adjusted   SMA.RT Buy Sell
2016-01-22    55.33    56.12   54.45     55.74   38622500
54.98281 57.36524  NA   NA
2016-01-25    54.68    56.08   53.10     53.14   29120000
52.41813 57.06048  NA   NA
2016-01-26    54.10    55.22   53.40     55.15   25354900
54.40083 56.72810  NA   NA
2016-01-27    54.77    56.42   54.20     54.89   36494500
54.14436 56.41000  NA   NA
2016-01-28    56.97    57.19   55.43     *56.56* 38171900
55.79167 *56.22476* 1   NA
2016-01-29    56.66    58.27   56.49     *58.21* 31498200
57.41926 56.09810  NA   NA
2016-02-01    57.24    57.67   56.39     57.24   27685100
56.46243 55.96429  NA   NA
2016-02-02    55.84    56.10   55.05     55.33   25231200
54.57838 55.72667  NA    1
2016-02-03    56.13    57.35   54.11     57.30   36440700
56.52162 55.58381   1   NA
2016-02-04    57.42    58.50   57.00     57.27   37056100
56.49203 55.42857  NA   NA
2016-02-05    56.50    56.74   55.47     55.94   30241000
55.18009 55.32095  NA   NA
2016-02-08    54.83    56.00   54.00     55.65   34806700
54.89403 55.26714  NA   NA
2016-02-09    54.82    55.49   53.44     54.31   37411300
53.57224 55.18429  NA    1
2016-02-10    54.15    55.32   53.51     54.09   30215800
53.35522 55.14810  NA   NA

getTxns(Portfolio=qs.strategy, Symbol="XLE")...

10 2015-12-03 2016-01-29    -5000   -5000        2           -325550
   34500.010      0.000 66700.005       0.1059745338
11 2016-02-03 2016-02-04    -5000   -5000        2           -286500
     149.995      0.000   149.995       0.0005235428
12 2016-02-10 2016-02-16    -5000   -5000        2           -270450
   -8700.010  -8700.010  1149.995      -0.0321686449

	[[alternative HTML version deleted]]


From brian at braverock.com  Mon Aug  1 12:22:16 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 1 Aug 2016 05:22:16 -0500
Subject: [R-SIG-Finance] Help required in getting SMA triggered entry
 with quantstrat add.rule
In-Reply-To: <CAHmZ1ZtURtweAXs1mmcmRU-Maxx8FW236ZE60jSG6JGprQT=tw@mail.gmail.com>
References: <CAHmZ1ZtURtweAXs1mmcmRU-Maxx8FW236ZE60jSG6JGprQT=tw@mail.gmail.com>
Message-ID: <579F22D8.9000302@braverock.com>

On 08/01/2016 05:07 AM, golam sakline wrote:
> In Quantstrat, is it possible to use add.rule that can pick the crossover
> between SMA and the price as entry rather than the bar close price? Is
> there a way I can add buy-stop and sell-stop order types using limits that
> look into the SMA figures.
>
> Also why does it seem like that the trade registration date is one day
> late? How can we fix this to register as per the day of the signal?-- See
> the mktdata and getTxns output.

Real markets are not instant. It is physically impossible to observe a 
signal and act on it at the same instant.  You must observe your signal, 
do some calculation, place an order, the market must receive your order, 
and the market must match your order.

If you want action at higher frequencies, use higher frequency data.

If you insist on proceeding with unrealistic expectations, pass

allowMagicalThinking=TRUE

-- 
Brian


From brian at braverock.com  Mon Aug  1 21:08:39 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 01 Aug 2016 14:08:39 -0500
Subject: [R-SIG-Finance] Help required in getting SMA triggered entry
 with quantstrat add.rule
In-Reply-To: <CAHmZ1Zsyg5joTyvKwxdjkRNkgpQN1Vg7FORv=j306qjyyQ4Egg@mail.gmail.com>
References: <CAHmZ1ZtURtweAXs1mmcmRU-Maxx8FW236ZE60jSG6JGprQT=tw@mail.gmail.com>
	<579F22D8.9000302@braverock.com>
	<CAHmZ1Zsyg5joTyvKwxdjkRNkgpQN1Vg7FORv=j306qjyyQ4Egg@mail.gmail.com>
Message-ID: <1470078519.24047.200.camel@brian-rcg>

<on-list>

Instant execution can't happen.

If you insist, pass 

allowMagicalThinking=TRUE 

in the call to applyStrategy.

If you want to execute at your signal price, the 'right answer' is to
use higher frequency data, and enter an order after you get the signal.
If you insist on believing that you can execute at the signal price, add
a column for the signal price, e.g. "magic_signal_price" when you add
your indicators, and pass

prefer="magical_signal_price" in the arguments list for your entry rule.

This is *not* a realistic "proof of concept", where your goal should be
to focus on *disproving* your assumptions, not insisting on unrealistic
execution assumptions.  

Yes, you can do it, and quantstrat will let you.  That doesn't make it a
good idea.  

We've tried to make it hard to make most of the common mistakes, and try
to make more realistic assumptions the default (and have documented them
in the manual).

Brian 

On Mon, 2016-08-01 at 19:31 +0400, golam sakline wrote:
> Hi Brian,
> 
> 
> Really appreciate you responding to my query. While I understand what
> you are saying, I I am just using the SMA indicator to assess whether
> it is possible to execute On Signal date trade to build our proof of
> concept in R Quantstrat. Our signal generator is using a
> predictive pricing mechanism and when the real market price becomes
> equal to/crosses the predicted price, a trade is executed at market
> within some parameters of slippage.  From your reply should I presume
> that a day late execution from signal date is deliberate and you have
> a mechanism of making it on signal date execution?
> 
> 
> thanks
> 
> 
> Golam
> 
> On Mon, Aug 1, 2016 at 2:22 PM, Brian G. Peterson
> <brian at braverock.com> wrote:
>         On 08/01/2016 05:07 AM, golam sakline wrote:
>                 In Quantstrat, is it possible to use add.rule that can
>                 pick the crossover
>                 between SMA and the price as entry rather than the bar
>                 close price? Is
>                 there a way I can add buy-stop and sell-stop order
>                 types using limits that
>                 look into the SMA figures.
>                 
>                 Also why does it seem like that the trade registration
>                 date is one day
>                 late? How can we fix this to register as per the day
>                 of the signal?-- See
>                 the mktdata and getTxns output.
>         
>         Real markets are not instant. It is physically impossible to
>         observe a signal and act on it at the same instant.  You must
>         observe your signal, do some calculation, place an order, the
>         market must receive your order, and the market must match your
>         order.
>         
>         If you want action at higher frequencies, use higher frequency
>         data.
>         
>         If you insist on proceeding with unrealistic expectations,
>         pass
>         
>         allowMagicalThinking=TRUE
>


From erol.biceroglu at alumni.utoronto.ca  Tue Aug  2 02:18:26 2016
From: erol.biceroglu at alumni.utoronto.ca (Erol Biceroglu)
Date: Mon, 1 Aug 2016 20:18:26 -0400
Subject: [R-SIG-Finance] apply.paramset.signal.analysis error
Message-ID: <CACjNfmmDQgR1UBts_c1e-wBd_ZdYAx2X6XsPYVQfZh+iE3kyZg@mail.gmail.com>

Hello,

I've updated to the latest quanstrat, and still get an error using
apply.paramset.signal.analysis:

Error in post.signal.returns(signals = .sig.list[[name.ref]][,
paste(symbols[j],  :
  number of items to replace is not a multiple of replacement length


applyStrategy works, apply.paramset works, however I can't get the signal
portion working and was wondering if anyone knew what the error was.

When I run debug, the problem occurs in *post.signal.returns*, on the final
signal.ret[j,] = tryCatch, where the tryCatch returns an xts object with 5
rows, and it wants to update signal.ret[j,] which is length 6.

Any feedback would be greatly appreciated.  Thanks for your help.

Here's my sessionInfo():

####

> sessionInfo()R version 3.3.1 (2016-06-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.4 LTS

locale:
 [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
LC_TIME=en_CA.UTF-8
 [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
LC_MESSAGES=en_CA.UTF-8
 [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
LC_IDENTIFICATION=C

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets
methods   base

other attached packages:
 [1] doParallel_1.0.10             iterators_1.0.8
quantstrat_0.9.1739
 [4] foreach_1.4.3                 blotter_0.9.1695
FinancialInstrument_1.2.0
 [7] quantmod_0.4-5                TTR_0.23-1
PerformanceAnalytics_1.4.3541
[10] xts_0.9.874                   zoo_1.7-13

loaded via a namespace (and not attached):
[1] compiler_3.3.1   tools_3.3.1      codetools_0.2-14 grid_3.3.1
 lattice_0.20-33

####

Here's the MRE:
#################################

library(xts)
library(PerformanceAnalytics)
library(quantmod)
library(TTR)
library(quantstrat)

getSymbols(Symbols = "SPY", from = "2000-01-01")


startDate<-as.Date(index(SPY)[1], format="%Y-%m-%d")
endDate<-as.Date(index(last(SPY)), format="%Y-%m-%d")

currency("USD")

stock(primary_id = c("SPY"),currency = "USD")

#name
maStrategy <-"MAStrategy"

#Date, one day before prices
strategyDate <- min(index(SPY)) - 1

NumSh<-1

#rm.strat(maStrategy)
#rm(mktdata)


maLag <- 5


#init portfolio and account
initPortf(name = maStrategy
          , symbols = list("SPY") #as defined in Financial instrument
          , initDate = strategyDate
)

initAcct(name = maStrategy
         ,portfolios = maStrategy
         ,initDate = strategyDate
         ,initEq = 1
)

#order book, and strategy
initOrders(portfolio = maStrategy
           , initDate = strategyDate
)

#position limits
addPosLimit(maStrategy, symbol = "SPY", strategyDate, maxpos = NumSh,
longlevels = NumSh, minpos = 0)

strategy( maStrategy, store = TRUE)

#add indicator
add.indicator(strategy = maStrategy
              , name = "EMA"
              , arguments = list(x = quote(mktdata$SPY.Close), n =
quote(maLag))
              , label = "SPYma"
)




add.signal(strategy = maStrategy
           , name = "sigComparison"
           , arguments = list(columns = c("SPY.Close","SPYma")
                              , relationship = "gt"
           )
           , label = "SPY.gt.ma"
)



add.signal(strategy = maStrategy
           , name = "sigComparison"
           , arguments = list(columns = c("SPY.Close","SPYma")
                              , relationship = "lte"
           )
           , label = "SPY.lte.ma"
)




#Entry and exit rules


add.rule(strategy = maStrategy
         , name = "ruleSignal"
         , arguments = list(sigcol = "SPY.gt.ma"
                            , sigval = TRUE
                            , orderqty = NumSh
                            , ordertype = "market"
                            , orderside = NULL
                            , osFUN = "osMaxPos"
                            , symbol = "SPY"
         )
         , type = "enter"
)


add.rule(strategy = maStrategy
         , name = "ruleSignal"
         , arguments = list(sigcol = "SPY.lte.ma"
                            , sigval = TRUE
                            , orderqty = "all"
                            , ordertype = "market"
                            , orderside = NULL
                            , osFUN = "osMaxPos"
                            , symbol = "SPY"
         )
         , type = "exit"
)


applyStrategy(strategy = maStrategy
              , portfolios = maStrategy
)

updatePortf(maStrategy)
updateAcct(maStrategy)
updateEndEq(maStrategy)


maLag <- seq(5,10,1)
####################
#delete.paramset(maStrategy,"maLagDist")
add.distribution(strategy = maStrategy
                 , paramset.label = "maLagDist"
                 , component.type = "indicator"
                 , component.label = "SPYma"
                 , variable = list(n = maLag)
                 , label = "lagDist"

)



library(foreach)
library(doParallel)
cl <- makeForkCluster(nnodes = detectCores())
registerDoParallel(cl)
maStrategyAP <-
  apply.paramset(strategy.st = maStrategy
                 , paramset.label = "maLagDist"
                 , portfolio.st = maStrategy
                 , account.st = maStrategy
  )
stopCluster(cl = cl)
cl <- NULL
closeAllConnections()
gc()


#this works
maStrategyAP$tradeStats$Profit.To.Max.Draw


head(mktdata)

#undebug(apply.paramset.signal.analysis)
maStrategyAPSA <-
  apply.paramset.signal.analysis(strategy.st = maStrategy
                                 , paramset.label = "maLagDist"
                                 , portfolio.st = maStrategy
                                 , sigcol = "SPY.gt.ma"
                                 , sigval = 1
                                 , on = NULL
                                 , forward.days = 5
                                 , include.day.of.signal = TRUE
  )


##################################



Erol Biceroglu

	[[alternative HTML version deleted]]


From msinghal_22 at yahoo.com  Tue Aug  2 05:38:10 2016
From: msinghal_22 at yahoo.com (Mayank Singhal)
Date: Tue, 2 Aug 2016 03:38:10 +0000 (UTC)
Subject: [R-SIG-Finance] Quantstrat - Triggering chain rule with lag period
References: <92980001.9548004.1470109090512.JavaMail.yahoo.ref@mail.yahoo.com>
Message-ID: <92980001.9548004.1470109090512.JavaMail.yahoo@mail.yahoo.com>

Hello all,
Here is what i am trying to achieve : For every entry order (which gets filled, note that some might get rejected because of MaxPos criteria), i want to exit based on the exit rule (which is based on signal generation) or on a second exit rule (which is fixed no. of periods, "n", ?from entry) depending upon whichever of these two exit criteria is met first.

The result i am getting is : exit rule 2 (fixed no. of periods) triggers off the following day from the entry rule and not after desired "n" periods. Please if someone can advise - if i am doing something wrong with the syntax here ? Below is the code snapshot of rules
**********************************************************************************eb3 = TRUE
#entry rulestrat.st?<- add.rule(strat.st,name='ruleSignal',arguments?=?list(?sigcol=c("signal4.gt.zero"),sigval=TRUE,orderqty=1,ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos),type='enter',label='enter_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)
#exit rule 1strat.st?<- add.rule(strat.st,name='ruleSignal',arguments?=?list(?sigcol=c("signal4.lt.zero"),?sigval=TRUE,orderqty='all',ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos,orderset='ocolong'),type='exit', label='exit_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)
#exit rule 2?strat.st?<- add.rule(strat.st,name='ruleSignal',arguments = list(sigcol=c("longExit"), sigval=TRUE,orderqty=-1,ordertype='market',orderside='long',prefer="Open",replace=FALSE, orderset='ocolong'), type='chain', parent='enter_long_alpha5c',label='Sqroff_LONG',enabled=eb3,?path.dep = TRUE)
***********************************************************?Note that - in exit rule 2 , the sigcol "longexit" is just a "n" period lag on "signal4.gt.zero" column
Any guidance in this regard will be very helpful.
Regards,Mayank
	[[alternative HTML version deleted]]


From ilya.kipnis at gmail.com  Tue Aug  2 05:42:47 2016
From: ilya.kipnis at gmail.com (Ilya Kipnis)
Date: Mon, 1 Aug 2016 23:42:47 -0400
Subject: [R-SIG-Finance] Quantstrat - Triggering chain rule with lag
	period
In-Reply-To: <92980001.9548004.1470109090512.JavaMail.yahoo@mail.yahoo.com>
References: <92980001.9548004.1470109090512.JavaMail.yahoo.ref@mail.yahoo.com>
	<92980001.9548004.1470109090512.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CA+oJuEHckmRiame5dB3-MJpA6n5vh8tCmOi_S-8tFiqtrA4TwA@mail.gmail.com>

You might want to send a minimum reproducible example.

On Mon, Aug 1, 2016 at 11:38 PM, Mayank Singhal via R-SIG-Finance <
r-sig-finance at r-project.org> wrote:

> Hello all,
> Here is what i am trying to achieve : For every entry order (which gets
> filled, note that some might get rejected because of MaxPos criteria), i
> want to exit based on the exit rule (which is based on signal generation)
> or on a second exit rule (which is fixed no. of periods, "n",  from entry)
> depending upon whichever of these two exit criteria is met first.
>
> The result i am getting is : exit rule 2 (fixed no. of periods) triggers
> off the following day from the entry rule and not after desired "n"
> periods. Please if someone can advise - if i am doing something wrong with
> the syntax here ? Below is the code snapshot of rules
> **********************************************************************************eb3
> = TRUE
> #entry rulestrat.st <- add.rule(strat.st,name='ruleSignal',arguments = list( sigcol=c("signal4.gt.zero"),sigval=TRUE,orderqty=1,ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos),type='enter',label='enter_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep
> = TRUE)
> #exit rule 1strat.st <- add.rule(strat.st,name='ruleSignal',arguments = list( sigcol=c("signal4.lt.zero"), sigval=TRUE,orderqty='all',ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos,orderset='ocolong'),type='exit',
> label='exit_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)
> #exit rule 2 strat.st <- add.rule(strat.st,name='ruleSignal',arguments =
> list(sigcol=c("longExit"),
> sigval=TRUE,orderqty=-1,ordertype='market',orderside='long',prefer="Open",replace=FALSE,
> orderset='ocolong'), type='chain',
> parent='enter_long_alpha5c',label='Sqroff_LONG',enabled=eb3, path.dep =
> TRUE)
> *********************************************************** Note that - in
> exit rule 2 , the sigcol "longexit" is just a "n" period lag on
> "signal4.gt.zero" column
> Any guidance in this regard will be very helpful.
> Regards,Mayank
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.

	[[alternative HTML version deleted]]


From msinghal_22 at yahoo.com  Tue Aug  2 07:14:35 2016
From: msinghal_22 at yahoo.com (Mayank Singhal)
Date: Tue, 2 Aug 2016 05:14:35 +0000 (UTC)
Subject: [R-SIG-Finance] Quantstrat - Triggering chain rule with lag
 period
In-Reply-To: <CA+oJuEHckmRiame5dB3-MJpA6n5vh8tCmOi_S-8tFiqtrA4TwA@mail.gmail.com>
References: <92980001.9548004.1470109090512.JavaMail.yahoo.ref@mail.yahoo.com>
	<92980001.9548004.1470109090512.JavaMail.yahoo@mail.yahoo.com>
	<CA+oJuEHckmRiame5dB3-MJpA6n5vh8tCmOi_S-8tFiqtrA4TwA@mail.gmail.com>
Message-ID: <223244311.9504182.1470114875549.JavaMail.yahoo@mail.yahoo.com>

Sure, please find attached the sample case. 

    On Tuesday, August 2, 2016 9:13 AM, Ilya Kipnis <ilya.kipnis at gmail.com> wrote:
 

 You might want to send a minimum reproducible example.
On Mon, Aug 1, 2016 at 11:38 PM, Mayank Singhal via R-SIG-Finance <r-sig-finance at r-project.org> wrote:

Hello all,
Here is what i am trying to achieve : For every entry order (which gets filled, note that some might get rejected because of MaxPos criteria), i want to exit based on the exit rule (which is based on signal generation) or on a second exit rule (which is fixed no. of periods, "n", ?from entry) depending upon whichever of these two exit criteria is met first.

The result i am getting is : exit rule 2 (fixed no. of periods) triggers off the following day from the entry rule and not after desired "n" periods. Please if someone can advise - if i am doing something wrong with the syntax here ? Below is the code snapshot of rules
**********************************************************************************eb3 = TRUE
#entry rulestrat.st?<- add.rule(strat.st,name='ruleSignal',arguments?=?list(?sigcol=c("signal4.gt.zero"),sigval=TRUE,orderqty=1,ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos),type='enter',label='enter_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)
#exit rule 1strat.st?<- add.rule(strat.st,name='ruleSignal',arguments?=?list(?sigcol=c("signal4.lt.zero"),?sigval=TRUE,orderqty='all',ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos,orderset='ocolong'),type='exit', label='exit_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)
#exit rule 2?strat.st?<- add.rule(strat.st,name='ruleSignal',arguments = list(sigcol=c("longExit"), sigval=TRUE,orderqty=-1,ordertype='market',orderside='long',prefer="Open",replace=FALSE, orderset='ocolong'), type='chain', parent='enter_long_alpha5c',label='Sqroff_LONG',enabled=eb3,?path.dep = TRUE)
***********************************************************?Note that - in exit rule 2 , the sigcol "longexit" is just a "n" period lag on "signal4.gt.zero" column
Any guidance in this regard will be very helpful.
Regards,Mayank
? ? ? ? [[alternative HTML version deleted]]

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.



  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160802/9b6314e3/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: demo_msinghal.R
Type: application/octet-stream
Size: 3615 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160802/9b6314e3/attachment.obj>

From josh.m.ulrich at gmail.com  Wed Aug  3 00:27:45 2016
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 2 Aug 2016 17:27:45 -0500
Subject: [R-SIG-Finance] apply.paramset.signal.analysis error
In-Reply-To: <CACjNfmmDQgR1UBts_c1e-wBd_ZdYAx2X6XsPYVQfZh+iE3kyZg@mail.gmail.com>
References: <CACjNfmmDQgR1UBts_c1e-wBd_ZdYAx2X6XsPYVQfZh+iE3kyZg@mail.gmail.com>
Message-ID: <CAPPM_gTHoG6qhBwrE8_E74c9thGFMEYEyK1HM=PgS1oaBQeyPw@mail.gmail.com>

Hi Erol,

On Mon, Aug 1, 2016 at 7:18 PM, Erol Biceroglu
<erol.biceroglu at alumni.utoronto.ca> wrote:
> Hello,
>
> I've updated to the latest quanstrat, and still get an error using
> apply.paramset.signal.analysis:
>
> Error in post.signal.returns(signals = .sig.list[[name.ref]][,
> paste(symbols[j],  :
>   number of items to replace is not a multiple of replacement length
>
>
> applyStrategy works, apply.paramset works, however I can't get the signal
> portion working and was wondering if anyone knew what the error was.
>
> When I run debug, the problem occurs in *post.signal.returns*, on the final
> signal.ret[j,] = tryCatch, where the tryCatch returns an xts object with 5
> rows, and it wants to update signal.ret[j,] which is length 6.
>
Thanks for the reproducible example.  This looks like a bug when
include.day.of.signal = TRUE.  I'll investigate.

> Any feedback would be greatly appreciated.  Thanks for your help.
>
> Here's my sessionInfo():
>
> ####
>
>> sessionInfo()R version 3.3.1 (2016-06-21)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Ubuntu 14.04.4 LTS
>
> locale:
>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
> LC_TIME=en_CA.UTF-8
>  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
> LC_MESSAGES=en_CA.UTF-8
>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
> LC_ADDRESS=C
> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
> LC_IDENTIFICATION=C
>
> attached base packages:
> [1] parallel  stats     graphics  grDevices utils     datasets
> methods   base
>
> other attached packages:
>  [1] doParallel_1.0.10             iterators_1.0.8
> quantstrat_0.9.1739
>  [4] foreach_1.4.3                 blotter_0.9.1695
> FinancialInstrument_1.2.0
>  [7] quantmod_0.4-5                TTR_0.23-1
> PerformanceAnalytics_1.4.3541
> [10] xts_0.9.874                   zoo_1.7-13
>
> loaded via a namespace (and not attached):
> [1] compiler_3.3.1   tools_3.3.1      codetools_0.2-14 grid_3.3.1
>  lattice_0.20-33
>
> ####
>
> Here's the MRE:
> #################################
>
> library(xts)
> library(PerformanceAnalytics)
> library(quantmod)
> library(TTR)
> library(quantstrat)
>
> getSymbols(Symbols = "SPY", from = "2000-01-01")
>
>
> startDate<-as.Date(index(SPY)[1], format="%Y-%m-%d")
> endDate<-as.Date(index(last(SPY)), format="%Y-%m-%d")
>
> currency("USD")
>
> stock(primary_id = c("SPY"),currency = "USD")
>
> #name
> maStrategy <-"MAStrategy"
>
> #Date, one day before prices
> strategyDate <- min(index(SPY)) - 1
>
> NumSh<-1
>
> #rm.strat(maStrategy)
> #rm(mktdata)
>
>
> maLag <- 5
>
>
> #init portfolio and account
> initPortf(name = maStrategy
>           , symbols = list("SPY") #as defined in Financial instrument
>           , initDate = strategyDate
> )
>
> initAcct(name = maStrategy
>          ,portfolios = maStrategy
>          ,initDate = strategyDate
>          ,initEq = 1
> )
>
> #order book, and strategy
> initOrders(portfolio = maStrategy
>            , initDate = strategyDate
> )
>
> #position limits
> addPosLimit(maStrategy, symbol = "SPY", strategyDate, maxpos = NumSh,
> longlevels = NumSh, minpos = 0)
>
> strategy( maStrategy, store = TRUE)
>
> #add indicator
> add.indicator(strategy = maStrategy
>               , name = "EMA"
>               , arguments = list(x = quote(mktdata$SPY.Close), n =
> quote(maLag))
>               , label = "SPYma"
> )
>
>
>
>
> add.signal(strategy = maStrategy
>            , name = "sigComparison"
>            , arguments = list(columns = c("SPY.Close","SPYma")
>                               , relationship = "gt"
>            )
>            , label = "SPY.gt.ma"
> )
>
>
>
> add.signal(strategy = maStrategy
>            , name = "sigComparison"
>            , arguments = list(columns = c("SPY.Close","SPYma")
>                               , relationship = "lte"
>            )
>            , label = "SPY.lte.ma"
> )
>
>
>
>
> #Entry and exit rules
>
>
> add.rule(strategy = maStrategy
>          , name = "ruleSignal"
>          , arguments = list(sigcol = "SPY.gt.ma"
>                             , sigval = TRUE
>                             , orderqty = NumSh
>                             , ordertype = "market"
>                             , orderside = NULL
>                             , osFUN = "osMaxPos"
>                             , symbol = "SPY"
>          )
>          , type = "enter"
> )
>
>
> add.rule(strategy = maStrategy
>          , name = "ruleSignal"
>          , arguments = list(sigcol = "SPY.lte.ma"
>                             , sigval = TRUE
>                             , orderqty = "all"
>                             , ordertype = "market"
>                             , orderside = NULL
>                             , osFUN = "osMaxPos"
>                             , symbol = "SPY"
>          )
>          , type = "exit"
> )
>
>
> applyStrategy(strategy = maStrategy
>               , portfolios = maStrategy
> )
>
> updatePortf(maStrategy)
> updateAcct(maStrategy)
> updateEndEq(maStrategy)
>
>
> maLag <- seq(5,10,1)
> ####################
> #delete.paramset(maStrategy,"maLagDist")
> add.distribution(strategy = maStrategy
>                  , paramset.label = "maLagDist"
>                  , component.type = "indicator"
>                  , component.label = "SPYma"
>                  , variable = list(n = maLag)
>                  , label = "lagDist"
>
> )
>
>
>
> library(foreach)
> library(doParallel)
> cl <- makeForkCluster(nnodes = detectCores())
> registerDoParallel(cl)
> maStrategyAP <-
>   apply.paramset(strategy.st = maStrategy
>                  , paramset.label = "maLagDist"
>                  , portfolio.st = maStrategy
>                  , account.st = maStrategy
>   )
> stopCluster(cl = cl)
> cl <- NULL
> closeAllConnections()
> gc()
>
>
> #this works
> maStrategyAP$tradeStats$Profit.To.Max.Draw
>
>
> head(mktdata)
>
> #undebug(apply.paramset.signal.analysis)
> maStrategyAPSA <-
>   apply.paramset.signal.analysis(strategy.st = maStrategy
>                                  , paramset.label = "maLagDist"
>                                  , portfolio.st = maStrategy
>                                  , sigcol = "SPY.gt.ma"
>                                  , sigval = 1
>                                  , on = NULL
>                                  , forward.days = 5
>                                  , include.day.of.signal = TRUE
>   )
>
>
> ##################################
>
>
>
> Erol Biceroglu
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2016 | www.rinfinance.com


From josh.m.ulrich at gmail.com  Wed Aug  3 02:07:41 2016
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 2 Aug 2016 19:07:41 -0500
Subject: [R-SIG-Finance] apply.paramset.signal.analysis error
In-Reply-To: <CAPPM_gTHoG6qhBwrE8_E74c9thGFMEYEyK1HM=PgS1oaBQeyPw@mail.gmail.com>
References: <CACjNfmmDQgR1UBts_c1e-wBd_ZdYAx2X6XsPYVQfZh+iE3kyZg@mail.gmail.com>
	<CAPPM_gTHoG6qhBwrE8_E74c9thGFMEYEyK1HM=PgS1oaBQeyPw@mail.gmail.com>
Message-ID: <CAPPM_gR1sJiipUj7+2BAbkEeeyOWKzHVWKFsNAcKtUM3=T0gGg@mail.gmail.com>

On Tue, Aug 2, 2016 at 5:27 PM, Joshua Ulrich <josh.m.ulrich at gmail.com> wrote:
> Hi Erol,
>
> On Mon, Aug 1, 2016 at 7:18 PM, Erol Biceroglu
> <erol.biceroglu at alumni.utoronto.ca> wrote:
>> Hello,
>>
>> I've updated to the latest quanstrat, and still get an error using
>> apply.paramset.signal.analysis:
>>
>> Error in post.signal.returns(signals = .sig.list[[name.ref]][,
>> paste(symbols[j],  :
>>   number of items to replace is not a multiple of replacement length
>>
>>
>> applyStrategy works, apply.paramset works, however I can't get the signal
>> portion working and was wondering if anyone knew what the error was.
>>
>> When I run debug, the problem occurs in *post.signal.returns*, on the final
>> signal.ret[j,] = tryCatch, where the tryCatch returns an xts object with 5
>> rows, and it wants to update signal.ret[j,] which is length 6.
>>
> Thanks for the reproducible example.  This looks like a bug when
> include.day.of.signal = TRUE.  I'll investigate.
>
Thanks for the report. This should now be fixed in quantstrat on GitHub.

Please note that your call to apply.paramset.signal.analysis does not
have a value for the obj.fun argument, which is required.  You can add
obj.fun = signal.obj.slope as an example.

>> Any feedback would be greatly appreciated.  Thanks for your help.
>>
>> Here's my sessionInfo():
>>
>> ####
>>
>>> sessionInfo()R version 3.3.1 (2016-06-21)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>> Running under: Ubuntu 14.04.4 LTS
>>
>> locale:
>>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
>> LC_TIME=en_CA.UTF-8
>>  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
>> LC_MESSAGES=en_CA.UTF-8
>>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
>> LC_ADDRESS=C
>> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
>> LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] parallel  stats     graphics  grDevices utils     datasets
>> methods   base
>>
>> other attached packages:
>>  [1] doParallel_1.0.10             iterators_1.0.8
>> quantstrat_0.9.1739
>>  [4] foreach_1.4.3                 blotter_0.9.1695
>> FinancialInstrument_1.2.0
>>  [7] quantmod_0.4-5                TTR_0.23-1
>> PerformanceAnalytics_1.4.3541
>> [10] xts_0.9.874                   zoo_1.7-13
>>
>> loaded via a namespace (and not attached):
>> [1] compiler_3.3.1   tools_3.3.1      codetools_0.2-14 grid_3.3.1
>>  lattice_0.20-33
>>
>> ####
>>
>> Here's the MRE:
>> #################################
>>
>> library(xts)
>> library(PerformanceAnalytics)
>> library(quantmod)
>> library(TTR)
>> library(quantstrat)
>>
>> getSymbols(Symbols = "SPY", from = "2000-01-01")
>>
>>
>> startDate<-as.Date(index(SPY)[1], format="%Y-%m-%d")
>> endDate<-as.Date(index(last(SPY)), format="%Y-%m-%d")
>>
>> currency("USD")
>>
>> stock(primary_id = c("SPY"),currency = "USD")
>>
>> #name
>> maStrategy <-"MAStrategy"
>>
>> #Date, one day before prices
>> strategyDate <- min(index(SPY)) - 1
>>
>> NumSh<-1
>>
>> #rm.strat(maStrategy)
>> #rm(mktdata)
>>
>>
>> maLag <- 5
>>
>>
>> #init portfolio and account
>> initPortf(name = maStrategy
>>           , symbols = list("SPY") #as defined in Financial instrument
>>           , initDate = strategyDate
>> )
>>
>> initAcct(name = maStrategy
>>          ,portfolios = maStrategy
>>          ,initDate = strategyDate
>>          ,initEq = 1
>> )
>>
>> #order book, and strategy
>> initOrders(portfolio = maStrategy
>>            , initDate = strategyDate
>> )
>>
>> #position limits
>> addPosLimit(maStrategy, symbol = "SPY", strategyDate, maxpos = NumSh,
>> longlevels = NumSh, minpos = 0)
>>
>> strategy( maStrategy, store = TRUE)
>>
>> #add indicator
>> add.indicator(strategy = maStrategy
>>               , name = "EMA"
>>               , arguments = list(x = quote(mktdata$SPY.Close), n =
>> quote(maLag))
>>               , label = "SPYma"
>> )
>>
>>
>>
>>
>> add.signal(strategy = maStrategy
>>            , name = "sigComparison"
>>            , arguments = list(columns = c("SPY.Close","SPYma")
>>                               , relationship = "gt"
>>            )
>>            , label = "SPY.gt.ma"
>> )
>>
>>
>>
>> add.signal(strategy = maStrategy
>>            , name = "sigComparison"
>>            , arguments = list(columns = c("SPY.Close","SPYma")
>>                               , relationship = "lte"
>>            )
>>            , label = "SPY.lte.ma"
>> )
>>
>>
>>
>>
>> #Entry and exit rules
>>
>>
>> add.rule(strategy = maStrategy
>>          , name = "ruleSignal"
>>          , arguments = list(sigcol = "SPY.gt.ma"
>>                             , sigval = TRUE
>>                             , orderqty = NumSh
>>                             , ordertype = "market"
>>                             , orderside = NULL
>>                             , osFUN = "osMaxPos"
>>                             , symbol = "SPY"
>>          )
>>          , type = "enter"
>> )
>>
>>
>> add.rule(strategy = maStrategy
>>          , name = "ruleSignal"
>>          , arguments = list(sigcol = "SPY.lte.ma"
>>                             , sigval = TRUE
>>                             , orderqty = "all"
>>                             , ordertype = "market"
>>                             , orderside = NULL
>>                             , osFUN = "osMaxPos"
>>                             , symbol = "SPY"
>>          )
>>          , type = "exit"
>> )
>>
>>
>> applyStrategy(strategy = maStrategy
>>               , portfolios = maStrategy
>> )
>>
>> updatePortf(maStrategy)
>> updateAcct(maStrategy)
>> updateEndEq(maStrategy)
>>
>>
>> maLag <- seq(5,10,1)
>> ####################
>> #delete.paramset(maStrategy,"maLagDist")
>> add.distribution(strategy = maStrategy
>>                  , paramset.label = "maLagDist"
>>                  , component.type = "indicator"
>>                  , component.label = "SPYma"
>>                  , variable = list(n = maLag)
>>                  , label = "lagDist"
>>
>> )
>>
>>
>>
>> library(foreach)
>> library(doParallel)
>> cl <- makeForkCluster(nnodes = detectCores())
>> registerDoParallel(cl)
>> maStrategyAP <-
>>   apply.paramset(strategy.st = maStrategy
>>                  , paramset.label = "maLagDist"
>>                  , portfolio.st = maStrategy
>>                  , account.st = maStrategy
>>   )
>> stopCluster(cl = cl)
>> cl <- NULL
>> closeAllConnections()
>> gc()
>>
>>
>> #this works
>> maStrategyAP$tradeStats$Profit.To.Max.Draw
>>
>>
>> head(mktdata)
>>
>> #undebug(apply.paramset.signal.analysis)
>> maStrategyAPSA <-
>>   apply.paramset.signal.analysis(strategy.st = maStrategy
>>                                  , paramset.label = "maLagDist"
>>                                  , portfolio.st = maStrategy
>>                                  , sigcol = "SPY.gt.ma"
>>                                  , sigval = 1
>>                                  , on = NULL
>>                                  , forward.days = 5
>>                                  , include.day.of.signal = TRUE
>>   )
>>
>>
>> ##################################
>>
>>
>>
>> Erol Biceroglu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-SIG-Finance at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> -- Subscriber-posting only. If you want to post, subscribe first.
>> -- Also note that this is not the r-help list where general R questions should go.
>
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
> R/Finance 2016 | www.rinfinance.com



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2016 | www.rinfinance.com


From erol.biceroglu at alumni.utoronto.ca  Wed Aug  3 02:30:33 2016
From: erol.biceroglu at alumni.utoronto.ca (Erol Biceroglu)
Date: Tue, 2 Aug 2016 20:30:33 -0400
Subject: [R-SIG-Finance] apply.paramset.signal.analysis error
In-Reply-To: <CAPPM_gR1sJiipUj7+2BAbkEeeyOWKzHVWKFsNAcKtUM3=T0gGg@mail.gmail.com>
References: <CACjNfmmDQgR1UBts_c1e-wBd_ZdYAx2X6XsPYVQfZh+iE3kyZg@mail.gmail.com>
	<CAPPM_gTHoG6qhBwrE8_E74c9thGFMEYEyK1HM=PgS1oaBQeyPw@mail.gmail.com>
	<CAPPM_gR1sJiipUj7+2BAbkEeeyOWKzHVWKFsNAcKtUM3=T0gGg@mail.gmail.com>
Message-ID: <CACjNfmmb_7oA8iOSV6V4f8aV1C2ZcZ=kiOp6w90xinCZ9AWH3A@mail.gmail.com>

Thank you Joshua for the quick response, and for pointing out the missing
objective function, it works great now.


Erol Biceroglu


*erol.biceroglu at alumni.utoronto.ca
<erol.biceroglu at alumni.utoronto.ca>416-275-7970*

On Tue, Aug 2, 2016 at 8:07 PM, Joshua Ulrich <josh.m.ulrich at gmail.com>
wrote:

> On Tue, Aug 2, 2016 at 5:27 PM, Joshua Ulrich <josh.m.ulrich at gmail.com>
> wrote:
> > Hi Erol,
> >
> > On Mon, Aug 1, 2016 at 7:18 PM, Erol Biceroglu
> > <erol.biceroglu at alumni.utoronto.ca> wrote:
> >> Hello,
> >>
> >> I've updated to the latest quanstrat, and still get an error using
> >> apply.paramset.signal.analysis:
> >>
> >> Error in post.signal.returns(signals = .sig.list[[name.ref]][,
> >> paste(symbols[j],  :
> >>   number of items to replace is not a multiple of replacement length
> >>
> >>
> >> applyStrategy works, apply.paramset works, however I can't get the
> signal
> >> portion working and was wondering if anyone knew what the error was.
> >>
> >> When I run debug, the problem occurs in *post.signal.returns*, on the
> final
> >> signal.ret[j,] = tryCatch, where the tryCatch returns an xts object
> with 5
> >> rows, and it wants to update signal.ret[j,] which is length 6.
> >>
> > Thanks for the reproducible example.  This looks like a bug when
> > include.day.of.signal = TRUE.  I'll investigate.
> >
> Thanks for the report. This should now be fixed in quantstrat on GitHub.
>
> Please note that your call to apply.paramset.signal.analysis does not
> have a value for the obj.fun argument, which is required.  You can add
> obj.fun = signal.obj.slope as an example.
>
> >> Any feedback would be greatly appreciated.  Thanks for your help.
> >>
> >> Here's my sessionInfo():
> >>
> >> ####
> >>
> >>> sessionInfo()R version 3.3.1 (2016-06-21)
> >> Platform: x86_64-pc-linux-gnu (64-bit)
> >> Running under: Ubuntu 14.04.4 LTS
> >>
> >> locale:
> >>  [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
> >> LC_TIME=en_CA.UTF-8
> >>  [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
> >> LC_MESSAGES=en_CA.UTF-8
> >>  [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
> >> LC_ADDRESS=C
> >> [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
> >> LC_IDENTIFICATION=C
> >>
> >> attached base packages:
> >> [1] parallel  stats     graphics  grDevices utils     datasets
> >> methods   base
> >>
> >> other attached packages:
> >>  [1] doParallel_1.0.10             iterators_1.0.8
> >> quantstrat_0.9.1739
> >>  [4] foreach_1.4.3                 blotter_0.9.1695
> >> FinancialInstrument_1.2.0
> >>  [7] quantmod_0.4-5                TTR_0.23-1
> >> PerformanceAnalytics_1.4.3541
> >> [10] xts_0.9.874                   zoo_1.7-13
> >>
> >> loaded via a namespace (and not attached):
> >> [1] compiler_3.3.1   tools_3.3.1      codetools_0.2-14 grid_3.3.1
> >>  lattice_0.20-33
> >>
> >> ####
> >>
> >> Here's the MRE:
> >> #################################
> >>
> >> library(xts)
> >> library(PerformanceAnalytics)
> >> library(quantmod)
> >> library(TTR)
> >> library(quantstrat)
> >>
> >> getSymbols(Symbols = "SPY", from = "2000-01-01")
> >>
> >>
> >> startDate<-as.Date(index(SPY)[1], format="%Y-%m-%d")
> >> endDate<-as.Date(index(last(SPY)), format="%Y-%m-%d")
> >>
> >> currency("USD")
> >>
> >> stock(primary_id = c("SPY"),currency = "USD")
> >>
> >> #name
> >> maStrategy <-"MAStrategy"
> >>
> >> #Date, one day before prices
> >> strategyDate <- min(index(SPY)) - 1
> >>
> >> NumSh<-1
> >>
> >> #rm.strat(maStrategy)
> >> #rm(mktdata)
> >>
> >>
> >> maLag <- 5
> >>
> >>
> >> #init portfolio and account
> >> initPortf(name = maStrategy
> >>           , symbols = list("SPY") #as defined in Financial instrument
> >>           , initDate = strategyDate
> >> )
> >>
> >> initAcct(name = maStrategy
> >>          ,portfolios = maStrategy
> >>          ,initDate = strategyDate
> >>          ,initEq = 1
> >> )
> >>
> >> #order book, and strategy
> >> initOrders(portfolio = maStrategy
> >>            , initDate = strategyDate
> >> )
> >>
> >> #position limits
> >> addPosLimit(maStrategy, symbol = "SPY", strategyDate, maxpos = NumSh,
> >> longlevels = NumSh, minpos = 0)
> >>
> >> strategy( maStrategy, store = TRUE)
> >>
> >> #add indicator
> >> add.indicator(strategy = maStrategy
> >>               , name = "EMA"
> >>               , arguments = list(x = quote(mktdata$SPY.Close), n =
> >> quote(maLag))
> >>               , label = "SPYma"
> >> )
> >>
> >>
> >>
> >>
> >> add.signal(strategy = maStrategy
> >>            , name = "sigComparison"
> >>            , arguments = list(columns = c("SPY.Close","SPYma")
> >>                               , relationship = "gt"
> >>            )
> >>            , label = "SPY.gt.ma"
> >> )
> >>
> >>
> >>
> >> add.signal(strategy = maStrategy
> >>            , name = "sigComparison"
> >>            , arguments = list(columns = c("SPY.Close","SPYma")
> >>                               , relationship = "lte"
> >>            )
> >>            , label = "SPY.lte.ma"
> >> )
> >>
> >>
> >>
> >>
> >> #Entry and exit rules
> >>
> >>
> >> add.rule(strategy = maStrategy
> >>          , name = "ruleSignal"
> >>          , arguments = list(sigcol = "SPY.gt.ma"
> >>                             , sigval = TRUE
> >>                             , orderqty = NumSh
> >>                             , ordertype = "market"
> >>                             , orderside = NULL
> >>                             , osFUN = "osMaxPos"
> >>                             , symbol = "SPY"
> >>          )
> >>          , type = "enter"
> >> )
> >>
> >>
> >> add.rule(strategy = maStrategy
> >>          , name = "ruleSignal"
> >>          , arguments = list(sigcol = "SPY.lte.ma"
> >>                             , sigval = TRUE
> >>                             , orderqty = "all"
> >>                             , ordertype = "market"
> >>                             , orderside = NULL
> >>                             , osFUN = "osMaxPos"
> >>                             , symbol = "SPY"
> >>          )
> >>          , type = "exit"
> >> )
> >>
> >>
> >> applyStrategy(strategy = maStrategy
> >>               , portfolios = maStrategy
> >> )
> >>
> >> updatePortf(maStrategy)
> >> updateAcct(maStrategy)
> >> updateEndEq(maStrategy)
> >>
> >>
> >> maLag <- seq(5,10,1)
> >> ####################
> >> #delete.paramset(maStrategy,"maLagDist")
> >> add.distribution(strategy = maStrategy
> >>                  , paramset.label = "maLagDist"
> >>                  , component.type = "indicator"
> >>                  , component.label = "SPYma"
> >>                  , variable = list(n = maLag)
> >>                  , label = "lagDist"
> >>
> >> )
> >>
> >>
> >>
> >> library(foreach)
> >> library(doParallel)
> >> cl <- makeForkCluster(nnodes = detectCores())
> >> registerDoParallel(cl)
> >> maStrategyAP <-
> >>   apply.paramset(strategy.st = maStrategy
> >>                  , paramset.label = "maLagDist"
> >>                  , portfolio.st = maStrategy
> >>                  , account.st = maStrategy
> >>   )
> >> stopCluster(cl = cl)
> >> cl <- NULL
> >> closeAllConnections()
> >> gc()
> >>
> >>
> >> #this works
> >> maStrategyAP$tradeStats$Profit.To.Max.Draw
> >>
> >>
> >> head(mktdata)
> >>
> >> #undebug(apply.paramset.signal.analysis)
> >> maStrategyAPSA <-
> >>   apply.paramset.signal.analysis(strategy.st = maStrategy
> >>                                  , paramset.label = "maLagDist"
> >>                                  , portfolio.st = maStrategy
> >>                                  , sigcol = "SPY.gt.ma"
> >>                                  , sigval = 1
> >>                                  , on = NULL
> >>                                  , forward.days = 5
> >>                                  , include.day.of.signal = TRUE
> >>   )
> >>
> >>
> >> ##################################
> >>
> >>
> >>
> >> Erol Biceroglu
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-SIG-Finance at r-project.org mailing list
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> -- Subscriber-posting only. If you want to post, subscribe first.
> >> -- Also note that this is not the r-help list where general R questions
> should go.
> >
> >
> >
> > --
> > Joshua Ulrich  |  about.me/joshuaulrich
> > FOSS Trading  |  www.fosstrading.com
> > R/Finance 2016 | www.rinfinance.com
>
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
> R/Finance 2016 | www.rinfinance.com
>

	[[alternative HTML version deleted]]


From msinghal_22 at yahoo.com  Wed Aug  3 17:39:35 2016
From: msinghal_22 at yahoo.com (Mayank Singhal)
Date: Wed, 3 Aug 2016 15:39:35 +0000 (UTC)
Subject: [R-SIG-Finance] Quantstrat - Triggering chain rule with lag
 period
In-Reply-To: <223244311.9504182.1470114875549.JavaMail.yahoo@mail.yahoo.com>
References: <92980001.9548004.1470109090512.JavaMail.yahoo.ref@mail.yahoo.com>
	<92980001.9548004.1470109090512.JavaMail.yahoo@mail.yahoo.com>
	<CA+oJuEHckmRiame5dB3-MJpA6n5vh8tCmOi_S-8tFiqtrA4TwA@mail.gmail.com>
	<223244311.9504182.1470114875549.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1233943055.10398505.1470238775059.JavaMail.yahoo@mail.yahoo.com>



Apologies for repeated email. I think my previous email had some formatting issues.

Here is what i am trying to achieve : For every entry order (which gets filled, note that some might get rejected because of MaxPos criteria), i want to exit based on the exit rule (which is based on signal generation) or on a second exit rule (which is fixed no. of periods, "n",  from entry) depending upon whichever of these two exit criteria is met first.

The result i am getting is : exit rule 2 (fixed no. of periods) triggers off the following day from the entry rule and not after desired "n" periods.


Please see below the code :

##########################################################
require(quantstrat)
Sys.setenv(TZ="UTC")

sigLag <- function(label, data=mktdata, column, cross=FALSE, nLag=1){ 
colNum <- match.names(column, colnames(data)) 
ret_sig <- lag(data[,colNum], nLag) 
if (isTRUE(cross)) 
ret_sig <- diff(ret_sig) == 1 
if (!missing(label)) 
colnames(ret_sig) <- label 
return(ret_sig) 
} # Thanks to Ilya Kipnis

stock1="SPY"
getSymbols(stock1, from = "1998-01-01", to = "2015-12-31")
xts1 = get(stock1)["2010/"]

init.date = "1990-01-01"
start.date = start(xts1)
endDate=end(xts1)
init.equity=100000
MaxPos <- 2
lvls <- 1
eb3 = TRUE

rm.strat(portfolio.st)
rm.strat(account.st)
portfolio.st='msinghal'
account.st='msinghal'

initPortf(portfolio.st,symbols="xts1", initDate = init.date)
initAcct(account.st,portfolios=portfolio.st, initDate = init.date, initEq = init.equity)
initOrders(portfolio=portfolio.st, initDate = init.date)

strat.st<-portfolio.st
strategy(strat.st, store=TRUE)

addPosLimit(portfolio=portfolio.st, timestamp=start.date, symbol="xts1",maxpos=MaxPos, longlevels=lvls, minpos=-MaxPos, shortlevels=lvls)

# indicators
strat.st <- add.indicator(strat.st, name = "SMA", arguments = list(
x = quote(Cl(mktdata)),
n = 50),
label="ind1"
)

strat.st <- add.indicator(strat.st, name="SMA",
arguments = list(
x = quote(Cl(mktdata)),
n = 20),
label="ind2"
)

### signals

strat.st <- add.signal(strat.st, name='sigCrossover',
arguments = list(
columns=c("SMA.ind1","SMA.ind2"),
relationship="gte"
),
label='signal4.gt.zero'
)

strat.st <- add.signal(strat.st, name='sigCrossover',
arguments = list(
columns=c("SMA.ind1","SMA.ind2"),
relationship="lt"
),
label='signal4.lt.zero'
)

strat.st <- add.signal(strat.st,name="sigLag", 
arguments=list(
column="signal4.gt.zero",
nLag=5, cross=FALSE
),
label="longExit"
) 

#entry rule
strat.st <- add.rule(strat.st,name='ruleSignal',arguments = list( 
sigcol=c("signal4.gt.zero"),sigval=TRUE,orderqty=1,
ordertype='market',orderside='long',prefer="Open",
replace=FALSE,threshold=NULL,osFUN=osMaxPos),type='enter',
label='enter_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)

#exit rule 1
strat.st <- add.rule(strat.st,name='ruleSignal',arguments = list( 
sigcol=c("signal4.lt.zero"), sigval=TRUE,orderqty='all',
ordertype='market',orderside='long',prefer="Open",
replace=FALSE,threshold=NULL,osFUN=osMaxPos,orderset='ocolong'),
type='exit', label='exit_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)

#exit rule 2
strat.st <- add.rule(strat.st,name='ruleSignal',arguments = list(
sigcol=c("longExit"), sigval=TRUE,orderqty=-1,ordertype='market',
orderside='long',prefer="Open",replace=FALSE, orderset='ocolong'), 
type='chain', parent='enter_long_alpha5c',label='Sqroff_LONG',
enabled=eb3, path.dep = TRUE)

start_t<-Sys.time()
out<-applyStrategy(strat.st , portfolios=portfolio.st,mktdata = xts1,verbose=FALSE)
end_t<-Sys.time()
print(end_t-start_t)

start_t<-Sys.time()
updatePortf(Portfolio=portfolio.st,Dates=paste('::',as.Date(Sys.time()),sep=''))
try(updateAcct(account.st,Dates = paste(start.date,endDate,sep='/')))
updateEndEq(account.st,Dates = paste(start.date,endDate,sep='/'))
end_t<-Sys.time()
print(end_t-start_t)

ob <- getOrderBook(portfolio.st)
ob2 <- ob$msinghal$xts1
print(ob2)

#########################################################################

Regards,
Mayank




Sure, please find attached the sample case.


On Tuesday, August 2, 2016 9:13 AM, Ilya Kipnis <ilya.kipnis at gmail.com> wrote:



You might want to send a minimum reproducible example.


On Mon, Aug 1, 2016 at 11:38 PM, Mayank Singhal via R-SIG-Finance <r-sig-finance at r-project.org> wrote:

Hello all,
>Here is what i am trying to achieve : For every entry order (which gets filled, note that some might get rejected because of MaxPos criteria), i want to exit based on the exit rule (which is based on signal generation) or on a second exit rule (which is fixed no. of periods, "n",  from entry) depending upon whichever of these two exit criteria is met first.
>
>The result i am getting is : exit rule 2 (fixed no. of periods) triggers off the following day from the entry rule and not after desired "n" periods. Please if someone can advise - if i am doing something wrong with the syntax here ? Below is the code snapshot of rules
>**********************************************************************************eb3 = TRUE
>#entry rulestrat.st <- add.rule(strat.st,name='ruleSignal',arguments = list( sigcol=c("signal4.gt.zero"),sigval=TRUE,orderqty=1,ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos),type='enter',label='enter_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)
>#exit rule 1strat.st <- add.rule(strat.st,name='ruleSignal',arguments = list( sigcol=c("signal4.lt.zero"), sigval=TRUE,orderqty='all',ordertype='market',orderside='long',prefer="Open",replace=FALSE,threshold=NULL,osFUN=osMaxPos,orderset='ocolong'),type='exit', label='exit_long_alpha5c',storefun=FALSE,enabled=eb3,path.dep = TRUE)
>#exit rule 2 strat.st <- add.rule(strat.st,name='ruleSignal',arguments = list(sigcol=c("longExit"), sigval=TRUE,orderqty=-1,ordertype='market',orderside='long',prefer="Open",replace=FALSE, orderset='ocolong'), type='chain', parent='enter_long_alpha5c',label='Sqroff_LONG',enabled=eb3, path.dep = TRUE)
>*********************************************************** Note that - in exit rule 2 , the sigcol "longexit" is just a "n" period lag on "signal4.gt.zero" column
>Any guidance in this regard will be very helpful.
>Regards,Mayank
>        [[alternative HTML version deleted]]
>
>_______________________________________________
>R-SIG-Finance at r-project.org mailing list
>https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>-- Subscriber-posting only. If you want to post, subscribe first.
>-- Also note that this is not the r-help list where general R questions should go.


From golam.sakline at gmail.com  Mon Aug  8 14:48:10 2016
From: golam.sakline at gmail.com (golam sakline)
Date: Mon, 8 Aug 2016 16:48:10 +0400
Subject: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy with
 'data' must be of a vector type, was 'NULL'
Message-ID: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>

Hi All,

I have an error at applyStrategy that is failing with "Error in array(x,
c(length(x), 1L), if (!is.null(names(x))) list(names(x),  : 'data' must be
of a vector type, was 'NULL'" .
I believe the problem is occurring at add.indicator function "RT" that
takes in OHLC(mktdata) data and outputs an univariate series.
This error doesn't occur when I replace RT with MACD function that takes in
Cl(mktdata) rather than OHLC.
This error doesn't occur when I am using RT function with a single asset in
the symbol i.e. the length(symbol) = 1.

What am I doing wrong or missing here?

Thanks in advance. Much appreciated.

G

##########################################################################
rm(list = ls(all = TRUE))
setwd("/Users/mm/Documents/R")
library(lattice)
library(timeSeries)
library(timeDate)
library(PerformanceAnalytics)
library(quantmod)
library(xts)
library(blotter)
library(TTR)
library(quantstrat)
library(FinancialInstrument)
source("functions.R")

setwd("/Users/mm/Documents/R/UAE")
options("getSymbols.warning4.0" = FALSE)
#sessionInfo()

startDate = "2015-07-01"
symbols <- c("DFMC", "ARTC", "EMAARMALLS", "DUBAIPARKS")
Sys.setenv(TZ="UTC")

getSymbols("DFM", src="csv",
col.names=c("Open","High","Low","Close","Volume"))
getSymbols(symbols, src="csv",
col.names=c("Open","High","Low","Close","Volume"))


initDate <- "2015-07-01"
initEq <- 100000
tradeSize <- initEq/length(symbols)
currency("USD")
stock(symbols, currency="USD",multiplier=1)

myTheme<-chart_theme()
myTheme$col$dn.col<- 'lightblue'
myTheme$col$dn.border <-  'lightgray'
myTheme$col$up.border <-  'lightgray'


par(mfrow=c(2,2))
for(symbol in symbols)
{
  plot(chart_Series(get(symbol),name=symbol))
}
par(mfrow=c(1,1))


if(exists('.strategy')) rm.strat(qs.strategy)
if(!exists('.blotter')) .blotter <- new.env()
if(!exists('.strategy')) .strategy <- new.env()

qs.strategy <- "AD26"
initPortf(qs.strategy, symbols, initDate=initDate)
initAcct(qs.strategy,portfolios=qs.strategy, initDate=initDate,
initEq=initEq)
initOrders(portfolio=qs.strategy,initDate=initDate)
strategy(qs.strategy,store=TRUE)

add.indicator("AD26", name = "RT",
              arguments = list(x=quote(OHLC(mktdata))),label= "RT")

summary(getStrategy(qs.strategy))

#########################################################################

add.signal(qs.strategy, name="sigCrossover",
arguments=list(columns=c("Close", "RT"), relationship="gte"), label="Buy")

add.signal(qs.strategy, name="sigCrossover",
arguments=list(columns=c("Close", "RT"), relationship="lt"), label="Sell")

#########################################################################

summary(getStrategy(qs.strategy))

#########################################################################

add.rule(qs.strategy, name='ruleSignal',
         arguments = list(sigcol="Buy", sigval=TRUE,
                          prefer ="open",
                          replace = FALSE,
                          orderqty = 10,
                          osFUN = "osFixedDollar",
                          ordertype='market',
                          orderside='long',
                          TxnFees=-5,
                          orderset ="ocolong"
         ),
         type='enter',
         label = 'LE'
)

add.rule(qs.strategy, name='ruleSignal',
         arguments = list(sigcol="Sell", sigval=TRUE,
                          replace = TRUE,
                          prefer ="open",
                          orderqty="all",
                          ordertype='market',
                          orderside='long',
                          TxnFees=-5,
                          orderset = "ocolong"
         ),
         type='exit',
         label = "LX"
)

add.rule(qs.strategy, name='ruleSignal',
         arguments = list(sigcol="Buy", sigval=TRUE,
                          replace =FALSE,
                          orderqty="all",
                          ordertype='stoplimit',
                          orderside='long',
                          tmult = TRUE,
                          threshold = quote(stopLossPercent),
                          TxnFees=-5,
                          orderset = "ocolong"
         ),
         type='chain',
         parent = "LE",
         label = "StopLossLong",
         enabled = FALSE
)

summary(getStrategy(qs.strategy))

#enable.rule(qs.strategy, type="chain", label ="StopLoss")

applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)

updatePortf(qs.strategy)
updateAcct(qs.strategy)
updateEndEq(qs.strategy)

checkBlotterUpdate("AD26", "AD26")

##################################################################

OUTPUT:

> rm(list = ls(all = TRUE))
> setwd("/Users/mm/Documents/R")
> library(lattice)
> library(timeSeries)
Loading required package: timeDate
> library(timeDate)
> library(PerformanceAnalytics)
Loading required package: xts
Loading required package: zoo

Attaching package: ?zoo?

The following object is masked from ?package:timeSeries?:

    time<-

The following objects are masked from ?package:base?:

    as.Date, as.Date.numeric


Package PerformanceAnalytics (1.4.3541) loaded.
Copyright (c) 2004-2014 Peter Carl and Brian G. Peterson, GPL-2 | GPL-3
http://r-forge.r-project.org/projects/returnanalytics/


Attaching package: ?PerformanceAnalytics?

The following objects are masked from ?package:timeDate?:

    kurtosis, skewness

The following object is masked from ?package:graphics?:

    legend

Warning message:
package ?zoo? was built under R version 3.2.5
> library(quantmod)
Loading required package: TTR
Version 0.4-0 included new data defaults. See ?getSymbols.
> library(xts)
> library(blotter)
Loading required package: FinancialInstrument
> library(TTR)
> library(quantstrat)
Loading required package: foreach
foreach: simple, scalable parallel programming from Revolution Analytics
Use Revolution R for scalability, fault tolerance and more.
http://www.revolutionanalytics.com
> library(FinancialInstrument)
> source("functions.R")
>
> setwd("/Users/mm/Documents/R/UAE")
> options("getSymbols.warning4.0" = FALSE)
> #sessionInfo()
>
> startDate = "2015-07-01"
> symbols <- c("DFMC", "ARTC", "EMAARMALLS", "DUBAIPARKS")
> Sys.setenv(TZ="UTC")
>
> getSymbols("DFM", src="csv",
col.names=c("Open","High","Low","Close","Volume"))
[1] "DFM"
> getSymbols(symbols, src="csv",
col.names=c("Open","High","Low","Close","Volume"))
[1] "DFMC"       "ARTC"       "EMAARMALLS" "DUBAIPARKS"
>
>
> initDate <- "2015-07-01"
> initEq <- 100000
> tradeSize <- initEq/length(symbols)
> currency("USD")
[1] "USD"
> stock(symbols, currency="USD",multiplier=1)
[1] "DFMC"       "ARTC"       "EMAARMALLS" "DUBAIPARKS"
>
> myTheme<-chart_theme()
> myTheme$col$dn.col<- 'lightblue'
> myTheme$col$dn.border <-  'lightgray'
> myTheme$col$up.border <-  'lightgray'
>
>
> par(mfrow=c(2,2))
> for(symbol in symbols)
+ {
+   plot(chart_Series(get(symbol),name=symbol))
+ }
> par(mfrow=c(1,1))
>
>
> if(exists('.strategy')) rm.strat(qs.strategy)
Error in is.strategy(name) : object 'qs.strategy' not found
> if(!exists('.blotter')) .blotter <- new.env()
> if(!exists('.strategy')) .strategy <- new.env()
>
> qs.strategy <- "AD26"
> initPortf(qs.strategy, symbols, initDate=initDate)
[1] "AD26"
> initAcct(qs.strategy,portfolios=qs.strategy, initDate=initDate,
initEq=initEq)
[1] "AD26"
> initOrders(portfolio=qs.strategy,initDate=initDate)
> strategy(qs.strategy,store=TRUE)
>
> add.indicator("AD26", name = "RT",
+               arguments = list(x=quote(OHLC(mktdata))),label= "RT")
[1] "AD26"
>
> summary(getStrategy(qs.strategy))
            Length Class  Mode
name        1      -none- character
assets      0      -none- NULL
indicators  1      -none- list
signals     0      -none- list
rules       1      -none- list
constraints 0      -none- NULL
init        0      -none- list
wrapup      0      -none- list
call        3      -none- call
>
>
#############################################################################################################
>
> add.signal(qs.strategy, name="sigCrossover",
arguments=list(columns=c("Close", "RT"), relationship="gte"), label="Buy")
[1] "AD26"
>
> add.signal(qs.strategy, name="sigCrossover",
arguments=list(columns=c("Close", "RT"), relationship="lt"), label="Sell")
[1] "AD26"
>
>
##############################################################################################################
>
> summary(getStrategy(qs.strategy))
            Length Class  Mode
name        1      -none- character
assets      0      -none- NULL
indicators  1      -none- list
signals     2      -none- list
rules       1      -none- list
constraints 0      -none- NULL
init        0      -none- list
wrapup      0      -none- list
call        3      -none- call
>
>
##############################################################################################################
>
> add.rule(qs.strategy, name='ruleSignal',
+          arguments = list(sigcol="Buy", sigval=TRUE,
+                           prefer ="open",
+                           replace = FALSE,
+                           orderqty = 10,
+                           osFUN = "osFixedDollar",
+                           ordertype='market',
+                           orderside='long',
+                           TxnFees=-5,
+                           orderset ="ocolong"
+          ),
+          type='enter',
+          label = 'LE'
+ )
[1] "AD26"
>
> add.rule(qs.strategy, name='ruleSignal',
+          arguments = list(sigcol="Sell", sigval=TRUE,
+                           replace = TRUE,
+                           prefer ="open",
+                           orderqty="all",
+                           ordertype='market',
+                           orderside='long',
+                           TxnFees=-5,
+                           orderset = "ocolong"
+          ),
+          type='exit',
+          label = "LX"
+ )
[1] "AD26"
>
> add.rule(qs.strategy, name='ruleSignal',
+          arguments = list(sigcol="Buy", sigval=TRUE,
+                           replace =FALSE,
+                           orderqty="all",
+                           ordertype='stoplimit',
+                           orderside='long',
+                           tmult = TRUE,
+                           threshold = quote(stopLossPercent),
+                           TxnFees=-5,
+                           orderset = "ocolong"
+          ),
+          type='chain',
+          parent = "LE",
+          label = "StopLossLong",
+          enabled = FALSE
+ )
[1] "AD26"
>
> summary(getStrategy(qs.strategy))
            Length Class  Mode
name        1      -none- character
assets      0      -none- NULL
indicators  1      -none- list
signals     2      -none- list
rules       4      -none- list
constraints 0      -none- NULL
init        0      -none- list
wrapup      0      -none- list
call        3      -none- call
>
> #enable.rule(qs.strategy, type="chain", label ="StopLoss")
>
> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)
*Error in array(x, c(length(x), 1L), if (!is.null(names(x))) list(names(x),
 : *
*  'data' must be of a vector type, was 'NULL'*
*In addition: Warning messages:*
*1: In min(j, na.rm = TRUE) :*
*  no non-missing arguments to min; returning Inf*
*2: In max(j, na.rm = TRUE) :*
*  no non-missing arguments to max; returning -Inf*
*Called from: array(x, c(length(x), 1L), if (!is.null(names(x)))
list(names(x), *
*    NULL) else NULL)*
Browse[1]>
> updatePortf(qs.strategy)
[1] "AD26"
> updateAcct(qs.strategy)
[1] "AD26"
> updateEndEq(qs.strategy)
[1] "AD26"
>
> checkBlotterUpdate("AD26", "AD26")
[1] TRUE
>
> sessionInfo()
R version 3.2.4 (2016-03-10)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.11.6 (El Capitan)

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
 [1] quantstrat_0.9.1739           foreach_1.4.3
blotter_0.9.1741
 [4] FinancialInstrument_1.2.0     quantmod_0.4-5                TTR_0.23-1

 [7] PerformanceAnalytics_1.4.3541 xts_0.9-7                     zoo_1.7-13

[10] timeSeries_3022.101.2         timeDate_3012.100
lattice_0.20-33

loaded via a namespace (and not attached):
[1] rsconnect_0.4.2.2 tools_3.2.4       codetools_0.2-14  grid_3.2.4
 iterators_1.0.8

	[[alternative HTML version deleted]]


From josh.m.ulrich at gmail.com  Mon Aug  8 14:58:56 2016
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Mon, 8 Aug 2016 07:58:56 -0500
Subject: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy
 with 'data' must be of a vector type, was 'NULL'
In-Reply-To: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>
References: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>
Message-ID: <CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>

On Mon, Aug 8, 2016 at 7:48 AM, golam sakline <golam.sakline at gmail.com> wrote:
> Hi All,
>
> I have an error at applyStrategy that is failing with "Error in array(x,
> c(length(x), 1L), if (!is.null(names(x))) list(names(x),  : 'data' must be
> of a vector type, was 'NULL'" .
> I believe the problem is occurring at add.indicator function "RT" that
> takes in OHLC(mktdata) data and outputs an univariate series.
> This error doesn't occur when I replace RT with MACD function that takes in
> Cl(mktdata) rather than OHLC.
> This error doesn't occur when I am using RT function with a single asset in
> the symbol i.e. the length(symbol) = 1.
>
> What am I doing wrong or missing here?
>
It is nearly impossible for anyone to help you because your example
uses data (CSVs on your local hard drive) and functions (in
functions.R) that no one else has access to.  And you suspect the
error is related to one of those functions...

> Thanks in advance. Much appreciated.
>
> G
>
> ##########################################################################
> rm(list = ls(all = TRUE))
> setwd("/Users/mm/Documents/R")
> library(lattice)
> library(timeSeries)
> library(timeDate)
> library(PerformanceAnalytics)
> library(quantmod)
> library(xts)
> library(blotter)
> library(TTR)
> library(quantstrat)
> library(FinancialInstrument)
> source("functions.R")
>
> setwd("/Users/mm/Documents/R/UAE")
> options("getSymbols.warning4.0" = FALSE)
> #sessionInfo()
>
> startDate = "2015-07-01"
> symbols <- c("DFMC", "ARTC", "EMAARMALLS", "DUBAIPARKS")
> Sys.setenv(TZ="UTC")
>
> getSymbols("DFM", src="csv",
> col.names=c("Open","High","Low","Close","Volume"))
> getSymbols(symbols, src="csv",
> col.names=c("Open","High","Low","Close","Volume"))
>
>
> initDate <- "2015-07-01"
> initEq <- 100000
> tradeSize <- initEq/length(symbols)
> currency("USD")
> stock(symbols, currency="USD",multiplier=1)
>
> myTheme<-chart_theme()
> myTheme$col$dn.col<- 'lightblue'
> myTheme$col$dn.border <-  'lightgray'
> myTheme$col$up.border <-  'lightgray'
>
>
> par(mfrow=c(2,2))
> for(symbol in symbols)
> {
>   plot(chart_Series(get(symbol),name=symbol))
> }
> par(mfrow=c(1,1))
>
>
> if(exists('.strategy')) rm.strat(qs.strategy)
> if(!exists('.blotter')) .blotter <- new.env()
> if(!exists('.strategy')) .strategy <- new.env()
>
> qs.strategy <- "AD26"
> initPortf(qs.strategy, symbols, initDate=initDate)
> initAcct(qs.strategy,portfolios=qs.strategy, initDate=initDate,
> initEq=initEq)
> initOrders(portfolio=qs.strategy,initDate=initDate)
> strategy(qs.strategy,store=TRUE)
>
> add.indicator("AD26", name = "RT",
>               arguments = list(x=quote(OHLC(mktdata))),label= "RT")
>
> summary(getStrategy(qs.strategy))
>
> #########################################################################
>
> add.signal(qs.strategy, name="sigCrossover",
> arguments=list(columns=c("Close", "RT"), relationship="gte"), label="Buy")
>
> add.signal(qs.strategy, name="sigCrossover",
> arguments=list(columns=c("Close", "RT"), relationship="lt"), label="Sell")
>
> #########################################################################
>
> summary(getStrategy(qs.strategy))
>
> #########################################################################
>
> add.rule(qs.strategy, name='ruleSignal',
>          arguments = list(sigcol="Buy", sigval=TRUE,
>                           prefer ="open",
>                           replace = FALSE,
>                           orderqty = 10,
>                           osFUN = "osFixedDollar",
>                           ordertype='market',
>                           orderside='long',
>                           TxnFees=-5,
>                           orderset ="ocolong"
>          ),
>          type='enter',
>          label = 'LE'
> )
>
> add.rule(qs.strategy, name='ruleSignal',
>          arguments = list(sigcol="Sell", sigval=TRUE,
>                           replace = TRUE,
>                           prefer ="open",
>                           orderqty="all",
>                           ordertype='market',
>                           orderside='long',
>                           TxnFees=-5,
>                           orderset = "ocolong"
>          ),
>          type='exit',
>          label = "LX"
> )
>
> add.rule(qs.strategy, name='ruleSignal',
>          arguments = list(sigcol="Buy", sigval=TRUE,
>                           replace =FALSE,
>                           orderqty="all",
>                           ordertype='stoplimit',
>                           orderside='long',
>                           tmult = TRUE,
>                           threshold = quote(stopLossPercent),
>                           TxnFees=-5,
>                           orderset = "ocolong"
>          ),
>          type='chain',
>          parent = "LE",
>          label = "StopLossLong",
>          enabled = FALSE
> )
>
> summary(getStrategy(qs.strategy))
>
> #enable.rule(qs.strategy, type="chain", label ="StopLoss")
>
> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)
>
> updatePortf(qs.strategy)
> updateAcct(qs.strategy)
> updateEndEq(qs.strategy)
>
> checkBlotterUpdate("AD26", "AD26")
>
> ##################################################################
>
> OUTPUT:
>
<snip>
>> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)
> *Error in array(x, c(length(x), 1L), if (!is.null(names(x))) list(names(x),
>  : *
> *  'data' must be of a vector type, was 'NULL'*
> *In addition: Warning messages:*
> *1: In min(j, na.rm = TRUE) :*
> *  no non-missing arguments to min; returning Inf*
> *2: In max(j, na.rm = TRUE) :*
> *  no non-missing arguments to max; returning -Inf*
> *Called from: array(x, c(length(x), 1L), if (!is.null(names(x)))
> list(names(x), *
> *    NULL) else NULL)*
> Browse[1]>
>> updatePortf(qs.strategy)
> [1] "AD26"
>> updateAcct(qs.strategy)
> [1] "AD26"
>> updateEndEq(qs.strategy)
> [1] "AD26"
>>
>> checkBlotterUpdate("AD26", "AD26")
> [1] TRUE
>>
>> sessionInfo()
> R version 3.2.4 (2016-03-10)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.11.6 (El Capitan)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
>  [1] quantstrat_0.9.1739           foreach_1.4.3
> blotter_0.9.1741
>  [4] FinancialInstrument_1.2.0     quantmod_0.4-5                TTR_0.23-1
>
>  [7] PerformanceAnalytics_1.4.3541 xts_0.9-7                     zoo_1.7-13
>
> [10] timeSeries_3022.101.2         timeDate_3012.100
> lattice_0.20-33
>
> loaded via a namespace (and not attached):
> [1] rsconnect_0.4.2.2 tools_3.2.4       codetools_0.2-14  grid_3.2.4
>  iterators_1.0.8
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2016 | www.rinfinance.com


From josh.m.ulrich at gmail.com  Wed Aug 10 01:41:16 2016
From: josh.m.ulrich at gmail.com (Joshua Ulrich)
Date: Tue, 9 Aug 2016 18:41:16 -0500
Subject: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy
 with 'data' must be of a vector type, was 'NULL'
In-Reply-To: <CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>
References: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>
	<CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>
Message-ID: <CAPPM_gR8F0GgnM8TPLGeK52=XxyV+1D4M=V8aJMQOXgBG=M3uw@mail.gmail.com>

Please keep your replies on-list, so others can follow/contribute.

On Mon, Aug 8, 2016 at 9:59 AM, golam sakline <golam.sakline at gmail.com> wrote:
> RT is the function you wrote here...
>
> http://stackoverflow.com/questions/5554220/r-statistics-average-true-range-trailing-stop-indicator
>
> RT <- function(x)
> {
>   x$stopLongATR <- -3.5*ATR(HLC(x),5)[,"atr"]
>   x$stopShortATR <- 3.5*ATR(HLC(x),5)[,"atr"]
>
>
>   x$CR <- Cl(x)
>   x$x.lagCl <- lag(Cl(x))
>
>   for(i in 6:NROW(x)) {
>     trail1 <- coredata(x$CR[i-1])
>
>     if(Cl(x)[i] > trail1 && x$x.lagCl[i] > trail1) {
>       x$CR[i] <- max(trail1,coredata(Cl(x)[i]+x$stopLongATR[i]))
>     } else
>       if(Cl(x)[i] < trail1 && x$x.lagCl[i] < trail1) {
>         x$CR[i] <- min(trail1,coredata(Cl(x)[i]+x$stopShortATR[i]))
>       } else
>         if(Cl(x)[i] > trail1) {
>           x$CR[i] <- coredata(Cl(x)[i]+x$stopLongATR[i])
>         } else {
>           x$CR[i] <- coredata(Cl(x)[i]+x$stopShortATR[i])
>         }
>   }
>   x$CR
> }
>
You still need to provide data, and _all_ the relevant functions.
osFixedDollar is still missing.  I assume the function you used is a
version of the function from Guy Yollin's presentations:

osFixedDollar <- function(timestamp, orderqty, portfolio, symbol, ruletype, ...)
{
  ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
  orderqty <- round(tradeSize/ClosePrice,-2)
  return(orderqty)
}


Your strategy runs fine for me using SPY data from Yahoo Finance, and
the latest version of quantstrat, blotter, and xts from GitHub. Here's
a version with many extraneous components removed.


require(quantstrat)

symbols <- c("SPY")
Sys.setenv(TZ="UTC")

getSymbols(symbols)

initEq <- 100000
tradeSize <- initEq/length(symbols)
currency("USD")
stock(symbols, currency="USD",multiplier=1)

if(exists('.strategy')) rm.strat(qs.strategy)
if(!exists('.blotter')) .blotter <- new.env()
if(!exists('.strategy')) .strategy <- new.env()

qs.strategy <- "AD26"
initPortf(qs.strategy, symbols)
initAcct(qs.strategy,portfolios=qs.strategy, initEq=initEq)
initOrders(portfolio=qs.strategy)
strategy(qs.strategy,store=TRUE)

add.indicator("AD26", name = "RT",
              arguments = list(x=quote(OHLC(mktdata))),label= "RT")

add.signal(qs.strategy, name="sigCrossover",
arguments=list(columns=c("Close", "RT"), relationship="gte"), label="Buy")

add.signal(qs.strategy, name="sigCrossover",
arguments=list(columns=c("Close", "RT"), relationship="lt"), label="Sell")

add.rule(qs.strategy, name='ruleSignal',
         arguments = list(sigcol="Buy", sigval=TRUE,
                          prefer ="open",
                          replace = FALSE,
                          orderqty = 10,
                          osFUN = "osFixedDollar",
                          ordertype='market',
                          orderside='long',
                          TxnFees=-5,
                          orderset ="ocolong"
         ),
         type='enter',
         label = 'LE'
)

add.rule(qs.strategy, name='ruleSignal',
         arguments = list(sigcol="Sell", sigval=TRUE,
                          replace = TRUE,
                          prefer ="open",
                          orderqty="all",
                          ordertype='market',
                          orderside='long',
                          TxnFees=-5,
                          orderset = "ocolong"
         ),
         type='exit',
         label = "LX"
)

add.rule(qs.strategy, name='ruleSignal',
         arguments = list(sigcol="Buy", sigval=TRUE,
                          replace =FALSE,
                          orderqty="all",
                          ordertype='stoplimit',
                          orderside='long',
                          tmult = TRUE,
                          threshold = quote(stopLossPercent),
                          TxnFees=-5,
                          orderset = "ocolong"
         ),
         type='chain',
         parent = "LE",
         label = "StopLossLong",
         enabled = FALSE
)

applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)

updatePortf(qs.strategy)
updateAcct(qs.strategy)
updateEndEq(qs.strategy)



Here's my sessionInfo() output:
R> sessionInfo()
R version 3.3.1 (2016-06-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 16.04.1 LTS

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] quantstrat_0.9.1739           foreach_1.4.2
[3] blotter_0.10.2                PerformanceAnalytics_1.4.3541
[5] FinancialInstrument_1.2.0     quantmod_0.4-5
[7] TTR_0.23-1                    xts_0.10-0
[9] zoo_1.7-13

loaded via a namespace (and not attached):
[1] codetools_0.2-14 grid_3.3.1       iterators_1.0.7  boot_1.3-18
[5] lattice_0.20-33

>
> On Mon, Aug 8, 2016 at 4:58 PM, Joshua Ulrich <josh.m.ulrich at gmail.com>
> wrote:
>>
>> On Mon, Aug 8, 2016 at 7:48 AM, golam sakline <golam.sakline at gmail.com>
>> wrote:
>> > Hi All,
>> >
>> > I have an error at applyStrategy that is failing with "Error in array(x,
>> > c(length(x), 1L), if (!is.null(names(x))) list(names(x),  : 'data' must
>> > be
>> > of a vector type, was 'NULL'" .
>> > I believe the problem is occurring at add.indicator function "RT" that
>> > takes in OHLC(mktdata) data and outputs an univariate series.
>> > This error doesn't occur when I replace RT with MACD function that takes
>> > in
>> > Cl(mktdata) rather than OHLC.
>> > This error doesn't occur when I am using RT function with a single asset
>> > in
>> > the symbol i.e. the length(symbol) = 1.
>> >
>> > What am I doing wrong or missing here?
>> >
>> It is nearly impossible for anyone to help you because your example
>> uses data (CSVs on your local hard drive) and functions (in
>> functions.R) that no one else has access to.  And you suspect the
>> error is related to one of those functions...
>>
>> > Thanks in advance. Much appreciated.
>> >
>> > G
>> >
>> >
>> > ##########################################################################
>> > rm(list = ls(all = TRUE))
>> > setwd("/Users/mm/Documents/R")
>> > library(lattice)
>> > library(timeSeries)
>> > library(timeDate)
>> > library(PerformanceAnalytics)
>> > library(quantmod)
>> > library(xts)
>> > library(blotter)
>> > library(TTR)
>> > library(quantstrat)
>> > library(FinancialInstrument)
>> > source("functions.R")
>> >
>> > setwd("/Users/mm/Documents/R/UAE")
>> > options("getSymbols.warning4.0" = FALSE)
>> > #sessionInfo()
>> >
>> > startDate = "2015-07-01"
>> > symbols <- c("DFMC", "ARTC", "EMAARMALLS", "DUBAIPARKS")
>> > Sys.setenv(TZ="UTC")
>> >
>> > getSymbols("DFM", src="csv",
>> > col.names=c("Open","High","Low","Close","Volume"))
>> > getSymbols(symbols, src="csv",
>> > col.names=c("Open","High","Low","Close","Volume"))
>> >
>> >
>> > initDate <- "2015-07-01"
>> > initEq <- 100000
>> > tradeSize <- initEq/length(symbols)
>> > currency("USD")
>> > stock(symbols, currency="USD",multiplier=1)
>> >
>> > myTheme<-chart_theme()
>> > myTheme$col$dn.col<- 'lightblue'
>> > myTheme$col$dn.border <-  'lightgray'
>> > myTheme$col$up.border <-  'lightgray'
>> >
>> >
>> > par(mfrow=c(2,2))
>> > for(symbol in symbols)
>> > {
>> >   plot(chart_Series(get(symbol),name=symbol))
>> > }
>> > par(mfrow=c(1,1))
>> >
>> >
>> > if(exists('.strategy')) rm.strat(qs.strategy)
>> > if(!exists('.blotter')) .blotter <- new.env()
>> > if(!exists('.strategy')) .strategy <- new.env()
>> >
>> > qs.strategy <- "AD26"
>> > initPortf(qs.strategy, symbols, initDate=initDate)
>> > initAcct(qs.strategy,portfolios=qs.strategy, initDate=initDate,
>> > initEq=initEq)
>> > initOrders(portfolio=qs.strategy,initDate=initDate)
>> > strategy(qs.strategy,store=TRUE)
>> >
>> > add.indicator("AD26", name = "RT",
>> >               arguments = list(x=quote(OHLC(mktdata))),label= "RT")
>> >
>> > summary(getStrategy(qs.strategy))
>> >
>> >
>> > #########################################################################
>> >
>> > add.signal(qs.strategy, name="sigCrossover",
>> > arguments=list(columns=c("Close", "RT"), relationship="gte"),
>> > label="Buy")
>> >
>> > add.signal(qs.strategy, name="sigCrossover",
>> > arguments=list(columns=c("Close", "RT"), relationship="lt"),
>> > label="Sell")
>> >
>> >
>> > #########################################################################
>> >
>> > summary(getStrategy(qs.strategy))
>> >
>> >
>> > #########################################################################
>> >
>> > add.rule(qs.strategy, name='ruleSignal',
>> >          arguments = list(sigcol="Buy", sigval=TRUE,
>> >                           prefer ="open",
>> >                           replace = FALSE,
>> >                           orderqty = 10,
>> >                           osFUN = "osFixedDollar",
>> >                           ordertype='market',
>> >                           orderside='long',
>> >                           TxnFees=-5,
>> >                           orderset ="ocolong"
>> >          ),
>> >          type='enter',
>> >          label = 'LE'
>> > )
>> >
>> > add.rule(qs.strategy, name='ruleSignal',
>> >          arguments = list(sigcol="Sell", sigval=TRUE,
>> >                           replace = TRUE,
>> >                           prefer ="open",
>> >                           orderqty="all",
>> >                           ordertype='market',
>> >                           orderside='long',
>> >                           TxnFees=-5,
>> >                           orderset = "ocolong"
>> >          ),
>> >          type='exit',
>> >          label = "LX"
>> > )
>> >
>> > add.rule(qs.strategy, name='ruleSignal',
>> >          arguments = list(sigcol="Buy", sigval=TRUE,
>> >                           replace =FALSE,
>> >                           orderqty="all",
>> >                           ordertype='stoplimit',
>> >                           orderside='long',
>> >                           tmult = TRUE,
>> >                           threshold = quote(stopLossPercent),
>> >                           TxnFees=-5,
>> >                           orderset = "ocolong"
>> >          ),
>> >          type='chain',
>> >          parent = "LE",
>> >          label = "StopLossLong",
>> >          enabled = FALSE
>> > )
>> >
>> > summary(getStrategy(qs.strategy))
>> >
>> > #enable.rule(qs.strategy, type="chain", label ="StopLoss")
>> >
>> > applyStrategy(strategy=qs.strategy , portfolios=qs.strategy,
>> > verbose=TRUE)
>> >
>> > updatePortf(qs.strategy)
>> > updateAcct(qs.strategy)
>> > updateEndEq(qs.strategy)
>> >
>> > checkBlotterUpdate("AD26", "AD26")
>> >
>> > ##################################################################
>> >
>> > OUTPUT:
>> >
>> <snip>
>> >> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy,
>> >> verbose=TRUE)
>> > *Error in array(x, c(length(x), 1L), if (!is.null(names(x)))
>> > list(names(x),
>> >  : *
>> > *  'data' must be of a vector type, was 'NULL'*
>> > *In addition: Warning messages:*
>> > *1: In min(j, na.rm = TRUE) :*
>> > *  no non-missing arguments to min; returning Inf*
>> > *2: In max(j, na.rm = TRUE) :*
>> > *  no non-missing arguments to max; returning -Inf*
>> > *Called from: array(x, c(length(x), 1L), if (!is.null(names(x)))
>> > list(names(x), *
>> > *    NULL) else NULL)*
>> > Browse[1]>
>> >> updatePortf(qs.strategy)
>> > [1] "AD26"
>> >> updateAcct(qs.strategy)
>> > [1] "AD26"
>> >> updateEndEq(qs.strategy)
>> > [1] "AD26"
>> >>
>> >> checkBlotterUpdate("AD26", "AD26")
>> > [1] TRUE
>> >>
>> >> sessionInfo()
>> > R version 3.2.4 (2016-03-10)
>> > Platform: x86_64-apple-darwin13.4.0 (64-bit)
>> > Running under: OS X 10.11.6 (El Capitan)
>> >
>> > locale:
>> > [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > other attached packages:
>> >  [1] quantstrat_0.9.1739           foreach_1.4.3
>> > blotter_0.9.1741
>> >  [4] FinancialInstrument_1.2.0     quantmod_0.4-5
>> > TTR_0.23-1
>> >
>> >  [7] PerformanceAnalytics_1.4.3541 xts_0.9-7
>> > zoo_1.7-13
>> >
>> > [10] timeSeries_3022.101.2         timeDate_3012.100
>> > lattice_0.20-33
>> >
>> > loaded via a namespace (and not attached):
>> > [1] rsconnect_0.4.2.2 tools_3.2.4       codetools_0.2-14  grid_3.2.4
>> >  iterators_1.0.8
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-SIG-Finance at r-project.org mailing list
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>> > -- Subscriber-posting only. If you want to post, subscribe first.
>> > -- Also note that this is not the r-help list where general R questions
>> > should go.
>>
>>
>>
>> --
>> Joshua Ulrich  |  about.me/joshuaulrich
>> FOSS Trading  |  www.fosstrading.com
>> R/Finance 2016 | www.rinfinance.com
>
>



-- 
Joshua Ulrich  |  about.me/joshuaulrich
FOSS Trading  |  www.fosstrading.com
R/Finance 2016 | www.rinfinance.com


From gttga2000 at yahoo.com  Wed Aug 10 13:56:12 2016
From: gttga2000 at yahoo.com (AIE ATUMA)
Date: Wed, 10 Aug 2016 11:56:12 +0000 (UTC)
Subject: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy
 with 'data' must be of a vector type, was 'NULL'
In-Reply-To: <CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>
References: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>
	<CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>
Message-ID: <118812197.430413.1470830172592.JavaMail.yahoo@mail.yahoo.com>

Dear Joshua,
Sequel to your response below, what package can other nationals whose data are not in R use to do analysis and manage assets??Thank You and Best Regards,?EmekaIntegrity is work your talk don't talk your work

      From: Joshua Ulrich <josh.m.ulrich at gmail.com>
 To: golam sakline <golam.sakline at gmail.com> 
Cc: r-sig-finance <r-sig-finance at r-project.org>
 Sent: Monday, 8 August 2016, 13:58
 Subject: Re: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy with 'data' must be of a vector type, was 'NULL'
   
On Mon, Aug 8, 2016 at 7:48 AM, golam sakline <golam.sakline at gmail.com> wrote:
> Hi All,
>
> I have an error at applyStrategy that is failing with "Error in array(x,
> c(length(x), 1L), if (!is.null(names(x))) list(names(x),? : 'data' must be
> of a vector type, was 'NULL'" .
> I believe the problem is occurring at add.indicator function "RT" that
> takes in OHLC(mktdata) data and outputs an univariate series.
> This error doesn't occur when I replace RT with MACD function that takes in
> Cl(mktdata) rather than OHLC.
> This error doesn't occur when I am using RT function with a single asset in
> the symbol i.e. the length(symbol) = 1.
>
> What am I doing wrong or missing here?
>
It is nearly impossible for anyone to help you because your example
uses data (CSVs on your local hard drive) and functions (in
functions.R) that no one else has access to.? And you suspect the
error is related to one of those functions...

> Thanks in advance. Much appreciated.
>
> G
>
> ##########################################################################
> rm(list = ls(all = TRUE))
> setwd("/Users/mm/Documents/R")
> library(lattice)
> library(timeSeries)
> library(timeDate)
> library(PerformanceAnalytics)
> library(quantmod)
> library(xts)
> library(blotter)
> library(TTR)
> library(quantstrat)
> library(FinancialInstrument)
> source("functions.R")
>
> setwd("/Users/mm/Documents/R/UAE")
> options("getSymbols.warning4.0" = FALSE)
> #sessionInfo()
>
> startDate = "2015-07-01"
> symbols <- c("DFMC", "ARTC", "EMAARMALLS", "DUBAIPARKS")
> Sys.setenv(TZ="UTC")
>
> getSymbols("DFM", src="csv",
> col.names=c("Open","High","Low","Close","Volume"))
> getSymbols(symbols, src="csv",
> col.names=c("Open","High","Low","Close","Volume"))
>
>
> initDate <- "2015-07-01"
> initEq <- 100000
> tradeSize <- initEq/length(symbols)
> currency("USD")
> stock(symbols, currency="USD",multiplier=1)
>
> myTheme<-chart_theme()
> myTheme$col$dn.col<- 'lightblue'
> myTheme$col$dn.border <-? 'lightgray'
> myTheme$col$up.border <-? 'lightgray'
>
>
> par(mfrow=c(2,2))
> for(symbol in symbols)
> {
>? plot(chart_Series(get(symbol),name=symbol))
> }
> par(mfrow=c(1,1))
>
>
> if(exists('.strategy')) rm.strat(qs.strategy)
> if(!exists('.blotter')) .blotter <- new.env()
> if(!exists('.strategy')) .strategy <- new.env()
>
> qs.strategy <- "AD26"
> initPortf(qs.strategy, symbols, initDate=initDate)
> initAcct(qs.strategy,portfolios=qs.strategy, initDate=initDate,
> initEq=initEq)
> initOrders(portfolio=qs.strategy,initDate=initDate)
> strategy(qs.strategy,store=TRUE)
>
> add.indicator("AD26", name = "RT",
>? ? ? ? ? ? ? arguments = list(x=quote(OHLC(mktdata))),label= "RT")
>
> summary(getStrategy(qs.strategy))
>
> #########################################################################
>
> add.signal(qs.strategy, name="sigCrossover",
> arguments=list(columns=c("Close", "RT"), relationship="gte"), label="Buy")
>
> add.signal(qs.strategy, name="sigCrossover",
> arguments=list(columns=c("Close", "RT"), relationship="lt"), label="Sell")
>
> #########################################################################
>
> summary(getStrategy(qs.strategy))
>
> #########################################################################
>
> add.rule(qs.strategy, name='ruleSignal',
>? ? ? ? ? arguments = list(sigcol="Buy", sigval=TRUE,
>? ? ? ? ? ? ? ? ? ? ? ? ? prefer ="open",
>? ? ? ? ? ? ? ? ? ? ? ? ? replace = FALSE,
>? ? ? ? ? ? ? ? ? ? ? ? ? orderqty = 10,
>? ? ? ? ? ? ? ? ? ? ? ? ? osFUN = "osFixedDollar",
>? ? ? ? ? ? ? ? ? ? ? ? ? ordertype='market',
>? ? ? ? ? ? ? ? ? ? ? ? ? orderside='long',
>? ? ? ? ? ? ? ? ? ? ? ? ? TxnFees=-5,
>? ? ? ? ? ? ? ? ? ? ? ? ? orderset ="ocolong"
>? ? ? ? ? ),
>? ? ? ? ? type='enter',
>? ? ? ? ? label = 'LE'
> )
>
> add.rule(qs.strategy, name='ruleSignal',
>? ? ? ? ? arguments = list(sigcol="Sell", sigval=TRUE,
>? ? ? ? ? ? ? ? ? ? ? ? ? replace = TRUE,
>? ? ? ? ? ? ? ? ? ? ? ? ? prefer ="open",
>? ? ? ? ? ? ? ? ? ? ? ? ? orderqty="all",
>? ? ? ? ? ? ? ? ? ? ? ? ? ordertype='market',
>? ? ? ? ? ? ? ? ? ? ? ? ? orderside='long',
>? ? ? ? ? ? ? ? ? ? ? ? ? TxnFees=-5,
>? ? ? ? ? ? ? ? ? ? ? ? ? orderset = "ocolong"
>? ? ? ? ? ),
>? ? ? ? ? type='exit',
>? ? ? ? ? label = "LX"
> )
>
> add.rule(qs.strategy, name='ruleSignal',
>? ? ? ? ? arguments = list(sigcol="Buy", sigval=TRUE,
>? ? ? ? ? ? ? ? ? ? ? ? ? replace =FALSE,
>? ? ? ? ? ? ? ? ? ? ? ? ? orderqty="all",
>? ? ? ? ? ? ? ? ? ? ? ? ? ordertype='stoplimit',
>? ? ? ? ? ? ? ? ? ? ? ? ? orderside='long',
>? ? ? ? ? ? ? ? ? ? ? ? ? tmult = TRUE,
>? ? ? ? ? ? ? ? ? ? ? ? ? threshold = quote(stopLossPercent),
>? ? ? ? ? ? ? ? ? ? ? ? ? TxnFees=-5,
>? ? ? ? ? ? ? ? ? ? ? ? ? orderset = "ocolong"
>? ? ? ? ? ),
>? ? ? ? ? type='chain',
>? ? ? ? ? parent = "LE",
>? ? ? ? ? label = "StopLossLong",
>? ? ? ? ? enabled = FALSE
> )
>
> summary(getStrategy(qs.strategy))
>
> #enable.rule(qs.strategy, type="chain", label ="StopLoss")
>
> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)
>
> updatePortf(qs.strategy)
> updateAcct(qs.strategy)
> updateEndEq(qs.strategy)
>
> checkBlotterUpdate("AD26", "AD26")
>
> ##################################################################
>
> OUTPUT:
>
<snip>
>> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)
> *Error in array(x, c(length(x), 1L), if (!is.null(names(x))) list(names(x),
>? : *
> *? 'data' must be of a vector type, was 'NULL'*
> *In addition: Warning messages:*
> *1: In min(j, na.rm = TRUE) :*
> *? no non-missing arguments to min; returning Inf*
> *2: In max(j, na.rm = TRUE) :*
> *? no non-missing arguments to max; returning -Inf*
> *Called from: array(x, c(length(x), 1L), if (!is.null(names(x)))
> list(names(x), *
> *? ? NULL) else NULL)*
> Browse[1]>
>> updatePortf(qs.strategy)
> [1] "AD26"
>> updateAcct(qs.strategy)
> [1] "AD26"
>> updateEndEq(qs.strategy)
> [1] "AD26"
>>
>> checkBlotterUpdate("AD26", "AD26")
> [1] TRUE
>>
>> sessionInfo()
> R version 3.2.4 (2016-03-10)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.11.6 (El Capitan)
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats? ? graphics? grDevices utils? ? datasets? methods? base
>
> other attached packages:
>? [1] quantstrat_0.9.1739? ? ? ? ? foreach_1.4.3
> blotter_0.9.1741
>? [4] FinancialInstrument_1.2.0? ? quantmod_0.4-5? ? ? ? ? ? ? ? TTR_0.23-1
>
>? [7] PerformanceAnalytics_1.4.3541 xts_0.9-7? ? ? ? ? ? ? ? ? ? zoo_1.7-13
>
> [10] timeSeries_3022.101.2? ? ? ? timeDate_3012.100
> lattice_0.20-33
>
> loaded via a namespace (and not attached):
> [1] rsconnect_0.4.2.2 tools_3.2.4? ? ? codetools_0.2-14? grid_3.2.4
>? iterators_1.0.8
>
>? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.



-- 
Joshua Ulrich? |? about.me/joshuaulrich
FOSS Trading? |? www.fosstrading.com
R/Finance 2016 | www.rinfinance.com

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.


  
	[[alternative HTML version deleted]]


From brian at braverock.com  Wed Aug 10 14:15:39 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Wed, 10 Aug 2016 07:15:39 -0500
Subject: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy
 with 'data' must be of a vector type, was 'NULL'
In-Reply-To: <118812197.430413.1470830172592.JavaMail.yahoo@mail.yahoo.com>
References: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>
	<CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>
	<118812197.430413.1470830172592.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1470831339.7874.3.camel@brian-rcg>

On Wed, 2016-08-10 at 11:56 +0000, AIE ATUMA via R-SIG-Finance wrote:
> Sequel to your response below, what package can other nationals whose
> data are not in R use to do analysis and manage assets?
> 
I don't see that this question has anything to do with the thread.  If
you have a new question, please post with a new subject line, so that
people who use threaded email readers can see that it is a new thread.

People get data from many sources.  That has been discussed on this list
countless times.

This is a list for using R in Finance.  So the only answer to the second
half of your question is to take your data and put it into R, where
there are many many packages available for doing the analysis.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From gttga2000 at yahoo.com  Wed Aug 10 15:34:10 2016
From: gttga2000 at yahoo.com (AIE ATUMA)
Date: Wed, 10 Aug 2016 13:34:10 +0000 (UTC)
Subject: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy
 with 'data' must be of a vector type, was 'NULL'
In-Reply-To: <1470831339.7874.3.camel@brian-rcg>
References: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>
	<CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>
	<118812197.430413.1470830172592.JavaMail.yahoo@mail.yahoo.com>
	<1470831339.7874.3.camel@brian-rcg>
Message-ID: <144355907.574531.1470836051003@mail.yahoo.com>

Hi Brian,
This was the thread I raised my question on;
It is nearly impossible for anyone to help you because your example
uses data (CSVs on your local hard drive) and functions (in
functions.R) that no one else has access to.? And you suspect the
error is related to one of those functions..
?Thank You and Best Regards,Emeka

      From: Brian G. Peterson <brian at braverock.com>
 To: AIE ATUMA <gttga2000 at yahoo.com> 
Cc: r-sig-finance <r-sig-finance at r-project.org>
 Sent: Wednesday, 10 August 2016, 13:15
 Subject: Re: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy with 'data' must be of a vector type, was 'NULL'
   
On Wed, 2016-08-10 at 11:56 +0000, AIE ATUMA via R-SIG-Finance wrote:
> Sequel to your response below, what package can other nationals whose
> data are not in R use to do analysis and manage assets?
> 
I don't see that this question has anything to do with the thread.? If
you have a new question, please post with a new subject line, so that
people who use threaded email readers can see that it is a new thread.

People get data from many sources.? That has been discussed on this list
countless times.

This is a list for using R in Finance.? So the only answer to the second
half of your question is to take your data and put it into R, where
there are many many packages available for doing the analysis.

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock






   
	[[alternative HTML version deleted]]


From golam.sakline at gmail.com  Fri Aug 12 12:28:35 2016
From: golam.sakline at gmail.com (golam sakline)
Date: Fri, 12 Aug 2016 14:28:35 +0400
Subject: [R-SIG-Finance] Multi Asset portfolio failing at applyStrategy
 with 'data' must be of a vector type, was 'NULL'
In-Reply-To: <CAPPM_gR8F0GgnM8TPLGeK52=XxyV+1D4M=V8aJMQOXgBG=M3uw@mail.gmail.com>
References: <CAHmZ1ZvgyqkHWxGW=fi3v946g52xUxKgGHsrNYErjdV+JjbwEg@mail.gmail.com>
	<CAPPM_gQz0EvF_9UOzv5Su5J_3OEeNFHe+aOwV_SpiBmZ8qvW5w@mail.gmail.com>
	<CAPPM_gR8F0GgnM8TPLGeK52=XxyV+1D4M=V8aJMQOXgBG=M3uw@mail.gmail.com>
Message-ID: <CAHmZ1Zu4Lv6DCraVDODuLXoHoiiwEAO=qzm06LUuStU0co+a0g@mail.gmail.com>

Hi Joshua,

I have found the problem and it is not within the code. There was a problem
with one of the CSV files with "NA" data cells.

Thanks & Regards

Golam

On Wed, Aug 10, 2016 at 3:41 AM, Joshua Ulrich <josh.m.ulrich at gmail.com>
wrote:

> Please keep your replies on-list, so others can follow/contribute.
>
> On Mon, Aug 8, 2016 at 9:59 AM, golam sakline <golam.sakline at gmail.com>
> wrote:
> > RT is the function you wrote here...
> >
> > http://stackoverflow.com/questions/5554220/r-
> statistics-average-true-range-trailing-stop-indicator
> >
> > RT <- function(x)
> > {
> >   x$stopLongATR <- -3.5*ATR(HLC(x),5)[,"atr"]
> >   x$stopShortATR <- 3.5*ATR(HLC(x),5)[,"atr"]
> >
> >
> >   x$CR <- Cl(x)
> >   x$x.lagCl <- lag(Cl(x))
> >
> >   for(i in 6:NROW(x)) {
> >     trail1 <- coredata(x$CR[i-1])
> >
> >     if(Cl(x)[i] > trail1 && x$x.lagCl[i] > trail1) {
> >       x$CR[i] <- max(trail1,coredata(Cl(x)[i]+x$stopLongATR[i]))
> >     } else
> >       if(Cl(x)[i] < trail1 && x$x.lagCl[i] < trail1) {
> >         x$CR[i] <- min(trail1,coredata(Cl(x)[i]+x$stopShortATR[i]))
> >       } else
> >         if(Cl(x)[i] > trail1) {
> >           x$CR[i] <- coredata(Cl(x)[i]+x$stopLongATR[i])
> >         } else {
> >           x$CR[i] <- coredata(Cl(x)[i]+x$stopShortATR[i])
> >         }
> >   }
> >   x$CR
> > }
> >
> You still need to provide data, and _all_ the relevant functions.
> osFixedDollar is still missing.  I assume the function you used is a
> version of the function from Guy Yollin's presentations:
>
> osFixedDollar <- function(timestamp, orderqty, portfolio, symbol,
> ruletype, ...)
> {
>   ClosePrice <- as.numeric(Cl(mktdata[timestamp,]))
>   orderqty <- round(tradeSize/ClosePrice,-2)
>   return(orderqty)
> }
>
>
> Your strategy runs fine for me using SPY data from Yahoo Finance, and
> the latest version of quantstrat, blotter, and xts from GitHub. Here's
> a version with many extraneous components removed.
>
>
> require(quantstrat)
>
> symbols <- c("SPY")
> Sys.setenv(TZ="UTC")
>
> getSymbols(symbols)
>
> initEq <- 100000
> tradeSize <- initEq/length(symbols)
> currency("USD")
> stock(symbols, currency="USD",multiplier=1)
>
> if(exists('.strategy')) rm.strat(qs.strategy)
> if(!exists('.blotter')) .blotter <- new.env()
> if(!exists('.strategy')) .strategy <- new.env()
>
> qs.strategy <- "AD26"
> initPortf(qs.strategy, symbols)
> initAcct(qs.strategy,portfolios=qs.strategy, initEq=initEq)
> initOrders(portfolio=qs.strategy)
> strategy(qs.strategy,store=TRUE)
>
> add.indicator("AD26", name = "RT",
>               arguments = list(x=quote(OHLC(mktdata))),label= "RT")
>
> add.signal(qs.strategy, name="sigCrossover",
> arguments=list(columns=c("Close", "RT"), relationship="gte"), label="Buy")
>
> add.signal(qs.strategy, name="sigCrossover",
> arguments=list(columns=c("Close", "RT"), relationship="lt"), label="Sell")
>
> add.rule(qs.strategy, name='ruleSignal',
>          arguments = list(sigcol="Buy", sigval=TRUE,
>                           prefer ="open",
>                           replace = FALSE,
>                           orderqty = 10,
>                           osFUN = "osFixedDollar",
>                           ordertype='market',
>                           orderside='long',
>                           TxnFees=-5,
>                           orderset ="ocolong"
>          ),
>          type='enter',
>          label = 'LE'
> )
>
> add.rule(qs.strategy, name='ruleSignal',
>          arguments = list(sigcol="Sell", sigval=TRUE,
>                           replace = TRUE,
>                           prefer ="open",
>                           orderqty="all",
>                           ordertype='market',
>                           orderside='long',
>                           TxnFees=-5,
>                           orderset = "ocolong"
>          ),
>          type='exit',
>          label = "LX"
> )
>
> add.rule(qs.strategy, name='ruleSignal',
>          arguments = list(sigcol="Buy", sigval=TRUE,
>                           replace =FALSE,
>                           orderqty="all",
>                           ordertype='stoplimit',
>                           orderside='long',
>                           tmult = TRUE,
>                           threshold = quote(stopLossPercent),
>                           TxnFees=-5,
>                           orderset = "ocolong"
>          ),
>          type='chain',
>          parent = "LE",
>          label = "StopLossLong",
>          enabled = FALSE
> )
>
> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy, verbose=TRUE)
>
> updatePortf(qs.strategy)
> updateAcct(qs.strategy)
> updateEndEq(qs.strategy)
>
>
>
> Here's my sessionInfo() output:
> R> sessionInfo()
> R version 3.3.1 (2016-06-21)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Ubuntu 16.04.1 LTS
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] quantstrat_0.9.1739           foreach_1.4.2
> [3] blotter_0.10.2                PerformanceAnalytics_1.4.3541
> [5] FinancialInstrument_1.2.0     quantmod_0.4-5
> [7] TTR_0.23-1                    xts_0.10-0
> [9] zoo_1.7-13
>
> loaded via a namespace (and not attached):
> [1] codetools_0.2-14 grid_3.3.1       iterators_1.0.7  boot_1.3-18
> [5] lattice_0.20-33
>
> >
> > On Mon, Aug 8, 2016 at 4:58 PM, Joshua Ulrich <josh.m.ulrich at gmail.com>
> > wrote:
> >>
> >> On Mon, Aug 8, 2016 at 7:48 AM, golam sakline <golam.sakline at gmail.com>
> >> wrote:
> >> > Hi All,
> >> >
> >> > I have an error at applyStrategy that is failing with "Error in
> array(x,
> >> > c(length(x), 1L), if (!is.null(names(x))) list(names(x),  : 'data'
> must
> >> > be
> >> > of a vector type, was 'NULL'" .
> >> > I believe the problem is occurring at add.indicator function "RT" that
> >> > takes in OHLC(mktdata) data and outputs an univariate series.
> >> > This error doesn't occur when I replace RT with MACD function that
> takes
> >> > in
> >> > Cl(mktdata) rather than OHLC.
> >> > This error doesn't occur when I am using RT function with a single
> asset
> >> > in
> >> > the symbol i.e. the length(symbol) = 1.
> >> >
> >> > What am I doing wrong or missing here?
> >> >
> >> It is nearly impossible for anyone to help you because your example
> >> uses data (CSVs on your local hard drive) and functions (in
> >> functions.R) that no one else has access to.  And you suspect the
> >> error is related to one of those functions...
> >>
> >> > Thanks in advance. Much appreciated.
> >> >
> >> > G
> >> >
> >> >
> >> > ############################################################
> ##############
> >> > rm(list = ls(all = TRUE))
> >> > setwd("/Users/mm/Documents/R")
> >> > library(lattice)
> >> > library(timeSeries)
> >> > library(timeDate)
> >> > library(PerformanceAnalytics)
> >> > library(quantmod)
> >> > library(xts)
> >> > library(blotter)
> >> > library(TTR)
> >> > library(quantstrat)
> >> > library(FinancialInstrument)
> >> > source("functions.R")
> >> >
> >> > setwd("/Users/mm/Documents/R/UAE")
> >> > options("getSymbols.warning4.0" = FALSE)
> >> > #sessionInfo()
> >> >
> >> > startDate = "2015-07-01"
> >> > symbols <- c("DFMC", "ARTC", "EMAARMALLS", "DUBAIPARKS")
> >> > Sys.setenv(TZ="UTC")
> >> >
> >> > getSymbols("DFM", src="csv",
> >> > col.names=c("Open","High","Low","Close","Volume"))
> >> > getSymbols(symbols, src="csv",
> >> > col.names=c("Open","High","Low","Close","Volume"))
> >> >
> >> >
> >> > initDate <- "2015-07-01"
> >> > initEq <- 100000
> >> > tradeSize <- initEq/length(symbols)
> >> > currency("USD")
> >> > stock(symbols, currency="USD",multiplier=1)
> >> >
> >> > myTheme<-chart_theme()
> >> > myTheme$col$dn.col<- 'lightblue'
> >> > myTheme$col$dn.border <-  'lightgray'
> >> > myTheme$col$up.border <-  'lightgray'
> >> >
> >> >
> >> > par(mfrow=c(2,2))
> >> > for(symbol in symbols)
> >> > {
> >> >   plot(chart_Series(get(symbol),name=symbol))
> >> > }
> >> > par(mfrow=c(1,1))
> >> >
> >> >
> >> > if(exists('.strategy')) rm.strat(qs.strategy)
> >> > if(!exists('.blotter')) .blotter <- new.env()
> >> > if(!exists('.strategy')) .strategy <- new.env()
> >> >
> >> > qs.strategy <- "AD26"
> >> > initPortf(qs.strategy, symbols, initDate=initDate)
> >> > initAcct(qs.strategy,portfolios=qs.strategy, initDate=initDate,
> >> > initEq=initEq)
> >> > initOrders(portfolio=qs.strategy,initDate=initDate)
> >> > strategy(qs.strategy,store=TRUE)
> >> >
> >> > add.indicator("AD26", name = "RT",
> >> >               arguments = list(x=quote(OHLC(mktdata))),label= "RT")
> >> >
> >> > summary(getStrategy(qs.strategy))
> >> >
> >> >
> >> > ############################################################
> #############
> >> >
> >> > add.signal(qs.strategy, name="sigCrossover",
> >> > arguments=list(columns=c("Close", "RT"), relationship="gte"),
> >> > label="Buy")
> >> >
> >> > add.signal(qs.strategy, name="sigCrossover",
> >> > arguments=list(columns=c("Close", "RT"), relationship="lt"),
> >> > label="Sell")
> >> >
> >> >
> >> > ############################################################
> #############
> >> >
> >> > summary(getStrategy(qs.strategy))
> >> >
> >> >
> >> > ############################################################
> #############
> >> >
> >> > add.rule(qs.strategy, name='ruleSignal',
> >> >          arguments = list(sigcol="Buy", sigval=TRUE,
> >> >                           prefer ="open",
> >> >                           replace = FALSE,
> >> >                           orderqty = 10,
> >> >                           osFUN = "osFixedDollar",
> >> >                           ordertype='market',
> >> >                           orderside='long',
> >> >                           TxnFees=-5,
> >> >                           orderset ="ocolong"
> >> >          ),
> >> >          type='enter',
> >> >          label = 'LE'
> >> > )
> >> >
> >> > add.rule(qs.strategy, name='ruleSignal',
> >> >          arguments = list(sigcol="Sell", sigval=TRUE,
> >> >                           replace = TRUE,
> >> >                           prefer ="open",
> >> >                           orderqty="all",
> >> >                           ordertype='market',
> >> >                           orderside='long',
> >> >                           TxnFees=-5,
> >> >                           orderset = "ocolong"
> >> >          ),
> >> >          type='exit',
> >> >          label = "LX"
> >> > )
> >> >
> >> > add.rule(qs.strategy, name='ruleSignal',
> >> >          arguments = list(sigcol="Buy", sigval=TRUE,
> >> >                           replace =FALSE,
> >> >                           orderqty="all",
> >> >                           ordertype='stoplimit',
> >> >                           orderside='long',
> >> >                           tmult = TRUE,
> >> >                           threshold = quote(stopLossPercent),
> >> >                           TxnFees=-5,
> >> >                           orderset = "ocolong"
> >> >          ),
> >> >          type='chain',
> >> >          parent = "LE",
> >> >          label = "StopLossLong",
> >> >          enabled = FALSE
> >> > )
> >> >
> >> > summary(getStrategy(qs.strategy))
> >> >
> >> > #enable.rule(qs.strategy, type="chain", label ="StopLoss")
> >> >
> >> > applyStrategy(strategy=qs.strategy , portfolios=qs.strategy,
> >> > verbose=TRUE)
> >> >
> >> > updatePortf(qs.strategy)
> >> > updateAcct(qs.strategy)
> >> > updateEndEq(qs.strategy)
> >> >
> >> > checkBlotterUpdate("AD26", "AD26")
> >> >
> >> > ##################################################################
> >> >
> >> > OUTPUT:
> >> >
> >> <snip>
> >> >> applyStrategy(strategy=qs.strategy , portfolios=qs.strategy,
> >> >> verbose=TRUE)
> >> > *Error in array(x, c(length(x), 1L), if (!is.null(names(x)))
> >> > list(names(x),
> >> >  : *
> >> > *  'data' must be of a vector type, was 'NULL'*
> >> > *In addition: Warning messages:*
> >> > *1: In min(j, na.rm = TRUE) :*
> >> > *  no non-missing arguments to min; returning Inf*
> >> > *2: In max(j, na.rm = TRUE) :*
> >> > *  no non-missing arguments to max; returning -Inf*
> >> > *Called from: array(x, c(length(x), 1L), if (!is.null(names(x)))
> >> > list(names(x), *
> >> > *    NULL) else NULL)*
> >> > Browse[1]>
> >> >> updatePortf(qs.strategy)
> >> > [1] "AD26"
> >> >> updateAcct(qs.strategy)
> >> > [1] "AD26"
> >> >> updateEndEq(qs.strategy)
> >> > [1] "AD26"
> >> >>
> >> >> checkBlotterUpdate("AD26", "AD26")
> >> > [1] TRUE
> >> >>
> >> >> sessionInfo()
> >> > R version 3.2.4 (2016-03-10)
> >> > Platform: x86_64-apple-darwin13.4.0 (64-bit)
> >> > Running under: OS X 10.11.6 (El Capitan)
> >> >
> >> > locale:
> >> > [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
> >> >
> >> > attached base packages:
> >> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >> >
> >> > other attached packages:
> >> >  [1] quantstrat_0.9.1739           foreach_1.4.3
> >> > blotter_0.9.1741
> >> >  [4] FinancialInstrument_1.2.0     quantmod_0.4-5
> >> > TTR_0.23-1
> >> >
> >> >  [7] PerformanceAnalytics_1.4.3541 xts_0.9-7
> >> > zoo_1.7-13
> >> >
> >> > [10] timeSeries_3022.101.2         timeDate_3012.100
> >> > lattice_0.20-33
> >> >
> >> > loaded via a namespace (and not attached):
> >> > [1] rsconnect_0.4.2.2 tools_3.2.4       codetools_0.2-14  grid_3.2.4
> >> >  iterators_1.0.8
> >> >
> >> >         [[alternative HTML version deleted]]
> >> >
> >> > _______________________________________________
> >> > R-SIG-Finance at r-project.org mailing list
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> >> > -- Subscriber-posting only. If you want to post, subscribe first.
> >> > -- Also note that this is not the r-help list where general R
> questions
> >> > should go.
> >>
> >>
> >>
> >> --
> >> Joshua Ulrich  |  about.me/joshuaulrich
> >> FOSS Trading  |  www.fosstrading.com
> >> R/Finance 2016 | www.rinfinance.com
> >
> >
>
>
>
> --
> Joshua Ulrich  |  about.me/joshuaulrich
> FOSS Trading  |  www.fosstrading.com
> R/Finance 2016 | www.rinfinance.com
>

	[[alternative HTML version deleted]]


From erol.biceroglu at alumni.utoronto.ca  Sat Aug 13 06:26:41 2016
From: erol.biceroglu at alumni.utoronto.ca (Erol Biceroglu)
Date: Sat, 13 Aug 2016 00:26:41 -0400
Subject: [R-SIG-Finance] Attempting to switch between instruments in
	quantstrat
Message-ID: <CACjNfmkXj8=4A6MdQGbV-veOrZsOmELe8aKe5JJyBPwK6q6GAA@mail.gmail.com>

Hello,

I have another quantstrat-related question I was hoping someone could
help me with.

There's no error this time (at least I think), it's probably how I'm
setting it up, however any feedback would be greatly appreciated.

So, what I'm *trying* to do, is get quantstrat to chose an instrument
in mktdata to apply the rules to based on the value of a variable
(here **decileThreshold**).  The idea is, if **decileThreshold** is
equal to 2, I only want to trade the 2nd instrument and ignore the
first.  Thus, I load the indicator and signal as usual, and then add
*another* signal to check if the instrument equals
**decileThreshold**.  Lastly, I then combine the previous signals with
**sigFormula** (which combines **decileThreshold** with the
indicator-signal) to generate the buy-rule.

The buy-rule, in theory, is only executed if the rule-signal is true
AND if the "instrument is equal to the **decileThreshold** threshold".

I'm trying to pack it all into one set of code since I *eventually*
want to optimize the volatility of the instrument. (I've cut out a lot
of stuff and have included only the bare minimum).

applyIndicators and applySignals work if I supply my own mktdata
matrix, where I really just merge the instruments.

What confuses me, is why applyRules works on the first instrument,
when my **decileThreshold** value should only make it applicable to
the second instrument?

This is likely extremely confusing, so please let me know how I can
clarify my objective any further.

Worst case, for my "real code", I have a work-around that involves
running each instrument separately within a for-loop.  However, I was
hoping that I can get this to work so that I can leverage the
optimization functionality within quantstrat.

Any thoughts, comments, or feedback would be greatly appreciated.

Thank you,

Session Info:

> sessionInfo()
R version 3.3.1 (2016-06-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.4 LTS

locale:
 [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C
LC_TIME=en_CA.UTF-8
 [4] LC_COLLATE=en_CA.UTF-8     LC_MONETARY=en_CA.UTF-8
LC_MESSAGES=en_CA.UTF-8
 [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C
LC_ADDRESS=C
[10] LC_TELEPHONE=C             LC_MEASUREMENT=en_CA.UTF-8
LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] quantstrat_0.9.1739           foreach_1.4.3
blotter_0.9.1695
[4] FinancialInstrument_1.2.0     quantmod_0.4-5
TTR_0.23-1
[7] PerformanceAnalytics_1.4.3541 xts_0.9.874
zoo_1.7-13

loaded via a namespace (and not attached):
[1] tools_3.3.1      codetools_0.2-14 grid_3.3.1       iterators_1.0.8
 lattice_0.20-33



MRE:
####################

library(xts)
library(PerformanceAnalytics)
library(quantmod)
library(TTR)
library(quantstrat)


getSymbols(Symbols = "SPY")
SPY <- SPY$SPY.Close

#create a more volatile copy
tmp <- diff(SPY)
tmp <- 1.5*tmp
SPY2 <- cumsum(rbind(SPY[1,],tmp[-1,]))
colnames(SPY2) <- "SPY2.Close"

#There we go...
# head(SPY)
# head(SPY2)

#Rename to fit into my "existing" code:
MAPortfolio1 <- SPY
MAPortfolio2 <- SPY2
rm(SPY,SPY2)
colnames(MAPortfolio1) <- "MAPortfolio1"
colnames(MAPortfolio2) <- "MAPortfolio2"


########################
# All this block does is loop through the instruments, and append a
constant vector to it
for(item in paste0("MAPortfolio",1:2)){
  tmp <- merge(get(item), rep(which(item ==
paste0("MAPortfolio",1:2)),nrow(get(item))))
  colnames(tmp) <- c(paste0(colnames(tmp)[1],".Close")
                     ,paste0("MAPortfolio",which(item ==
paste0("MAPortfolio",1:2)),".Ind")
  )
  command <- paste0("MAPortfolio",which(item ==
paste0("MAPortfolio",1:2))," <- ",quote(tmp))
  eval(parse(text = command))
}
rm(tmp)

# head(MAPortfolio1)
# head(MAPortfolio2)
#########################

startDate<-as.Date(index(MAPortfolio1)[1], format="%Y-%m-%d")
endDate<-as.Date(index(last(MAPortfolio1)), format="%Y-%m-%d")

currency("USD")


stock(primary_id = c("MAPortfolio1"),currency = "USD")
stock(primary_id = c("MAPortfolio2"),currency = "USD")

#name
maStrategy <-"MAStrategy"

#Date, one day before prices
strategyDate <- min(index(MAPortfolio1)) - 1

#*******************************
#Used to reset for testing
#rm.strat(maStrategy)
#rm(mktdata)
#*******************************

NumSh<-1
decileThreshold <- 2

maLag <- 5

if (!exists('.blotter')) .blotter <- new.env()
if (!exists('.strategy')) .strategy <- new.env()

#init portfolio and account
initPortf(name = maStrategy
          , symbols = as.list(paste0("MAPortfolio",1:2)) #as defined
in Financial instrument
          , initDate = strategyDate
)

initAcct(name = maStrategy
         ,portfolios = maStrategy
         ,initDate = strategyDate
         ,initEq = 1
)

#order book, and strategy
initOrders(portfolio = maStrategy
           , initDate = strategyDate
)

#position limits
addPosLimit(maStrategy, symbol = "MAPortfolio1", strategyDate, maxpos
= NumSh, longlevels = NumSh, minpos = 0)
addPosLimit(maStrategy, symbol = "MAPortfolio2", strategyDate, maxpos
= NumSh, longlevels = NumSh, minpos = 0)

strategy( maStrategy, store = TRUE)

###############################################
#add indicator
add.indicator(strategy = maStrategy
              , name = "EMA"
              , arguments = list(x =
quote(mktdata$MAPortfolio1.Close), n = quote(maLag))
              , label = "MAPortfolioma1"
)

add.indicator(strategy = maStrategy
              , name = "EMA"
              , arguments = list(x =
quote(mktdata$MAPortfolio2.Close), n = quote(maLag))
              , label = "MAPortfolioma2"
)
#################################################

#################################################
#MAPortfolio is greater than N-Lag Moving Average
add.signal(strategy = maStrategy
           , name = "sigComparison"
           , arguments = list(columns =
c("MAPortfolio1.Close","MAPortfolioma1")
                              , relationship = "gt"
           )
           , label = "MAPortfolio.gt.ma1"
)

add.signal(strategy = maStrategy
           , name = "sigComparison"
           , arguments = list(columns =
c("MAPortfolio2.Close","MAPortfolioma2")
                              , relationship = "gt"
           )
           , label = "MAPortfolio.gt.ma2"
)

#################################################

#MAPortfolio is less-than-equal-to N-Lag Moving Average
#################################################
add.signal(strategy = maStrategy
           , name = "sigComparison"
           , arguments = list(columns = c("MAPortfolio1.Close","MAPortfolioma1")
                              , relationship = "lte"
           )
           , label = "MAPortfolio.lte.ma1"
)

add.signal(strategy = maStrategy
           , name = "sigComparison"
           , arguments = list(columns = c("MAPortfolio2.Close","MAPortfolioma2")
                              , relationship = "lte"
           )
           , label = "MAPortfolio.lte.ma2"
)
#################################################

add.signal(strategy = maStrategy
           , name = "sigThreshold"
           , arguments = list(column = "MAPortfolio1.Ind"
                              , threshold = decileThreshold
                              , relationship = "eq"
           )
           , label = "MAPortfolio.dThresh1"
)

add.signal(strategy = maStrategy
           , name = "sigThreshold"
           , arguments = list(column = "MAPortfolio2.Ind"
                              , threshold = decileThreshold
                              , relationship = "eq"
           )
           , label = "MAPortfolio.dThresh2"
)
#################################################


#######
add.signal(strategy = maStrategy
           , name = "sigFormula"
           , arguments = list(formula = "MAPortfolio.dThresh1 == 1 &
MAPortfolio.gt.ma1 == 1")
           , label = "MAPortfolio.sig.buy1"
)

add.signal(strategy = maStrategy
           , name = "sigFormula"
           , arguments = list(formula = "MAPortfolio.dThresh1 == 1 &
MAPortfolio.lte.ma1 == 1")
           , label = "MAPortfolio.sig.sell1"
)
#######

#######
add.signal(strategy = maStrategy
           , name = "sigFormula"
           , arguments = list(formula = "MAPortfolio.dThresh2 == 1 &
MAPortfolio.gt.ma2 == 1")
           , label = "MAPortfolio.sig.buy2"
)

add.signal(strategy = maStrategy
           , name = "sigFormula"
           , arguments = list(formula = "MAPortfolio.dThresh2 == 1 &
MAPortfolio.lte.ma2 == 1")
           , label = "MAPortfolio.sig.sell2"
)
#######

#Entry and exit rules

#######
#buy MAPortfolio when above N-Lag Moving Average
add.rule(strategy = maStrategy
         , name = "ruleSignal"
         , arguments = list(sigcol = "MAPortfolio.sig.buy1"
                            , sigval = TRUE
                            , orderqty = NumSh
                            , ordertype = "market"
                            , orderside = NULL
                            , osFUN = "osMaxPos"
                            , symbol = "MAPortfolio1"
         )
         , type = "enter"
)

#sell MAPortfolio when above N-Lag Moving Average
add.rule(strategy = maStrategy
         , name = "ruleSignal"
         , arguments = list(sigcol = "MAPortfolio.sig.sell1"
                            , sigval = TRUE
                            , orderqty = "all"
                            , ordertype = "market"
                            , orderside = NULL
                            , osFUN = "osMaxPos"
                            , symbol = "MAPortfolio1"
         )
         , type = "exit"
)
#######

#######
#buy MAPortfolio when above N-Lag Moving Average
add.rule(strategy = maStrategy
         , name = "ruleSignal"
         , arguments = list(sigcol = "MAPortfolio.sig.buy2"
                            , sigval = TRUE
                            , orderqty = NumSh
                            , ordertype = "market"
                            , orderside = NULL
                            , osFUN = "osMaxPos"
                            , symbol = "MAPortfolio2"
         )
         , type = "enter"
)

#sell MAPortfolio when above N-Lag Moving Average
add.rule(strategy = maStrategy
         , name = "ruleSignal"
         , arguments = list(sigcol = "MAPortfolio.sig.sell2"
                            , sigval = TRUE
                            , orderqty = "all"
                            , ordertype = "market"
                            , orderside = NULL
                            , osFUN = "osMaxPos"
                            , symbol = "MAPortfolio2"
         )
         , type = "exit"
)
#######

mktdata <- merge(MAPortfolio1
                 , MAPortfolio2
)


applyIndicators(strategy = maStrategy, mktdata = mktdata)
applySignals(strategy = maStrategy, mktdata = mktdata)

#Why is this working, when decileThreshold == 2 ?
applyRules(portfolio = maStrategy
           , symbol = "MAPortfolio1"
           , strategy = maStrategy
           , mktdata = mktdata
           )


applyStrategy(strategy = maStrategy
              , portfolios = maStrategy
              #, mktdata = mktdata
)



#####################



Erol Biceroglu
erol.biceroglu at alumni.utoronto.ca


From d.indjic at iee.org  Fri Aug 19 19:31:33 2016
From: d.indjic at iee.org (d.indjic at iee.org)
Date: Fri, 19 Aug 2016 18:31:33 +0100
Subject: [R-SIG-Finance] Backtesting without long-only constraint
Message-ID: <006901d1fa3f$8886e300$9994a900$@iee.org>

Dear R-ers

 

Are there any libraries enabling the portfolio back testing a la
PortfolioAnalytics's Portfolio.return() with -ve weightings, or relaxed
leverage constraint?

 

Regards

Drago 


	[[alternative HTML version deleted]]


From brian at braverock.com  Fri Aug 19 19:42:07 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Fri, 19 Aug 2016 12:42:07 -0500
Subject: [R-SIG-Finance] Backtesting without long-only constraint
In-Reply-To: <006901d1fa3f$8886e300$9994a900$@iee.org>
References: <006901d1fa3f$8886e300$9994a900$@iee.org>
Message-ID: <1471628527.7874.94.camel@brian-rcg>


On Fri, 2016-08-19 at 18:31 +0100, d.indjic at iee.org wrote:
> Are there any libraries enabling the portfolio back testing a la
> PortfolioAnalytics's Portfolio.return() with -ve weightings, or relaxed
> leverage constraint?

Return.portfolio in PerformanceAnalytics supports whatever you want for
the weights vector, including negative weights and leverage.

You speak about 'portfolio back testing' without specifics, so I'll
assume that you mean a portfolio optimization with periodic rebalancing.

If my assumption is correct, you can use the package PortfolioAnalytics
for rebalancing optimizations of long/short portfolios with or without
leverage constraints.  It can also support selective constraint
relaxation to get to a feasible portfolio.  

Be aware that more complicated constraints and objectives rapidly get
into the territory of stochastic global solvers like differential
evolution, particle swarms, and simulated annealing, or constraint-based
random search of the feasible space.   These are all supported, but may
take a long time or be difficult to get convergence.

Regards,

Brian


From thomas.fuller at coherentlogic.com  Mon Aug 22 16:12:54 2016
From: thomas.fuller at coherentlogic.com (Thomas Fuller)
Date: Mon, 22 Aug 2016 10:12:54 -0400
Subject: [R-SIG-Finance] Coherent Datafeed R Package for Thomson Reuters
 Elektron version 1.0.8 Released Today
Message-ID: <CAM0JZ3=rt1kF7dhVDe-QbEhQiySpJU3=f4SWXd4gKCpt30SHDA@mail.gmail.com>

Hi Folks,

We have a new version of the Coherent Datafeed R Package for working with
the Thomson Reuters Elektron platform available for download here:

https://coherentlogic.com/middleware-development/solutions-for-traders-using-thomson-reuters-market-data/version-1-0-8-release-details/

Version 1.0.8 has many changes, bug fixes, and performance improvements.

The release page includes a short video that covers the installation and
usage of the package, pictures of time series data rendered in R, and
results of some performance tests that were conducted recently.

If you're interested in the Java API for working with Elektron, which is
used internally by this package, several modules have been added -- they
are:

- *db-int* for persisting data to any database supported by the Java
Persistence API (JPA).
- *jms-int* for sending updates to an implementation of the Java Messaging
Service, such as HornetQ.
- *spark-int* for streaming data to Apache Spark.

The spark-int module should be finished this week and then the Java
dependencies will be made available on Maven Central.

Questions and comments are welcomed.

Tom
+1.312.694.3313
*LinkedIn <https://www.linkedin.com/in/thomasfuller>*

	[[alternative HTML version deleted]]


From coltonsmith321 at gmail.com  Wed Aug 24 19:19:44 2016
From: coltonsmith321 at gmail.com (Colton Smith)
Date: Wed, 24 Aug 2016 11:19:44 -0600
Subject: [R-SIG-Finance] Quantstrat Parameter Optimization
Message-ID: <CAE5uSD3G7mk49NqC87+sODrpYHDb8OVYPa-iPN45yqEm40FtLg@mail.gmail.com>

Hello all,

I'm fairly new to backtesting in R. I made a Bollinger Bands and R strategy
to learn how to use quantstrat which works fine. After playing around with
different Bollinger Bands and RSI variables, I am now trying to run a
Bollinger Bands parameter analysis. I followed this:
https://timtrice.github.io/backtesting-strategies/
parameter-optimization.html to add the distribution and run the param set.
I got it to work but the results are the same for each parameter which is
wrong even though it indicates it is using a different parameter value each
time. There really isn't any error or debugging information I can use to
figure this out but I believe the issue is with where/how I'm applying the
indicators/signals which makes it stuck on a single parameter value. This
also could be from the location of the added distribution in the code but
I'm not sure. Does anyone have any guidance? Below is the portion of
interest and attached is the full code.

#DISTRIBUTIONS
sdb = c(1.5,1.75,2,2.25,2.5)
RSIhigh = 70
RSIlow = 30

add.distribution(strategy.st,
                 paramset.label = "BBands",
                 component.type = "indicator",
                 component.label = "BBands",
                 variable = list(n = sdb),
                 label = "RBBands")

#INDICATORS
add.indicator(strategy = strategy.st,
              name = "BBands",
              arguments = list(HLC = quote(HLC(mktdata)),
                               n = 20, maType = "SMA", "RBBands"),
              label = "BBands")

add.indicator(strategy = strategy.st,
              name = "RSI",
              arguments = list(price = quote(Cl(mktdata)), n = 14,
                               maType = "WMA"),
              label = "rsi")

applyIndicators(strategy = strategy.st, mktdata=OHLC(SPY))
colnames(mktdata) <- c("SPY.Open","SPY.High","SPY.
Low","SPY.Close","dn.BBands","mavg.BBands","up.BBands","pctB.BBands","rsi")


#SIGNALS
add.signal(strategy = strategy.st,
           name="sigFormula",
           arguments = list(label = "Cl.gt.UpperBB.RSI",
           data = mktdata,
           formula = "(SPY.Close >= up.BBands & rsi >= RSIhigh)",
           cross = FALSE),
           label = "Cl.gt.UpperBB.RSI")

add.signal(strategy = strategy.st,
           name="sigFormula",
           arguments = list(label = "Cl.lt.LowerBB.RSI",
           data = mktdata,
           formula = "(SPY.Close <= dn.BBands & rsi <= RSIlow)",
           cross = FALSE),
           label = "Cl.lt.LowerBB.RSI")

applySignals(strategy = strategy.st,  mktdata)


#RULES
add.rule(strategy = strategy.st,
         name = "ruleSignal",
         arguments = list(sigcol = "Cl.gt.UpperBB.RSI",
                          sigval = TRUE,
                          orderqty = "all",
                          ordertype = "market",
                          orderside = NULL,
                          threshold = NULL),
         type = "exit")

add.rule(strategy = strategy.st,
         name = "ruleSignal",
         arguments = list(sigcol = "Cl.lt.LowerBB.RSI",
                          sigval = TRUE,
                          orderqty = 500,
                          ordertype = "market",
                          orderside = NULL,
                          threshold = NULL),
         type = "enter")


#APPLY STRAT
cwd <- getwd()
results_file <- paste("results", strategy.st, "RData", sep = ".")
if( file.exists(results_file) ) {
  load(results_file)
} else {
  results <- apply.paramset(strategy.st,
                            paramset.label = "BBands",
                            portfolio.st = portfolio.st,
                            account.st = account.st,
                            nsamples = 5)
  if(checkBlotterUpdate(portfolio.st, account.st, verbose = TRUE)) {
    save(list = "results", file = results_file)
    save.strategy(strategy.st)
    }
}
setwd(cwd)




Thanks for your help,
Colton Smith
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160824/2a9b4957/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: BBRSI2.R
Type: application/octet-stream
Size: 7060 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160824/2a9b4957/attachment.obj>

From oobanubi at googlemail.com  Thu Aug 25 02:50:21 2016
From: oobanubi at googlemail.com (Olasunkanmi Obanubi)
Date: Thu, 25 Aug 2016 02:50:21 +0200
Subject: [R-SIG-Finance] Fwd: Multi-Asset Portfolio Performance Attribution
In-Reply-To: <CAOg9M-+UdTkgyC_4c9FD+Z9dO=SaFU5Jiz=R1HpfAoWr+JOAuQ@mail.gmail.com>
References: <CAOg9M-+UdTkgyC_4c9FD+Z9dO=SaFU5Jiz=R1HpfAoWr+JOAuQ@mail.gmail.com>
Message-ID: <CAOg9M-KKXe=s=41124iuBxrRG+ZEjKMxh4znu-+KXGPNjammPw@mail.gmail.com>

Hi all,

I am interested in knowing if there are any packages that deal with
performance attribution for a multi-asset portfolio in general.

In particular, I am interested in capturing the performance attribution at
each level of a top-down approach (say, for example, starting with asset
allocation at the highest level all the way down to manager selection at
the lowest level) to investing in a multi-asset portfolio.

Thanks for your time and thanks in advance for your response.

Regards,

Ola.

	[[alternative HTML version deleted]]


From brian at braverock.com  Thu Aug 25 14:57:03 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Thu, 25 Aug 2016 07:57:03 -0500
Subject: [R-SIG-Finance] Fwd: Multi-Asset Portfolio Performance
 Attribution
In-Reply-To: <CAOg9M-KKXe=s=41124iuBxrRG+ZEjKMxh4znu-+KXGPNjammPw@mail.gmail.com>
References: <CAOg9M-+UdTkgyC_4c9FD+Z9dO=SaFU5Jiz=R1HpfAoWr+JOAuQ@mail.gmail.com>
	<CAOg9M-KKXe=s=41124iuBxrRG+ZEjKMxh4znu-+KXGPNjammPw@mail.gmail.com>
Message-ID: <1472129823.9044.1.camel@brian-rcg>

install.packages("PortfolioAttribution",repos="http://R-Forge.R-project.org")

Regards,

Brian

On Thu, 2016-08-25 at 02:50 +0200, Olasunkanmi Obanubi via R-SIG-Finance
wrote:
> Hi all,
> 
> I am interested in knowing if there are any packages that deal with
> performance attribution for a multi-asset portfolio in general.
> 
> In particular, I am interested in capturing the performance attribution at
> each level of a top-down approach (say, for example, starting with asset
> allocation at the highest level all the way down to manager selection at
> the lowest level) to investing in a multi-asset portfolio.


From luigimaria.briglia at gmail.com  Mon Aug 29 17:28:06 2016
From: luigimaria.briglia at gmail.com (Luigi Maria Briglia)
Date: Mon, 29 Aug 2016 17:28:06 +0200
Subject: [R-SIG-Finance] Rugarch package using external regressors
Message-ID: <6318C0AE-9346-4A9A-830D-DD7095142A53@gmail.com>

I?m using the rugarch package and I?m having troubles understanding how the external.regressors work.

For example I would expect that fitting a time series with gjr-garch(1,1) should give the same results as fitting the same time series with the plain vanilla garch(1,1) augmented with S_(t-1)*eps_(t-1)^2 as an external regressor.

However I'm not getting the same results.

Specifically this is the code I'm running:

rm(list = ls()) # empty memory 

library(rugarch) 
library(xts) 
data(sp500ret)
spx <- xts(sp500ret, as.Date(rownames(sp500ret)))
t = length(spx)
# assuming mu = 0; r_t = eps_t
s = rep(0,t)
for(i in 1:t){
  if(spx[i]<0){s[i]=1}
}
# eps.neg represents the leverage effect regressor
eps.neg <- xts(spx*s, as.Date(rownames(sp500ret)))
colnames(eps.neg)<-"eps.neg" 
# lag eps.neg
eps.neg.lag = lag(eps.neg,1)
inputs<-na.omit(cbind(spx, eps.neg.lag, join="left")) 
# gjrgarch(1,1)
gjr.spec <- ugarchspec(variance.model = list(model='gjrGARCH', garchOrder=c(1,1),
                      external.regressors = NULL, variance.targeting = T),
                      mean.model = list(armaOrder=c(0,0)),fixed.pars=list(mu = 0))
gjr.fit <- ugarchfit(spec=gjr.spec, data=inputs[,1],
                     solver.control=list(trace = 1))
# garch(1,1) augmented with inputs[,2]
aug.s.spec <- ugarchspec(variance.model = list(model='sGARCH', garchOrder=c(1,1),
                        external.regressors = inputs[,2]^2, variance.targeting = T),
                        mean.model = list(armaOrder=c(0,0)),fixed.pars=list(mu = 0))
aug.s.fit <- ugarchfit(spec=aug.s.spec, data=inputs[,1],
                       solver.control=list(trace = 1))
#results
gjr.fit
aug.s.fit 
However these are the results:

GJR-GARCH(1,1)

Robust Standard Errors:
        Estimate  Std. Error    t value Pr(>|t|)
mu      0.000000          NA         NA       NA
alpha1  0.007933    0.000184     43.139        0
beta1   0.909048    0.000008 117316.512        0
gamma1  0.139258    0.004006     34.764        0
omega   0.000002          NA         NA       NA
Augmented-Garch(1,1)

Robust Standard Errors:
        Estimate  Std. Error    t value Pr(>|t|)
mu      0.000000          NA         NA       NA
alpha1  0.085378    0.002123 4.0223e+01  0.00000
beta1   0.904696    0.000001 1.0116e+06  0.00000
vxreg1  0.000000    0.000060 1.6700e-04  0.99987
omega   0.000001          NA         NA       NA
clearly the two fits are not equivalent. Is there something I?m missing about the external.regressors?



	[[alternative HTML version deleted]]


From alexios at 4dscape.com  Mon Aug 29 17:39:27 2016
From: alexios at 4dscape.com (alexios galanos)
Date: Mon, 29 Aug 2016 18:39:27 +0300
Subject: [R-SIG-Finance] Rugarch package using external regressors
In-Reply-To: <6318C0AE-9346-4A9A-830D-DD7095142A53@gmail.com>
References: <6318C0AE-9346-4A9A-830D-DD7095142A53@gmail.com>
Message-ID: <3cc567bf-0c91-3874-eb45-030e5818d14b@4dscape.com>

Yes, you are missing good default bounds for the external regressors.
Try:
setbounds(aug.s.spec)<-list("vxreg1"=c(-1, 1))

This gives me the same results.

Alexios

On 29/08/2016 18:28, Luigi Maria Briglia wrote:
> I?m using the rugarch package and I?m having troubles understanding how the external.regressors work.
>
> For example I would expect that fitting a time series with gjr-garch(1,1) should give the same results as fitting the same time series with the plain vanilla garch(1,1) augmented with S_(t-1)*eps_(t-1)^2 as an external regressor.
>
> However I'm not getting the same results.
>
> Specifically this is the code I'm running:
>
> rm(list = ls()) # empty memory 
>
> library(rugarch) 
> library(xts) 
> data(sp500ret)
> spx <- xts(sp500ret, as.Date(rownames(sp500ret)))
> t = length(spx)
> # assuming mu = 0; r_t = eps_t
> s = rep(0,t)
> for(i in 1:t){
>   if(spx[i]<0){s[i]=1}
> }
> # eps.neg represents the leverage effect regressor
> eps.neg <- xts(spx*s, as.Date(rownames(sp500ret)))
> colnames(eps.neg)<-"eps.neg" 
> # lag eps.neg
> eps.neg.lag = lag(eps.neg,1)
> inputs<-na.omit(cbind(spx, eps.neg.lag, join="left")) 
> # gjrgarch(1,1)
> gjr.spec <- ugarchspec(variance.model = list(model='gjrGARCH', garchOrder=c(1,1),
>                       external.regressors = NULL, variance.targeting = T),
>                       mean.model = list(armaOrder=c(0,0)),fixed.pars=list(mu = 0))
> gjr.fit <- ugarchfit(spec=gjr.spec, data=inputs[,1],
>                      solver.control=list(trace = 1))
> # garch(1,1) augmented with inputs[,2]
> aug.s.spec <- ugarchspec(variance.model = list(model='sGARCH', garchOrder=c(1,1),
>                         external.regressors = inputs[,2]^2, variance.targeting = T),
>                         mean.model = list(armaOrder=c(0,0)),fixed.pars=list(mu = 0))
> aug.s.fit <- ugarchfit(spec=aug.s.spec, data=inputs[,1],
>                        solver.control=list(trace = 1))
> #results
> gjr.fit
> aug.s.fit 
> However these are the results:
>
> GJR-GARCH(1,1)
>
> Robust Standard Errors:
>         Estimate  Std. Error    t value Pr(>|t|)
> mu      0.000000          NA         NA       NA
> alpha1  0.007933    0.000184     43.139        0
> beta1   0.909048    0.000008 117316.512        0
> gamma1  0.139258    0.004006     34.764        0
> omega   0.000002          NA         NA       NA
> Augmented-Garch(1,1)
>
> Robust Standard Errors:
>         Estimate  Std. Error    t value Pr(>|t|)
> mu      0.000000          NA         NA       NA
> alpha1  0.085378    0.002123 4.0223e+01  0.00000
> beta1   0.904696    0.000001 1.0116e+06  0.00000
> vxreg1  0.000000    0.000060 1.6700e-04  0.99987
> omega   0.000001          NA         NA       NA
> clearly the two fits are not equivalent. Is there something I?m missing about the external.regressors?
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From erinm.hodgess at gmail.com  Thu Sep  1 20:18:17 2016
From: erinm.hodgess at gmail.com (Erin Hodgess)
Date: Thu, 1 Sep 2016 13:18:17 -0500
Subject: [R-SIG-Finance] an opinion question
Message-ID: <CACxE24kLwF5JijZg2dWDAi+1MDyKhjZ2Ucp7qXAkRDqM+A4==g@mail.gmail.com>

Dear R Finance People:

At one point in time, I knew a little bit about finance/econometrics; in
terms of copulas, heavy tailed distributions, etc.

Now I find myself needing to update my knowledge of finance.  What are the
best resources that you might recommend, please?

I was looking at some of the slides/html's from the R/Finance meeting and
they look fascinating, particularly the Tessera.


Thank you for your help.
Sincerely,
Erin


-- 
Erin Hodgess
Associate Professor
Department of Mathematical and Statistics
University of Houston - Downtown
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From markleeds2 at gmail.com  Thu Sep  1 21:02:27 2016
From: markleeds2 at gmail.com (Mark Leeds)
Date: Thu, 1 Sep 2016 15:02:27 -0400
Subject: [R-SIG-Finance] an opinion question
In-Reply-To: <CACxE24kLwF5JijZg2dWDAi+1MDyKhjZ2Ucp7qXAkRDqM+A4==g@mail.gmail.com>
References: <CACxE24kLwF5JijZg2dWDAi+1MDyKhjZ2Ucp7qXAkRDqM+A4==g@mail.gmail.com>
Message-ID: <CAHz+bWbgLhSk6W5YhwuzK9z31A_XYKF_5adD1pVeq1p1Ku=Twg@mail.gmail.com>

Hi Erin: Eric Zivot's S+Finmetrics book provides a good intro to the
various topics. It's probably more than 10 years old now but not much has
changed as far as the topics.
( maybe techniques have ).  Then, if you want to dig deeper into any of the
topics he presents, he's got the references in each chapter. There are
other R based books that
are more recent but I can't say anything about them because I haven't
looked at them. Good luck.


Mark

P.S: For me, Hamilton's text is still the bible for non-dynamic time
series. Nerlove, Grether
and Carvalho is  a great dynamic time series book that doesn't get much
street cred.
I guess because it's  contains mostly farming applications ?





















On Thu, Sep 1, 2016 at 2:18 PM, Erin Hodgess <erinm.hodgess at gmail.com>
wrote:

> Dear R Finance People:
>
> At one point in time, I knew a little bit about finance/econometrics; in
> terms of copulas, heavy tailed distributions, etc.
>
> Now I find myself needing to update my knowledge of finance.  What are the
> best resources that you might recommend, please?
>
> I was looking at some of the slides/html's from the R/Finance meeting and
> they look fascinating, particularly the Tessera.
>
>
> Thank you for your help.
> Sincerely,
> Erin
>
>
> --
> Erin Hodgess
> Associate Professor
> Department of Mathematical and Statistics
> University of Houston - Downtown
> mailto: erinm.hodgess at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From yuanchaowen at gmail.com  Sun Sep  4 10:27:41 2016
From: yuanchaowen at gmail.com (yuanchaowen at gmail.com)
Date: Sun, 4 Sep 2016 16:27:41 +0800
Subject: [R-SIG-Finance]  a question about highfrequency
Message-ID: <2016090416273867051210@gmail.com>

Dear all,

I am fairly new in using R. I want to use the highfrequency package to calculate the spot volatility and its periodic component.
But the spotvol function seems doesn't work. Can anyone help?

library("highfrequency")
load("1mindata.RData")

vol1 <- spotvol(aaa1min, on="minutes",k=1, marketclose = "15:00:00")

Thank you very much in advanced. 
Sincerely.
Chaowen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160904/224c2b38/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1mindata.RData
Type: application/octet-stream
Size: 49783 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160904/224c2b38/attachment.obj>

From maxbredendiek at gmail.com  Tue Sep  6 15:47:26 2016
From: maxbredendiek at gmail.com (Maximilian Bredendiek)
Date: Tue, 6 Sep 2016 15:47:26 +0200
Subject: [R-SIG-Finance] Does autoarfima from rugarch only work with
 external regressors in "full" mode?
Message-ID: <CAHJUbfWhqToYtJpy-d_-Bj7u6cK_ZCb4CL57WRHrbKc-fsiDsw@mail.gmail.com>

 Dear all,

I want to determine the optimal lag length for an ARMA model, using the
"autoarfima" function from the rugarch package.

I am not interested in all possible lag combinations, but only in those of
consecutive orders. Thus, I call the function with method = c("partial").

However, I found that the external regressors I provide are only included
when setting the mode to "full". I tried the partial mode with and without
external regressors for lags up to 10 and got the same results w.r.t. to
AIC.

Here is a minimum working example (Regr is a vector of returns, exRegr a
matrix of external regressors with the same number of rows as Regr):

1) autoarfima(Regr, ar.max = 2, ma.max = 2, criterion = c("AIC"), method =
c("full"), external.regressors = exRegr)

Optimal Parameters
------------------------------------
         Estimate  Std. Error  t value Pr(>|t|)
mu       0.001050    0.000641  1.63898 0.101217
mxreg1   0.010120    0.000326 31.01558 0.000000
mxreg2   0.000207    0.000319  0.65083 0.515156
mxreg3  -0.000422    0.000318 -1.32807 0.184156
mxreg4  -0.000503    0.000319 -1.57776 0.114621
mxreg5   0.000092    0.000318  0.28860 0.772885
mxreg6   0.045095    0.028073  1.60634 0.108199
mxreg7   0.023944    0.029951  0.79945 0.424027
mxreg8  -0.293903    0.133907 -2.19482 0.028176
mxreg9  -0.301839    0.064925 -4.64906 0.000003
mxreg10  0.317559    0.029646 10.71167 0.000000
mxreg11 -0.001181    0.000896 -1.31891 0.187200
mxreg12 -0.001620    0.000895 -1.81045 0.070225
mxreg13  0.000365    0.000897  0.40702 0.683997
sigma    0.014096    0.000222 63.39932 0.000000

2) autoarfima(Regr, ar.max = 2, ma.max = 2, criterion = c("AIC"),
method = c("partial"), external.regressors = exRegr)

Optimal Parameters
------------------------------------
       Estimate  Std. Error  t value Pr(>|t|)
ar1    0.040781    0.022287   1.8298 0.067286
sigma  0.018892    0.000298  63.4193 0.000000

Do you know why this is the case?

Can you tell me how to run the function in "partial" mode and
including external regressors? The "full" mode takes too much
resources on my machine...

Thank you!

	[[alternative HTML version deleted]]


From cduranceau at nial.ky  Wed Sep  7 19:33:55 2016
From: cduranceau at nial.ky (Charles Duranceau)
Date: Wed, 7 Sep 2016 17:33:55 +0000
Subject: [R-SIG-Finance]  RQuantLib Holiday Calendar
Message-ID: <253B4FA1ECEEB54DB661809CB677345537E817A8@NOR-EXC01.northview.local>

Hi,
Is there a way to modify/update or create a holiday calendar in RQuantLib?

The reason I'm asking is that having pre-defined, hard-coded, holiday calendars maybe convenient but is limited as it does not cover all countries and will omit a possible change in the future.
More importantly it fell short to represent financial reality by restricting the use to only one calendar (not combined or unified) while in some instance more than one calendar need to be taken into account.


*         In Forex market, settlement calendar required that the financials centers related to the countries of the currency being  open and, for a cross currencies instrument, required that US banking being open.


*         For single currency (non GBP), interest rate swap where the fixing is based on Libor, the banks of the country related to the settlement the currency and London bank need to be open which require a combined calendar.

In the following example (see bottom for code)  I showed that a US 5Y swap starting on August 31 2016 will have a wrong date (2020-08-31) when using the US default calendar but will have the right date when using the "UK" calendar because of a holiday on 2020-08-31 which bring back the date to 2020-08-28.

This lead to a wrong generation of date schedule and thus cash flows hence impacting valuation and calibration.

I add a look and Quanlib which suggest using ql/time/calendars/bespokecalendar.hpp but I don't think it's possible in RQuantlib.
Is there any idea to combined or customized holiday calendar in RQuantLib?

I don't know if these rules are expressed in any decent Finance textbook as they are market conventions but think they could be useful to know

Regards
Charles


Code to replicate
Example with US calendar only => wrong date
params <- list(effectiveDate=as.Date("2016-08-31"),
+                maturityDate=as.Date("2021-08-31"),
+                period='Semiannual',
+                calendar="UnitedStates",
+                businessDayConvention=1,
+                terminationDateConvention=1,
+                dateGeneration='Backward',emr =0)


Schedule(params)

 [1] "2016-08-31" "2017-02-28" "2017-08-31" "2018-02-28" "2018-08-31" "2019-02-28"

 [7] "2019-08-30" "2020-02-28" "2020-08-31" "2021-02-26" "2021-08-31"

Example with UK calendar only => good schedule but not general as it need to include US holidays as well

params <- list(effectiveDate=as.Date("2016-08-31"),

+                maturityDate=as.Date("2021-08-31"),

+                period='Semiannual',

+                calendar="UnitedKingdom",

+                businessDayConvention=1,

+                terminationDateConvention=1,

+                dateGeneration='Backward',emr =0)

> Schedule(params)

 [1] "2016-08-31" "2017-02-28" "2017-08-31" "2018-02-28" "2018-08-31" "2019-02-28"

 [7] "2019-08-30" "2020-02-28" "2020-08-28" "2021-02-26" "2021-08-31"


Charles



**********************************************************************************************************************************************************
The contents of this email and any attachments are confidential to the intended recipient.  They may not be disclosed to or used by or copied in any way by anyone other than the intended recipient.  If this email is received in error, please contact Northview Investment Advisors Ltd. on + 1 345 943 2828 quoting the name of the sender and the email address to which it has been sent and then delete it.

Please further note that neither Northview Investment Advisors Ltd. nor the sender accepts any responsibility for viruses and it is your responsibility to scan or otherwise check this email and any attachments


	[[alternative HTML version deleted]]


From damiano.luis at gmail.com  Tue Sep 13 20:52:36 2016
From: damiano.luis at gmail.com (Luis Damiano)
Date: Tue, 13 Sep 2016 15:52:36 -0300
Subject: [R-SIG-Finance] Optimum bandwidth for Parzen's kernel using
	highfrequency
Message-ID: <CAMBYN3feSNZ4BC+s=PQ3_ijsTsqQi4bMnDrweWorX3uSubYjkg@mail.gmail.com>

Hi all!

We're studying Barndorff-Nielsen, Hansen, Lunde and Shephard (2009) [1] in
depth. In particular, as a first step we aim at replicating the estimation
based on Parzen's kernel. After attempting to use highfrequency's
rKernelCov, which is based on Barndorff-Nielsen, Hansen, Lunde and Shephard
(2004) [2], we've got a few questions.

In equation 1.2 [3], H works as a bandwidth for the kernel and a covariance
lag. Equation 1.3 shows how to find the optimum bandwidth, which depends on
a constant that changes for each density function. We're trying to find
their counterparts in highfrequency:

1. Is rKernelCov's kernel.param argument related to the bandwidth H in
Equation 1.2?
2. Is rKernelCov's kernel.dofadj argument related to h / (H + 1), the inner
expression in Equation 1.2?
3. When using spotvol's kernel method, setting the est parameter to cv or
quarticity makes the function estimate the optimum bandwidth. Is any of the
two methods related to Equation 1.3? If spotvol computes the optimum
bandwidth, we're considering modifying kernelk [4] to allow for Parzen's
kernel.

We are very thankful for your support and sorry if any of the questions
makes little sense, we may be a bit confused!

[1] https://ideas.repec.org/a/ect/emjrnl/v12y2009i3pc1-c32.html
[2] https://ideas.repec.org/a/ect/emjrnl/v12y2009i3pc1-c32.html
[3] http://onlinelibrary.wiley.com/doi/10.1111/j.1368-423X.2008.00275.x/full
[4] https://github.com/jonathancornelissen/highfrequency/blob/master/R/
spotvol.r

	[[alternative HTML version deleted]]


From oleg.mubarakshin at gmail.com  Sun Sep 18 01:46:45 2016
From: oleg.mubarakshin at gmail.com (Oleg Mubarakshin)
Date: Sun, 18 Sep 2016 00:46:45 +0100
Subject: [R-SIG-Finance] Rblpapi
Message-ID: <55CEE4E1B7BC4E8E9DAD5962A11D3D5D@HPEnvy>

Hi,

I use a Bloomberg terminal in the office and Bloomberg Anywhere (through Mozilla Firefox) at my home.
Is there a way to set up Rblpapi connection on my home PC w/o additional purchases from Bloomberg?

Regards,
Oleg Mubarakshin
	[[alternative HTML version deleted]]


From scott at statblocks.com  Sun Sep 18 02:33:01 2016
From: scott at statblocks.com (Scott @ Statblocks)
Date: Sat, 17 Sep 2016 20:33:01 -0400
Subject: [R-SIG-Finance] Rblpapi
In-Reply-To: <55CEE4E1B7BC4E8E9DAD5962A11D3D5D@HPEnvy>
References: <55CEE4E1B7BC4E8E9DAD5962A11D3D5D@HPEnvy>
Message-ID: <DD8F8E6B-7255-4653-8780-6BB54AF79B5C@statblocks.com>

Yes, just download the Bloomberg software at home and login with your bbg anywhere token.

Regards,

Scott

Sent from a mobile device.  Please excuse typos and tone.

> On Sep 17, 2016, at 7:46 PM, Oleg Mubarakshin <oleg.mubarakshin at gmail.com> wrote:
> 
> Hi,
> 
> I use a Bloomberg terminal in the office and Bloomberg Anywhere (through Mozilla Firefox) at my home.
> Is there a way to set up Rblpapi connection on my home PC w/o additional purchases from Bloomberg?
> 
> Regards,
> Oleg Mubarakshin
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.


From oleg.mubarakshin at gmail.com  Sun Sep 18 15:30:35 2016
From: oleg.mubarakshin at gmail.com (Oleg Mubarakshin)
Date: Sun, 18 Sep 2016 14:30:35 +0100
Subject: [R-SIG-Finance] Rblpapi
In-Reply-To: <DD8F8E6B-7255-4653-8780-6BB54AF79B5C@statblocks.com>
References: <55CEE4E1B7BC4E8E9DAD5962A11D3D5D@HPEnvy>
	<DD8F8E6B-7255-4653-8780-6BB54AF79B5C@statblocks.com>
Message-ID: <49DE246BBA934A96B36C49BA0F2D797F@HPEnvy>

It works. Thank you, Scott!

King regards,
Oleg

-----???????? ?????????----- 
From: Scott @ Statblocks
Sent: Sunday, September 18, 2016 1:33 AM
To: Oleg Mubarakshin
Cc: r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] Rblpapi

Yes, just download the Bloomberg software at home and login with your bbg 
anywhere token.

Regards,

Scott

Sent from a mobile device.  Please excuse typos and tone.

> On Sep 17, 2016, at 7:46 PM, Oleg Mubarakshin <oleg.mubarakshin at gmail.com> 
> wrote:
>
> Hi,
>
> I use a Bloomberg terminal in the office and Bloomberg Anywhere (through 
> Mozilla Firefox) at my home.
> Is there a way to set up Rblpapi connection on my home PC w/o additional 
> purchases from Bloomberg?
>
> Regards,
> Oleg Mubarakshin
>    [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions 
> should go.


From abhadani at gmail.com  Mon Sep 19 16:52:15 2016
From: abhadani at gmail.com (Abhay Bhadani)
Date: Mon, 19 Sep 2016 20:22:15 +0530
Subject: [R-SIG-Finance] PortfolioAnalytics: Custom Constraint
Message-ID: <CALV0wnqr-GDJrFMdcHsRGfKvLv5Q2EZt3Kx6ejgk-AoS340Wwg@mail.gmail.com>

Hi,

I just started exploring PortfolioAnalytics package.

Similar to setting up custom objective functions, is there a way to set up
custom constraints too?

I would like to know how to set up cardinality constraint (i.e., limiting
number of assets in a portfolio).


Thanks!

	[[alternative HTML version deleted]]


From brian at braverock.com  Mon Sep 19 17:02:09 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Mon, 19 Sep 2016 10:02:09 -0500
Subject: [R-SIG-Finance] PortfolioAnalytics: Custom Constraint
In-Reply-To: <CALV0wnqr-GDJrFMdcHsRGfKvLv5Q2EZt3Kx6ejgk-AoS340Wwg@mail.gmail.com>
References: <CALV0wnqr-GDJrFMdcHsRGfKvLv5Q2EZt3Kx6ejgk-AoS340Wwg@mail.gmail.com>
Message-ID: <1474297329.14041.73.camel@brian-rcg>

On Mon, 2016-09-19 at 20:22 +0530, Abhay Bhadani wrote:
> I just started exploring PortfolioAnalytics package.
> 
> Similar to setting up custom objective functions, is there a way to set up
> custom constraints too?
> 
> I would like to know how to set up cardinality constraint (i.e., limiting
> number of assets in a portfolio).

cardinality constraints are already supported via the 'position_limit'
constraint which is an integer constraint limiting the maximum number of
non-zero weight positions in the portfolio.  It may be added like this:


pspec <- add.constraint(portfolio=pspec,
                        type="position_limit",
                        max_pos=3,
                        enabled=TRUE)

assuming that your portfolio specification object is 'pspec'.

As with other constraint types, this may not be efficiently supported by
all optimization engines. (This is a limitation of the underlying
optimizers/solvers, not of PortfolioAnalytics). 

On a more general note, any constraint may be expressed as an objective
by creating a penalty for violating the constraint.  As noted above,
this may lead to very inefficient or non-converging optimization.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From abhadani at gmail.com  Mon Sep 19 17:25:47 2016
From: abhadani at gmail.com (Abhay Bhadani)
Date: Mon, 19 Sep 2016 20:55:47 +0530
Subject: [R-SIG-Finance] PortfolioAnalytics: Custom Constraint
In-Reply-To: <1474297329.14041.73.camel@brian-rcg>
References: <CALV0wnqr-GDJrFMdcHsRGfKvLv5Q2EZt3Kx6ejgk-AoS340Wwg@mail.gmail.com>
	<1474297329.14041.73.camel@brian-rcg>
Message-ID: <CALV0wnoebq17JWjp-r3-FEJZPXdBZn=P5wspEKSNJOpNeNab7Q@mail.gmail.com>

Thanks, Brian!

I implemented the following:
----------------------------------------------------------------------------------------------
data("edhec")
returns <- edhec[,1:12]
colnames(returns) <-
c("CA","CTAG","DS","EM","EN","ED","FIA","GMLS","MA","RV","SS","FF")
print(head(returns,5))
fund.names <- colnames(returns)


#Giving Portfolio Specifications
pspec <- portfolio.spec(assets=fund.names)
print.default(pspec)

#Adding Constraints
#Full investment constraint: sum of all x_i is 1
pspec <- add.constraint(portfolio= pspec, type =
"weight_sum",min=0.99,max=1.01)

#Box constraint: value of x_i varies between 0.2 to 0.8
pspec <- add.constraint(portfolio= pspec, type="box", min = 0.01, max =
0.25)

#Cardinality constraint
pspec <- add.constraint(portfolio= pspec, type="position_limit",max_pos =
6,enabled=TRUE)

#Adding Objective
pspec <- add.objective(portfolio=pspec, type="risk", name="var")
pspec <- add.objective(portfolio=pspec, type="return", name="mean")

opt_meanvar <- optimize.portfolio(R=returns,portfolio = pspec,
                                  optimize_method="pso", trace=TRUE)

------------------------------------------------------------------------------------------

Results:

Optimal Weights:
    CA   CTAG     DS     EM     EN     ED    FIA   GMLS     MA     RV
SS     FF
0.1319 0.0551 0.0312 0.1312 0.1127 0.1467 0.0641 0.0218 0.0805 0.1101
0.0296 0.0952

_____________________________________________________

I obtained weights for all 12 assets. That's why I was not sure whether
position_limit constraint is same as cardinality constraint.


On Mon, Sep 19, 2016 at 8:32 PM, Brian G. Peterson <brian at braverock.com>
wrote:

> On Mon, 2016-09-19 at 20:22 +0530, Abhay Bhadani wrote:
> > I just started exploring PortfolioAnalytics package.
> >
> > Similar to setting up custom objective functions, is there a way to set
> up
> > custom constraints too?
> >
> > I would like to know how to set up cardinality constraint (i.e., limiting
> > number of assets in a portfolio).
>
> cardinality constraints are already supported via the 'position_limit'
> constraint which is an integer constraint limiting the maximum number of
> non-zero weight positions in the portfolio.  It may be added like this:
>
>
> pspec <- add.constraint(portfolio=pspec,
>                         type="position_limit",
>                         max_pos=3,
>                         enabled=TRUE)
>
> assuming that your portfolio specification object is 'pspec'.
>
> As with other constraint types, this may not be efficiently supported by
> all optimization engines. (This is a limitation of the underlying
> optimizers/solvers, not of PortfolioAnalytics).
>
> On a more general note, any constraint may be expressed as an objective
> by creating a penalty for violating the constraint.  As noted above,
> this may lead to very inefficient or non-converging optimization.
>
> Regards,
>
> Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
>
>
>
>

	[[alternative HTML version deleted]]


From jasonhart4 at icloud.com  Tue Sep 20 01:08:22 2016
From: jasonhart4 at icloud.com (Jason Hart)
Date: Mon, 19 Sep 2016 23:08:22 +0000 (GMT)
Subject: [R-SIG-Finance] PortfolioAnalytics: Custom Constraint
Message-ID: <7d6410e2-1529-4ac8-b63e-86be57b747c8@me.com>

I've never been able to get portfolioanalytics to work for me. ?It looks like a nice little addition to the R arsenal but we just weren't meant to work together. ?I figured what the heck I'll try this code and I got the same error message I usually get:

Error in optimize.portfolio(R = returns, portfolio = pspec, optimize_method = "pso", : 
unused arguments (R = returns, portfolio = pspec, optimize_method = "pso", trace = TRUE)


I've installed all the dependent (or at least I think I have) but to no avail. ?I installed pso, all the different ROI packages, Rcmdr. ?I've seen other people with the same issue but did not see a solution.

Any help is much appreciated.

Jason ??

On Sep 19, 2016, at 08:03 AM, "Brian G. Peterson" <brian at braverock.com> wrote:

On Mon, 2016-09-19 at 20:22 +0530, Abhay Bhadani wrote:
I just started exploring PortfolioAnalytics package.

Similar to setting up custom objective functions, is there a way to set up
custom constraints too?

I would like to know how to set up cardinality constraint (i.e., limiting
number of assets in a portfolio).

cardinality constraints are already supported via the 'position_limit'
constraint which is an integer constraint limiting the maximum number of
non-zero weight positions in the portfolio. It may be added like this:


pspec <- add.constraint(portfolio=pspec,
type="position_limit",
max_pos=3,
enabled=TRUE)

assuming that your portfolio specification object is 'pspec'.

As with other constraint types, this may not be efficiently supported by
all optimization engines. (This is a limitation of the underlying
optimizers/solvers, not of PortfolioAnalytics). 

On a more general note, any constraint may be expressed as an objective
by creating a penalty for violating the constraint. As noted above,
this may lead to very inefficient or non-converging optimization.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions should go.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160919/3ffc9bc7/attachment.html>

From rossbennett34 at gmail.com  Tue Sep 20 14:18:10 2016
From: rossbennett34 at gmail.com (Ross Bennett)
Date: Tue, 20 Sep 2016 07:18:10 -0500
Subject: [R-SIG-Finance] PortfolioAnalytics: Custom Constraint
In-Reply-To: <CALV0wnoebq17JWjp-r3-FEJZPXdBZn=P5wspEKSNJOpNeNab7Q@mail.gmail.com>
References: <CALV0wnqr-GDJrFMdcHsRGfKvLv5Q2EZt3Kx6ejgk-AoS340Wwg@mail.gmail.com>
	<1474297329.14041.73.camel@brian-rcg>
	<CALV0wnoebq17JWjp-r3-FEJZPXdBZn=P5wspEKSNJOpNeNab7Q@mail.gmail.com>
Message-ID: <CAEESW=VvyqK4DdrwMw+y7+3wTsigm+-ttLWr+mX1wVZnPxnbOw@mail.gmail.com>

Hi Abhay,

The cardinality constraint is not directly support by the pso solver so we
have to implement that constraint as a penalized objective. Also note that
your box constraint is greater than 0, so the box constraint and position
limit constraint are fighting each other (i.e your problem is
overconstrained).

I recommend using DEoptim or random portfolios as a solver when dealing
with position limit constraints. Position limit constraints are supported
directly by the algorithm in the random portfolios 'sample' method. We use
the mapping function supported by DEoptim to handle more complex
constraints such as position limit when using DEoptim as the solver.

Hope that helps.

Ross


On Mon, Sep 19, 2016 at 10:25 AM, Abhay Bhadani <abhadani at gmail.com> wrote:

> Thanks, Brian!
>
> I implemented the following:
> ------------------------------------------------------------
> ----------------------------------
> data("edhec")
> returns <- edhec[,1:12]
> colnames(returns) <-
> c("CA","CTAG","DS","EM","EN","ED","FIA","GMLS","MA","RV","SS","FF")
> print(head(returns,5))
> fund.names <- colnames(returns)
>
>
> #Giving Portfolio Specifications
> pspec <- portfolio.spec(assets=fund.names)
> print.default(pspec)
>
> #Adding Constraints
> #Full investment constraint: sum of all x_i is 1
> pspec <- add.constraint(portfolio= pspec, type =
> "weight_sum",min=0.99,max=1.01)
>
> #Box constraint: value of x_i varies between 0.2 to 0.8
> pspec <- add.constraint(portfolio= pspec, type="box", min = 0.01, max =
> 0.25)
>
> #Cardinality constraint
> pspec <- add.constraint(portfolio= pspec, type="position_limit",max_pos =
> 6,enabled=TRUE)
>
> #Adding Objective
> pspec <- add.objective(portfolio=pspec, type="risk", name="var")
> pspec <- add.objective(portfolio=pspec, type="return", name="mean")
>
> opt_meanvar <- optimize.portfolio(R=returns,portfolio = pspec,
>                                   optimize_method="pso", trace=TRUE)
>
> ------------------------------------------------------------
> ------------------------------
>
> Results:
>
> Optimal Weights:
>     CA   CTAG     DS     EM     EN     ED    FIA   GMLS     MA     RV
> SS     FF
> 0.1319 0.0551 0.0312 0.1312 0.1127 0.1467 0.0641 0.0218 0.0805 0.1101
> 0.0296 0.0952
>
> _____________________________________________________
>
> I obtained weights for all 12 assets. That's why I was not sure whether
> position_limit constraint is same as cardinality constraint.
>
>
> On Mon, Sep 19, 2016 at 8:32 PM, Brian G. Peterson <brian at braverock.com>
> wrote:
>
> > On Mon, 2016-09-19 at 20:22 +0530, Abhay Bhadani wrote:
> > > I just started exploring PortfolioAnalytics package.
> > >
> > > Similar to setting up custom objective functions, is there a way to set
> > up
> > > custom constraints too?
> > >
> > > I would like to know how to set up cardinality constraint (i.e.,
> limiting
> > > number of assets in a portfolio).
> >
> > cardinality constraints are already supported via the 'position_limit'
> > constraint which is an integer constraint limiting the maximum number of
> > non-zero weight positions in the portfolio.  It may be added like this:
> >
> >
> > pspec <- add.constraint(portfolio=pspec,
> >                         type="position_limit",
> >                         max_pos=3,
> >                         enabled=TRUE)
> >
> > assuming that your portfolio specification object is 'pspec'.
> >
> > As with other constraint types, this may not be efficiently supported by
> > all optimization engines. (This is a limitation of the underlying
> > optimizers/solvers, not of PortfolioAnalytics).
> >
> > On a more general note, any constraint may be expressed as an objective
> > by creating a penalty for violating the constraint.  As noted above,
> > this may lead to very inefficient or non-converging optimization.
> >
> > Regards,
> >
> > Brian
> >
> > --
> > Brian G. Peterson
> > http://braverock.com/brian/
> > Ph: 773-459-4973
> > IM: bgpbraverock
> >
> >
> >
> >
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From brian at braverock.com  Tue Sep 20 17:23:22 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 20 Sep 2016 10:23:22 -0500
Subject: [R-SIG-Finance] PortfolioAnalytics: Custom Constraint
In-Reply-To: <CAEESW=VvyqK4DdrwMw+y7+3wTsigm+-ttLWr+mX1wVZnPxnbOw@mail.gmail.com>
References: <CALV0wnqr-GDJrFMdcHsRGfKvLv5Q2EZt3Kx6ejgk-AoS340Wwg@mail.gmail.com>
	<1474297329.14041.73.camel@brian-rcg>
	<CALV0wnoebq17JWjp-r3-FEJZPXdBZn=P5wspEKSNJOpNeNab7Q@mail.gmail.com>
	<CAEESW=VvyqK4DdrwMw+y7+3wTsigm+-ttLWr+mX1wVZnPxnbOw@mail.gmail.com>
Message-ID: <1474385002.14041.95.camel@brian-rcg>

The attached .R file should demonstrate what Ross was talking about.

The cardinality constraint is directly supported by the stochastic
global solvers 'DEoptim' and 'random', as described in the
documentation.  

It can also be formulated as a mixed integer linear problem for certain
objective functions, but because you're looknig for the Markowitz
mean/variance portfolio, you have a quadratic problem, and can't
formulate it using an MILP.

The attached file fixes the minimum position box constraint to 0, which
aalows all solvers to converge.  

pso still doesn't get a good solution, but this solution may be improved
by increasing the maximum number of iterations via the parameter
'maxit'. After increasing maxit, it gets closer to the solutions
returned by 'random' and 'DEoptim'.

Both 'random' and 'DEoptim' produce similar solutions which meet the
constraints and objectives, but they are not identical, and change over
multiple runs.  (This is stochastic optimization, after all, so the only
way to get the same answer would be to artificially, and incorrectly,
set the random seed.).

This suggests two things:

1> that there are not enough random portfolios (for 'random') or that
the population size and number of generations are insufficient to find
the global solution (for DEoptim).

2> that the problem may still be somewhat over constrained, most likely
by the max weight box constraint.  You might want to use random
portfolios and portfolio sets to compare and plot the difference between
the unconstrained search space and the constrained search space to sort
out whether this is really what you want to do.

Regards,

Brian

-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


On Tue, 2016-09-20 at 07:18 -0500, Ross Bennett wrote:
> Hi Abhay,
> 
> The cardinality constraint is not directly support by the pso solver so we
> have to implement that constraint as a penalized objective. Also note that
> your box constraint is greater than 0, so the box constraint and position
> limit constraint are fighting each other (i.e your problem is
> overconstrained).
> 
> I recommend using DEoptim or random portfolios as a solver when dealing
> with position limit constraints. Position limit constraints are supported
> directly by the algorithm in the random portfolios 'sample' method. We use
> the mapping function supported by DEoptim to handle more complex
> constraints such as position limit when using DEoptim as the solver.
> 
> Hope that helps.
> 
> Ross
> 
> 
> On Mon, Sep 19, 2016 at 10:25 AM, Abhay Bhadani <abhadani at gmail.com> wrote:
> 
> > Thanks, Brian!
> >
> > I implemented the following:
> > ------------------------------------------------------------
> > ----------------------------------
> > data("edhec")
> > returns <- edhec[,1:12]
> > colnames(returns) <-
> > c("CA","CTAG","DS","EM","EN","ED","FIA","GMLS","MA","RV","SS","FF")
> > print(head(returns,5))
> > fund.names <- colnames(returns)
> >
> >
> > #Giving Portfolio Specifications
> > pspec <- portfolio.spec(assets=fund.names)
> > print.default(pspec)
> >
> > #Adding Constraints
> > #Full investment constraint: sum of all x_i is 1
> > pspec <- add.constraint(portfolio= pspec, type =
> > "weight_sum",min=0.99,max=1.01)
> >
> > #Box constraint: value of x_i varies between 0.2 to 0.8
> > pspec <- add.constraint(portfolio= pspec, type="box", min = 0.01, max =
> > 0.25)
> >
> > #Cardinality constraint
> > pspec <- add.constraint(portfolio= pspec, type="position_limit",max_pos =
> > 6,enabled=TRUE)
> >
> > #Adding Objective
> > pspec <- add.objective(portfolio=pspec, type="risk", name="var")
> > pspec <- add.objective(portfolio=pspec, type="return", name="mean")
> >
> > opt_meanvar <- optimize.portfolio(R=returns,portfolio = pspec,
> >                                   optimize_method="pso", trace=TRUE)
> >
> > ------------------------------------------------------------
> > ------------------------------
> >
> > Results:
> >
> > Optimal Weights:
> >     CA   CTAG     DS     EM     EN     ED    FIA   GMLS     MA     RV
> > SS     FF
> > 0.1319 0.0551 0.0312 0.1312 0.1127 0.1467 0.0641 0.0218 0.0805 0.1101
> > 0.0296 0.0952
> >
> > _____________________________________________________
> >
> > I obtained weights for all 12 assets. That's why I was not sure whether
> > position_limit constraint is same as cardinality constraint.
> >
> >
> > On Mon, Sep 19, 2016 at 8:32 PM, Brian G. Peterson <brian at braverock.com>
> > wrote:
> >
> > > On Mon, 2016-09-19 at 20:22 +0530, Abhay Bhadani wrote:
> > > > I just started exploring PortfolioAnalytics package.
> > > >
> > > > Similar to setting up custom objective functions, is there a way to set
> > > up
> > > > custom constraints too?
> > > >
> > > > I would like to know how to set up cardinality constraint (i.e.,
> > limiting
> > > > number of assets in a portfolio).
> > >
> > > cardinality constraints are already supported via the 'position_limit'
> > > constraint which is an integer constraint limiting the maximum number of
> > > non-zero weight positions in the portfolio.  It may be added like this:
> > >
> > >
> > > pspec <- add.constraint(portfolio=pspec,
> > >                         type="position_limit",
> > >                         max_pos=3,
> > >                         enabled=TRUE)
> > >
> > > assuming that your portfolio specification object is 'pspec'.
> > >
> > > As with other constraint types, this may not be efficiently supported by
> > > all optimization engines. (This is a limitation of the underlying
> > > optimizers/solvers, not of PortfolioAnalytics).
> > >
> > > On a more general note, any constraint may be expressed as an objective
> > > by creating a penalty for violating the constraint.  As noted above,
> > > this may lead to very inefficient or non-converging optimization.
> > >
> > > Regards,
> > >
> > > Brian
> > >
> > > --
> > > Brian G. Peterson
> > > http://braverock.com/brian/
> > > Ph: 773-459-4973
> > > IM: bgpbraverock
> > >
> > >
> > >
> > >
> > >
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cardinality_test.R
Type: text/x-r-source
Size: 1590 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160920/04b22810/attachment.bin>

From brian at braverock.com  Tue Sep 20 17:32:45 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Tue, 20 Sep 2016 10:32:45 -0500
Subject: [R-SIG-Finance] PortfolioAnalytics: unused argument error
In-Reply-To: <7d6410e2-1529-4ac8-b63e-86be57b747c8@me.com>
References: <7d6410e2-1529-4ac8-b63e-86be57b747c8@me.com>
Message-ID: <1474385565.14041.101.camel@brian-rcg>

On Mon, 2016-09-19 at 23:08 +0000, Jason Hart wrote:
> I've never been able to get portfolioanalytics to work for me.  It
> looks like a nice little addition to the R arsenal but we just weren't
> meant to work together.  I figured what the heck I'll try this code
> and I got the same error message I usually get:

> Error in optimize.portfolio(R = returns, portfolio = pspec,
> optimize_method = "pso", : 
> unused arguments (R = returns, portfolio = pspec, optimize_method =
> "pso", trace = TRUE)
> 
> I've installed all the dependent (or at least I think I have) but to
> no avail.  I installed pso, all the different ROI packages, Rcmdr.
>  I've seen other people with the same issue but did not see a
> solution.

Really?  Which "other people"?  Link?  

My Google-fu only turned up one other instance of this error, and the
error was reportedly resolved by installing the dependencies.

> Any help is much appreciated.

Jason,

Please don't hijack the thread.  People who use threaded mail readers
will have difficulty following or finding your question.

Assuming you used the script from the prior thread, I had no problem
running that code on multiple machines and R versions.  

The error itself suggests that something is masking objects like
optimize.portfolio in your .GlobalEnv, but without more information
there's nothing to diagnose.

Please try to follow the posting guide:

https://www.r-project.org/posting-guide.html

At a minimum, please provide the output of 

sessionInfo()

Regards,

Brian


From trunglh at hvnh.edu.vn  Wed Sep 21 11:48:33 2016
From: trunglh at hvnh.edu.vn (Le Hai Trung KNH)
Date: Wed, 21 Sep 2016 10:48:33 +0100
Subject: [R-SIG-Finance] racd installation
Message-ID: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>

Hi,
I am trying to install 'racd' package of Alexios to R 3.3.1 and come up
with the following error messages.
-----
>  require(devtools)
Loading required package: devtools
> install_bitbucket("alexiosg/racd")

** preparing package for lazy loading
Warning in rgl.init(initValue, onlyNULL) :
  RGL: unable to open X11 display
Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE
Error : object 'as.vector' is not exported by 'namespace:Matrix'
ERROR: lazy loading failed for package 'racd'
* removing '/gpfs/software/R/3.3.1/gcc/lib64/R/library/racd'
Error: Command failed (1)

-----
How could I solve for these errors? By the way, when will the 'racd' could
be downloaded directly from CRAN?

Regards,
Trung

	[[alternative HTML version deleted]]


From alexios at 4dscape.com  Wed Sep 21 13:16:19 2016
From: alexios at 4dscape.com (Alexios Ghalanos)
Date: Wed, 21 Sep 2016 06:16:19 -0500
Subject: [R-SIG-Finance] racd installation
In-Reply-To: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
References: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
Message-ID: <7B4E90B6-C860-468A-BA9C-BC6ABE3E0F55@4dscape.com>

I'll upload a fix for that today.

Alexios


> On Sep 21, 2016, at 4:48 AM, Le Hai Trung KNH <trunglh at hvnh.edu.vn> wrote:
> 
> Hi,
> I am trying to install 'racd' package of Alexios to R 3.3.1 and come up
> with the following error messages.
> -----
>> require(devtools)
> Loading required package: devtools
>> install_bitbucket("alexiosg/racd")
> 
> ** preparing package for lazy loading
> Warning in rgl.init(initValue, onlyNULL) :
>  RGL: unable to open X11 display
> Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE
> Error : object 'as.vector' is not exported by 'namespace:Matrix'
> ERROR: lazy loading failed for package 'racd'
> * removing '/gpfs/software/R/3.3.1/gcc/lib64/R/library/racd'
> Error: Command failed (1)
> 
> -----
> How could I solve for these errors? By the way, when will the 'racd' could
> be downloaded directly from CRAN?
> 
> Regards,
> Trung
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions should go.
> 


From edd at debian.org  Wed Sep 21 13:19:56 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 21 Sep 2016 06:19:56 -0500
Subject: [R-SIG-Finance] racd installation
In-Reply-To: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
References: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
Message-ID: <22498.27868.336415.29258@max.nulle.part>


On 21 September 2016 at 10:48, Le Hai Trung KNH wrote:
| Hi,
| I am trying to install 'racd' package of Alexios to R 3.3.1 and come up
| with the following error messages.
| -----
| >  require(devtools)
| Loading required package: devtools
| > install_bitbucket("alexiosg/racd")
| 
| ** preparing package for lazy loading
| Warning in rgl.init(initValue, onlyNULL) :
|   RGL: unable to open X11 display
| Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE
| Error : object 'as.vector' is not exported by 'namespace:Matrix'
| ERROR: lazy loading failed for package 'racd'
| * removing '/gpfs/software/R/3.3.1/gcc/lib64/R/library/racd'
| Error: Command failed (1)

There are two errors here.

One comes from the rgl package noticing that you have no X11 display, and
recovering nicely (thanks, Duncan).

The other comes from racd which wants to import as.vector from Matrix, but
Matrix no longer exports it.  Clone the repo, and make this change:

diff --git a/NAMESPACE b/NAMESPACE
index 45b3765..4c146fb 100644
--- a/NAMESPACE
+++ b/NAMESPACE
@@ -6,7 +6,7 @@ importFrom(numDeriv, jacobian, hessian, grad)
 importFrom(xts, xts, as.xts, is.xts, axTicksByTime)
 importFrom(zoo, coredata, index)
 importFrom(Rsolnp, solnp, gosolnp, startpars)
-importFrom(Matrix, Matrix, crossprod, t, as.matrix, as.vector)
+importFrom(Matrix, Matrix, crossprod, t, as.matrix)
 importFrom(parallel, makeForkCluster, makePSOCKcluster, stopCluster, clusterEvalQ, clusterExport, clusterMap, parLapply, parSapply)
 exportClasses("ACDspec", "ACDfit", "ACDfilter", "ACDforecast", "ACDsim", "ACDpath", "ACDroll")
 exportClasses("ACDmultispec", "ACDmultifit", "ACDmultifilter", "ACDmultiforecast")

ie remove ", as.vector" from the end of the importFrom line for package
Matrix.  Now you can install.

| -----
| How could I solve for these errors? By the way, when will the 'racd' could
| be downloaded directly from CRAN?


| 
| Regards,
| Trung
| 
| 	[[alternative HTML version deleted]]
| 
| _______________________________________________
| R-SIG-Finance at r-project.org mailing list
| https://stat.ethz.ch/mailman/listinfo/r-sig-finance
| -- Subscriber-posting only. If you want to post, subscribe first.
| -- Also note that this is not the r-help list where general R questions should go.

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From openbmsjsc at gmail.com  Wed Sep 21 13:26:37 2016
From: openbmsjsc at gmail.com (Open Business Management Solutions JSC)
Date: Wed, 21 Sep 2016 18:26:37 +0700
Subject: [R-SIG-Finance] racd installation
In-Reply-To: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
References: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
Message-ID: <CACk8VyHwfJ0K_oUt=EYubYUPyf_PnYTTiR45-eifJhZfSJiuyg@mail.gmail.com>

It looks like an issue with X display. If you're installing this on a
server through a x-terminal, make sure you export the DISPLAY environment,
e.g.

export DISPLAY=0.0

2016-09-21 16:48 GMT+07:00 Le Hai Trung KNH <trunglh at hvnh.edu.vn>:

> Hi,
> I am trying to install 'racd' package of Alexios to R 3.3.1 and come up
> with the following error messages.
> -----
> >  require(devtools)
> Loading required package: devtools
> > install_bitbucket("alexiosg/racd")
>
> ** preparing package for lazy loading
> Warning in rgl.init(initValue, onlyNULL) :
>   RGL: unable to open X11 display
> Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE
> Error : object 'as.vector' is not exported by 'namespace:Matrix'
> ERROR: lazy loading failed for package 'racd'
> * removing '/gpfs/software/R/3.3.1/gcc/lib64/R/library/racd'
> Error: Command failed (1)
>
> -----
> How could I solve for these errors? By the way, when will the 'racd' could
> be downloaded directly from CRAN?
>
> Regards,
> Trung
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>



-- 
OpenBMS - *Unlock your potentials*

Level 6, Master Building
41-43 Tran Cao Van Street
Ward 6, District 3, Hochiminh City

	[[alternative HTML version deleted]]


From abhadani at gmail.com  Wed Sep 21 18:23:14 2016
From: abhadani at gmail.com (Abhay Bhadani)
Date: Wed, 21 Sep 2016 21:53:14 +0530
Subject: [R-SIG-Finance] PortfolioAnalytics: Custom Constraint
In-Reply-To: <1474385002.14041.95.camel@brian-rcg>
References: <CALV0wnqr-GDJrFMdcHsRGfKvLv5Q2EZt3Kx6ejgk-AoS340Wwg@mail.gmail.com>
	<1474297329.14041.73.camel@brian-rcg>
	<CALV0wnoebq17JWjp-r3-FEJZPXdBZn=P5wspEKSNJOpNeNab7Q@mail.gmail.com>
	<CAEESW=VvyqK4DdrwMw+y7+3wTsigm+-ttLWr+mX1wVZnPxnbOw@mail.gmail.com>
	<1474385002.14041.95.camel@brian-rcg>
Message-ID: <CALV0wnoC4DkYrAJ8UQsywdm8aiVh-sMb2E9tM7m1UwkBVDE=9A@mail.gmail.com>

Thank you, Brian and Ross.

That was very helpful.

DEoptim and random solvers gave good results. I tested the same using
GenSA, which performed worse than pso.

Thank you again! :)

On Tue, Sep 20, 2016 at 8:53 PM, Brian G. Peterson <brian at braverock.com>
wrote:

> The attached .R file should demonstrate what Ross was talking about.
>
> The cardinality constraint is directly supported by the stochastic
> global solvers 'DEoptim' and 'random', as described in the
> documentation.
>
> It can also be formulated as a mixed integer linear problem for certain
> objective functions, but because you're looknig for the Markowitz
> mean/variance portfolio, you have a quadratic problem, and can't
> formulate it using an MILP.
>
> The attached file fixes the minimum position box constraint to 0, which
> aalows all solvers to converge.
>
> pso still doesn't get a good solution, but this solution may be improved
> by increasing the maximum number of iterations via the parameter
> 'maxit'. After increasing maxit, it gets closer to the solutions
> returned by 'random' and 'DEoptim'.
>
> Both 'random' and 'DEoptim' produce similar solutions which meet the
> constraints and objectives, but they are not identical, and change over
> multiple runs.  (This is stochastic optimization, after all, so the only
> way to get the same answer would be to artificially, and incorrectly,
> set the random seed.).
>
> This suggests two things:
>
> 1> that there are not enough random portfolios (for 'random') or that
> the population size and number of generations are insufficient to find
> the global solution (for DEoptim).
>
> 2> that the problem may still be somewhat over constrained, most likely
> by the max weight box constraint.  You might want to use random
> portfolios and portfolio sets to compare and plot the difference between
> the unconstrained search space and the constrained search space to sort
> out whether this is really what you want to do.
>
> Regards,
>
> Brian
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
>
> On Tue, 2016-09-20 at 07:18 -0500, Ross Bennett wrote:
> > Hi Abhay,
> >
> > The cardinality constraint is not directly support by the pso solver so
> we
> > have to implement that constraint as a penalized objective. Also note
> that
> > your box constraint is greater than 0, so the box constraint and position
> > limit constraint are fighting each other (i.e your problem is
> > overconstrained).
> >
> > I recommend using DEoptim or random portfolios as a solver when dealing
> > with position limit constraints. Position limit constraints are supported
> > directly by the algorithm in the random portfolios 'sample' method. We
> use
> > the mapping function supported by DEoptim to handle more complex
> > constraints such as position limit when using DEoptim as the solver.
> >
> > Hope that helps.
> >
> > Ross
> >
> >
> > On Mon, Sep 19, 2016 at 10:25 AM, Abhay Bhadani <abhadani at gmail.com>
> wrote:
> >
> > > Thanks, Brian!
> > >
> > > I implemented the following:
> > > ------------------------------------------------------------
> > > ----------------------------------
> > > data("edhec")
> > > returns <- edhec[,1:12]
> > > colnames(returns) <-
> > > c("CA","CTAG","DS","EM","EN","ED","FIA","GMLS","MA","RV","SS","FF")
> > > print(head(returns,5))
> > > fund.names <- colnames(returns)
> > >
> > >
> > > #Giving Portfolio Specifications
> > > pspec <- portfolio.spec(assets=fund.names)
> > > print.default(pspec)
> > >
> > > #Adding Constraints
> > > #Full investment constraint: sum of all x_i is 1
> > > pspec <- add.constraint(portfolio= pspec, type =
> > > "weight_sum",min=0.99,max=1.01)
> > >
> > > #Box constraint: value of x_i varies between 0.2 to 0.8
> > > pspec <- add.constraint(portfolio= pspec, type="box", min = 0.01, max =
> > > 0.25)
> > >
> > > #Cardinality constraint
> > > pspec <- add.constraint(portfolio= pspec,
> type="position_limit",max_pos =
> > > 6,enabled=TRUE)
> > >
> > > #Adding Objective
> > > pspec <- add.objective(portfolio=pspec, type="risk", name="var")
> > > pspec <- add.objective(portfolio=pspec, type="return", name="mean")
> > >
> > > opt_meanvar <- optimize.portfolio(R=returns,portfolio = pspec,
> > >                                   optimize_method="pso", trace=TRUE)
> > >
> > > ------------------------------------------------------------
> > > ------------------------------
> > >
> > > Results:
> > >
> > > Optimal Weights:
> > >     CA   CTAG     DS     EM     EN     ED    FIA   GMLS     MA     RV
> > > SS     FF
> > > 0.1319 0.0551 0.0312 0.1312 0.1127 0.1467 0.0641 0.0218 0.0805 0.1101
> > > 0.0296 0.0952
> > >
> > > _____________________________________________________
> > >
> > > I obtained weights for all 12 assets. That's why I was not sure whether
> > > position_limit constraint is same as cardinality constraint.
> > >
> > >
> > > On Mon, Sep 19, 2016 at 8:32 PM, Brian G. Peterson <
> brian at braverock.com>
> > > wrote:
> > >
> > > > On Mon, 2016-09-19 at 20:22 +0530, Abhay Bhadani wrote:
> > > > > I just started exploring PortfolioAnalytics package.
> > > > >
> > > > > Similar to setting up custom objective functions, is there a way
> to set
> > > > up
> > > > > custom constraints too?
> > > > >
> > > > > I would like to know how to set up cardinality constraint (i.e.,
> > > limiting
> > > > > number of assets in a portfolio).
> > > >
> > > > cardinality constraints are already supported via the
> 'position_limit'
> > > > constraint which is an integer constraint limiting the maximum
> number of
> > > > non-zero weight positions in the portfolio.  It may be added like
> this:
> > > >
> > > >
> > > > pspec <- add.constraint(portfolio=pspec,
> > > >                         type="position_limit",
> > > >                         max_pos=3,
> > > >                         enabled=TRUE)
> > > >
> > > > assuming that your portfolio specification object is 'pspec'.
> > > >
> > > > As with other constraint types, this may not be efficiently
> supported by
> > > > all optimization engines. (This is a limitation of the underlying
> > > > optimizers/solvers, not of PortfolioAnalytics).
> > > >
> > > > On a more general note, any constraint may be expressed as an
> objective
> > > > by creating a penalty for violating the constraint.  As noted above,
> > > > this may lead to very inefficient or non-converging optimization.
> > > >
> > > > Regards,
> > > >
> > > > Brian
> > > >
> > > > --
> > > > Brian G. Peterson
> > > > http://braverock.com/brian/
> > > > Ph: 773-459-4973
> > > > IM: bgpbraverock
> > > >
> > > >
> > > >
> > > >
> > > >
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-SIG-Finance at r-project.org mailing list
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > > -- Subscriber-posting only. If you want to post, subscribe first.
> > > -- Also note that this is not the r-help list where general R questions
> > > should go.
> > >
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From jasonhart4 at icloud.com  Thu Sep 22 02:25:56 2016
From: jasonhart4 at icloud.com (Jason Hart)
Date: Thu, 22 Sep 2016 00:25:56 +0000 (GMT)
Subject: [R-SIG-Finance]
 =?utf-8?q?PortfolioAnalytics=3A_unused_argument_e?= =?utf-8?q?rror?=
Message-ID: <7359fa1e-6722-439b-994f-840d1a0d6b57@me.com>

Brian - Get over yourself! ?That was an A++ response in terms of being obnoxious, smug and condescending. I wasn't looking for anyone to do any internet searches high atop their Ivory Tower, it was a simple question that I was hoping someone had a similar experience with. ?Trust me, I've done plenty of searches on this topic and my "google fu" skills are on par with yours. ?I saw the same inquiry you probably saw w/ your search results, but the user with my problem never confirmed if he figured it out despite asking a couple of times on the thread. ?If he's asking the same follow-up question more than once then chances are he never got it working. ?

As far as "hijacking the thread" it was a simple post that seemed appropriate for the topic but I am so sorry if I offended you, or anyone else, for breaking the unwritten rules. Look, I've been an R user for 2.5 years but my skills are nowhere near 90%, hell maybe 100% of the people here -- if I were to post this as a standalone question there wouldn't be a single response. ?Half the subscribers would be laughing behind their keyboard. Posting here is only a matter of last resort, so sometimes you gotta take your shot. ?

PS - I did figure it out though, all of the packages were properly installed so that wasn't the problem....and thankfully I'm not crazy! ?But it was a simple fix in hindsight and I'm sure all of you experienced it at one point or another ?


On Sep 20, 2016, at 08:33 AM, "Brian G. Peterson" <brian at braverock.com> wrote:

On Mon, 2016-09-19 at 23:08 +0000, Jason Hart wrote:
I've never been able to get portfolioanalytics to work for me. It
looks like a nice little addition to the R arsenal but we just weren't
meant to work together. I figured what the heck I'll try this code
and I got the same error message I usually get:

Error in optimize.portfolio(R = returns, portfolio = pspec,
optimize_method = "pso", :
unused arguments (R = returns, portfolio = pspec, optimize_method =
"pso", trace = TRUE)

I've installed all the dependent (or at least I think I have) but to
no avail. I installed pso, all the different ROI packages, Rcmdr.
I've seen other people with the same issue but did not see a
solution.

Really? Which "other people"? Link? 

My Google-fu only turned up one other instance of this error, and the
error was reportedly resolved by installing the dependencies.

Any help is much appreciated.

Jason,

Please don't hijack the thread. People who use threaded mail readers
will have difficulty following or finding your question.

Assuming you used the script from the prior thread, I had no problem
running that code on multiple machines and R versions. 

The error itself suggests that something is masking objects like
optimize.portfolio in your .GlobalEnv, but without more information
there's nothing to diagnose.

Please try to follow the posting guide:

https://www.r-project.org/posting-guide.html

At a minimum, please provide the output of 

sessionInfo()

Regards,

Brian


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-finance/attachments/20160922/e8db02be/attachment.html>

From edd at debian.org  Thu Sep 22 05:21:36 2016
From: edd at debian.org (Dirk Eddelbuettel)
Date: Wed, 21 Sep 2016 22:21:36 -0500
Subject: [R-SIG-Finance] PortfolioAnalytics: unused argument error
In-Reply-To: <7359fa1e-6722-439b-994f-840d1a0d6b57@me.com>
References: <7359fa1e-6722-439b-994f-840d1a0d6b57@me.com>
Message-ID: <22499.20032.784729.733520@max.nulle.part>


Jason,

Welcome to the list.  I hope you will enjoy the generally cordial and
friendly tone around here -- something we established and maintained without
formal policies and guidelines.

This has worked so far because most people know how to behave.

But you have shown two departures from that in two posts.

First, and as you have been told already, don't 'hijack a thread'.  If you
have a new question, post it as a fresh question and Subject:.  Many of us
deal with high mail volumes, and sorting by Subject (aka "threading") helps.

Second, your tone in the most recent reply is inappropriate. Please strive to
do better.

Thanks, and I hope you will enjoy the list.

Dirk

-- 
http://dirk.eddelbuettel.com | @eddelbuettel | edd at debian.org


From vc248 at cornell.edu  Thu Sep 22 09:11:10 2016
From: vc248 at cornell.edu (Vis Chen)
Date: Thu, 22 Sep 2016 09:11:10 +0200
Subject: [R-SIG-Finance] racd installation
In-Reply-To: <CACk8VyHwfJ0K_oUt=EYubYUPyf_PnYTTiR45-eifJhZfSJiuyg@mail.gmail.com>
References: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
	<CACk8VyHwfJ0K_oUt=EYubYUPyf_PnYTTiR45-eifJhZfSJiuyg@mail.gmail.com>
Message-ID: <CAA5=k_QbDaY=MH718OHJ9E3zSWskg8LDoU9r9D3Qt0gX+56Ahg@mail.gmail.com>

Dear Alexios,

I have tested "rmgarch.test4.R" in the rmgarch package, and when I run the
rmgarch.test4b commands:

> data(dji30retw)
> Dat = dji30retw[, 1:15, drop = FALSE]
> spec2 = gogarchspec(mean.model = list(model = "AR", lag = 2),
+ variance.model = list(model = "gjrGARCH", garchOrder = c(1,1)),
+ distribution.model = c("mvnorm", "manig", "magh")[2],
+ ica = "fastica")
> M.gg = fmoments(spec2, Data = dji30retw[,1:15], n.ahead = 1, roll = 2,
+ solver = "solnp", cluster = cluster, gfun = "tanh", maxiter1=20000,
+ A.init = diag(15))
There were 15 warnings (use warnings() to see them)
> warnings()
Warning messages:
1: unidentified option(s) in fit.control:
 eval.se

I tried to solve this by adding:
M.gg = fmoments(spec3x, Data = P, n.ahead = 1, roll = 8,  *fit.control =
list(fixed.se <http://fixed.se> = FALSE, stationarity = TRUE, scale =
FALSE)*,
                solver = "solnp", cluster = cluster, gfun = "tanh",
maxiter1=20000,
                A.init = diag(10))

But I have difficulties interpreting how this fit.control affect the model.

Lastly, I tried to apply my own data to the same script and I received
these warnings:
> M.gg = fmoments(spec3x, Data = P, n.ahead = 1, roll = 8,  fit.control =
list(fixed.se = FALSE, stationarity = TRUE, scale = FALSE),
+                 solver = "solnp", cluster = cluster, gfun = "tanh",
maxiter1=20000,
+                 A.init = diag(10))
Warning messages:
1: In sqrt(ans$h) : NaNs produced
2: In sqrt(ans$h) : NaNs produced
3: In sqrt(ans$h) : NaNs produced
4: In sqrt(ans$h) : NaNs produced

I have some returns that equal to 0 can this be a problem? Would M.gg be
invalid as a consequence of these warnings?

Regards,
Vis



On Wed, Sep 21, 2016 at 1:26 PM, Open Business Management Solutions JSC <
openbmsjsc at gmail.com> wrote:

> It looks like an issue with X display. If you're installing this on a
> server through a x-terminal, make sure you export the DISPLAY environment,
> e.g.
>
> export DISPLAY=0.0
>
> 2016-09-21 16:48 GMT+07:00 Le Hai Trung KNH <trunglh at hvnh.edu.vn>:
>
> > Hi,
> > I am trying to install 'racd' package of Alexios to R 3.3.1 and come up
> > with the following error messages.
> > -----
> > >  require(devtools)
> > Loading required package: devtools
> > > install_bitbucket("alexiosg/racd")
> >
> > ** preparing package for lazy loading
> > Warning in rgl.init(initValue, onlyNULL) :
> >   RGL: unable to open X11 display
> > Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE
> > Error : object 'as.vector' is not exported by 'namespace:Matrix'
> > ERROR: lazy loading failed for package 'racd'
> > * removing '/gpfs/software/R/3.3.1/gcc/lib64/R/library/racd'
> > Error: Command failed (1)
> >
> > -----
> > How could I solve for these errors? By the way, when will the 'racd'
> could
> > be downloaded directly from CRAN?
> >
> > Regards,
> > Trung
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-SIG-Finance at r-project.org mailing list
> > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> > -- Subscriber-posting only. If you want to post, subscribe first.
> > -- Also note that this is not the r-help list where general R questions
> > should go.
> >
>
>
>
> --
> OpenBMS - *Unlock your potentials*
>
> Level 6, Master Building
> 41-43 Tran Cao Van Street
> Ward 6, District 3, Hochiminh City
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>

	[[alternative HTML version deleted]]


From alexios at 4dscape.com  Thu Sep 22 16:53:27 2016
From: alexios at 4dscape.com (alexios galanos)
Date: Thu, 22 Sep 2016 09:53:27 -0500
Subject: [R-SIG-Finance] racd installation
In-Reply-To: <CAA5=k_QbDaY=MH718OHJ9E3zSWskg8LDoU9r9D3Qt0gX+56Ahg@mail.gmail.com>
References: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>
	<CACk8VyHwfJ0K_oUt=EYubYUPyf_PnYTTiR45-eifJhZfSJiuyg@mail.gmail.com>
	<CAA5=k_QbDaY=MH718OHJ9E3zSWskg8LDoU9r9D3Qt0gX+56Ahg@mail.gmail.com>
Message-ID: <84c2ce1e-54cb-4ebb-8e91-c68fa804a07d@4dscape.com>

Vis,

1. You've switched from a topic related to racd to one relating to rmgarch.
Please start a new thread with an appropriate title (i.e. rmgarch in title).

2. I know that this list may have shrunk over time, but I am not the
only person on it.
Please address the question to the group, not me personally.

3. I recently added a dispatch function function for gogarchsim to accept
goGARCHfilter as well as goGARCHfit classes. This will allow easier
fitting,
filtering with new data, and then simulating the n-ahead predictive
density.
When I find time I will add some examples and clean up the warnings.


Alexios

On 22/09/2016 02:11, Vis Chen wrote:
> Dear Alexios, 
>
> I have tested "rmgarch.test4.R" in the rmgarch package, and when I run
> the rmgarch.test4b commands: 
>
> > data(dji30retw)
> > Dat = dji30retw[, 1:15, drop = FALSE]
> > spec2 = gogarchspec(mean.model = list(model = "AR", lag = 2), 
> + variance.model = list(model = "gjrGARCH", garchOrder = c(1,1)), 
> + distribution.model = c("mvnorm", "manig", "magh")[2], 
> + ica = "fastica")
> > M.gg = fmoments(spec2, Data = dji30retw[,1:15], n.ahead = 1, roll = 2, 
> + solver = "solnp", cluster = cluster, gfun = "tanh", maxiter1=20000, 
> + A.init = diag(15))
> There were 15 warnings (use warnings() to see them)
> > warnings()
> Warning messages:
> 1: unidentified option(s) in fit.control:
>  eval.se <http://eval.se>
>
> I tried to solve this by adding:
> M.gg = fmoments(spec3x, Data = P, n.ahead = 1, roll = 8,  *fit.control
> = list(fixed.se <http://fixed.se> = FALSE, stationarity = TRUE, scale
> = FALSE)*,
>                 solver = "solnp", cluster = cluster, gfun = "tanh",
> maxiter1=20000, 
>                 A.init = diag(10))
>
> But I have difficulties interpreting how this fit.control affect the
> model. 
>
> Lastly, I tried to apply my own data to the same script and I received
> these warnings: 
> > M.gg = fmoments(spec3x, Data = P, n.ahead = 1, roll = 8,
>  fit.control = list(fixed.se <http://fixed.se> = FALSE, stationarity =
> TRUE, scale = FALSE),
> +                 solver = "solnp", cluster = cluster, gfun = "tanh",
> maxiter1=20000, 
> +                 A.init = diag(10))
> Warning messages:
> 1: In sqrt(ans$h) : NaNs produced
> 2: In sqrt(ans$h) : NaNs produced
> 3: In sqrt(ans$h) : NaNs produced
> 4: In sqrt(ans$h) : NaNs produced
>
> I have some returns that equal to 0 can this be a problem? Would M.gg
> be invalid as a consequence of these warnings?
>
> Regards,
> Vis
>
>
>
> On Wed, Sep 21, 2016 at 1:26 PM, Open Business Management Solutions
> JSC <openbmsjsc at gmail.com <mailto:openbmsjsc at gmail.com>> wrote:
>
>     It looks like an issue with X display. If you're installing this on a
>     server through a x-terminal, make sure you export the DISPLAY
>     environment,
>     e.g.
>
>     export DISPLAY=0.0
>
>     2016-09-21 16:48 GMT+07:00 Le Hai Trung KNH <trunglh at hvnh.edu.vn
>     <mailto:trunglh at hvnh.edu.vn>>:
>
>     > Hi,
>     > I am trying to install 'racd' package of Alexios to R 3.3.1 and
>     come up
>     > with the following error messages.
>     > -----
>     > >  require(devtools)
>     > Loading required package: devtools
>     > > install_bitbucket("alexiosg/racd")
>     >
>     > ** preparing package for lazy loading
>     > Warning in rgl.init(initValue, onlyNULL) :
>     >   RGL: unable to open X11 display
>     > Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE
>     > Error : object 'as.vector' is not exported by 'namespace:Matrix'
>     > ERROR: lazy loading failed for package 'racd'
>     > * removing '/gpfs/software/R/3.3.1/gcc/lib64/R/library/racd'
>     > Error: Command failed (1)
>     >
>     > -----
>     > How could I solve for these errors? By the way, when will the
>     'racd' could
>     > be downloaded directly from CRAN?
>     >
>     > Regards,
>     > Trung
>     >
>     >         [[alternative HTML version deleted]]
>     >
>     > _______________________________________________
>     > R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>     > -- Subscriber-posting only. If you want to post, subscribe first.
>     > -- Also note that this is not the r-help list where general R
>     questions
>     > should go.
>     >
>
>
>
>     --
>     OpenBMS - *Unlock your potentials*
>
>     Level 6, Master Building
>     41-43 Tran Cao Van Street
>     Ward 6, District 3, Hochiminh City
>
>             [[alternative HTML version deleted]]
>
>     _______________________________________________
>     R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>
>


From dmack10 at verizon.net  Sat Sep 24 17:49:01 2016
From: dmack10 at verizon.net (Daniel Mack)
Date: Sat, 24 Sep 2016 11:49:01 -0400
Subject: [R-SIG-Finance] Question on Capturing Open, High, Low, Close,
	with a timestamp
Message-ID: <F51065C7-B1D0-44CC-B8EE-D01DE9F7D5FF@verizon.net>

Hello,  I looking for a function that would automatically list the timestamp of the OHLC data.   The open and close are obvious but the format I am looking would be some like

2016-09-23	AAPL    114.52  09:30:00	114.58  09:31:00	111.90  13:58:00	112.22  16:00:00

I have seen a the regular inclusion of time stamp meta data, and that would require the downloading and sorting of all intraday data and then taking the max and min of the data.  I am hoping not to have to due this to sane on data transfer time and additional processing. This takes more time than the analysis does.

I currently use the getSymbols from quant mod

Thanks  Dan

From trunglh at hvnh.edu.vn  Sun Sep 25 10:42:09 2016
From: trunglh at hvnh.edu.vn (Trung.HVNH)
Date: Sun, 25 Sep 2016 09:42:09 +0100
Subject: [R-SIG-Finance] racd installation
In-Reply-To: <84c2ce1e-54cb-4ebb-8e91-c68fa804a07d@4dscape.com>
References: <CAJ-k01xP1Z5Nb1C0EEEcKj3O+aNX-iDPAktWSh30QVBXczzd8g@mail.gmail.com>	<CACk8VyHwfJ0K_oUt=EYubYUPyf_PnYTTiR45-eifJhZfSJiuyg@mail.gmail.com>	<CAA5=k_QbDaY=MH718OHJ9E3zSWskg8LDoU9r9D3Qt0gX+56Ahg@mail.gmail.com>
	<84c2ce1e-54cb-4ebb-8e91-c68fa804a07d@4dscape.com>
Message-ID: <007a01d21708$b4e92080$1ebb6180$@hvnh.edu.vn>

Hi,
Thank you Alexios for fixing the installation error. 
I successfully installed the racd package. However, in the estimation I
cannot use the solver "msucminf" and "mssolnp" although the solver "msoptim"
and "uncminf"; "solnp" itself (without multi start strategy) still work. 
The error message is follow: 
---
Error in xsol[[best]] : no such index at level 3
Calls: acdfit -> acdfit -> .acdfit -> .acdsolver -> .msucminfsolver
Execution halted
---
How is that error? 

Best,
Trung

-----Original Message-----
From: R-SIG-Finance [mailto:r-sig-finance-bounces at r-project.org] On Behalf
Of alexios galanos
Sent: Thursday, September 22, 2016 3:53 PM
To: Vis Chen <vc248 at cornell.edu>; r-sig-finance at r-project.org
Subject: Re: [R-SIG-Finance] racd installation

Vis,

1. You've switched from a topic related to racd to one relating to rmgarch.
Please start a new thread with an appropriate title (i.e. rmgarch in title).

2. I know that this list may have shrunk over time, but I am not the only
person on it.
Please address the question to the group, not me personally.

3. I recently added a dispatch function function for gogarchsim to accept
goGARCHfilter as well as goGARCHfit classes. This will allow easier fitting,
filtering with new data, and then simulating the n-ahead predictive density.
When I find time I will add some examples and clean up the warnings.


Alexios

On 22/09/2016 02:11, Vis Chen wrote:
> Dear Alexios,
>
> I have tested "rmgarch.test4.R" in the rmgarch package, and when I run 
> the rmgarch.test4b commands:
>
> > data(dji30retw)
> > Dat = dji30retw[, 1:15, drop = FALSE]
> > spec2 = gogarchspec(mean.model = list(model = "AR", lag = 2),
> + variance.model = list(model = "gjrGARCH", garchOrder = c(1,1)), 
> + distribution.model = c("mvnorm", "manig", "magh")[2], ica = 
> + "fastica")
> > M.gg = fmoments(spec2, Data = dji30retw[,1:15], n.ahead = 1, roll = 
> > 2,
> + solver = "solnp", cluster = cluster, gfun = "tanh", maxiter1=20000, 
> + A.init = diag(15))
> There were 15 warnings (use warnings() to see them)
> > warnings()
> Warning messages:
> 1: unidentified option(s) in fit.control:
>  eval.se <http://eval.se>
>
> I tried to solve this by adding:
> M.gg = fmoments(spec3x, Data = P, n.ahead = 1, roll = 8,  *fit.control 
> = list(fixed.se <http://fixed.se> = FALSE, stationarity = TRUE, scale 
> = FALSE)*,
>                 solver = "solnp", cluster = cluster, gfun = "tanh", 
> maxiter1=20000,
>                 A.init = diag(10))
>
> But I have difficulties interpreting how this fit.control affect the 
> model.
>
> Lastly, I tried to apply my own data to the same script and I received 
> these warnings:
> > M.gg = fmoments(spec3x, Data = P, n.ahead = 1, roll = 8,
>  fit.control = list(fixed.se <http://fixed.se> = FALSE, stationarity = 
> TRUE, scale = FALSE),
> +                 solver = "solnp", cluster = cluster, gfun = "tanh",
> maxiter1=20000,
> +                 A.init = diag(10))
> Warning messages:
> 1: In sqrt(ans$h) : NaNs produced
> 2: In sqrt(ans$h) : NaNs produced
> 3: In sqrt(ans$h) : NaNs produced
> 4: In sqrt(ans$h) : NaNs produced
>
> I have some returns that equal to 0 can this be a problem? Would M.gg 
> be invalid as a consequence of these warnings?
>
> Regards,
> Vis
>
>
>
> On Wed, Sep 21, 2016 at 1:26 PM, Open Business Management Solutions 
> JSC <openbmsjsc at gmail.com <mailto:openbmsjsc at gmail.com>> wrote:
>
>     It looks like an issue with X display. If you're installing this on a
>     server through a x-terminal, make sure you export the DISPLAY
>     environment,
>     e.g.
>
>     export DISPLAY=0.0
>
>     2016-09-21 16:48 GMT+07:00 Le Hai Trung KNH <trunglh at hvnh.edu.vn
>     <mailto:trunglh at hvnh.edu.vn>>:
>
>     > Hi,
>     > I am trying to install 'racd' package of Alexios to R 3.3.1 and
>     come up
>     > with the following error messages.
>     > -----
>     > >  require(devtools)
>     > Loading required package: devtools
>     > > install_bitbucket("alexiosg/racd")
>     >
>     > ** preparing package for lazy loading
>     > Warning in rgl.init(initValue, onlyNULL) :
>     >   RGL: unable to open X11 display
>     > Warning: 'rgl_init' failed, running with rgl.useNULL = TRUE
>     > Error : object 'as.vector' is not exported by 'namespace:Matrix'
>     > ERROR: lazy loading failed for package 'racd'
>     > * removing '/gpfs/software/R/3.3.1/gcc/lib64/R/library/racd'
>     > Error: Command failed (1)
>     >
>     > -----
>     > How could I solve for these errors? By the way, when will the
>     'racd' could
>     > be downloaded directly from CRAN?
>     >
>     > Regards,
>     > Trung
>     >
>     >         [[alternative HTML version deleted]]
>     >
>     > _______________________________________________
>     > R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     > https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>     > -- Subscriber-posting only. If you want to post, subscribe first.
>     > -- Also note that this is not the r-help list where general R
>     questions
>     > should go.
>     >
>
>
>
>     --
>     OpenBMS - *Unlock your potentials*
>
>     Level 6, Master Building
>     41-43 Tran Cao Van Street
>     Ward 6, District 3, Hochiminh City
>
>             [[alternative HTML version deleted]]
>
>     _______________________________________________
>     R-SIG-Finance at r-project.org <mailto:R-SIG-Finance at r-project.org>
>     mailing list
>     https://stat.ethz.ch/mailman/listinfo/r-sig-finance
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-finance>
>     -- Subscriber-posting only. If you want to post, subscribe first.
>     -- Also note that this is not the r-help list where general R
>     questions should go.
>
>

_______________________________________________
R-SIG-Finance at r-project.org mailing list
https://stat.ethz.ch/mailman/listinfo/r-sig-finance
-- Subscriber-posting only. If you want to post, subscribe first.
-- Also note that this is not the r-help list where general R questions
should go.


From brian at braverock.com  Mon Sep 26 04:24:30 2016
From: brian at braverock.com (Brian G. Peterson)
Date: Sun, 25 Sep 2016 21:24:30 -0500
Subject: [R-SIG-Finance] Question on Capturing Open, High, Low, Close,
 with a timestamp
In-Reply-To: <F51065C7-B1D0-44CC-B8EE-D01DE9F7D5FF@verizon.net>
References: <F51065C7-B1D0-44CC-B8EE-D01DE9F7D5FF@verizon.net>
Message-ID: <57E886DE.8020802@braverock.com>

On 09/24/2016 10:49 AM, Daniel Mack wrote:
> Hello,  I looking for a function that would automatically list the timestamp of the OHLC data.   The open and close are obvious but the format I am looking would be some like
>
> 2016-09-23	AAPL    114.52  09:30:00	114.58  09:31:00	111.90  13:58:00	112.22  16:00:00
>
> I have seen a the regular inclusion of time stamp meta data, and that would require the downloading and sorting of all intraday data and then taking the max and min of the data.  I am hoping not to have to due this to sane on data transfer time and additional processing. This takes more time than the analysis does.
>
> I currently use the getSymbols from quant mod

There is no standardized format for what you're asking for.

OHLC data loses the time of the High and Low stamps.  That has always 
been true, in every format, and from every provider.

If you want higher granularity, you need to start from tick data and 
aggregate from there, which xts/quantmod provide multiple tools for 
doing. See ?to.period

Regards,

Brian


-- 
Brian G. Peterson
http://braverock.com/brian/
Ph: 773-459-4973
IM: bgpbraverock


From markpmc at gmail.com  Mon Sep 26 04:34:43 2016
From: markpmc at gmail.com (Mark McClellan)
Date: Mon, 26 Sep 2016 02:34:43 +0000
Subject: [R-SIG-Finance] Question on Capturing Open, High, Low, Close,
 with a timestamp
In-Reply-To: <57E886DE.8020802@braverock.com>
References: <F51065C7-B1D0-44CC-B8EE-D01DE9F7D5FF@verizon.net>
	<57E886DE.8020802@braverock.com>
Message-ID: <CABwSZmFMBm0Qut-GBSFCDUq-qO3+s5i0c10LLxQ159A-Tq5S=g@mail.gmail.com>

Dan,

I have a Java app (on github) that grabs the intra-day data (1 min bars)
and stores it in mongodb. Let me know if you want to take a look.

Mark

On Sun, Sep 25, 2016, 9:26 PM Brian G. Peterson <brian at braverock.com> wrote:

> On 09/24/2016 10:49 AM, Daniel Mack wrote:
> > Hello,  I looking for a function that would automatically list the
> timestamp of the OHLC data.   The open and close are obvious but the format
> I am looking would be some like
> >
> > 2016-09-23    AAPL    114.52  09:30:00        114.58  09:31:00
> 111.90  13:58:00        112.22  16:00:00
> >
> > I have seen a the regular inclusion of time stamp meta data, and that
> would require the downloading and sorting of all intraday data and then
> taking the max and min of the data.  I am hoping not to have to due this to
> sane on data transfer time and additional processing. This takes more time
> than the analysis does.
> >
> > I currently use the getSymbols from quant mod
>
> There is no standardized format for what you're asking for.
>
> OHLC data loses the time of the High and Low stamps.  That has always
> been true, in every format, and from every provider.
>
> If you want higher granularity, you need to start from tick data and
> aggregate from there, which xts/quantmod provide multiple tools for
> doing. See ?to.period
>
> Regards,
>
> Brian
>
>
> --
> Brian G. Peterson
> http://braverock.com/brian/
> Ph: 773-459-4973
> IM: bgpbraverock
>
> _______________________________________________
> R-SIG-Finance at r-project.org mailing list
> https://stat.ethz.ch/mailman/listinfo/r-sig-finance
> -- Subscriber-posting only. If you want to post, subscribe first.
> -- Also note that this is not the r-help list where general R questions
> should go.
>
-- 

Mark McClellan
251.391.3739

	[[alternative HTML version deleted]]


From omerle at laposte.net  Wed Sep 28 02:57:52 2016
From: omerle at laposte.net (omerle)
Date: RANDOM_Wed, 28 Sep 2016 03:57:52 +0300
Subject: [R-SIG-Finance] oh, what a surprise!
Message-ID: <00005ea2b129$12b25c39$2dbce6ad$@laposte.net>

Hey, 

Have you heard  the news? It is so awesome, it was a real surprise for me, just take a look <http://connect.geckopestcontrolchico.com/e7bim>

Be well, omerle



	[[alternative HTML version deleted]]


